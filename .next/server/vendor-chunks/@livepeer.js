"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@livepeer";
exports.ids = ["vendor-chunks/@livepeer"];
exports.modules = {

/***/ "(ssr)/./node_modules/@livepeer/core-web/dist/browser/index.js":
/*!***************************************************************!*\
  !*** ./node_modules/@livepeer/core-web/dist/browser/index.js ***!
  \***************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addEventListeners: () => (/* binding */ addEventListeners),\n/* harmony export */   addMediaMetrics: () => (/* binding */ addMediaMetrics),\n/* harmony export */   canPlayMediaNatively: () => (/* binding */ canPlayMediaNatively),\n/* harmony export */   getDeviceInfo: () => (/* binding */ getDeviceInfo)\n/* harmony export */ });\n/* harmony import */ var _livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @livepeer/core/errors */ \"(ssr)/./node_modules/@livepeer/core/dist/errors/index.js\");\n/* harmony import */ var _livepeer_core_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @livepeer/core/utils */ \"(ssr)/./node_modules/@livepeer/core/dist/utils/index.js\");\n/* harmony import */ var _livepeer_core_media__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @livepeer/core/media */ \"(ssr)/./node_modules/@livepeer/core/dist/media/index.js\");\n/* harmony import */ var hls_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! hls.js */ \"(ssr)/./node_modules/hls.js/dist/hls.mjs\");\n/* harmony import */ var _livepeer_core_storage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @livepeer/core/storage */ \"(ssr)/./node_modules/@livepeer/core/dist/storage/index.js\");\n/* harmony import */ var _livepeer_core_version__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @livepeer/core/version */ \"(ssr)/./node_modules/@livepeer/core/dist/version/index.js\");\n// src/media/controls/controller.ts\n\n\n\n// src/hls/hls.ts\n\n\n\n// src/media/utils.ts\n\nvar isClient = () => typeof window !== \"undefined\";\nvar ua = () => isClient() ? window?.navigator?.userAgent?.toLowerCase() : \"\";\nvar isIos = () => /iphone|ipad|ipod|ios|CriOS|FxiOS/.test(ua());\nvar isAndroid = () => /android/.test(ua());\nvar isMobile = () => isClient() && (isIos() || isAndroid());\nvar canPlayMediaNatively = (src) => {\n  if (isClient() && src?.mime) {\n    if (src?.type?.includes(\"audio\")) {\n      const audio = document.createElement(\"audio\");\n      return audio.canPlayType(src.mime).length > 0;\n    }\n    const video = document.createElement(\"video\");\n    return video.canPlayType(src.mime).length > 0;\n  }\n  return true;\n};\n\n// src/hls/hls.ts\nvar VIDEO_HLS_INITIALIZED_ATTRIBUTE = \"data-livepeer-video-hls-initialized\";\nvar isHlsSupported = () => isClient() ? hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].isSupported() : true;\nvar createNewHls = ({\n  source,\n  element,\n  callbacks,\n  aspectRatio,\n  config,\n  initialQuality\n}) => {\n  if (element.getAttribute(VIDEO_HLS_INITIALIZED_ATTRIBUTE) === \"true\") {\n    return {\n      setQuality: () => {\n      },\n      destroy: () => {\n      }\n    };\n  }\n  element.setAttribute(VIDEO_HLS_INITIALIZED_ATTRIBUTE, \"true\");\n  const hls = new hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]({\n    backBufferLength: 60 * 1.5,\n    manifestLoadingMaxRetry: 0,\n    fragLoadingMaxRetry: 0,\n    levelLoadingMaxRetry: 0,\n    appendErrorMaxRetry: 0,\n    ...config,\n    ...config?.liveSyncDurationCount ? {\n      liveSyncDurationCount: config.liveSyncDurationCount\n    } : {\n      liveMaxLatencyDurationCount: 7,\n      liveSyncDurationCount: 3\n    }\n  });\n  const onDestroy = () => {\n    hls?.destroy?.();\n    element?.removeAttribute?.(VIDEO_HLS_INITIALIZED_ATTRIBUTE);\n  };\n  if (element) {\n    hls.attachMedia(element);\n  }\n  let redirected = false;\n  hls.on(hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.LEVEL_LOADED, async (_e, data) => {\n    const { live, totalduration: duration, url } = data.details;\n    if (!redirected) {\n      callbacks?.onRedirect?.(url ?? null);\n      redirected = true;\n    }\n    callbacks?.onLive?.(Boolean(live));\n    callbacks?.onDuration?.(duration ?? 0);\n  });\n  hls.on(hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.MEDIA_ATTACHED, async () => {\n    hls.loadSource(source);\n    hls.on(hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.MANIFEST_PARSED, (_event, _data) => {\n      setQuality({\n        hls: hls ?? null,\n        quality: initialQuality,\n        aspectRatio\n      });\n      callbacks?.onCanPlay?.();\n      if (config.autoPlay) element?.play?.();\n    });\n  });\n  hls.on(hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Events.ERROR, async (_event, data) => {\n    const { details, fatal } = data;\n    const isManifestParsingError = details === \"manifestParsingError\";\n    if (!fatal && !isManifestParsingError) return;\n    callbacks?.onError?.(data);\n    if (fatal) {\n      console.error(`Fatal error : ${data.details}`);\n      switch (data.type) {\n        case hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].ErrorTypes.MEDIA_ERROR:\n          hls.recoverMediaError();\n          break;\n        case hls_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].ErrorTypes.NETWORK_ERROR:\n          console.error(`A network error occurred: ${data.details}`);\n          break;\n        default:\n          console.error(`An unrecoverable error occurred: ${data.details}`);\n          hls.destroy();\n          break;\n      }\n    }\n  });\n  function updateOffset() {\n    const currentDate = Date.now();\n    const newDate = hls.playingDate;\n    if (newDate && currentDate) {\n      callbacks?.onPlaybackOffsetUpdated?.(currentDate - newDate.getTime());\n    }\n  }\n  const updateOffsetInterval = setInterval(updateOffset, 2e3);\n  return {\n    destroy: () => {\n      onDestroy?.();\n      clearInterval?.(updateOffsetInterval);\n      element?.removeAttribute?.(VIDEO_HLS_INITIALIZED_ATTRIBUTE);\n    },\n    setQuality: (videoQuality) => {\n      setQuality({\n        hls: hls ?? null,\n        quality: videoQuality,\n        aspectRatio\n      });\n    }\n  };\n};\nvar setQuality = ({\n  hls,\n  quality,\n  aspectRatio\n}) => {\n  if (hls) {\n    const { width } = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_2__.calculateVideoQualityDimensions)(quality, aspectRatio);\n    if (!width || quality === \"auto\") {\n      hls.currentLevel = -1;\n      return;\n    }\n    if (hls.levels && hls.levels.length > 0) {\n      const sortedLevels = hls.levels.map((level, index) => ({ ...level, index })).sort(\n        (a, b) => Math.abs((width ?? 0) - a.width) - Math.abs((width ?? 0) - b.width)\n      );\n      const bestMatchLevel = sortedLevels?.[0];\n      if ((bestMatchLevel?.index ?? -1) >= 0) {\n        hls.currentLevel = bestMatchLevel.index;\n      } else {\n        hls.currentLevel = -1;\n      }\n    }\n  }\n};\n\n// src/webrtc/shared.ts\n\nvar getRTCPeerConnectionConstructor = () => {\n  if (!isClient()) {\n    return null;\n  }\n  return window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || null;\n};\nfunction createPeerConnection(host, iceServers) {\n  const RTCPeerConnectionConstructor = getRTCPeerConnectionConstructor();\n  if (!RTCPeerConnectionConstructor) {\n    throw new Error(\"No RTCPeerConnection constructor found in this browser.\");\n  }\n  const hostNoPort = host?.split(\":\")[0];\n  const defaultIceServers = host ? [\n    {\n      urls: `stun:${hostNoPort}`\n    },\n    {\n      urls: `turn:${hostNoPort}`,\n      username: \"livepeer\",\n      credential: \"livepeer\"\n    }\n  ] : [];\n  return new RTCPeerConnectionConstructor({\n    iceServers: iceServers ? Array.isArray(iceServers) ? iceServers : [iceServers] : defaultIceServers\n  });\n}\nvar DEFAULT_TIMEOUT = 1e4;\nasync function negotiateConnectionWithClientOffer(peerConnection, endpoint, ofr, controller, accessControl, sdpTimeout) {\n  if (peerConnection && endpoint && ofr) {\n    const response = await postSDPOffer(\n      endpoint,\n      ofr.sdp,\n      controller,\n      accessControl,\n      sdpTimeout\n    );\n    if (response.ok) {\n      const answerSDP = await response.text();\n      await peerConnection.setRemoteDescription(\n        new RTCSessionDescription({ type: \"answer\", sdp: answerSDP })\n      );\n      const playheadUtc = response.headers.get(\"Playhead-Utc\");\n      return new Date(playheadUtc ?? /* @__PURE__ */ new Date());\n    }\n    if (response.status === 406) {\n      throw new Error(_livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__.NOT_ACCEPTABLE_ERROR_MESSAGE);\n    }\n    const errorMessage = await response.text();\n    throw new Error(errorMessage);\n  }\n  throw new Error(\"Peer connection not defined.\");\n}\nfunction preferCodec(sdp, codec) {\n  const lines = sdp.split(\"\\r\\n\");\n  const mLineIndex = lines.findIndex((line) => line.startsWith(\"m=video\"));\n  if (mLineIndex === -1) return sdp;\n  const codecRegex = new RegExp(`a=rtpmap:(\\\\d+) ${codec}(/\\\\d+)+`);\n  const codecLine = lines.find((line) => codecRegex.test(line));\n  if (!codecLine) return sdp;\n  const codecPayload = codecRegex.exec(codecLine)[1];\n  const mLineElements = lines[mLineIndex].split(\" \");\n  const reorderedMLine = [\n    ...mLineElements.slice(0, 3),\n    codecPayload,\n    ...mLineElements.slice(3).filter((payload) => payload !== codecPayload)\n  ];\n  lines[mLineIndex] = reorderedMLine.join(\" \");\n  return lines.join(\"\\r\\n\");\n}\nasync function constructClientOffer(peerConnection, endpoint, noIceGathering) {\n  if (peerConnection && endpoint) {\n    const originalCreateOffer = peerConnection.createOffer.bind(peerConnection);\n    peerConnection.createOffer = async function(...args) {\n      const originalOffer = await originalCreateOffer.apply(this, args);\n      return new RTCSessionDescription({\n        // @ts-ignore (TODO: fix this)\n        type: originalOffer.type,\n        // @ts-ignore (TODO: fix this)\n        sdp: preferCodec(originalOffer.sdp, \"H264\")\n      });\n    };\n    const offer = await peerConnection.createOffer();\n    await peerConnection.setLocalDescription(offer);\n    if (noIceGathering) {\n      return peerConnection.localDescription;\n    }\n    const ofr = await waitToCompleteICEGathering(peerConnection);\n    if (!ofr) {\n      throw Error(\"failed to gather ICE candidates for offer\");\n    }\n    return ofr;\n  }\n  return null;\n}\nvar playbackIdPattern = /([/+])([^/+?]+)$/;\nvar REPLACE_PLACEHOLDER = \"PLAYBACK_ID\";\nvar MAX_REDIRECT_CACHE_SIZE = 10;\nvar redirectUrlCache = /* @__PURE__ */ new Map();\nfunction getCachedTemplate(key) {\n  const cachedItem = redirectUrlCache.get(key);\n  if (cachedItem) {\n    redirectUrlCache.delete(key);\n    redirectUrlCache.set(key, cachedItem);\n  }\n  return cachedItem;\n}\nfunction setCachedTemplate(key, value) {\n  if (redirectUrlCache.has(key)) {\n    redirectUrlCache.delete(key);\n  } else if (redirectUrlCache.size >= MAX_REDIRECT_CACHE_SIZE) {\n    const oldestKey = redirectUrlCache.keys().next().value;\n    if (oldestKey) {\n      redirectUrlCache.delete(oldestKey);\n    }\n  }\n  redirectUrlCache.set(key, value);\n}\nasync function postSDPOffer(endpoint, data, controller, accessControl, sdpTimeout) {\n  const id = setTimeout(\n    () => controller.abort(),\n    sdpTimeout ?? DEFAULT_TIMEOUT\n  );\n  const urlForPost = new URL(endpoint);\n  const parsedMatches = urlForPost.pathname.match(playbackIdPattern);\n  const currentPlaybackId = parsedMatches?.[2];\n  const cachedTemplateUrl = getCachedTemplate(endpoint);\n  if (cachedTemplateUrl && currentPlaybackId) {\n    urlForPost.host = cachedTemplateUrl.host;\n    urlForPost.pathname = cachedTemplateUrl.pathname.replace(\n      REPLACE_PLACEHOLDER,\n      currentPlaybackId\n    );\n    urlForPost.search = cachedTemplateUrl.search;\n  }\n  const response = await fetch(urlForPost.toString(), {\n    method: \"POST\",\n    mode: \"cors\",\n    headers: {\n      \"content-type\": \"application/sdp\",\n      ...accessControl?.accessKey ? {\n        \"Livepeer-Access-Key\": accessControl.accessKey\n      } : {},\n      ...accessControl?.jwt ? {\n        \"Livepeer-Jwt\": accessControl.jwt\n      } : {}\n    },\n    body: data,\n    signal: controller.signal\n  });\n  clearTimeout(id);\n  return response;\n}\nasync function getRedirectUrl(endpoint, abortController, timeout) {\n  try {\n    const cachedTemplateUrl = getCachedTemplate(endpoint);\n    if (cachedTemplateUrl) {\n      const currentIngestUrl = new URL(endpoint);\n      const matches = currentIngestUrl.pathname.match(playbackIdPattern);\n      const currentPlaybackId = matches?.[2];\n      if (currentPlaybackId) {\n        const finalRedirectUrl = new URL(cachedTemplateUrl);\n        finalRedirectUrl.pathname = cachedTemplateUrl.pathname.replace(\n          REPLACE_PLACEHOLDER,\n          currentPlaybackId\n        );\n        return finalRedirectUrl;\n      }\n    }\n    const id = setTimeout(\n      () => abortController.abort(),\n      timeout ?? DEFAULT_TIMEOUT\n    );\n    const response = await fetch(endpoint, {\n      method: \"HEAD\",\n      signal: abortController.signal\n    });\n    await response.text();\n    clearTimeout(id);\n    const actualRedirectedUrl = new URL(response.url);\n    if (actualRedirectedUrl) {\n      const templateForCache = new URL(actualRedirectedUrl);\n      templateForCache.pathname = templateForCache.pathname.replace(\n        playbackIdPattern,\n        `$1${REPLACE_PLACEHOLDER}`\n      );\n      if (!templateForCache.searchParams.has(\"ingestpb\") || templateForCache.searchParams.get(\"ingestpb\") !== \"true\") {\n        setCachedTemplate(endpoint, templateForCache);\n      }\n    }\n    return actualRedirectedUrl;\n  } catch (e) {\n    return null;\n  }\n}\nasync function waitToCompleteICEGathering(peerConnection) {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(peerConnection.localDescription);\n    }, 5e3);\n    peerConnection.onicegatheringstatechange = (_ev) => {\n      if (peerConnection.iceGatheringState === \"complete\") {\n        resolve(peerConnection.localDescription);\n      }\n    };\n  });\n}\n\n// src/webrtc/whep.ts\nvar VIDEO_WEBRTC_INITIALIZED_ATTRIBUTE = \"data-livepeer-video-whep-initialized\";\nvar createNewWHEP = ({\n  source,\n  element,\n  callbacks,\n  accessControl,\n  sdpTimeout,\n  iceServers\n}) => {\n  if (element.getAttribute(VIDEO_WEBRTC_INITIALIZED_ATTRIBUTE) === \"true\") {\n    return {\n      destroy: () => {\n      }\n    };\n  }\n  element.setAttribute(VIDEO_WEBRTC_INITIALIZED_ATTRIBUTE, \"true\");\n  let destroyed = false;\n  const abortController = new AbortController();\n  let peerConnection = null;\n  const stream = new MediaStream();\n  const errorComposed = (e) => {\n    callbacks?.onError?.(e);\n    if (element) {\n      element.srcObject = null;\n    }\n  };\n  getRedirectUrl(source, abortController, sdpTimeout).then((redirectUrl) => {\n    if (destroyed || !redirectUrl) {\n      return;\n    }\n    const redirectUrlString = redirectUrl.toString();\n    callbacks?.onRedirect?.(redirectUrlString ?? null);\n    peerConnection = createPeerConnection(redirectUrl.host, iceServers);\n    if (peerConnection) {\n      peerConnection.addTransceiver(\"video\", {\n        direction: \"recvonly\"\n      });\n      peerConnection.addTransceiver(\"audio\", {\n        direction: \"recvonly\"\n      });\n      peerConnection.ontrack = (event) => {\n        if (destroyed) {\n          return;\n        }\n        try {\n          if (stream) {\n            const track = event.track;\n            const currentTracks = stream.getTracks();\n            const streamAlreadyHasVideoTrack = currentTracks.some(\n              (track2) => track2.kind === \"video\"\n            );\n            const streamAlreadyHasAudioTrack = currentTracks.some(\n              (track2) => track2.kind === \"audio\"\n            );\n            switch (track.kind) {\n              case \"video\":\n                if (streamAlreadyHasVideoTrack) {\n                  break;\n                }\n                stream.addTrack(track);\n                break;\n              case \"audio\":\n                if (streamAlreadyHasAudioTrack) {\n                  break;\n                }\n                stream.addTrack(track);\n                break;\n              default:\n                console.log(`received unknown track ${track}`);\n            }\n          }\n        } catch (e) {\n          errorComposed(e);\n        }\n      };\n      peerConnection.addEventListener(\"connectionstatechange\", (_ev) => {\n        if (destroyed) {\n          return;\n        }\n        try {\n          if (peerConnection?.connectionState === \"failed\") {\n            callbacks?.onError?.(new Error(\"Failed to connect to peer.\"));\n          }\n          if (peerConnection?.connectionState === \"connected\" && !element.srcObject) {\n            element.srcObject = stream;\n            callbacks?.onConnected?.();\n          }\n        } catch (e) {\n          errorComposed(e);\n        }\n      });\n      peerConnection.addEventListener(\"negotiationneeded\", async (_ev) => {\n        if (destroyed) {\n          return;\n        }\n        try {\n          const ofr = await constructClientOffer(\n            peerConnection,\n            redirectUrlString\n          );\n          if (destroyed) {\n            return;\n          }\n          const response = await negotiateConnectionWithClientOffer(\n            peerConnection,\n            source,\n            ofr,\n            abortController,\n            accessControl,\n            sdpTimeout\n          );\n          if (destroyed) {\n            return;\n          }\n          const currentDate = Date.now();\n          if (response && currentDate) {\n            callbacks?.onPlaybackOffsetUpdated?.(\n              currentDate - response.getTime()\n            );\n          }\n        } catch (e) {\n          errorComposed(e);\n        }\n      });\n    }\n  }).catch((e) => errorComposed(e));\n  return {\n    destroy: () => {\n      destroyed = true;\n      abortController?.abort?.();\n      peerConnection?.close?.();\n      if (element) {\n        element.srcObject = null;\n      }\n      element?.removeAttribute?.(VIDEO_WEBRTC_INITIALIZED_ATTRIBUTE);\n    }\n  };\n};\n\n// src/media/controls/fullscreen.ts\nvar methodsList = [\n  // modern browsers\n  {\n    requestFullscreen: \"requestFullscreen\",\n    exitFullscreen: \"exitFullscreen\",\n    fullscreenElement: \"fullscreenElement\",\n    fullscreenEnabled: \"fullscreenEnabled\",\n    fullscreenchange: \"fullscreenchange\",\n    fullscreenerror: \"fullscreenerror\"\n  },\n  // new WebKit\n  {\n    requestFullscreen: \"webkitRequestFullscreen\",\n    exitFullscreen: \"webkitExitFullscreen\",\n    fullscreenElement: \"webkitFullscreenElement\",\n    fullscreenEnabled: \"webkitFullscreenEnabled\",\n    fullscreenchange: \"webkitfullscreenchange\",\n    fullscreenerror: \"webkitfullscreenerror\"\n  },\n  // old WebKit\n  {\n    requestFullscreen: \"webkitRequestFullScreen\",\n    exitFullscreen: \"webkitCancelFullScreen\",\n    fullscreenElement: \"webkitCurrentFullScreenElement\",\n    fullscreenEnabled: \"webkitCancelFullScreen\",\n    fullscreenchange: \"webkitfullscreenchange\",\n    fullscreenerror: \"webkitfullscreenerror\"\n  },\n  // old firefox\n  {\n    requestFullscreen: \"mozRequestFullScreen\",\n    exitFullscreen: \"mozCancelFullScreen\",\n    fullscreenElement: \"mozFullScreenElement\",\n    fullscreenEnabled: \"mozFullScreenEnabled\",\n    fullscreenchange: \"mozfullscreenchange\",\n    fullscreenerror: \"mozfullscreenerror\"\n  },\n  // old IE\n  {\n    requestFullscreen: \"msRequestFullscreen\",\n    exitFullscreen: \"msExitFullscreen\",\n    fullscreenElement: \"msFullscreenElement\",\n    fullscreenEnabled: \"msFullscreenEnabled\",\n    fullscreenchange: \"MSFullscreenChange\",\n    fullscreenerror: \"MSFullscreenError\"\n  }\n];\nvar iosMethods = {\n  requestFullscreen: \"webkitEnterFullscreen\",\n  exitFullscreen: \"webkitExitFullscreen\",\n  fullscreenElement: null,\n  fullscreenEnabled: \"webkitDisplayingFullscreen\",\n  fullscreenchange: \"fullscreenchange\",\n  fullscreenerror: \"fullscreenerror\"\n};\nvar isFullscreenSupported = () => {\n  if (typeof document === \"undefined\") {\n    return true;\n  }\n  const videoElement = document.createElement(\"video\");\n  const result = Boolean(getFullscreenMethods(videoElement));\n  videoElement.remove();\n  return result;\n};\nvar isCurrentlyFullscreen = (inputElement) => {\n  const { methods, element } = getFullscreenMethods(inputElement);\n  if (methods?.fullscreenElement) {\n    return Boolean(document[methods.fullscreenElement]);\n  }\n  return Boolean(element?.webkitPresentationMode === \"fullscreen\");\n};\nvar enterFullscreen = (inputElement) => {\n  const { methods, element } = getFullscreenMethods(inputElement);\n  if (methods) {\n    return new Promise((resolve, reject) => {\n      const fullscreenMethod = methods.requestFullscreen;\n      const onFullScreen = () => {\n        removeFullscreenEventListener(inputElement, onFullScreen);\n        resolve();\n      };\n      addFullscreenEventListener(inputElement, onFullScreen);\n      const returnPromise = methods.fullscreenElement ? element?.parentElement?.[fullscreenMethod]?.() : element?.[fullscreenMethod]?.() ?? null;\n      if (returnPromise === null) {\n        return resolve();\n      }\n      if (returnPromise instanceof Promise) {\n        returnPromise.then(onFullScreen).catch(reject);\n      }\n    });\n  }\n  return false;\n};\nvar exitFullscreen = (inputElement) => {\n  const { methods, element } = getFullscreenMethods(inputElement);\n  if (methods) {\n    return new Promise((resolve, reject) => {\n      if (!isCurrentlyFullscreen(inputElement)) {\n        resolve();\n        return;\n      }\n      const onFullScreenExit = () => {\n        removeFullscreenEventListener(inputElement, onFullScreenExit);\n        resolve();\n      };\n      addFullscreenEventListener(inputElement, onFullScreenExit);\n      const returnPromise = methods.fullscreenElement ? document?.[methods.exitFullscreen]?.() : element?.[methods.exitFullscreen]?.() ?? null;\n      if (returnPromise instanceof Promise) {\n        returnPromise.then(onFullScreenExit).catch(reject);\n      }\n    });\n  }\n  return false;\n};\nvar addFullscreenEventListener = (inputElement, callback) => {\n  const { methods, element } = getFullscreenMethods(inputElement);\n  if (methods && element) {\n    const parentElementOrElement = element?.parentElement ?? element;\n    parentElementOrElement?.addEventListener(\n      methods.fullscreenchange,\n      callback,\n      false\n    );\n    return () => {\n      removeFullscreenEventListener(inputElement, callback);\n    };\n  }\n  return null;\n};\nvar removeFullscreenEventListener = (inputElement, callback) => {\n  const { methods, element } = getFullscreenMethods(inputElement);\n  if (methods && element) {\n    const parentElementOrElement = element?.parentElement ?? element;\n    parentElementOrElement?.removeEventListener(\n      methods.fullscreenchange,\n      callback,\n      false\n    );\n    return true;\n  }\n  return false;\n};\nvar getFullscreenMethods = (element) => {\n  if (isClient()) {\n    for (const methods of methodsList) {\n      const exitFullscreenMethod = methods.exitFullscreen;\n      if (exitFullscreenMethod in document) {\n        return { methods, element };\n      }\n    }\n    if (element && iosMethods.requestFullscreen in element) {\n      return { methods: iosMethods, element };\n    }\n  }\n  return { methods: null };\n};\n\n// src/media/controls/pictureInPicture.ts\nvar isPictureInPictureSupported = (element) => {\n  if (typeof document === \"undefined\") {\n    return true;\n  }\n  const videoElement = element ?? document.createElement(\"video\");\n  const isPiPDisabled = Boolean(\n    videoElement.disablePictureInPicture\n  );\n  const { apiType } = getPictureInPictureMode(videoElement);\n  return Boolean(apiType) && !isPiPDisabled;\n};\nvar isCurrentlyPictureInPicture = (inputElement) => {\n  const { apiType, element } = getPictureInPictureMode(inputElement);\n  if (apiType === \"w3c\") {\n    return Boolean(document?.pictureInPictureElement);\n  }\n  if (apiType === \"webkit\") {\n    return element?.webkitPresentationMode === \"picture-in-picture\";\n  }\n  return false;\n};\nvar enterPictureInPicture = async (inputElement) => {\n  const { apiType, element } = getPictureInPictureMode(inputElement);\n  if (apiType === \"w3c\") {\n    await element?.requestPictureInPicture?.();\n  } else if (apiType === \"webkit\") {\n    await element?.webkitSetPresentationMode?.(\"picture-in-picture\");\n  }\n  return null;\n};\nvar exitPictureInPicture = (inputElement) => {\n  const { apiType, element } = getPictureInPictureMode(inputElement);\n  if (apiType === \"w3c\") {\n    return document?.exitPictureInPicture?.() ?? null;\n  }\n  if (apiType === \"webkit\") {\n    return element?.webkitSetPresentationMode?.(\"inline\") ?? null;\n  }\n  return null;\n};\nvar addEnterPictureInPictureEventListener = (inputElement, callback) => {\n  const { apiType, element } = getPictureInPictureMode(inputElement);\n  if (apiType === \"w3c\" && element) {\n    element.addEventListener(\"enterpictureinpicture\", callback, false);\n    return () => {\n      element.removeEventListener(\"enterpictureinpicture\", callback, false);\n    };\n  }\n  if (apiType === \"webkit\" && element) {\n    const callbackComposed = (e) => {\n      if (element?.webkitPresentationMode === \"picture-in-picture\") {\n        callback?.(e);\n      }\n    };\n    document.addEventListener(\n      \"webkitpresentationmodechanged\",\n      callbackComposed,\n      false\n    );\n    return () => {\n      document.removeEventListener(\n        \"webkitpresentationmodechanged\",\n        callbackComposed,\n        false\n      );\n    };\n  }\n  return null;\n};\nvar addExitPictureInPictureEventListener = (inputElement, callback) => {\n  const { apiType, element } = getPictureInPictureMode(inputElement);\n  if (apiType === \"w3c\" && element) {\n    element.addEventListener(\"leavepictureinpicture\", callback, false);\n    return () => {\n      element.removeEventListener(\"leavepictureinpicture\", callback, false);\n    };\n  }\n  if (apiType === \"webkit\" && element) {\n    const callbackComposed = (e) => {\n      if (element?.webkitPresentationMode === \"inline\") {\n        callback?.(e);\n      }\n    };\n    document.addEventListener(\n      \"webkitpresentationmodechanged\",\n      callbackComposed,\n      false\n    );\n    return () => {\n      document.removeEventListener(\n        \"webkitpresentationmodechanged\",\n        callbackComposed,\n        false\n      );\n    };\n  }\n  return null;\n};\nvar getPictureInPictureMode = (element) => {\n  if (isClient() && element instanceof HTMLVideoElement) {\n    if (document?.pictureInPictureEnabled) {\n      return { apiType: \"w3c\", element };\n    }\n    if (element?.webkitSupportsPresentationMode?.(\"picture-in-picture\")) {\n      return { apiType: \"webkit\", element };\n    }\n  }\n  return { apiType: null };\n};\n\n// src/media/controls/volume.ts\nvar isVolumeChangeSupported = (type) => {\n  return new Promise((resolve) => {\n    if (typeof window === \"undefined\") {\n      return false;\n    }\n    const testElement = document.createElement(type);\n    const newVolume = 0.342;\n    testElement.volume = newVolume;\n    setTimeout(() => {\n      const isSupported = testElement.volume !== 1;\n      testElement.remove();\n      resolve(isSupported);\n    });\n  });\n};\n\n// src/media/controls/controller.ts\nvar MEDIA_CONTROLLER_INITIALIZED_ATTRIBUTE = \"data-livepeer-controller-initialized\";\nvar allKeyTriggers = [\n  \"KeyF\",\n  \"KeyK\",\n  \"KeyM\",\n  \"KeyI\",\n  \"KeyV\",\n  \"KeyX\",\n  \"Space\",\n  \"ArrowRight\",\n  \"ArrowLeft\"\n];\nvar delay = (ms) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\nvar addEventListeners = (element, store) => {\n  const initializedState = store.getState();\n  try {\n    isVolumeChangeSupported(\n      initializedState.currentSource?.type === \"audio\" ? \"audio\" : \"video\"\n    ).then((result) => {\n      store.setState(({ __device }) => ({\n        __device: {\n          ...__device,\n          isVolumeChangeSupported: result\n        }\n      }));\n    });\n  } catch (e) {\n    console.error(e);\n  }\n  const onLoadedMetadata = () => {\n    store.getState().__controlsFunctions.onCanPlay();\n    store.getState().__controlsFunctions.requestMeasure();\n  };\n  const onLoadedData = () => {\n    store.getState().__controlsFunctions.requestMeasure();\n  };\n  const onPlay = () => {\n    store.getState().__controlsFunctions.onPlay();\n  };\n  const onPause = () => {\n    store.getState().__controlsFunctions.onPause();\n  };\n  const onDurationChange = () => store.getState().__controlsFunctions.onDurationChange(element?.duration ?? 0);\n  const onKeyUp = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const code = e.code;\n    store.getState().__controlsFunctions.updateLastInteraction();\n    const isNotBroadcast = store.getState().__initialProps.hotkeys !== \"broadcast\";\n    if (allKeyTriggers.includes(code)) {\n      if ((code === \"Space\" || code === \"KeyK\") && isNotBroadcast) {\n        store.getState().__controlsFunctions.togglePlay();\n      } else if (code === \"ArrowRight\" && isNotBroadcast) {\n        store.getState().__controlsFunctions.requestSeekForward();\n      } else if (code === \"ArrowLeft\" && isNotBroadcast) {\n        store.getState().__controlsFunctions.requestSeekBack();\n      } else if (code === \"KeyM\" && isNotBroadcast) {\n        store.getState().__controlsFunctions.requestToggleMute();\n      } else if (code === \"KeyX\" && isNotBroadcast) {\n        store.getState().__controlsFunctions.requestClip();\n      } else if (code === \"KeyF\") {\n        store.getState().__controlsFunctions.requestToggleFullscreen();\n      } else if (code === \"KeyI\") {\n        store.getState().__controlsFunctions.requestTogglePictureInPicture();\n      }\n    }\n  };\n  const onMouseUpdate = () => {\n    store.getState().__controlsFunctions.updateLastInteraction();\n  };\n  const onTouchUpdate = async () => {\n    store.getState().__controlsFunctions.updateLastInteraction();\n  };\n  const onVolumeChange = () => {\n    store.getState().__controlsFunctions.setVolume(element.muted ? 0 : element.volume ?? 0);\n  };\n  const onRateChange = () => {\n    store.getState().__controlsFunctions.setPlaybackRate(element.playbackRate);\n  };\n  const onTimeUpdate = () => {\n    store.getState().__controlsFunctions.onProgress(element?.currentTime ?? 0);\n    if (element && (element?.duration ?? 0) > 0) {\n      const currentTime = element.currentTime;\n      const buffered = [...Array(element.buffered.length)].reduce(\n        (prev, _curr, i) => {\n          const start = element.buffered.start(element.buffered.length - 1 - i);\n          const end = element.buffered.end(element.buffered.length - 1 - i);\n          if (start <= currentTime && end >= currentTime) {\n            return end;\n          }\n          return prev;\n        },\n        // default to no buffering\n        0\n      );\n      store.getState().__controlsFunctions.updateBuffered(buffered);\n    }\n  };\n  const onError = async (e) => {\n    const source = store.getState().currentSource;\n    if (source?.type === \"video\") {\n      const sourceElement = e.target;\n      const parentElement = sourceElement?.parentElement;\n      const videoUrl = parentElement?.currentSrc ?? sourceElement?.currentSrc;\n      if (videoUrl) {\n        try {\n          const response = await fetch(videoUrl);\n          if (response.status === 404) {\n            console.warn(\"Video not found\");\n            return store.getState().__controlsFunctions?.onError?.(\n              new Error(_livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__.STREAM_OFFLINE_ERROR_MESSAGE)\n            );\n          }\n          if (response.status === 401) {\n            console.warn(\"Unauthorized to view video\");\n            return store.getState().__controlsFunctions?.onError?.(\n              new Error(_livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__.ACCESS_CONTROL_ERROR_MESSAGE)\n            );\n          }\n        } catch (err) {\n          console.warn(err);\n          return store.getState().__controlsFunctions?.onError?.(\n            new Error(\"Error fetching video URL\")\n          );\n        }\n      }\n      console.warn(\"Unknown error loading video\");\n      return store.getState().__controlsFunctions?.onError?.(\n        new Error(\"Unknown error loading video\")\n      );\n    }\n    store.getState().__controlsFunctions.onError(new Error(e?.message));\n  };\n  const onWaiting = async () => {\n    store.getState().__controlsFunctions.onWaiting();\n  };\n  const onStalled = async () => {\n    store.getState().__controlsFunctions.onStalled();\n  };\n  const onLoadStart = async () => {\n    store.getState().__controlsFunctions.onLoading();\n  };\n  const onEnded = async () => {\n    store.getState().__controlsFunctions.onEnded();\n  };\n  const onResize = async () => {\n    store.getState().__controlsFunctions.requestMeasure();\n  };\n  const parentElementOrElement = element?.parentElement ?? element;\n  if (element) {\n    element.addEventListener(\"volumechange\", onVolumeChange);\n    element.addEventListener(\"ratechange\", onRateChange);\n    element.addEventListener(\"loadedmetadata\", onLoadedMetadata);\n    element.addEventListener(\"loadeddata\", onLoadedData);\n    element.addEventListener(\"play\", onPlay);\n    element.addEventListener(\"playing\", onPlay);\n    element.addEventListener(\"pause\", onPause);\n    element.addEventListener(\"durationchange\", onDurationChange);\n    element.addEventListener(\"timeupdate\", onTimeUpdate);\n    element.addEventListener(\"error\", onError);\n    element.addEventListener(\"waiting\", onWaiting);\n    element.addEventListener(\"stalled\", onStalled);\n    element.addEventListener(\"loadstart\", onLoadStart);\n    element.addEventListener(\"ended\", onEnded);\n    parentElementOrElement?.addEventListener(\"mouseout\", onMouseUpdate);\n    parentElementOrElement?.addEventListener(\"mousemove\", onMouseUpdate);\n    parentElementOrElement?.addEventListener(\"touchstart\", onTouchUpdate);\n    parentElementOrElement?.addEventListener(\"touchend\", onTouchUpdate);\n    parentElementOrElement?.addEventListener(\"touchmove\", onTouchUpdate);\n    if (typeof window !== \"undefined\") {\n      window?.addEventListener?.(\"resize\", onResize);\n    }\n    parentElementOrElement?.addEventListener(\"keyup\", onKeyUp);\n    parentElementOrElement?.setAttribute(\"tabindex\", \"0\");\n    element.setAttribute(MEDIA_CONTROLLER_INITIALIZED_ATTRIBUTE, \"true\");\n  }\n  const onFullscreenChange = () => {\n    store.getState().__controlsFunctions.setFullscreen(isCurrentlyFullscreen(element));\n  };\n  const onEnterPictureInPicture = () => {\n    store.getState().__controlsFunctions.setPictureInPicture(true);\n  };\n  const onExitPictureInPicture = () => {\n    store.getState().__controlsFunctions.setPictureInPicture(false);\n  };\n  const removeEffectsFromStore = addEffectsToStore(element, store);\n  const removeFullscreenListener = addFullscreenEventListener(\n    element,\n    onFullscreenChange\n  );\n  const removeEnterPictureInPictureListener = addEnterPictureInPictureEventListener(element, onEnterPictureInPicture);\n  const removeExitPictureInPictureListener = addExitPictureInPictureEventListener(element, onExitPictureInPicture);\n  return {\n    destroy: () => {\n      removeFullscreenListener?.();\n      removeEnterPictureInPictureListener?.();\n      removeExitPictureInPictureListener?.();\n      element?.removeEventListener?.(\"ratechange\", onRateChange);\n      element?.removeEventListener?.(\"volumechange\", onVolumeChange);\n      element?.removeEventListener?.(\"loadedmetadata\", onLoadedMetadata);\n      element?.removeEventListener?.(\"loadeddata\", onLoadedData);\n      element?.removeEventListener?.(\"play\", onPlay);\n      element?.removeEventListener?.(\"playing\", onPlay);\n      element?.removeEventListener?.(\"pause\", onPause);\n      element?.removeEventListener?.(\"durationchange\", onDurationChange);\n      element?.removeEventListener?.(\"timeupdate\", onTimeUpdate);\n      element?.removeEventListener?.(\"error\", onError);\n      element?.removeEventListener?.(\"waiting\", onWaiting);\n      element?.removeEventListener?.(\"stalled\", onStalled);\n      element?.removeEventListener?.(\"loadstart\", onLoadStart);\n      element?.removeEventListener?.(\"ended\", onEnded);\n      if (typeof window !== \"undefined\") {\n        window?.removeEventListener?.(\"resize\", onResize);\n      }\n      parentElementOrElement?.removeEventListener?.(\"mouseout\", onMouseUpdate);\n      parentElementOrElement?.removeEventListener?.(\"mousemove\", onMouseUpdate);\n      parentElementOrElement?.removeEventListener?.(\n        \"touchstart\",\n        onTouchUpdate\n      );\n      parentElementOrElement?.removeEventListener?.(\"touchend\", onTouchUpdate);\n      parentElementOrElement?.removeEventListener?.(\"touchmove\", onTouchUpdate);\n      parentElementOrElement?.removeEventListener?.(\"keyup\", onKeyUp);\n      removeEffectsFromStore?.();\n      element?.removeAttribute?.(MEDIA_CONTROLLER_INITIALIZED_ATTRIBUTE);\n    }\n  };\n};\nvar cleanupSource = () => {\n};\nvar cleanupPosterImage = () => {\n};\nvar addEffectsToStore = (element, store) => {\n  const destroySource = store.subscribe(\n    ({\n      __initialProps,\n      __controls,\n      currentSource,\n      errorCount,\n      progress,\n      mounted,\n      videoQuality\n    }) => ({\n      aspectRatio: __initialProps.aspectRatio,\n      autoPlay: __initialProps.autoPlay,\n      backoff: __initialProps.backoff,\n      backoffMax: __initialProps.backoffMax,\n      calculateDelay: __initialProps.calculateDelay,\n      errorCount,\n      lastError: __controls.lastError,\n      hlsConfig: __controls.hlsConfig,\n      mounted,\n      progress,\n      source: currentSource,\n      timeout: __initialProps.timeout,\n      videoQuality\n    }),\n    async ({\n      aspectRatio,\n      autoPlay,\n      // biome-ignore lint/correctness/noUnusedFunctionParameters: ignored using `--suppress`\n      backoff,\n      // biome-ignore lint/correctness/noUnusedFunctionParameters: ignored using `--suppress`\n      backoffMax,\n      calculateDelay,\n      errorCount,\n      // biome-ignore lint/correctness/noUnusedFunctionParameters: ignored using `--suppress`\n      lastError,\n      hlsConfig,\n      mounted,\n      progress,\n      source,\n      timeout,\n      videoQuality\n    }) => {\n      if (!mounted) {\n        return;\n      }\n      await cleanupSource?.();\n      await delay(\n        Math.max(calculateDelay(errorCount), errorCount === 0 ? 0 : 100)\n      );\n      let unmounted = false;\n      if (!source) {\n        return;\n      }\n      let jumped = false;\n      const jumpToPreviousPosition = () => {\n        const live = store.getState().live;\n        if (!live && progress && !jumped) {\n          element.currentTime = progress;\n          jumped = true;\n        }\n      };\n      const onErrorComposed = (err) => {\n        if (!unmounted) {\n          cleanupSource?.();\n          store.getState().__controlsFunctions?.onError?.(err);\n        }\n      };\n      if (source.type === \"webrtc\") {\n        const unsubscribeBframes = store.subscribe(\n          (state) => state?.__metadata,\n          (metadata) => {\n            let webrtcIsPossibleForOneTrack = false;\n            if (metadata?.meta?.tracks) {\n              for (const trackId of Object.keys(metadata.meta.tracks)) {\n                if (metadata?.meta?.tracks[trackId]?.bframes !== 1) {\n                  webrtcIsPossibleForOneTrack = true;\n                }\n              }\n            }\n            const shouldNotFallBackToHLS = webrtcIsPossibleForOneTrack || metadata?.meta?.bframes === 0;\n            if (!shouldNotFallBackToHLS && !unmounted) {\n              onErrorComposed(new Error(_livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__.BFRAMES_ERROR_MESSAGE));\n            }\n          }\n        );\n        const { destroy } = createNewWHEP({\n          source: source.src,\n          element,\n          callbacks: {\n            onConnected: () => {\n              store.getState().__controlsFunctions.setLive(true);\n              jumpToPreviousPosition();\n            },\n            onError: onErrorComposed,\n            onPlaybackOffsetUpdated: store.getState().__controlsFunctions.updatePlaybackOffsetMs,\n            onRedirect: store.getState().__controlsFunctions.onFinalUrl\n          },\n          accessControl: {\n            jwt: store.getState().__initialProps.jwt,\n            accessKey: store.getState().__initialProps.accessKey\n          },\n          sdpTimeout: timeout,\n          iceServers: store.getState().__initialProps.iceServers\n        });\n        const id = setTimeout(() => {\n          if (!store.getState().canPlay && !unmounted) {\n            store.getState().__controlsFunctions.onWebRTCTimeout?.();\n            onErrorComposed(\n              new Error(\n                \"Timeout reached for canPlay - triggering playback error.\"\n              )\n            );\n          }\n        }, timeout);\n        cleanupSource = () => {\n          unmounted = true;\n          clearTimeout(id);\n          destroy?.();\n          unsubscribeBframes?.();\n        };\n        return;\n      }\n      if (source.type === \"hls\") {\n        const indexUrl = /\\/hls\\/[^/\\s]+\\/index\\.m3u8/;\n        const onErrorCleaned = (error) => {\n          const cleanError = new Error(\n            error?.response?.data?.toString?.() ?? (error?.response?.code === 401 ? _livepeer_core_errors__WEBPACK_IMPORTED_MODULE_0__.ACCESS_CONTROL_ERROR_MESSAGE : \"Error with HLS.js\")\n          );\n          onErrorComposed?.(cleanError);\n        };\n        const hlsConfigResolved = hlsConfig;\n        const { destroy, setQuality: setQuality2 } = createNewHls({\n          source: source?.src,\n          element,\n          initialQuality: videoQuality,\n          aspectRatio: aspectRatio ?? 16 / 9,\n          callbacks: {\n            onLive: store.getState().__controlsFunctions.setLive,\n            onDuration: store.getState().__controlsFunctions.onDurationChange,\n            onCanPlay: () => {\n              store.getState().__controlsFunctions.onCanPlay();\n              jumpToPreviousPosition();\n              store.getState().__controlsFunctions.onError(null);\n            },\n            onError: onErrorCleaned,\n            onPlaybackOffsetUpdated: store.getState().__controlsFunctions.updatePlaybackOffsetMs,\n            onRedirect: store.getState().__controlsFunctions.onFinalUrl\n          },\n          config: {\n            ...hlsConfigResolved ?? {},\n            async xhrSetup(xhr, url) {\n              if (hlsConfigResolved?.xhrSetup) {\n                await hlsConfigResolved?.xhrSetup?.(xhr, url);\n              } else {\n                const live = store.getState().live;\n                if (!live || url.match(indexUrl)) {\n                  const jwt = store.getState().__initialProps.jwt;\n                  const accessKey = store.getState().__initialProps.accessKey;\n                  if (accessKey)\n                    xhr.setRequestHeader(\"Livepeer-Access-Key\", accessKey);\n                  else if (jwt) xhr.setRequestHeader(\"Livepeer-Jwt\", jwt);\n                }\n              }\n            },\n            autoPlay\n          }\n        });\n        const unsubscribeQualityUpdate = store.subscribe(\n          (state) => state.videoQuality,\n          (newQuality) => {\n            setQuality2(newQuality);\n          }\n        );\n        cleanupSource = () => {\n          unmounted = true;\n          destroy?.();\n          unsubscribeQualityUpdate?.();\n        };\n        return;\n      }\n      if (source?.type === \"video\") {\n        store.getState().__controlsFunctions.onFinalUrl(source.src);\n        element.addEventListener(\"canplay\", jumpToPreviousPosition);\n        element.src = source.src;\n        element.load();\n        cleanupSource = () => {\n          unmounted = true;\n          element?.removeEventListener?.(\"canplay\", jumpToPreviousPosition);\n        };\n        return;\n      }\n    },\n    {\n      equalityFn: (a, b) => {\n        const errorCountChanged = a.errorCount !== b.errorCount && b.errorCount !== 0;\n        const lastErrorChanged = a.lastError !== b.lastError;\n        const sourceChanged = a.source?.src !== b.source?.src;\n        const mountedChanged = a.mounted !== b.mounted;\n        const shouldReRender = errorCountChanged || lastErrorChanged || sourceChanged || mountedChanged;\n        return !shouldReRender;\n      }\n    }\n  );\n  const destroyPosterImage = store.subscribe(\n    ({ __controls, live, __controlsFunctions, __initialProps }) => ({\n      thumbnail: __controls.thumbnail?.src,\n      live,\n      setPoster: __controlsFunctions.setPoster,\n      posterLiveUpdate: __initialProps.posterLiveUpdate\n    }),\n    async ({ thumbnail, live, setPoster, posterLiveUpdate }) => {\n      cleanupPosterImage?.();\n      if (thumbnail && live && posterLiveUpdate > 0) {\n        const interval = setInterval(() => {\n          const thumbnailUrl = new URL(thumbnail);\n          thumbnailUrl.searchParams.set(\"v\", Date.now().toFixed(0));\n          setPoster(thumbnailUrl.toString());\n        }, posterLiveUpdate);\n        cleanupPosterImage = () => clearInterval(interval);\n      }\n    },\n    {\n      equalityFn: (a, b) => a.thumbnail === b.thumbnail && a.live === b.live\n    }\n  );\n  const destroyPlayPause = store.subscribe(\n    (state) => state.__controls.requestedPlayPauseLastTime,\n    async () => {\n      if (element.paused) {\n        await element.play();\n      } else {\n        await element.pause();\n      }\n    }\n  );\n  const destroyPlaybackRate = store.subscribe(\n    (state) => state.playbackRate,\n    (current) => {\n      element.playbackRate = current === \"constant\" ? 1 : current;\n    }\n  );\n  const destroyVolume = store.subscribe(\n    (state) => ({\n      playing: state.playing,\n      volume: state.volume,\n      isVolumeChangeSupported: state.__device.isVolumeChangeSupported\n    }),\n    (current) => {\n      if (current.isVolumeChangeSupported) {\n        element.volume = current.volume;\n      }\n    },\n    {\n      equalityFn: (a, b) => a.volume === b.volume && a.playing === b.playing && a.isVolumeChangeSupported === b.isVolumeChangeSupported\n    }\n  );\n  const destroyMute = store.subscribe(\n    (state) => state.__controls.muted,\n    (current, prev) => {\n      if (current !== prev) {\n        element.muted = current;\n      }\n    }\n  );\n  const destroySeeking = store.subscribe(\n    (state) => state.__controls.requestedRangeToSeekTo,\n    (current) => {\n      if (typeof element.readyState === \"undefined\" || element.readyState > 0) {\n        element.currentTime = current;\n      }\n    }\n  );\n  const destroyFullscreen = store.subscribe(\n    (state) => state.__controls.requestedFullscreenLastTime,\n    async () => {\n      const isFullscreen = isCurrentlyFullscreen(element);\n      if (isFullscreen) exitFullscreen(element);\n      else enterFullscreen(element);\n    }\n  );\n  const destroyPictureInPicture = store.subscribe(\n    (state) => state.__controls.requestedPictureInPictureLastTime,\n    async () => {\n      try {\n        const isPictureInPicture = await isCurrentlyPictureInPicture(element);\n        if (isPictureInPicture) await exitPictureInPicture(element);\n        else await enterPictureInPicture(element);\n      } catch (e) {\n        (0,_livepeer_core_utils__WEBPACK_IMPORTED_MODULE_1__.warn)(e?.message ?? \"Picture in picture is not supported\");\n        store.setState((state) => ({\n          __device: {\n            ...state.__device,\n            isPictureInPictureSupported: false\n          }\n        }));\n      }\n    }\n  );\n  const destroyAutohide = store.subscribe(\n    (state) => ({\n      lastInteraction: state.__controls.lastInteraction,\n      autohide: state.__controls.autohide\n    }),\n    async ({ lastInteraction, autohide }) => {\n      if (autohide && lastInteraction) {\n        store.getState().__controlsFunctions.setHidden(false);\n        await delay(autohide);\n        const parentElementOrElement = element?.parentElement ?? element;\n        const openElement = parentElementOrElement?.querySelector?.(\n          '[data-state=\"open\"]'\n        );\n        if (!openElement && !store.getState().hidden && lastInteraction === store.getState().__controls.lastInteraction) {\n          store.getState().__controlsFunctions.setHidden(true);\n        }\n      }\n    },\n    {\n      equalityFn: (a, b) => a?.lastInteraction === b?.lastInteraction && a?.autohide === b?.autohide\n    }\n  );\n  const destroyRequestSizing = store.subscribe(\n    (state) => ({\n      lastTime: state.__controls.requestedMeasureLastTime,\n      fullscreen: state.fullscreen\n    }),\n    async () => {\n      store.getState().__controlsFunctions.setSize({\n        ...element?.videoHeight && element?.videoWidth ? {\n          media: {\n            height: element.videoHeight,\n            width: element.videoWidth\n          }\n        } : {},\n        ...element?.clientHeight && element?.clientWidth ? {\n          container: {\n            height: element.clientHeight,\n            width: element.clientWidth\n          }\n        } : {},\n        ...typeof window !== \"undefined\" && window?.innerHeight && window?.innerWidth ? {\n          window: {\n            height: window.innerHeight,\n            width: window.innerWidth\n          }\n        } : {}\n      });\n    },\n    {\n      equalityFn: (a, b) => a?.fullscreen === b?.fullscreen && a?.lastTime === b?.lastTime\n    }\n  );\n  const destroyMediaSizing = store.subscribe(\n    (state) => state.__controls.size?.media,\n    async (media) => {\n      const parentElementOrElement = element?.parentElement ?? element;\n      if (parentElementOrElement) {\n        if (media?.height && media?.width) {\n          const elementStyle = parentElementOrElement.style;\n          elementStyle.setProperty(\n            \"--livepeer-media-height\",\n            `${media.height}px`\n          );\n          elementStyle.setProperty(\n            \"--livepeer-media-width\",\n            `${media.width}px`\n          );\n        }\n      }\n    },\n    {\n      equalityFn: (a, b) => a?.height === b?.height && a?.width === b?.width\n    }\n  );\n  const destroyContainerSizing = store.subscribe(\n    (state) => state.__controls.size?.container,\n    async (container) => {\n      const parentElementOrElement = element?.parentElement ?? element;\n      if (parentElementOrElement) {\n        if (container?.height && container?.width) {\n          const elementStyle = parentElementOrElement.style;\n          elementStyle.setProperty(\n            \"--livepeer-container-height\",\n            `${container.height}px`\n          );\n          elementStyle.setProperty(\n            \"--livepeer-container-width\",\n            `${container.width}px`\n          );\n        }\n      }\n    },\n    {\n      equalityFn: (a, b) => a?.height === b?.height && a?.width === b?.width\n    }\n  );\n  return () => {\n    destroyAutohide?.();\n    destroyContainerSizing?.();\n    destroyFullscreen?.();\n    destroyMediaSizing?.();\n    destroyMute?.();\n    destroyPictureInPicture?.();\n    destroyPlaybackRate?.();\n    destroyPlayPause?.();\n    destroyPosterImage?.();\n    destroyRequestSizing?.();\n    destroySeeking?.();\n    destroyVolume?.();\n    destroySource?.();\n    cleanupPosterImage?.();\n    cleanupSource?.();\n  };\n};\n\n// src/media/controls/device.ts\nvar getDeviceInfo = (version2) => ({\n  version: version2,\n  isAndroid: isAndroid(),\n  isIos: isIos(),\n  isMobile: isMobile(),\n  userAgent: typeof navigator !== \"undefined\" ? navigator.userAgent : \"Node.js or unknown\",\n  screenWidth: typeof window !== \"undefined\" && window?.screen ? window?.screen?.width ?? null : null,\n  isFullscreenSupported: isFullscreenSupported(),\n  isWebRTCSupported: Boolean(getRTCPeerConnectionConstructor()),\n  isPictureInPictureSupported: isPictureInPictureSupported(),\n  isHlsSupported: isHlsSupported(),\n  isVolumeChangeSupported: true\n});\n\n// src/media/metrics.ts\n\n\n\nfunction addMediaMetrics(element, opts = {}) {\n  if (element) {\n    const source = opts?.src ?? element?.src ?? null;\n    const { store, destroy } = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_2__.createControllerStore)({\n      src: source,\n      playbackId: opts?.playbackId,\n      device: getDeviceInfo(_livepeer_core_version__WEBPACK_IMPORTED_MODULE_5__.version.core),\n      storage: (0,_livepeer_core_storage__WEBPACK_IMPORTED_MODULE_4__.createStorage)({ storage: _livepeer_core_storage__WEBPACK_IMPORTED_MODULE_4__.noopStorage }),\n      initialProps: {\n        autoPlay: Boolean(element?.autoplay),\n        volume: element?.muted ? 0 : element?.volume,\n        preload: element?.preload === \"\" ? \"auto\" : element?.preload,\n        playbackRate: element?.playbackRate,\n        hotkeys: false,\n        posterLiveUpdate: 0,\n        ...opts,\n        onError(error) {\n          if (error) {\n            opts?.onError?.(error);\n          }\n        }\n      }\n    });\n    const { destroy: destroyListeners } = addEventListeners(element, store);\n    const { destroy: destroyMetrics } = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_2__.addMetricsToStore)(store, {\n      disableProgressListener: opts.disableProgressListener,\n      interval: opts.interval,\n      onPlaybackEvents: opts.onPlaybackEvents\n    });\n    const { destroy: destroyLegacyMetrics, metrics: legacyMetrics } = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_2__.addLegacyMediaMetricsToStore)(store, {\n      disableProgressListener: opts.disableProgressListener\n    });\n    store.getState().__controlsFunctions.onFinalUrl(\n      source ?? \"https://vod-cdn.lp-playback.studio\"\n    );\n    return {\n      /** @deprecated */\n      legacyMetrics,\n      destroy: () => {\n        destroy?.();\n        destroyListeners?.();\n        destroyMetrics?.();\n        destroyLegacyMetrics?.();\n      }\n    };\n  }\n  return {\n    destroy: () => {\n    }\n  };\n}\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUtd2ViL2Rpc3QvYnJvd3Nlci9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFLK0I7QUFDYTs7QUFFNUM7QUFHOEI7QUFDTDs7QUFFekI7QUFDNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHdDQUF3QywwREFBZTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw4Q0FBRztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxxREFBVTtBQUNuQixZQUFZLHFDQUFxQztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsU0FBUyxxREFBVTtBQUNuQjtBQUNBLFdBQVcscURBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0gsU0FBUyxxREFBVTtBQUNuQixZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxhQUFhO0FBQ2xEO0FBQ0EsYUFBYSx5REFBYztBQUMzQjtBQUNBO0FBQ0EsYUFBYSx5REFBYztBQUMzQixxREFBcUQsYUFBYTtBQUNsRTtBQUNBO0FBQ0EsNERBQTRELGFBQWE7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLFlBQVksUUFBUSxFQUFFLHFGQUErQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGlCQUFpQjtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixXQUFXO0FBQy9CLEtBQUs7QUFDTDtBQUNBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGdDQUFnQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtFQUE0QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxNQUFNO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLElBQUk7QUFDWjtBQUNBO0FBQ0EsUUFBUTtBQUNSLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsTUFBTTtBQUM1RDtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxtQkFBbUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxVQUFVO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxtQkFBbUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBLFdBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsVUFBVTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwrRUFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwrRUFBNEI7QUFDcEQ7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLHdFQUFxQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRkFBb0YsK0VBQTRCO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG1DQUFtQztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sdURBQXVEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsOENBQThDO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixRQUFRLDBEQUFJO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxhQUFhLDJCQUEyQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLElBQUk7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxJQUFJO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVixPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxhQUFhO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGlCQUFpQjtBQUNoQztBQUNBO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBSzhCO0FBQ3NDO0FBQ25CO0FBQ2pELDJDQUEyQztBQUMzQztBQUNBO0FBQ0EsWUFBWSxpQkFBaUIsRUFBRSwyRUFBcUI7QUFDcEQ7QUFDQTtBQUNBLDRCQUE0QiwyREFBTztBQUNuQyxlQUFlLHFFQUFhLEdBQUcsU0FBUywrREFBVyxFQUFFO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSw0QkFBNEI7QUFDeEMsWUFBWSwwQkFBMEIsRUFBRSx1RUFBaUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksd0RBQXdELEVBQUUsa0ZBQTRCO0FBQ2xHO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUtd2ViL2Rpc3QvYnJvd3Nlci9pbmRleC5qcz83MWFjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9tZWRpYS9jb250cm9scy9jb250cm9sbGVyLnRzXG5pbXBvcnQge1xuICBBQ0NFU1NfQ09OVFJPTF9FUlJPUl9NRVNTQUdFLFxuICBCRlJBTUVTX0VSUk9SX01FU1NBR0UsXG4gIFNUUkVBTV9PRkZMSU5FX0VSUk9SX01FU1NBR0Vcbn0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL2Vycm9yc1wiO1xuaW1wb3J0IHsgd2FybiB9IGZyb20gXCJAbGl2ZXBlZXIvY29yZS91dGlsc1wiO1xuXG4vLyBzcmMvaGxzL2hscy50c1xuaW1wb3J0IHtcbiAgY2FsY3VsYXRlVmlkZW9RdWFsaXR5RGltZW5zaW9uc1xufSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUvbWVkaWFcIjtcbmltcG9ydCBIbHMgZnJvbSBcImhscy5qc1wiO1xuXG4vLyBzcmMvbWVkaWEvdXRpbHMudHNcbmltcG9ydCB7IG5vb3AgfSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUvdXRpbHNcIjtcbnZhciBpc0NsaWVudCA9ICgpID0+IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCI7XG52YXIgdWEgPSAoKSA9PiBpc0NsaWVudCgpID8gd2luZG93Py5uYXZpZ2F0b3I/LnVzZXJBZ2VudD8udG9Mb3dlckNhc2UoKSA6IFwiXCI7XG52YXIgaXNJb3MgPSAoKSA9PiAvaXBob25lfGlwYWR8aXBvZHxpb3N8Q3JpT1N8RnhpT1MvLnRlc3QodWEoKSk7XG52YXIgaXNBbmRyb2lkID0gKCkgPT4gL2FuZHJvaWQvLnRlc3QodWEoKSk7XG52YXIgaXNNb2JpbGUgPSAoKSA9PiBpc0NsaWVudCgpICYmIChpc0lvcygpIHx8IGlzQW5kcm9pZCgpKTtcbnZhciBjYW5QbGF5TWVkaWFOYXRpdmVseSA9IChzcmMpID0+IHtcbiAgaWYgKGlzQ2xpZW50KCkgJiYgc3JjPy5taW1lKSB7XG4gICAgaWYgKHNyYz8udHlwZT8uaW5jbHVkZXMoXCJhdWRpb1wiKSkge1xuICAgICAgY29uc3QgYXVkaW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIik7XG4gICAgICByZXR1cm4gYXVkaW8uY2FuUGxheVR5cGUoc3JjLm1pbWUpLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIGNvbnN0IHZpZGVvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xuICAgIHJldHVybiB2aWRlby5jYW5QbGF5VHlwZShzcmMubWltZSkubGVuZ3RoID4gMDtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIHNyYy9obHMvaGxzLnRzXG52YXIgVklERU9fSExTX0lOSVRJQUxJWkVEX0FUVFJJQlVURSA9IFwiZGF0YS1saXZlcGVlci12aWRlby1obHMtaW5pdGlhbGl6ZWRcIjtcbnZhciBpc0hsc1N1cHBvcnRlZCA9ICgpID0+IGlzQ2xpZW50KCkgPyBIbHMuaXNTdXBwb3J0ZWQoKSA6IHRydWU7XG52YXIgY3JlYXRlTmV3SGxzID0gKHtcbiAgc291cmNlLFxuICBlbGVtZW50LFxuICBjYWxsYmFja3MsXG4gIGFzcGVjdFJhdGlvLFxuICBjb25maWcsXG4gIGluaXRpYWxRdWFsaXR5XG59KSA9PiB7XG4gIGlmIChlbGVtZW50LmdldEF0dHJpYnV0ZShWSURFT19ITFNfSU5JVElBTElaRURfQVRUUklCVVRFKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2V0UXVhbGl0eTogKCkgPT4ge1xuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6ICgpID0+IHtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKFZJREVPX0hMU19JTklUSUFMSVpFRF9BVFRSSUJVVEUsIFwidHJ1ZVwiKTtcbiAgY29uc3QgaGxzID0gbmV3IEhscyh7XG4gICAgYmFja0J1ZmZlckxlbmd0aDogNjAgKiAxLjUsXG4gICAgbWFuaWZlc3RMb2FkaW5nTWF4UmV0cnk6IDAsXG4gICAgZnJhZ0xvYWRpbmdNYXhSZXRyeTogMCxcbiAgICBsZXZlbExvYWRpbmdNYXhSZXRyeTogMCxcbiAgICBhcHBlbmRFcnJvck1heFJldHJ5OiAwLFxuICAgIC4uLmNvbmZpZyxcbiAgICAuLi5jb25maWc/LmxpdmVTeW5jRHVyYXRpb25Db3VudCA/IHtcbiAgICAgIGxpdmVTeW5jRHVyYXRpb25Db3VudDogY29uZmlnLmxpdmVTeW5jRHVyYXRpb25Db3VudFxuICAgIH0gOiB7XG4gICAgICBsaXZlTWF4TGF0ZW5jeUR1cmF0aW9uQ291bnQ6IDcsXG4gICAgICBsaXZlU3luY0R1cmF0aW9uQ291bnQ6IDNcbiAgICB9XG4gIH0pO1xuICBjb25zdCBvbkRlc3Ryb3kgPSAoKSA9PiB7XG4gICAgaGxzPy5kZXN0cm95Py4oKTtcbiAgICBlbGVtZW50Py5yZW1vdmVBdHRyaWJ1dGU/LihWSURFT19ITFNfSU5JVElBTElaRURfQVRUUklCVVRFKTtcbiAgfTtcbiAgaWYgKGVsZW1lbnQpIHtcbiAgICBobHMuYXR0YWNoTWVkaWEoZWxlbWVudCk7XG4gIH1cbiAgbGV0IHJlZGlyZWN0ZWQgPSBmYWxzZTtcbiAgaGxzLm9uKEhscy5FdmVudHMuTEVWRUxfTE9BREVELCBhc3luYyAoX2UsIGRhdGEpID0+IHtcbiAgICBjb25zdCB7IGxpdmUsIHRvdGFsZHVyYXRpb246IGR1cmF0aW9uLCB1cmwgfSA9IGRhdGEuZGV0YWlscztcbiAgICBpZiAoIXJlZGlyZWN0ZWQpIHtcbiAgICAgIGNhbGxiYWNrcz8ub25SZWRpcmVjdD8uKHVybCA/PyBudWxsKTtcbiAgICAgIHJlZGlyZWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjYWxsYmFja3M/Lm9uTGl2ZT8uKEJvb2xlYW4obGl2ZSkpO1xuICAgIGNhbGxiYWNrcz8ub25EdXJhdGlvbj8uKGR1cmF0aW9uID8/IDApO1xuICB9KTtcbiAgaGxzLm9uKEhscy5FdmVudHMuTUVESUFfQVRUQUNIRUQsIGFzeW5jICgpID0+IHtcbiAgICBobHMubG9hZFNvdXJjZShzb3VyY2UpO1xuICAgIGhscy5vbihIbHMuRXZlbnRzLk1BTklGRVNUX1BBUlNFRCwgKF9ldmVudCwgX2RhdGEpID0+IHtcbiAgICAgIHNldFF1YWxpdHkoe1xuICAgICAgICBobHM6IGhscyA/PyBudWxsLFxuICAgICAgICBxdWFsaXR5OiBpbml0aWFsUXVhbGl0eSxcbiAgICAgICAgYXNwZWN0UmF0aW9cbiAgICAgIH0pO1xuICAgICAgY2FsbGJhY2tzPy5vbkNhblBsYXk/LigpO1xuICAgICAgaWYgKGNvbmZpZy5hdXRvUGxheSkgZWxlbWVudD8ucGxheT8uKCk7XG4gICAgfSk7XG4gIH0pO1xuICBobHMub24oSGxzLkV2ZW50cy5FUlJPUiwgYXN5bmMgKF9ldmVudCwgZGF0YSkgPT4ge1xuICAgIGNvbnN0IHsgZGV0YWlscywgZmF0YWwgfSA9IGRhdGE7XG4gICAgY29uc3QgaXNNYW5pZmVzdFBhcnNpbmdFcnJvciA9IGRldGFpbHMgPT09IFwibWFuaWZlc3RQYXJzaW5nRXJyb3JcIjtcbiAgICBpZiAoIWZhdGFsICYmICFpc01hbmlmZXN0UGFyc2luZ0Vycm9yKSByZXR1cm47XG4gICAgY2FsbGJhY2tzPy5vbkVycm9yPy4oZGF0YSk7XG4gICAgaWYgKGZhdGFsKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYXRhbCBlcnJvciA6ICR7ZGF0YS5kZXRhaWxzfWApO1xuICAgICAgc3dpdGNoIChkYXRhLnR5cGUpIHtcbiAgICAgICAgY2FzZSBIbHMuRXJyb3JUeXBlcy5NRURJQV9FUlJPUjpcbiAgICAgICAgICBobHMucmVjb3Zlck1lZGlhRXJyb3IoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBIbHMuRXJyb3JUeXBlcy5ORVRXT1JLX0VSUk9SOlxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEEgbmV0d29yayBlcnJvciBvY2N1cnJlZDogJHtkYXRhLmRldGFpbHN9YCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29uc29sZS5lcnJvcihgQW4gdW5yZWNvdmVyYWJsZSBlcnJvciBvY2N1cnJlZDogJHtkYXRhLmRldGFpbHN9YCk7XG4gICAgICAgICAgaGxzLmRlc3Ryb3koKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBmdW5jdGlvbiB1cGRhdGVPZmZzZXQoKSB7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IG5ld0RhdGUgPSBobHMucGxheWluZ0RhdGU7XG4gICAgaWYgKG5ld0RhdGUgJiYgY3VycmVudERhdGUpIHtcbiAgICAgIGNhbGxiYWNrcz8ub25QbGF5YmFja09mZnNldFVwZGF0ZWQ/LihjdXJyZW50RGF0ZSAtIG5ld0RhdGUuZ2V0VGltZSgpKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgdXBkYXRlT2Zmc2V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh1cGRhdGVPZmZzZXQsIDJlMyk7XG4gIHJldHVybiB7XG4gICAgZGVzdHJveTogKCkgPT4ge1xuICAgICAgb25EZXN0cm95Py4oKTtcbiAgICAgIGNsZWFySW50ZXJ2YWw/Lih1cGRhdGVPZmZzZXRJbnRlcnZhbCk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVBdHRyaWJ1dGU/LihWSURFT19ITFNfSU5JVElBTElaRURfQVRUUklCVVRFKTtcbiAgICB9LFxuICAgIHNldFF1YWxpdHk6ICh2aWRlb1F1YWxpdHkpID0+IHtcbiAgICAgIHNldFF1YWxpdHkoe1xuICAgICAgICBobHM6IGhscyA/PyBudWxsLFxuICAgICAgICBxdWFsaXR5OiB2aWRlb1F1YWxpdHksXG4gICAgICAgIGFzcGVjdFJhdGlvXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59O1xudmFyIHNldFF1YWxpdHkgPSAoe1xuICBobHMsXG4gIHF1YWxpdHksXG4gIGFzcGVjdFJhdGlvXG59KSA9PiB7XG4gIGlmIChobHMpIHtcbiAgICBjb25zdCB7IHdpZHRoIH0gPSBjYWxjdWxhdGVWaWRlb1F1YWxpdHlEaW1lbnNpb25zKHF1YWxpdHksIGFzcGVjdFJhdGlvKTtcbiAgICBpZiAoIXdpZHRoIHx8IHF1YWxpdHkgPT09IFwiYXV0b1wiKSB7XG4gICAgICBobHMuY3VycmVudExldmVsID0gLTE7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChobHMubGV2ZWxzICYmIGhscy5sZXZlbHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3Qgc29ydGVkTGV2ZWxzID0gaGxzLmxldmVscy5tYXAoKGxldmVsLCBpbmRleCkgPT4gKHsgLi4ubGV2ZWwsIGluZGV4IH0pKS5zb3J0KFxuICAgICAgICAoYSwgYikgPT4gTWF0aC5hYnMoKHdpZHRoID8/IDApIC0gYS53aWR0aCkgLSBNYXRoLmFicygod2lkdGggPz8gMCkgLSBiLndpZHRoKVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGJlc3RNYXRjaExldmVsID0gc29ydGVkTGV2ZWxzPy5bMF07XG4gICAgICBpZiAoKGJlc3RNYXRjaExldmVsPy5pbmRleCA/PyAtMSkgPj0gMCkge1xuICAgICAgICBobHMuY3VycmVudExldmVsID0gYmVzdE1hdGNoTGV2ZWwuaW5kZXg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBobHMuY3VycmVudExldmVsID0gLTE7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG4vLyBzcmMvd2VicnRjL3NoYXJlZC50c1xuaW1wb3J0IHsgTk9UX0FDQ0VQVEFCTEVfRVJST1JfTUVTU0FHRSB9IGZyb20gXCJAbGl2ZXBlZXIvY29yZS9lcnJvcnNcIjtcbnZhciBnZXRSVENQZWVyQ29ubmVjdGlvbkNvbnN0cnVjdG9yID0gKCkgPT4ge1xuICBpZiAoIWlzQ2xpZW50KCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uIHx8IHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbiB8fCB3aW5kb3cubW96UlRDUGVlckNvbm5lY3Rpb24gfHwgbnVsbDtcbn07XG5mdW5jdGlvbiBjcmVhdGVQZWVyQ29ubmVjdGlvbihob3N0LCBpY2VTZXJ2ZXJzKSB7XG4gIGNvbnN0IFJUQ1BlZXJDb25uZWN0aW9uQ29uc3RydWN0b3IgPSBnZXRSVENQZWVyQ29ubmVjdGlvbkNvbnN0cnVjdG9yKCk7XG4gIGlmICghUlRDUGVlckNvbm5lY3Rpb25Db25zdHJ1Y3Rvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFJUQ1BlZXJDb25uZWN0aW9uIGNvbnN0cnVjdG9yIGZvdW5kIGluIHRoaXMgYnJvd3Nlci5cIik7XG4gIH1cbiAgY29uc3QgaG9zdE5vUG9ydCA9IGhvc3Q/LnNwbGl0KFwiOlwiKVswXTtcbiAgY29uc3QgZGVmYXVsdEljZVNlcnZlcnMgPSBob3N0ID8gW1xuICAgIHtcbiAgICAgIHVybHM6IGBzdHVuOiR7aG9zdE5vUG9ydH1gXG4gICAgfSxcbiAgICB7XG4gICAgICB1cmxzOiBgdHVybjoke2hvc3ROb1BvcnR9YCxcbiAgICAgIHVzZXJuYW1lOiBcImxpdmVwZWVyXCIsXG4gICAgICBjcmVkZW50aWFsOiBcImxpdmVwZWVyXCJcbiAgICB9XG4gIF0gOiBbXTtcbiAgcmV0dXJuIG5ldyBSVENQZWVyQ29ubmVjdGlvbkNvbnN0cnVjdG9yKHtcbiAgICBpY2VTZXJ2ZXJzOiBpY2VTZXJ2ZXJzID8gQXJyYXkuaXNBcnJheShpY2VTZXJ2ZXJzKSA/IGljZVNlcnZlcnMgOiBbaWNlU2VydmVyc10gOiBkZWZhdWx0SWNlU2VydmVyc1xuICB9KTtcbn1cbnZhciBERUZBVUxUX1RJTUVPVVQgPSAxZTQ7XG5hc3luYyBmdW5jdGlvbiBuZWdvdGlhdGVDb25uZWN0aW9uV2l0aENsaWVudE9mZmVyKHBlZXJDb25uZWN0aW9uLCBlbmRwb2ludCwgb2ZyLCBjb250cm9sbGVyLCBhY2Nlc3NDb250cm9sLCBzZHBUaW1lb3V0KSB7XG4gIGlmIChwZWVyQ29ubmVjdGlvbiAmJiBlbmRwb2ludCAmJiBvZnIpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBvc3RTRFBPZmZlcihcbiAgICAgIGVuZHBvaW50LFxuICAgICAgb2ZyLnNkcCxcbiAgICAgIGNvbnRyb2xsZXIsXG4gICAgICBhY2Nlc3NDb250cm9sLFxuICAgICAgc2RwVGltZW91dFxuICAgICk7XG4gICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBhbnN3ZXJTRFAgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBhd2FpdCBwZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihcbiAgICAgICAgbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7IHR5cGU6IFwiYW5zd2VyXCIsIHNkcDogYW5zd2VyU0RQIH0pXG4gICAgICApO1xuICAgICAgY29uc3QgcGxheWhlYWRVdGMgPSByZXNwb25zZS5oZWFkZXJzLmdldChcIlBsYXloZWFkLVV0Y1wiKTtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShwbGF5aGVhZFV0YyA/PyAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSk7XG4gICAgfVxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKE5PVF9BQ0NFUFRBQkxFX0VSUk9SX01FU1NBR0UpO1xuICAgIH1cbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKFwiUGVlciBjb25uZWN0aW9uIG5vdCBkZWZpbmVkLlwiKTtcbn1cbmZ1bmN0aW9uIHByZWZlckNvZGVjKHNkcCwgY29kZWMpIHtcbiAgY29uc3QgbGluZXMgPSBzZHAuc3BsaXQoXCJcXHJcXG5cIik7XG4gIGNvbnN0IG1MaW5lSW5kZXggPSBsaW5lcy5maW5kSW5kZXgoKGxpbmUpID0+IGxpbmUuc3RhcnRzV2l0aChcIm09dmlkZW9cIikpO1xuICBpZiAobUxpbmVJbmRleCA9PT0gLTEpIHJldHVybiBzZHA7XG4gIGNvbnN0IGNvZGVjUmVnZXggPSBuZXcgUmVnRXhwKGBhPXJ0cG1hcDooXFxcXGQrKSAke2NvZGVjfSgvXFxcXGQrKStgKTtcbiAgY29uc3QgY29kZWNMaW5lID0gbGluZXMuZmluZCgobGluZSkgPT4gY29kZWNSZWdleC50ZXN0KGxpbmUpKTtcbiAgaWYgKCFjb2RlY0xpbmUpIHJldHVybiBzZHA7XG4gIGNvbnN0IGNvZGVjUGF5bG9hZCA9IGNvZGVjUmVnZXguZXhlYyhjb2RlY0xpbmUpWzFdO1xuICBjb25zdCBtTGluZUVsZW1lbnRzID0gbGluZXNbbUxpbmVJbmRleF0uc3BsaXQoXCIgXCIpO1xuICBjb25zdCByZW9yZGVyZWRNTGluZSA9IFtcbiAgICAuLi5tTGluZUVsZW1lbnRzLnNsaWNlKDAsIDMpLFxuICAgIGNvZGVjUGF5bG9hZCxcbiAgICAuLi5tTGluZUVsZW1lbnRzLnNsaWNlKDMpLmZpbHRlcigocGF5bG9hZCkgPT4gcGF5bG9hZCAhPT0gY29kZWNQYXlsb2FkKVxuICBdO1xuICBsaW5lc1ttTGluZUluZGV4XSA9IHJlb3JkZXJlZE1MaW5lLmpvaW4oXCIgXCIpO1xuICByZXR1cm4gbGluZXMuam9pbihcIlxcclxcblwiKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbnN0cnVjdENsaWVudE9mZmVyKHBlZXJDb25uZWN0aW9uLCBlbmRwb2ludCwgbm9JY2VHYXRoZXJpbmcpIHtcbiAgaWYgKHBlZXJDb25uZWN0aW9uICYmIGVuZHBvaW50KSB7XG4gICAgY29uc3Qgb3JpZ2luYWxDcmVhdGVPZmZlciA9IHBlZXJDb25uZWN0aW9uLmNyZWF0ZU9mZmVyLmJpbmQocGVlckNvbm5lY3Rpb24pO1xuICAgIHBlZXJDb25uZWN0aW9uLmNyZWF0ZU9mZmVyID0gYXN5bmMgZnVuY3Rpb24oLi4uYXJncykge1xuICAgICAgY29uc3Qgb3JpZ2luYWxPZmZlciA9IGF3YWl0IG9yaWdpbmFsQ3JlYXRlT2ZmZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICByZXR1cm4gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgKFRPRE86IGZpeCB0aGlzKVxuICAgICAgICB0eXBlOiBvcmlnaW5hbE9mZmVyLnR5cGUsXG4gICAgICAgIC8vIEB0cy1pZ25vcmUgKFRPRE86IGZpeCB0aGlzKVxuICAgICAgICBzZHA6IHByZWZlckNvZGVjKG9yaWdpbmFsT2ZmZXIuc2RwLCBcIkgyNjRcIilcbiAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3Qgb2ZmZXIgPSBhd2FpdCBwZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcigpO1xuICAgIGF3YWl0IHBlZXJDb25uZWN0aW9uLnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXIpO1xuICAgIGlmIChub0ljZUdhdGhlcmluZykge1xuICAgICAgcmV0dXJuIHBlZXJDb25uZWN0aW9uLmxvY2FsRGVzY3JpcHRpb247XG4gICAgfVxuICAgIGNvbnN0IG9mciA9IGF3YWl0IHdhaXRUb0NvbXBsZXRlSUNFR2F0aGVyaW5nKHBlZXJDb25uZWN0aW9uKTtcbiAgICBpZiAoIW9mcikge1xuICAgICAgdGhyb3cgRXJyb3IoXCJmYWlsZWQgdG8gZ2F0aGVyIElDRSBjYW5kaWRhdGVzIGZvciBvZmZlclwiKTtcbiAgICB9XG4gICAgcmV0dXJuIG9mcjtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbnZhciBwbGF5YmFja0lkUGF0dGVybiA9IC8oWy8rXSkoW14vKz9dKykkLztcbnZhciBSRVBMQUNFX1BMQUNFSE9MREVSID0gXCJQTEFZQkFDS19JRFwiO1xudmFyIE1BWF9SRURJUkVDVF9DQUNIRV9TSVpFID0gMTA7XG52YXIgcmVkaXJlY3RVcmxDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRDYWNoZWRUZW1wbGF0ZShrZXkpIHtcbiAgY29uc3QgY2FjaGVkSXRlbSA9IHJlZGlyZWN0VXJsQ2FjaGUuZ2V0KGtleSk7XG4gIGlmIChjYWNoZWRJdGVtKSB7XG4gICAgcmVkaXJlY3RVcmxDYWNoZS5kZWxldGUoa2V5KTtcbiAgICByZWRpcmVjdFVybENhY2hlLnNldChrZXksIGNhY2hlZEl0ZW0pO1xuICB9XG4gIHJldHVybiBjYWNoZWRJdGVtO1xufVxuZnVuY3Rpb24gc2V0Q2FjaGVkVGVtcGxhdGUoa2V5LCB2YWx1ZSkge1xuICBpZiAocmVkaXJlY3RVcmxDYWNoZS5oYXMoa2V5KSkge1xuICAgIHJlZGlyZWN0VXJsQ2FjaGUuZGVsZXRlKGtleSk7XG4gIH0gZWxzZSBpZiAocmVkaXJlY3RVcmxDYWNoZS5zaXplID49IE1BWF9SRURJUkVDVF9DQUNIRV9TSVpFKSB7XG4gICAgY29uc3Qgb2xkZXN0S2V5ID0gcmVkaXJlY3RVcmxDYWNoZS5rZXlzKCkubmV4dCgpLnZhbHVlO1xuICAgIGlmIChvbGRlc3RLZXkpIHtcbiAgICAgIHJlZGlyZWN0VXJsQ2FjaGUuZGVsZXRlKG9sZGVzdEtleSk7XG4gICAgfVxuICB9XG4gIHJlZGlyZWN0VXJsQ2FjaGUuc2V0KGtleSwgdmFsdWUpO1xufVxuYXN5bmMgZnVuY3Rpb24gcG9zdFNEUE9mZmVyKGVuZHBvaW50LCBkYXRhLCBjb250cm9sbGVyLCBhY2Nlc3NDb250cm9sLCBzZHBUaW1lb3V0KSB7XG4gIGNvbnN0IGlkID0gc2V0VGltZW91dChcbiAgICAoKSA9PiBjb250cm9sbGVyLmFib3J0KCksXG4gICAgc2RwVGltZW91dCA/PyBERUZBVUxUX1RJTUVPVVRcbiAgKTtcbiAgY29uc3QgdXJsRm9yUG9zdCA9IG5ldyBVUkwoZW5kcG9pbnQpO1xuICBjb25zdCBwYXJzZWRNYXRjaGVzID0gdXJsRm9yUG9zdC5wYXRobmFtZS5tYXRjaChwbGF5YmFja0lkUGF0dGVybik7XG4gIGNvbnN0IGN1cnJlbnRQbGF5YmFja0lkID0gcGFyc2VkTWF0Y2hlcz8uWzJdO1xuICBjb25zdCBjYWNoZWRUZW1wbGF0ZVVybCA9IGdldENhY2hlZFRlbXBsYXRlKGVuZHBvaW50KTtcbiAgaWYgKGNhY2hlZFRlbXBsYXRlVXJsICYmIGN1cnJlbnRQbGF5YmFja0lkKSB7XG4gICAgdXJsRm9yUG9zdC5ob3N0ID0gY2FjaGVkVGVtcGxhdGVVcmwuaG9zdDtcbiAgICB1cmxGb3JQb3N0LnBhdGhuYW1lID0gY2FjaGVkVGVtcGxhdGVVcmwucGF0aG5hbWUucmVwbGFjZShcbiAgICAgIFJFUExBQ0VfUExBQ0VIT0xERVIsXG4gICAgICBjdXJyZW50UGxheWJhY2tJZFxuICAgICk7XG4gICAgdXJsRm9yUG9zdC5zZWFyY2ggPSBjYWNoZWRUZW1wbGF0ZVVybC5zZWFyY2g7XG4gIH1cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmxGb3JQb3N0LnRvU3RyaW5nKCksIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIG1vZGU6IFwiY29yc1wiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vc2RwXCIsXG4gICAgICAuLi5hY2Nlc3NDb250cm9sPy5hY2Nlc3NLZXkgPyB7XG4gICAgICAgIFwiTGl2ZXBlZXItQWNjZXNzLUtleVwiOiBhY2Nlc3NDb250cm9sLmFjY2Vzc0tleVxuICAgICAgfSA6IHt9LFxuICAgICAgLi4uYWNjZXNzQ29udHJvbD8uand0ID8ge1xuICAgICAgICBcIkxpdmVwZWVyLUp3dFwiOiBhY2Nlc3NDb250cm9sLmp3dFxuICAgICAgfSA6IHt9XG4gICAgfSxcbiAgICBib2R5OiBkYXRhLFxuICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgfSk7XG4gIGNsZWFyVGltZW91dChpZCk7XG4gIHJldHVybiByZXNwb25zZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFJlZGlyZWN0VXJsKGVuZHBvaW50LCBhYm9ydENvbnRyb2xsZXIsIHRpbWVvdXQpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjYWNoZWRUZW1wbGF0ZVVybCA9IGdldENhY2hlZFRlbXBsYXRlKGVuZHBvaW50KTtcbiAgICBpZiAoY2FjaGVkVGVtcGxhdGVVcmwpIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRJbmdlc3RVcmwgPSBuZXcgVVJMKGVuZHBvaW50KTtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBjdXJyZW50SW5nZXN0VXJsLnBhdGhuYW1lLm1hdGNoKHBsYXliYWNrSWRQYXR0ZXJuKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRQbGF5YmFja0lkID0gbWF0Y2hlcz8uWzJdO1xuICAgICAgaWYgKGN1cnJlbnRQbGF5YmFja0lkKSB7XG4gICAgICAgIGNvbnN0IGZpbmFsUmVkaXJlY3RVcmwgPSBuZXcgVVJMKGNhY2hlZFRlbXBsYXRlVXJsKTtcbiAgICAgICAgZmluYWxSZWRpcmVjdFVybC5wYXRobmFtZSA9IGNhY2hlZFRlbXBsYXRlVXJsLnBhdGhuYW1lLnJlcGxhY2UoXG4gICAgICAgICAgUkVQTEFDRV9QTEFDRUhPTERFUixcbiAgICAgICAgICBjdXJyZW50UGxheWJhY2tJZFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZmluYWxSZWRpcmVjdFVybDtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgaWQgPSBzZXRUaW1lb3V0KFxuICAgICAgKCkgPT4gYWJvcnRDb250cm9sbGVyLmFib3J0KCksXG4gICAgICB0aW1lb3V0ID8/IERFRkFVTFRfVElNRU9VVFxuICAgICk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuICAgICAgbWV0aG9kOiBcIkhFQURcIixcbiAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbFxuICAgIH0pO1xuICAgIGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICBjbGVhclRpbWVvdXQoaWQpO1xuICAgIGNvbnN0IGFjdHVhbFJlZGlyZWN0ZWRVcmwgPSBuZXcgVVJMKHJlc3BvbnNlLnVybCk7XG4gICAgaWYgKGFjdHVhbFJlZGlyZWN0ZWRVcmwpIHtcbiAgICAgIGNvbnN0IHRlbXBsYXRlRm9yQ2FjaGUgPSBuZXcgVVJMKGFjdHVhbFJlZGlyZWN0ZWRVcmwpO1xuICAgICAgdGVtcGxhdGVGb3JDYWNoZS5wYXRobmFtZSA9IHRlbXBsYXRlRm9yQ2FjaGUucGF0aG5hbWUucmVwbGFjZShcbiAgICAgICAgcGxheWJhY2tJZFBhdHRlcm4sXG4gICAgICAgIGAkMSR7UkVQTEFDRV9QTEFDRUhPTERFUn1gXG4gICAgICApO1xuICAgICAgaWYgKCF0ZW1wbGF0ZUZvckNhY2hlLnNlYXJjaFBhcmFtcy5oYXMoXCJpbmdlc3RwYlwiKSB8fCB0ZW1wbGF0ZUZvckNhY2hlLnNlYXJjaFBhcmFtcy5nZXQoXCJpbmdlc3RwYlwiKSAhPT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgc2V0Q2FjaGVkVGVtcGxhdGUoZW5kcG9pbnQsIHRlbXBsYXRlRm9yQ2FjaGUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYWN0dWFsUmVkaXJlY3RlZFVybDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5hc3luYyBmdW5jdGlvbiB3YWl0VG9Db21wbGV0ZUlDRUdhdGhlcmluZyhwZWVyQ29ubmVjdGlvbikge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc29sdmUocGVlckNvbm5lY3Rpb24ubG9jYWxEZXNjcmlwdGlvbik7XG4gICAgfSwgNWUzKTtcbiAgICBwZWVyQ29ubmVjdGlvbi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlID0gKF9ldikgPT4ge1xuICAgICAgaWYgKHBlZXJDb25uZWN0aW9uLmljZUdhdGhlcmluZ1N0YXRlID09PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgcmVzb2x2ZShwZWVyQ29ubmVjdGlvbi5sb2NhbERlc2NyaXB0aW9uKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbn1cblxuLy8gc3JjL3dlYnJ0Yy93aGVwLnRzXG52YXIgVklERU9fV0VCUlRDX0lOSVRJQUxJWkVEX0FUVFJJQlVURSA9IFwiZGF0YS1saXZlcGVlci12aWRlby13aGVwLWluaXRpYWxpemVkXCI7XG52YXIgY3JlYXRlTmV3V0hFUCA9ICh7XG4gIHNvdXJjZSxcbiAgZWxlbWVudCxcbiAgY2FsbGJhY2tzLFxuICBhY2Nlc3NDb250cm9sLFxuICBzZHBUaW1lb3V0LFxuICBpY2VTZXJ2ZXJzXG59KSA9PiB7XG4gIGlmIChlbGVtZW50LmdldEF0dHJpYnV0ZShWSURFT19XRUJSVENfSU5JVElBTElaRURfQVRUUklCVVRFKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGVzdHJveTogKCkgPT4ge1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoVklERU9fV0VCUlRDX0lOSVRJQUxJWkVEX0FUVFJJQlVURSwgXCJ0cnVlXCIpO1xuICBsZXQgZGVzdHJveWVkID0gZmFsc2U7XG4gIGNvbnN0IGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgbGV0IHBlZXJDb25uZWN0aW9uID0gbnVsbDtcbiAgY29uc3Qgc3RyZWFtID0gbmV3IE1lZGlhU3RyZWFtKCk7XG4gIGNvbnN0IGVycm9yQ29tcG9zZWQgPSAoZSkgPT4ge1xuICAgIGNhbGxiYWNrcz8ub25FcnJvcj8uKGUpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LnNyY09iamVjdCA9IG51bGw7XG4gICAgfVxuICB9O1xuICBnZXRSZWRpcmVjdFVybChzb3VyY2UsIGFib3J0Q29udHJvbGxlciwgc2RwVGltZW91dCkudGhlbigocmVkaXJlY3RVcmwpID0+IHtcbiAgICBpZiAoZGVzdHJveWVkIHx8ICFyZWRpcmVjdFVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCByZWRpcmVjdFVybFN0cmluZyA9IHJlZGlyZWN0VXJsLnRvU3RyaW5nKCk7XG4gICAgY2FsbGJhY2tzPy5vblJlZGlyZWN0Py4ocmVkaXJlY3RVcmxTdHJpbmcgPz8gbnVsbCk7XG4gICAgcGVlckNvbm5lY3Rpb24gPSBjcmVhdGVQZWVyQ29ubmVjdGlvbihyZWRpcmVjdFVybC5ob3N0LCBpY2VTZXJ2ZXJzKTtcbiAgICBpZiAocGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHBlZXJDb25uZWN0aW9uLmFkZFRyYW5zY2VpdmVyKFwidmlkZW9cIiwge1xuICAgICAgICBkaXJlY3Rpb246IFwicmVjdm9ubHlcIlxuICAgICAgfSk7XG4gICAgICBwZWVyQ29ubmVjdGlvbi5hZGRUcmFuc2NlaXZlcihcImF1ZGlvXCIsIHtcbiAgICAgICAgZGlyZWN0aW9uOiBcInJlY3Zvbmx5XCJcbiAgICAgIH0pO1xuICAgICAgcGVlckNvbm5lY3Rpb24ub250cmFjayA9IChldmVudCkgPT4ge1xuICAgICAgICBpZiAoZGVzdHJveWVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBldmVudC50cmFjaztcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRUcmFja3MgPSBzdHJlYW0uZ2V0VHJhY2tzKCk7XG4gICAgICAgICAgICBjb25zdCBzdHJlYW1BbHJlYWR5SGFzVmlkZW9UcmFjayA9IGN1cnJlbnRUcmFja3Muc29tZShcbiAgICAgICAgICAgICAgKHRyYWNrMikgPT4gdHJhY2syLmtpbmQgPT09IFwidmlkZW9cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbUFscmVhZHlIYXNBdWRpb1RyYWNrID0gY3VycmVudFRyYWNrcy5zb21lKFxuICAgICAgICAgICAgICAodHJhY2syKSA9PiB0cmFjazIua2luZCA9PT0gXCJhdWRpb1wiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgc3dpdGNoICh0cmFjay5raW5kKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJ2aWRlb1wiOlxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1BbHJlYWR5SGFzVmlkZW9UcmFjaykge1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgXCJhdWRpb1wiOlxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1BbHJlYWR5SGFzQXVkaW9UcmFjaykge1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHJlY2VpdmVkIHVua25vd24gdHJhY2sgJHt0cmFja31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlcnJvckNvbXBvc2VkKGUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcGVlckNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcihcImNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLCAoX2V2KSA9PiB7XG4gICAgICAgIGlmIChkZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAocGVlckNvbm5lY3Rpb24/LmNvbm5lY3Rpb25TdGF0ZSA9PT0gXCJmYWlsZWRcIikge1xuICAgICAgICAgICAgY2FsbGJhY2tzPy5vbkVycm9yPy4obmV3IEVycm9yKFwiRmFpbGVkIHRvIGNvbm5lY3QgdG8gcGVlci5cIikpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocGVlckNvbm5lY3Rpb24/LmNvbm5lY3Rpb25TdGF0ZSA9PT0gXCJjb25uZWN0ZWRcIiAmJiAhZWxlbWVudC5zcmNPYmplY3QpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuc3JjT2JqZWN0ID0gc3RyZWFtO1xuICAgICAgICAgICAgY2FsbGJhY2tzPy5vbkNvbm5lY3RlZD8uKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZXJyb3JDb21wb3NlZChlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBwZWVyQ29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFwibmVnb3RpYXRpb25uZWVkZWRcIiwgYXN5bmMgKF9ldikgPT4ge1xuICAgICAgICBpZiAoZGVzdHJveWVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgb2ZyID0gYXdhaXQgY29uc3RydWN0Q2xpZW50T2ZmZXIoXG4gICAgICAgICAgICBwZWVyQ29ubmVjdGlvbixcbiAgICAgICAgICAgIHJlZGlyZWN0VXJsU3RyaW5nXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoZGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbmVnb3RpYXRlQ29ubmVjdGlvbldpdGhDbGllbnRPZmZlcihcbiAgICAgICAgICAgIHBlZXJDb25uZWN0aW9uLFxuICAgICAgICAgICAgc291cmNlLFxuICAgICAgICAgICAgb2ZyLFxuICAgICAgICAgICAgYWJvcnRDb250cm9sbGVyLFxuICAgICAgICAgICAgYWNjZXNzQ29udHJvbCxcbiAgICAgICAgICAgIHNkcFRpbWVvdXRcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChkZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgIGlmIChyZXNwb25zZSAmJiBjdXJyZW50RGF0ZSkge1xuICAgICAgICAgICAgY2FsbGJhY2tzPy5vblBsYXliYWNrT2Zmc2V0VXBkYXRlZD8uKFxuICAgICAgICAgICAgICBjdXJyZW50RGF0ZSAtIHJlc3BvbnNlLmdldFRpbWUoKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlcnJvckNvbXBvc2VkKGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0pLmNhdGNoKChlKSA9PiBlcnJvckNvbXBvc2VkKGUpKTtcbiAgcmV0dXJuIHtcbiAgICBkZXN0cm95OiAoKSA9PiB7XG4gICAgICBkZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgYWJvcnRDb250cm9sbGVyPy5hYm9ydD8uKCk7XG4gICAgICBwZWVyQ29ubmVjdGlvbj8uY2xvc2U/LigpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5zcmNPYmplY3QgPSBudWxsO1xuICAgICAgfVxuICAgICAgZWxlbWVudD8ucmVtb3ZlQXR0cmlidXRlPy4oVklERU9fV0VCUlRDX0lOSVRJQUxJWkVEX0FUVFJJQlVURSk7XG4gICAgfVxuICB9O1xufTtcblxuLy8gc3JjL21lZGlhL2NvbnRyb2xzL2Z1bGxzY3JlZW4udHNcbnZhciBtZXRob2RzTGlzdCA9IFtcbiAgLy8gbW9kZXJuIGJyb3dzZXJzXG4gIHtcbiAgICByZXF1ZXN0RnVsbHNjcmVlbjogXCJyZXF1ZXN0RnVsbHNjcmVlblwiLFxuICAgIGV4aXRGdWxsc2NyZWVuOiBcImV4aXRGdWxsc2NyZWVuXCIsXG4gICAgZnVsbHNjcmVlbkVsZW1lbnQ6IFwiZnVsbHNjcmVlbkVsZW1lbnRcIixcbiAgICBmdWxsc2NyZWVuRW5hYmxlZDogXCJmdWxsc2NyZWVuRW5hYmxlZFwiLFxuICAgIGZ1bGxzY3JlZW5jaGFuZ2U6IFwiZnVsbHNjcmVlbmNoYW5nZVwiLFxuICAgIGZ1bGxzY3JlZW5lcnJvcjogXCJmdWxsc2NyZWVuZXJyb3JcIlxuICB9LFxuICAvLyBuZXcgV2ViS2l0XG4gIHtcbiAgICByZXF1ZXN0RnVsbHNjcmVlbjogXCJ3ZWJraXRSZXF1ZXN0RnVsbHNjcmVlblwiLFxuICAgIGV4aXRGdWxsc2NyZWVuOiBcIndlYmtpdEV4aXRGdWxsc2NyZWVuXCIsXG4gICAgZnVsbHNjcmVlbkVsZW1lbnQ6IFwid2Via2l0RnVsbHNjcmVlbkVsZW1lbnRcIixcbiAgICBmdWxsc2NyZWVuRW5hYmxlZDogXCJ3ZWJraXRGdWxsc2NyZWVuRW5hYmxlZFwiLFxuICAgIGZ1bGxzY3JlZW5jaGFuZ2U6IFwid2Via2l0ZnVsbHNjcmVlbmNoYW5nZVwiLFxuICAgIGZ1bGxzY3JlZW5lcnJvcjogXCJ3ZWJraXRmdWxsc2NyZWVuZXJyb3JcIlxuICB9LFxuICAvLyBvbGQgV2ViS2l0XG4gIHtcbiAgICByZXF1ZXN0RnVsbHNjcmVlbjogXCJ3ZWJraXRSZXF1ZXN0RnVsbFNjcmVlblwiLFxuICAgIGV4aXRGdWxsc2NyZWVuOiBcIndlYmtpdENhbmNlbEZ1bGxTY3JlZW5cIixcbiAgICBmdWxsc2NyZWVuRWxlbWVudDogXCJ3ZWJraXRDdXJyZW50RnVsbFNjcmVlbkVsZW1lbnRcIixcbiAgICBmdWxsc2NyZWVuRW5hYmxlZDogXCJ3ZWJraXRDYW5jZWxGdWxsU2NyZWVuXCIsXG4gICAgZnVsbHNjcmVlbmNoYW5nZTogXCJ3ZWJraXRmdWxsc2NyZWVuY2hhbmdlXCIsXG4gICAgZnVsbHNjcmVlbmVycm9yOiBcIndlYmtpdGZ1bGxzY3JlZW5lcnJvclwiXG4gIH0sXG4gIC8vIG9sZCBmaXJlZm94XG4gIHtcbiAgICByZXF1ZXN0RnVsbHNjcmVlbjogXCJtb3pSZXF1ZXN0RnVsbFNjcmVlblwiLFxuICAgIGV4aXRGdWxsc2NyZWVuOiBcIm1vekNhbmNlbEZ1bGxTY3JlZW5cIixcbiAgICBmdWxsc2NyZWVuRWxlbWVudDogXCJtb3pGdWxsU2NyZWVuRWxlbWVudFwiLFxuICAgIGZ1bGxzY3JlZW5FbmFibGVkOiBcIm1vekZ1bGxTY3JlZW5FbmFibGVkXCIsXG4gICAgZnVsbHNjcmVlbmNoYW5nZTogXCJtb3pmdWxsc2NyZWVuY2hhbmdlXCIsXG4gICAgZnVsbHNjcmVlbmVycm9yOiBcIm1vemZ1bGxzY3JlZW5lcnJvclwiXG4gIH0sXG4gIC8vIG9sZCBJRVxuICB7XG4gICAgcmVxdWVzdEZ1bGxzY3JlZW46IFwibXNSZXF1ZXN0RnVsbHNjcmVlblwiLFxuICAgIGV4aXRGdWxsc2NyZWVuOiBcIm1zRXhpdEZ1bGxzY3JlZW5cIixcbiAgICBmdWxsc2NyZWVuRWxlbWVudDogXCJtc0Z1bGxzY3JlZW5FbGVtZW50XCIsXG4gICAgZnVsbHNjcmVlbkVuYWJsZWQ6IFwibXNGdWxsc2NyZWVuRW5hYmxlZFwiLFxuICAgIGZ1bGxzY3JlZW5jaGFuZ2U6IFwiTVNGdWxsc2NyZWVuQ2hhbmdlXCIsXG4gICAgZnVsbHNjcmVlbmVycm9yOiBcIk1TRnVsbHNjcmVlbkVycm9yXCJcbiAgfVxuXTtcbnZhciBpb3NNZXRob2RzID0ge1xuICByZXF1ZXN0RnVsbHNjcmVlbjogXCJ3ZWJraXRFbnRlckZ1bGxzY3JlZW5cIixcbiAgZXhpdEZ1bGxzY3JlZW46IFwid2Via2l0RXhpdEZ1bGxzY3JlZW5cIixcbiAgZnVsbHNjcmVlbkVsZW1lbnQ6IG51bGwsXG4gIGZ1bGxzY3JlZW5FbmFibGVkOiBcIndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuXCIsXG4gIGZ1bGxzY3JlZW5jaGFuZ2U6IFwiZnVsbHNjcmVlbmNoYW5nZVwiLFxuICBmdWxsc2NyZWVuZXJyb3I6IFwiZnVsbHNjcmVlbmVycm9yXCJcbn07XG52YXIgaXNGdWxsc2NyZWVuU3VwcG9ydGVkID0gKCkgPT4ge1xuICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgdmlkZW9FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xuICBjb25zdCByZXN1bHQgPSBCb29sZWFuKGdldEZ1bGxzY3JlZW5NZXRob2RzKHZpZGVvRWxlbWVudCkpO1xuICB2aWRlb0VsZW1lbnQucmVtb3ZlKCk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xudmFyIGlzQ3VycmVudGx5RnVsbHNjcmVlbiA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgY29uc3QgeyBtZXRob2RzLCBlbGVtZW50IH0gPSBnZXRGdWxsc2NyZWVuTWV0aG9kcyhpbnB1dEVsZW1lbnQpO1xuICBpZiAobWV0aG9kcz8uZnVsbHNjcmVlbkVsZW1lbnQpIHtcbiAgICByZXR1cm4gQm9vbGVhbihkb2N1bWVudFttZXRob2RzLmZ1bGxzY3JlZW5FbGVtZW50XSk7XG4gIH1cbiAgcmV0dXJuIEJvb2xlYW4oZWxlbWVudD8ud2Via2l0UHJlc2VudGF0aW9uTW9kZSA9PT0gXCJmdWxsc2NyZWVuXCIpO1xufTtcbnZhciBlbnRlckZ1bGxzY3JlZW4gPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gIGNvbnN0IHsgbWV0aG9kcywgZWxlbWVudCB9ID0gZ2V0RnVsbHNjcmVlbk1ldGhvZHMoaW5wdXRFbGVtZW50KTtcbiAgaWYgKG1ldGhvZHMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgZnVsbHNjcmVlbk1ldGhvZCA9IG1ldGhvZHMucmVxdWVzdEZ1bGxzY3JlZW47XG4gICAgICBjb25zdCBvbkZ1bGxTY3JlZW4gPSAoKSA9PiB7XG4gICAgICAgIHJlbW92ZUZ1bGxzY3JlZW5FdmVudExpc3RlbmVyKGlucHV0RWxlbWVudCwgb25GdWxsU2NyZWVuKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcbiAgICAgIGFkZEZ1bGxzY3JlZW5FdmVudExpc3RlbmVyKGlucHV0RWxlbWVudCwgb25GdWxsU2NyZWVuKTtcbiAgICAgIGNvbnN0IHJldHVyblByb21pc2UgPSBtZXRob2RzLmZ1bGxzY3JlZW5FbGVtZW50ID8gZWxlbWVudD8ucGFyZW50RWxlbWVudD8uW2Z1bGxzY3JlZW5NZXRob2RdPy4oKSA6IGVsZW1lbnQ/LltmdWxsc2NyZWVuTWV0aG9kXT8uKCkgPz8gbnVsbDtcbiAgICAgIGlmIChyZXR1cm5Qcm9taXNlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICB9XG4gICAgICBpZiAocmV0dXJuUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuUHJvbWlzZS50aGVuKG9uRnVsbFNjcmVlbikuY2F0Y2gocmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xudmFyIGV4aXRGdWxsc2NyZWVuID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICBjb25zdCB7IG1ldGhvZHMsIGVsZW1lbnQgfSA9IGdldEZ1bGxzY3JlZW5NZXRob2RzKGlucHV0RWxlbWVudCk7XG4gIGlmIChtZXRob2RzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmICghaXNDdXJyZW50bHlGdWxsc2NyZWVuKGlucHV0RWxlbWVudCkpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBvbkZ1bGxTY3JlZW5FeGl0ID0gKCkgPT4ge1xuICAgICAgICByZW1vdmVGdWxsc2NyZWVuRXZlbnRMaXN0ZW5lcihpbnB1dEVsZW1lbnQsIG9uRnVsbFNjcmVlbkV4aXQpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgYWRkRnVsbHNjcmVlbkV2ZW50TGlzdGVuZXIoaW5wdXRFbGVtZW50LCBvbkZ1bGxTY3JlZW5FeGl0KTtcbiAgICAgIGNvbnN0IHJldHVyblByb21pc2UgPSBtZXRob2RzLmZ1bGxzY3JlZW5FbGVtZW50ID8gZG9jdW1lbnQ/LlttZXRob2RzLmV4aXRGdWxsc2NyZWVuXT8uKCkgOiBlbGVtZW50Py5bbWV0aG9kcy5leGl0RnVsbHNjcmVlbl0/LigpID8/IG51bGw7XG4gICAgICBpZiAocmV0dXJuUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuUHJvbWlzZS50aGVuKG9uRnVsbFNjcmVlbkV4aXQpLmNhdGNoKHJlamVjdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcbnZhciBhZGRGdWxsc2NyZWVuRXZlbnRMaXN0ZW5lciA9IChpbnB1dEVsZW1lbnQsIGNhbGxiYWNrKSA9PiB7XG4gIGNvbnN0IHsgbWV0aG9kcywgZWxlbWVudCB9ID0gZ2V0RnVsbHNjcmVlbk1ldGhvZHMoaW5wdXRFbGVtZW50KTtcbiAgaWYgKG1ldGhvZHMgJiYgZWxlbWVudCkge1xuICAgIGNvbnN0IHBhcmVudEVsZW1lbnRPckVsZW1lbnQgPSBlbGVtZW50Py5wYXJlbnRFbGVtZW50ID8/IGVsZW1lbnQ7XG4gICAgcGFyZW50RWxlbWVudE9yRWxlbWVudD8uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIG1ldGhvZHMuZnVsbHNjcmVlbmNoYW5nZSxcbiAgICAgIGNhbGxiYWNrLFxuICAgICAgZmFsc2VcbiAgICApO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICByZW1vdmVGdWxsc2NyZWVuRXZlbnRMaXN0ZW5lcihpbnB1dEVsZW1lbnQsIGNhbGxiYWNrKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbnZhciByZW1vdmVGdWxsc2NyZWVuRXZlbnRMaXN0ZW5lciA9IChpbnB1dEVsZW1lbnQsIGNhbGxiYWNrKSA9PiB7XG4gIGNvbnN0IHsgbWV0aG9kcywgZWxlbWVudCB9ID0gZ2V0RnVsbHNjcmVlbk1ldGhvZHMoaW5wdXRFbGVtZW50KTtcbiAgaWYgKG1ldGhvZHMgJiYgZWxlbWVudCkge1xuICAgIGNvbnN0IHBhcmVudEVsZW1lbnRPckVsZW1lbnQgPSBlbGVtZW50Py5wYXJlbnRFbGVtZW50ID8/IGVsZW1lbnQ7XG4gICAgcGFyZW50RWxlbWVudE9yRWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgIG1ldGhvZHMuZnVsbHNjcmVlbmNoYW5nZSxcbiAgICAgIGNhbGxiYWNrLFxuICAgICAgZmFsc2VcbiAgICApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG52YXIgZ2V0RnVsbHNjcmVlbk1ldGhvZHMgPSAoZWxlbWVudCkgPT4ge1xuICBpZiAoaXNDbGllbnQoKSkge1xuICAgIGZvciAoY29uc3QgbWV0aG9kcyBvZiBtZXRob2RzTGlzdCkge1xuICAgICAgY29uc3QgZXhpdEZ1bGxzY3JlZW5NZXRob2QgPSBtZXRob2RzLmV4aXRGdWxsc2NyZWVuO1xuICAgICAgaWYgKGV4aXRGdWxsc2NyZWVuTWV0aG9kIGluIGRvY3VtZW50KSB7XG4gICAgICAgIHJldHVybiB7IG1ldGhvZHMsIGVsZW1lbnQgfTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVsZW1lbnQgJiYgaW9zTWV0aG9kcy5yZXF1ZXN0RnVsbHNjcmVlbiBpbiBlbGVtZW50KSB7XG4gICAgICByZXR1cm4geyBtZXRob2RzOiBpb3NNZXRob2RzLCBlbGVtZW50IH07XG4gICAgfVxuICB9XG4gIHJldHVybiB7IG1ldGhvZHM6IG51bGwgfTtcbn07XG5cbi8vIHNyYy9tZWRpYS9jb250cm9scy9waWN0dXJlSW5QaWN0dXJlLnRzXG52YXIgaXNQaWN0dXJlSW5QaWN0dXJlU3VwcG9ydGVkID0gKGVsZW1lbnQpID0+IHtcbiAgaWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IHZpZGVvRWxlbWVudCA9IGVsZW1lbnQgPz8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xuICBjb25zdCBpc1BpUERpc2FibGVkID0gQm9vbGVhbihcbiAgICB2aWRlb0VsZW1lbnQuZGlzYWJsZVBpY3R1cmVJblBpY3R1cmVcbiAgKTtcbiAgY29uc3QgeyBhcGlUeXBlIH0gPSBnZXRQaWN0dXJlSW5QaWN0dXJlTW9kZSh2aWRlb0VsZW1lbnQpO1xuICByZXR1cm4gQm9vbGVhbihhcGlUeXBlKSAmJiAhaXNQaVBEaXNhYmxlZDtcbn07XG52YXIgaXNDdXJyZW50bHlQaWN0dXJlSW5QaWN0dXJlID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICBjb25zdCB7IGFwaVR5cGUsIGVsZW1lbnQgfSA9IGdldFBpY3R1cmVJblBpY3R1cmVNb2RlKGlucHV0RWxlbWVudCk7XG4gIGlmIChhcGlUeXBlID09PSBcInczY1wiKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4oZG9jdW1lbnQ/LnBpY3R1cmVJblBpY3R1cmVFbGVtZW50KTtcbiAgfVxuICBpZiAoYXBpVHlwZSA9PT0gXCJ3ZWJraXRcIikge1xuICAgIHJldHVybiBlbGVtZW50Py53ZWJraXRQcmVzZW50YXRpb25Nb2RlID09PSBcInBpY3R1cmUtaW4tcGljdHVyZVwiO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG52YXIgZW50ZXJQaWN0dXJlSW5QaWN0dXJlID0gYXN5bmMgKGlucHV0RWxlbWVudCkgPT4ge1xuICBjb25zdCB7IGFwaVR5cGUsIGVsZW1lbnQgfSA9IGdldFBpY3R1cmVJblBpY3R1cmVNb2RlKGlucHV0RWxlbWVudCk7XG4gIGlmIChhcGlUeXBlID09PSBcInczY1wiKSB7XG4gICAgYXdhaXQgZWxlbWVudD8ucmVxdWVzdFBpY3R1cmVJblBpY3R1cmU/LigpO1xuICB9IGVsc2UgaWYgKGFwaVR5cGUgPT09IFwid2Via2l0XCIpIHtcbiAgICBhd2FpdCBlbGVtZW50Py53ZWJraXRTZXRQcmVzZW50YXRpb25Nb2RlPy4oXCJwaWN0dXJlLWluLXBpY3R1cmVcIik7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xudmFyIGV4aXRQaWN0dXJlSW5QaWN0dXJlID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICBjb25zdCB7IGFwaVR5cGUsIGVsZW1lbnQgfSA9IGdldFBpY3R1cmVJblBpY3R1cmVNb2RlKGlucHV0RWxlbWVudCk7XG4gIGlmIChhcGlUeXBlID09PSBcInczY1wiKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50Py5leGl0UGljdHVyZUluUGljdHVyZT8uKCkgPz8gbnVsbDtcbiAgfVxuICBpZiAoYXBpVHlwZSA9PT0gXCJ3ZWJraXRcIikge1xuICAgIHJldHVybiBlbGVtZW50Py53ZWJraXRTZXRQcmVzZW50YXRpb25Nb2RlPy4oXCJpbmxpbmVcIikgPz8gbnVsbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG52YXIgYWRkRW50ZXJQaWN0dXJlSW5QaWN0dXJlRXZlbnRMaXN0ZW5lciA9IChpbnB1dEVsZW1lbnQsIGNhbGxiYWNrKSA9PiB7XG4gIGNvbnN0IHsgYXBpVHlwZSwgZWxlbWVudCB9ID0gZ2V0UGljdHVyZUluUGljdHVyZU1vZGUoaW5wdXRFbGVtZW50KTtcbiAgaWYgKGFwaVR5cGUgPT09IFwidzNjXCIgJiYgZWxlbWVudCkge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImVudGVycGljdHVyZWlucGljdHVyZVwiLCBjYWxsYmFjaywgZmFsc2UpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlbnRlcnBpY3R1cmVpbnBpY3R1cmVcIiwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICB9O1xuICB9XG4gIGlmIChhcGlUeXBlID09PSBcIndlYmtpdFwiICYmIGVsZW1lbnQpIHtcbiAgICBjb25zdCBjYWxsYmFja0NvbXBvc2VkID0gKGUpID0+IHtcbiAgICAgIGlmIChlbGVtZW50Py53ZWJraXRQcmVzZW50YXRpb25Nb2RlID09PSBcInBpY3R1cmUtaW4tcGljdHVyZVwiKSB7XG4gICAgICAgIGNhbGxiYWNrPy4oZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJ3ZWJraXRwcmVzZW50YXRpb25tb2RlY2hhbmdlZFwiLFxuICAgICAgY2FsbGJhY2tDb21wb3NlZCxcbiAgICAgIGZhbHNlXG4gICAgKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJ3ZWJraXRwcmVzZW50YXRpb25tb2RlY2hhbmdlZFwiLFxuICAgICAgICBjYWxsYmFja0NvbXBvc2VkLFxuICAgICAgICBmYWxzZVxuICAgICAgKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbnZhciBhZGRFeGl0UGljdHVyZUluUGljdHVyZUV2ZW50TGlzdGVuZXIgPSAoaW5wdXRFbGVtZW50LCBjYWxsYmFjaykgPT4ge1xuICBjb25zdCB7IGFwaVR5cGUsIGVsZW1lbnQgfSA9IGdldFBpY3R1cmVJblBpY3R1cmVNb2RlKGlucHV0RWxlbWVudCk7XG4gIGlmIChhcGlUeXBlID09PSBcInczY1wiICYmIGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsZWF2ZXBpY3R1cmVpbnBpY3R1cmVcIiwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibGVhdmVwaWN0dXJlaW5waWN0dXJlXCIsIGNhbGxiYWNrLCBmYWxzZSk7XG4gICAgfTtcbiAgfVxuICBpZiAoYXBpVHlwZSA9PT0gXCJ3ZWJraXRcIiAmJiBlbGVtZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tDb21wb3NlZCA9IChlKSA9PiB7XG4gICAgICBpZiAoZWxlbWVudD8ud2Via2l0UHJlc2VudGF0aW9uTW9kZSA9PT0gXCJpbmxpbmVcIikge1xuICAgICAgICBjYWxsYmFjaz8uKGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwid2Via2l0cHJlc2VudGF0aW9ubW9kZWNoYW5nZWRcIixcbiAgICAgIGNhbGxiYWNrQ29tcG9zZWQsXG4gICAgICBmYWxzZVxuICAgICk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwid2Via2l0cHJlc2VudGF0aW9ubW9kZWNoYW5nZWRcIixcbiAgICAgICAgY2FsbGJhY2tDb21wb3NlZCxcbiAgICAgICAgZmFsc2VcbiAgICAgICk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG52YXIgZ2V0UGljdHVyZUluUGljdHVyZU1vZGUgPSAoZWxlbWVudCkgPT4ge1xuICBpZiAoaXNDbGllbnQoKSAmJiBlbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkge1xuICAgIGlmIChkb2N1bWVudD8ucGljdHVyZUluUGljdHVyZUVuYWJsZWQpIHtcbiAgICAgIHJldHVybiB7IGFwaVR5cGU6IFwidzNjXCIsIGVsZW1lbnQgfTtcbiAgICB9XG4gICAgaWYgKGVsZW1lbnQ/LndlYmtpdFN1cHBvcnRzUHJlc2VudGF0aW9uTW9kZT8uKFwicGljdHVyZS1pbi1waWN0dXJlXCIpKSB7XG4gICAgICByZXR1cm4geyBhcGlUeXBlOiBcIndlYmtpdFwiLCBlbGVtZW50IH07XG4gICAgfVxuICB9XG4gIHJldHVybiB7IGFwaVR5cGU6IG51bGwgfTtcbn07XG5cbi8vIHNyYy9tZWRpYS9jb250cm9scy92b2x1bWUudHNcbnZhciBpc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZCA9ICh0eXBlKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHRlc3RFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcbiAgICBjb25zdCBuZXdWb2x1bWUgPSAwLjM0MjtcbiAgICB0ZXN0RWxlbWVudC52b2x1bWUgPSBuZXdWb2x1bWU7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjb25zdCBpc1N1cHBvcnRlZCA9IHRlc3RFbGVtZW50LnZvbHVtZSAhPT0gMTtcbiAgICAgIHRlc3RFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgcmVzb2x2ZShpc1N1cHBvcnRlZCk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuLy8gc3JjL21lZGlhL2NvbnRyb2xzL2NvbnRyb2xsZXIudHNcbnZhciBNRURJQV9DT05UUk9MTEVSX0lOSVRJQUxJWkVEX0FUVFJJQlVURSA9IFwiZGF0YS1saXZlcGVlci1jb250cm9sbGVyLWluaXRpYWxpemVkXCI7XG52YXIgYWxsS2V5VHJpZ2dlcnMgPSBbXG4gIFwiS2V5RlwiLFxuICBcIktleUtcIixcbiAgXCJLZXlNXCIsXG4gIFwiS2V5SVwiLFxuICBcIktleVZcIixcbiAgXCJLZXlYXCIsXG4gIFwiU3BhY2VcIixcbiAgXCJBcnJvd1JpZ2h0XCIsXG4gIFwiQXJyb3dMZWZ0XCJcbl07XG52YXIgZGVsYXkgPSAobXMpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59O1xudmFyIGFkZEV2ZW50TGlzdGVuZXJzID0gKGVsZW1lbnQsIHN0b3JlKSA9PiB7XG4gIGNvbnN0IGluaXRpYWxpemVkU3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICB0cnkge1xuICAgIGlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkKFxuICAgICAgaW5pdGlhbGl6ZWRTdGF0ZS5jdXJyZW50U291cmNlPy50eXBlID09PSBcImF1ZGlvXCIgPyBcImF1ZGlvXCIgOiBcInZpZGVvXCJcbiAgICApLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgc3RvcmUuc2V0U3RhdGUoKHsgX19kZXZpY2UgfSkgPT4gKHtcbiAgICAgICAgX19kZXZpY2U6IHtcbiAgICAgICAgICAuLi5fX2RldmljZSxcbiAgICAgICAgICBpc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZDogcmVzdWx0XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gIH1cbiAgY29uc3Qgb25Mb2FkZWRNZXRhZGF0YSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMub25DYW5QbGF5KCk7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnJlcXVlc3RNZWFzdXJlKCk7XG4gIH07XG4gIGNvbnN0IG9uTG9hZGVkRGF0YSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMucmVxdWVzdE1lYXN1cmUoKTtcbiAgfTtcbiAgY29uc3Qgb25QbGF5ID0gKCkgPT4ge1xuICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5vblBsYXkoKTtcbiAgfTtcbiAgY29uc3Qgb25QYXVzZSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMub25QYXVzZSgpO1xuICB9O1xuICBjb25zdCBvbkR1cmF0aW9uQ2hhbmdlID0gKCkgPT4gc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uRHVyYXRpb25DaGFuZ2UoZWxlbWVudD8uZHVyYXRpb24gPz8gMCk7XG4gIGNvbnN0IG9uS2V5VXAgPSAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGNvbnN0IGNvZGUgPSBlLmNvZGU7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnVwZGF0ZUxhc3RJbnRlcmFjdGlvbigpO1xuICAgIGNvbnN0IGlzTm90QnJvYWRjYXN0ID0gc3RvcmUuZ2V0U3RhdGUoKS5fX2luaXRpYWxQcm9wcy5ob3RrZXlzICE9PSBcImJyb2FkY2FzdFwiO1xuICAgIGlmIChhbGxLZXlUcmlnZ2Vycy5pbmNsdWRlcyhjb2RlKSkge1xuICAgICAgaWYgKChjb2RlID09PSBcIlNwYWNlXCIgfHwgY29kZSA9PT0gXCJLZXlLXCIpICYmIGlzTm90QnJvYWRjYXN0KSB7XG4gICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy50b2dnbGVQbGF5KCk7XG4gICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IFwiQXJyb3dSaWdodFwiICYmIGlzTm90QnJvYWRjYXN0KSB7XG4gICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0U2Vla0ZvcndhcmQoKTtcbiAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gXCJBcnJvd0xlZnRcIiAmJiBpc05vdEJyb2FkY2FzdCkge1xuICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMucmVxdWVzdFNlZWtCYWNrKCk7XG4gICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IFwiS2V5TVwiICYmIGlzTm90QnJvYWRjYXN0KSB7XG4gICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0VG9nZ2xlTXV0ZSgpO1xuICAgICAgfSBlbHNlIGlmIChjb2RlID09PSBcIktleVhcIiAmJiBpc05vdEJyb2FkY2FzdCkge1xuICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMucmVxdWVzdENsaXAoKTtcbiAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gXCJLZXlGXCIpIHtcbiAgICAgICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnJlcXVlc3RUb2dnbGVGdWxsc2NyZWVuKCk7XG4gICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IFwiS2V5SVwiKSB7XG4gICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0VG9nZ2xlUGljdHVyZUluUGljdHVyZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3Qgb25Nb3VzZVVwZGF0ZSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMudXBkYXRlTGFzdEludGVyYWN0aW9uKCk7XG4gIH07XG4gIGNvbnN0IG9uVG91Y2hVcGRhdGUgPSBhc3luYyAoKSA9PiB7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnVwZGF0ZUxhc3RJbnRlcmFjdGlvbigpO1xuICB9O1xuICBjb25zdCBvblZvbHVtZUNoYW5nZSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0Vm9sdW1lKGVsZW1lbnQubXV0ZWQgPyAwIDogZWxlbWVudC52b2x1bWUgPz8gMCk7XG4gIH07XG4gIGNvbnN0IG9uUmF0ZUNoYW5nZSA9ICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0UGxheWJhY2tSYXRlKGVsZW1lbnQucGxheWJhY2tSYXRlKTtcbiAgfTtcbiAgY29uc3Qgb25UaW1lVXBkYXRlID0gKCkgPT4ge1xuICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5vblByb2dyZXNzKGVsZW1lbnQ/LmN1cnJlbnRUaW1lID8/IDApO1xuICAgIGlmIChlbGVtZW50ICYmIChlbGVtZW50Py5kdXJhdGlvbiA/PyAwKSA+IDApIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gZWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgIGNvbnN0IGJ1ZmZlcmVkID0gWy4uLkFycmF5KGVsZW1lbnQuYnVmZmVyZWQubGVuZ3RoKV0ucmVkdWNlKFxuICAgICAgICAocHJldiwgX2N1cnIsIGkpID0+IHtcbiAgICAgICAgICBjb25zdCBzdGFydCA9IGVsZW1lbnQuYnVmZmVyZWQuc3RhcnQoZWxlbWVudC5idWZmZXJlZC5sZW5ndGggLSAxIC0gaSk7XG4gICAgICAgICAgY29uc3QgZW5kID0gZWxlbWVudC5idWZmZXJlZC5lbmQoZWxlbWVudC5idWZmZXJlZC5sZW5ndGggLSAxIC0gaSk7XG4gICAgICAgICAgaWYgKHN0YXJ0IDw9IGN1cnJlbnRUaW1lICYmIGVuZCA+PSBjdXJyZW50VGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIGVuZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGRlZmF1bHQgdG8gbm8gYnVmZmVyaW5nXG4gICAgICAgIDBcbiAgICAgICk7XG4gICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMudXBkYXRlQnVmZmVyZWQoYnVmZmVyZWQpO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgb25FcnJvciA9IGFzeW5jIChlKSA9PiB7XG4gICAgY29uc3Qgc291cmNlID0gc3RvcmUuZ2V0U3RhdGUoKS5jdXJyZW50U291cmNlO1xuICAgIGlmIChzb3VyY2U/LnR5cGUgPT09IFwidmlkZW9cIikge1xuICAgICAgY29uc3Qgc291cmNlRWxlbWVudCA9IGUudGFyZ2V0O1xuICAgICAgY29uc3QgcGFyZW50RWxlbWVudCA9IHNvdXJjZUVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG4gICAgICBjb25zdCB2aWRlb1VybCA9IHBhcmVudEVsZW1lbnQ/LmN1cnJlbnRTcmMgPz8gc291cmNlRWxlbWVudD8uY3VycmVudFNyYztcbiAgICAgIGlmICh2aWRlb1VybCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godmlkZW9VcmwpO1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiVmlkZW8gbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucz8ub25FcnJvcj8uKFxuICAgICAgICAgICAgICBuZXcgRXJyb3IoU1RSRUFNX09GRkxJTkVfRVJST1JfTUVTU0FHRSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiVW5hdXRob3JpemVkIHRvIHZpZXcgdmlkZW9cIik7XG4gICAgICAgICAgICByZXR1cm4gc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zPy5vbkVycm9yPy4oXG4gICAgICAgICAgICAgIG5ldyBFcnJvcihBQ0NFU1NfQ09OVFJPTF9FUlJPUl9NRVNTQUdFKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUud2FybihlcnIpO1xuICAgICAgICAgIHJldHVybiBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnM/Lm9uRXJyb3I/LihcbiAgICAgICAgICAgIG5ldyBFcnJvcihcIkVycm9yIGZldGNoaW5nIHZpZGVvIFVSTFwiKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnNvbGUud2FybihcIlVua25vd24gZXJyb3IgbG9hZGluZyB2aWRlb1wiKTtcbiAgICAgIHJldHVybiBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnM/Lm9uRXJyb3I/LihcbiAgICAgICAgbmV3IEVycm9yKFwiVW5rbm93biBlcnJvciBsb2FkaW5nIHZpZGVvXCIpXG4gICAgICApO1xuICAgIH1cbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMub25FcnJvcihuZXcgRXJyb3IoZT8ubWVzc2FnZSkpO1xuICB9O1xuICBjb25zdCBvbldhaXRpbmcgPSBhc3luYyAoKSA9PiB7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uV2FpdGluZygpO1xuICB9O1xuICBjb25zdCBvblN0YWxsZWQgPSBhc3luYyAoKSA9PiB7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uU3RhbGxlZCgpO1xuICB9O1xuICBjb25zdCBvbkxvYWRTdGFydCA9IGFzeW5jICgpID0+IHtcbiAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMub25Mb2FkaW5nKCk7XG4gIH07XG4gIGNvbnN0IG9uRW5kZWQgPSBhc3luYyAoKSA9PiB7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uRW5kZWQoKTtcbiAgfTtcbiAgY29uc3Qgb25SZXNpemUgPSBhc3luYyAoKSA9PiB7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnJlcXVlc3RNZWFzdXJlKCk7XG4gIH07XG4gIGNvbnN0IHBhcmVudEVsZW1lbnRPckVsZW1lbnQgPSBlbGVtZW50Py5wYXJlbnRFbGVtZW50ID8/IGVsZW1lbnQ7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidm9sdW1lY2hhbmdlXCIsIG9uVm9sdW1lQ2hhbmdlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyYXRlY2hhbmdlXCIsIG9uUmF0ZUNoYW5nZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVkbWV0YWRhdGFcIiwgb25Mb2FkZWRNZXRhZGF0YSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBvbkxvYWRlZERhdGEpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBsYXlcIiwgb25QbGF5KTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwbGF5aW5nXCIsIG9uUGxheSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicGF1c2VcIiwgb25QYXVzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHVyYXRpb25jaGFuZ2VcIiwgb25EdXJhdGlvbkNoYW5nZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidGltZXVwZGF0ZVwiLCBvblRpbWVVcGRhdGUpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIG9uRXJyb3IpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndhaXRpbmdcIiwgb25XYWl0aW5nKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdGFsbGVkXCIsIG9uU3RhbGxlZCk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZHN0YXJ0XCIsIG9uTG9hZFN0YXJ0KTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBvbkVuZGVkKTtcbiAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgb25Nb3VzZVVwZGF0ZSk7XG4gICAgcGFyZW50RWxlbWVudE9yRWxlbWVudD8uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlVXBkYXRlKTtcbiAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBvblRvdWNoVXBkYXRlKTtcbiAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgb25Ub3VjaFVwZGF0ZSk7XG4gICAgcGFyZW50RWxlbWVudE9yRWxlbWVudD8uYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCBvblRvdWNoVXBkYXRlKTtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgd2luZG93Py5hZGRFdmVudExpc3RlbmVyPy4oXCJyZXNpemVcIiwgb25SZXNpemUpO1xuICAgIH1cbiAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgb25LZXlVcCk7XG4gICAgcGFyZW50RWxlbWVudE9yRWxlbWVudD8uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCIwXCIpO1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKE1FRElBX0NPTlRST0xMRVJfSU5JVElBTElaRURfQVRUUklCVVRFLCBcInRydWVcIik7XG4gIH1cbiAgY29uc3Qgb25GdWxsc2NyZWVuQ2hhbmdlID0gKCkgPT4ge1xuICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5zZXRGdWxsc2NyZWVuKGlzQ3VycmVudGx5RnVsbHNjcmVlbihlbGVtZW50KSk7XG4gIH07XG4gIGNvbnN0IG9uRW50ZXJQaWN0dXJlSW5QaWN0dXJlID0gKCkgPT4ge1xuICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5zZXRQaWN0dXJlSW5QaWN0dXJlKHRydWUpO1xuICB9O1xuICBjb25zdCBvbkV4aXRQaWN0dXJlSW5QaWN0dXJlID0gKCkgPT4ge1xuICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5zZXRQaWN0dXJlSW5QaWN0dXJlKGZhbHNlKTtcbiAgfTtcbiAgY29uc3QgcmVtb3ZlRWZmZWN0c0Zyb21TdG9yZSA9IGFkZEVmZmVjdHNUb1N0b3JlKGVsZW1lbnQsIHN0b3JlKTtcbiAgY29uc3QgcmVtb3ZlRnVsbHNjcmVlbkxpc3RlbmVyID0gYWRkRnVsbHNjcmVlbkV2ZW50TGlzdGVuZXIoXG4gICAgZWxlbWVudCxcbiAgICBvbkZ1bGxzY3JlZW5DaGFuZ2VcbiAgKTtcbiAgY29uc3QgcmVtb3ZlRW50ZXJQaWN0dXJlSW5QaWN0dXJlTGlzdGVuZXIgPSBhZGRFbnRlclBpY3R1cmVJblBpY3R1cmVFdmVudExpc3RlbmVyKGVsZW1lbnQsIG9uRW50ZXJQaWN0dXJlSW5QaWN0dXJlKTtcbiAgY29uc3QgcmVtb3ZlRXhpdFBpY3R1cmVJblBpY3R1cmVMaXN0ZW5lciA9IGFkZEV4aXRQaWN0dXJlSW5QaWN0dXJlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCBvbkV4aXRQaWN0dXJlSW5QaWN0dXJlKTtcbiAgcmV0dXJuIHtcbiAgICBkZXN0cm95OiAoKSA9PiB7XG4gICAgICByZW1vdmVGdWxsc2NyZWVuTGlzdGVuZXI/LigpO1xuICAgICAgcmVtb3ZlRW50ZXJQaWN0dXJlSW5QaWN0dXJlTGlzdGVuZXI/LigpO1xuICAgICAgcmVtb3ZlRXhpdFBpY3R1cmVJblBpY3R1cmVMaXN0ZW5lcj8uKCk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJyYXRlY2hhbmdlXCIsIG9uUmF0ZUNoYW5nZSk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJ2b2x1bWVjaGFuZ2VcIiwgb25Wb2x1bWVDaGFuZ2UpO1xuICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcj8uKFwibG9hZGVkbWV0YWRhdGFcIiwgb25Mb2FkZWRNZXRhZGF0YSk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJsb2FkZWRkYXRhXCIsIG9uTG9hZGVkRGF0YSk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJwbGF5XCIsIG9uUGxheSk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJwbGF5aW5nXCIsIG9uUGxheSk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJwYXVzZVwiLCBvblBhdXNlKTtcbiAgICAgIGVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcImR1cmF0aW9uY2hhbmdlXCIsIG9uRHVyYXRpb25DaGFuZ2UpO1xuICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcj8uKFwidGltZXVwZGF0ZVwiLCBvblRpbWVVcGRhdGUpO1xuICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcj8uKFwiZXJyb3JcIiwgb25FcnJvcik7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJ3YWl0aW5nXCIsIG9uV2FpdGluZyk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJzdGFsbGVkXCIsIG9uU3RhbGxlZCk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJsb2Fkc3RhcnRcIiwgb25Mb2FkU3RhcnQpO1xuICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcj8uKFwiZW5kZWRcIiwgb25FbmRlZCk7XG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICB3aW5kb3c/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcInJlc2l6ZVwiLCBvblJlc2l6ZSk7XG4gICAgICB9XG4gICAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJtb3VzZW91dFwiLCBvbk1vdXNlVXBkYXRlKTtcbiAgICAgIHBhcmVudEVsZW1lbnRPckVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlVXBkYXRlKTtcbiAgICAgIHBhcmVudEVsZW1lbnRPckVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcbiAgICAgICAgXCJ0b3VjaHN0YXJ0XCIsXG4gICAgICAgIG9uVG91Y2hVcGRhdGVcbiAgICAgICk7XG4gICAgICBwYXJlbnRFbGVtZW50T3JFbGVtZW50Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oXCJ0b3VjaGVuZFwiLCBvblRvdWNoVXBkYXRlKTtcbiAgICAgIHBhcmVudEVsZW1lbnRPckVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcInRvdWNobW92ZVwiLCBvblRvdWNoVXBkYXRlKTtcbiAgICAgIHBhcmVudEVsZW1lbnRPckVsZW1lbnQ/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcImtleXVwXCIsIG9uS2V5VXApO1xuICAgICAgcmVtb3ZlRWZmZWN0c0Zyb21TdG9yZT8uKCk7XG4gICAgICBlbGVtZW50Py5yZW1vdmVBdHRyaWJ1dGU/LihNRURJQV9DT05UUk9MTEVSX0lOSVRJQUxJWkVEX0FUVFJJQlVURSk7XG4gICAgfVxuICB9O1xufTtcbnZhciBjbGVhbnVwU291cmNlID0gKCkgPT4ge1xufTtcbnZhciBjbGVhbnVwUG9zdGVySW1hZ2UgPSAoKSA9PiB7XG59O1xudmFyIGFkZEVmZmVjdHNUb1N0b3JlID0gKGVsZW1lbnQsIHN0b3JlKSA9PiB7XG4gIGNvbnN0IGRlc3Ryb3lTb3VyY2UgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHtcbiAgICAgIF9faW5pdGlhbFByb3BzLFxuICAgICAgX19jb250cm9scyxcbiAgICAgIGN1cnJlbnRTb3VyY2UsXG4gICAgICBlcnJvckNvdW50LFxuICAgICAgcHJvZ3Jlc3MsXG4gICAgICBtb3VudGVkLFxuICAgICAgdmlkZW9RdWFsaXR5XG4gICAgfSkgPT4gKHtcbiAgICAgIGFzcGVjdFJhdGlvOiBfX2luaXRpYWxQcm9wcy5hc3BlY3RSYXRpbyxcbiAgICAgIGF1dG9QbGF5OiBfX2luaXRpYWxQcm9wcy5hdXRvUGxheSxcbiAgICAgIGJhY2tvZmY6IF9faW5pdGlhbFByb3BzLmJhY2tvZmYsXG4gICAgICBiYWNrb2ZmTWF4OiBfX2luaXRpYWxQcm9wcy5iYWNrb2ZmTWF4LFxuICAgICAgY2FsY3VsYXRlRGVsYXk6IF9faW5pdGlhbFByb3BzLmNhbGN1bGF0ZURlbGF5LFxuICAgICAgZXJyb3JDb3VudCxcbiAgICAgIGxhc3RFcnJvcjogX19jb250cm9scy5sYXN0RXJyb3IsXG4gICAgICBobHNDb25maWc6IF9fY29udHJvbHMuaGxzQ29uZmlnLFxuICAgICAgbW91bnRlZCxcbiAgICAgIHByb2dyZXNzLFxuICAgICAgc291cmNlOiBjdXJyZW50U291cmNlLFxuICAgICAgdGltZW91dDogX19pbml0aWFsUHJvcHMudGltZW91dCxcbiAgICAgIHZpZGVvUXVhbGl0eVxuICAgIH0pLFxuICAgIGFzeW5jICh7XG4gICAgICBhc3BlY3RSYXRpbyxcbiAgICAgIGF1dG9QbGF5LFxuICAgICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3Mvbm9VbnVzZWRGdW5jdGlvblBhcmFtZXRlcnM6IGlnbm9yZWQgdXNpbmcgYC0tc3VwcHJlc3NgXG4gICAgICBiYWNrb2ZmLFxuICAgICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3Mvbm9VbnVzZWRGdW5jdGlvblBhcmFtZXRlcnM6IGlnbm9yZWQgdXNpbmcgYC0tc3VwcHJlc3NgXG4gICAgICBiYWNrb2ZmTWF4LFxuICAgICAgY2FsY3VsYXRlRGVsYXksXG4gICAgICBlcnJvckNvdW50LFxuICAgICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3Mvbm9VbnVzZWRGdW5jdGlvblBhcmFtZXRlcnM6IGlnbm9yZWQgdXNpbmcgYC0tc3VwcHJlc3NgXG4gICAgICBsYXN0RXJyb3IsXG4gICAgICBobHNDb25maWcsXG4gICAgICBtb3VudGVkLFxuICAgICAgcHJvZ3Jlc3MsXG4gICAgICBzb3VyY2UsXG4gICAgICB0aW1lb3V0LFxuICAgICAgdmlkZW9RdWFsaXR5XG4gICAgfSkgPT4ge1xuICAgICAgaWYgKCFtb3VudGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGF3YWl0IGNsZWFudXBTb3VyY2U/LigpO1xuICAgICAgYXdhaXQgZGVsYXkoXG4gICAgICAgIE1hdGgubWF4KGNhbGN1bGF0ZURlbGF5KGVycm9yQ291bnQpLCBlcnJvckNvdW50ID09PSAwID8gMCA6IDEwMClcbiAgICAgICk7XG4gICAgICBsZXQgdW5tb3VudGVkID0gZmFsc2U7XG4gICAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsZXQganVtcGVkID0gZmFsc2U7XG4gICAgICBjb25zdCBqdW1wVG9QcmV2aW91c1Bvc2l0aW9uID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBsaXZlID0gc3RvcmUuZ2V0U3RhdGUoKS5saXZlO1xuICAgICAgICBpZiAoIWxpdmUgJiYgcHJvZ3Jlc3MgJiYgIWp1bXBlZCkge1xuICAgICAgICAgIGVsZW1lbnQuY3VycmVudFRpbWUgPSBwcm9ncmVzcztcbiAgICAgICAgICBqdW1wZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY29uc3Qgb25FcnJvckNvbXBvc2VkID0gKGVycikgPT4ge1xuICAgICAgICBpZiAoIXVubW91bnRlZCkge1xuICAgICAgICAgIGNsZWFudXBTb3VyY2U/LigpO1xuICAgICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucz8ub25FcnJvcj8uKGVycik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBpZiAoc291cmNlLnR5cGUgPT09IFwid2VicnRjXCIpIHtcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmVCZnJhbWVzID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgICAgICAgIChzdGF0ZSkgPT4gc3RhdGU/Ll9fbWV0YWRhdGEsXG4gICAgICAgICAgKG1ldGFkYXRhKSA9PiB7XG4gICAgICAgICAgICBsZXQgd2VicnRjSXNQb3NzaWJsZUZvck9uZVRyYWNrID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAobWV0YWRhdGE/Lm1ldGE/LnRyYWNrcykge1xuICAgICAgICAgICAgICBmb3IgKGNvbnN0IHRyYWNrSWQgb2YgT2JqZWN0LmtleXMobWV0YWRhdGEubWV0YS50cmFja3MpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhPy5tZXRhPy50cmFja3NbdHJhY2tJZF0/LmJmcmFtZXMgIT09IDEpIHtcbiAgICAgICAgICAgICAgICAgIHdlYnJ0Y0lzUG9zc2libGVGb3JPbmVUcmFjayA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzaG91bGROb3RGYWxsQmFja1RvSExTID0gd2VicnRjSXNQb3NzaWJsZUZvck9uZVRyYWNrIHx8IG1ldGFkYXRhPy5tZXRhPy5iZnJhbWVzID09PSAwO1xuICAgICAgICAgICAgaWYgKCFzaG91bGROb3RGYWxsQmFja1RvSExTICYmICF1bm1vdW50ZWQpIHtcbiAgICAgICAgICAgICAgb25FcnJvckNvbXBvc2VkKG5ldyBFcnJvcihCRlJBTUVTX0VSUk9SX01FU1NBR0UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHsgZGVzdHJveSB9ID0gY3JlYXRlTmV3V0hFUCh7XG4gICAgICAgICAgc291cmNlOiBzb3VyY2Uuc3JjLFxuICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgICAgICBvbkNvbm5lY3RlZDogKCkgPT4ge1xuICAgICAgICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0TGl2ZSh0cnVlKTtcbiAgICAgICAgICAgICAganVtcFRvUHJldmlvdXNQb3NpdGlvbigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uRXJyb3I6IG9uRXJyb3JDb21wb3NlZCxcbiAgICAgICAgICAgIG9uUGxheWJhY2tPZmZzZXRVcGRhdGVkOiBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMudXBkYXRlUGxheWJhY2tPZmZzZXRNcyxcbiAgICAgICAgICAgIG9uUmVkaXJlY3Q6IHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5vbkZpbmFsVXJsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhY2Nlc3NDb250cm9sOiB7XG4gICAgICAgICAgICBqd3Q6IHN0b3JlLmdldFN0YXRlKCkuX19pbml0aWFsUHJvcHMuand0LFxuICAgICAgICAgICAgYWNjZXNzS2V5OiBzdG9yZS5nZXRTdGF0ZSgpLl9faW5pdGlhbFByb3BzLmFjY2Vzc0tleVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2RwVGltZW91dDogdGltZW91dCxcbiAgICAgICAgICBpY2VTZXJ2ZXJzOiBzdG9yZS5nZXRTdGF0ZSgpLl9faW5pdGlhbFByb3BzLmljZVNlcnZlcnNcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKCFzdG9yZS5nZXRTdGF0ZSgpLmNhblBsYXkgJiYgIXVubW91bnRlZCkge1xuICAgICAgICAgICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uV2ViUlRDVGltZW91dD8uKCk7XG4gICAgICAgICAgICBvbkVycm9yQ29tcG9zZWQoXG4gICAgICAgICAgICAgIG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICBcIlRpbWVvdXQgcmVhY2hlZCBmb3IgY2FuUGxheSAtIHRyaWdnZXJpbmcgcGxheWJhY2sgZXJyb3IuXCJcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICBjbGVhbnVwU291cmNlID0gKCkgPT4ge1xuICAgICAgICAgIHVubW91bnRlZCA9IHRydWU7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGlkKTtcbiAgICAgICAgICBkZXN0cm95Py4oKTtcbiAgICAgICAgICB1bnN1YnNjcmliZUJmcmFtZXM/LigpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiaGxzXCIpIHtcbiAgICAgICAgY29uc3QgaW5kZXhVcmwgPSAvXFwvaGxzXFwvW14vXFxzXStcXC9pbmRleFxcLm0zdTgvO1xuICAgICAgICBjb25zdCBvbkVycm9yQ2xlYW5lZCA9IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnN0IGNsZWFuRXJyb3IgPSBuZXcgRXJyb3IoXG4gICAgICAgICAgICBlcnJvcj8ucmVzcG9uc2U/LmRhdGE/LnRvU3RyaW5nPy4oKSA/PyAoZXJyb3I/LnJlc3BvbnNlPy5jb2RlID09PSA0MDEgPyBBQ0NFU1NfQ09OVFJPTF9FUlJPUl9NRVNTQUdFIDogXCJFcnJvciB3aXRoIEhMUy5qc1wiKVxuICAgICAgICAgICk7XG4gICAgICAgICAgb25FcnJvckNvbXBvc2VkPy4oY2xlYW5FcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhsc0NvbmZpZ1Jlc29sdmVkID0gaGxzQ29uZmlnO1xuICAgICAgICBjb25zdCB7IGRlc3Ryb3ksIHNldFF1YWxpdHk6IHNldFF1YWxpdHkyIH0gPSBjcmVhdGVOZXdIbHMoe1xuICAgICAgICAgIHNvdXJjZTogc291cmNlPy5zcmMsXG4gICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICBpbml0aWFsUXVhbGl0eTogdmlkZW9RdWFsaXR5LFxuICAgICAgICAgIGFzcGVjdFJhdGlvOiBhc3BlY3RSYXRpbyA/PyAxNiAvIDksXG4gICAgICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgICAgICBvbkxpdmU6IHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5zZXRMaXZlLFxuICAgICAgICAgICAgb25EdXJhdGlvbjogc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uRHVyYXRpb25DaGFuZ2UsXG4gICAgICAgICAgICBvbkNhblBsYXk6ICgpID0+IHtcbiAgICAgICAgICAgICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uQ2FuUGxheSgpO1xuICAgICAgICAgICAgICBqdW1wVG9QcmV2aW91c1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5vbkVycm9yKG51bGwpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uRXJyb3I6IG9uRXJyb3JDbGVhbmVkLFxuICAgICAgICAgICAgb25QbGF5YmFja09mZnNldFVwZGF0ZWQ6IHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy51cGRhdGVQbGF5YmFja09mZnNldE1zLFxuICAgICAgICAgICAgb25SZWRpcmVjdDogc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uRmluYWxVcmxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgLi4uaGxzQ29uZmlnUmVzb2x2ZWQgPz8ge30sXG4gICAgICAgICAgICBhc3luYyB4aHJTZXR1cCh4aHIsIHVybCkge1xuICAgICAgICAgICAgICBpZiAoaGxzQ29uZmlnUmVzb2x2ZWQ/LnhoclNldHVwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgaGxzQ29uZmlnUmVzb2x2ZWQ/LnhoclNldHVwPy4oeGhyLCB1cmwpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpdmUgPSBzdG9yZS5nZXRTdGF0ZSgpLmxpdmU7XG4gICAgICAgICAgICAgICAgaWYgKCFsaXZlIHx8IHVybC5tYXRjaChpbmRleFVybCkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGp3dCA9IHN0b3JlLmdldFN0YXRlKCkuX19pbml0aWFsUHJvcHMuand0O1xuICAgICAgICAgICAgICAgICAgY29uc3QgYWNjZXNzS2V5ID0gc3RvcmUuZ2V0U3RhdGUoKS5fX2luaXRpYWxQcm9wcy5hY2Nlc3NLZXk7XG4gICAgICAgICAgICAgICAgICBpZiAoYWNjZXNzS2V5KVxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkxpdmVwZWVyLUFjY2Vzcy1LZXlcIiwgYWNjZXNzS2V5KTtcbiAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGp3dCkgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJMaXZlcGVlci1Kd3RcIiwgand0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdXRvUGxheVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlUXVhbGl0eVVwZGF0ZSA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAgICAgICAoc3RhdGUpID0+IHN0YXRlLnZpZGVvUXVhbGl0eSxcbiAgICAgICAgICAobmV3UXVhbGl0eSkgPT4ge1xuICAgICAgICAgICAgc2V0UXVhbGl0eTIobmV3UXVhbGl0eSk7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBjbGVhbnVwU291cmNlID0gKCkgPT4ge1xuICAgICAgICAgIHVubW91bnRlZCA9IHRydWU7XG4gICAgICAgICAgZGVzdHJveT8uKCk7XG4gICAgICAgICAgdW5zdWJzY3JpYmVRdWFsaXR5VXBkYXRlPy4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHNvdXJjZT8udHlwZSA9PT0gXCJ2aWRlb1wiKSB7XG4gICAgICAgIHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9sc0Z1bmN0aW9ucy5vbkZpbmFsVXJsKHNvdXJjZS5zcmMpO1xuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjYW5wbGF5XCIsIGp1bXBUb1ByZXZpb3VzUG9zaXRpb24pO1xuICAgICAgICBlbGVtZW50LnNyYyA9IHNvdXJjZS5zcmM7XG4gICAgICAgIGVsZW1lbnQubG9hZCgpO1xuICAgICAgICBjbGVhbnVwU291cmNlID0gKCkgPT4ge1xuICAgICAgICAgIHVubW91bnRlZCA9IHRydWU7XG4gICAgICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcj8uKFwiY2FucGxheVwiLCBqdW1wVG9QcmV2aW91c1Bvc2l0aW9uKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgZXF1YWxpdHlGbjogKGEsIGIpID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3JDb3VudENoYW5nZWQgPSBhLmVycm9yQ291bnQgIT09IGIuZXJyb3JDb3VudCAmJiBiLmVycm9yQ291bnQgIT09IDA7XG4gICAgICAgIGNvbnN0IGxhc3RFcnJvckNoYW5nZWQgPSBhLmxhc3RFcnJvciAhPT0gYi5sYXN0RXJyb3I7XG4gICAgICAgIGNvbnN0IHNvdXJjZUNoYW5nZWQgPSBhLnNvdXJjZT8uc3JjICE9PSBiLnNvdXJjZT8uc3JjO1xuICAgICAgICBjb25zdCBtb3VudGVkQ2hhbmdlZCA9IGEubW91bnRlZCAhPT0gYi5tb3VudGVkO1xuICAgICAgICBjb25zdCBzaG91bGRSZVJlbmRlciA9IGVycm9yQ291bnRDaGFuZ2VkIHx8IGxhc3RFcnJvckNoYW5nZWQgfHwgc291cmNlQ2hhbmdlZCB8fCBtb3VudGVkQ2hhbmdlZDtcbiAgICAgICAgcmV0dXJuICFzaG91bGRSZVJlbmRlcjtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lQb3N0ZXJJbWFnZSA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoeyBfX2NvbnRyb2xzLCBsaXZlLCBfX2NvbnRyb2xzRnVuY3Rpb25zLCBfX2luaXRpYWxQcm9wcyB9KSA9PiAoe1xuICAgICAgdGh1bWJuYWlsOiBfX2NvbnRyb2xzLnRodW1ibmFpbD8uc3JjLFxuICAgICAgbGl2ZSxcbiAgICAgIHNldFBvc3RlcjogX19jb250cm9sc0Z1bmN0aW9ucy5zZXRQb3N0ZXIsXG4gICAgICBwb3N0ZXJMaXZlVXBkYXRlOiBfX2luaXRpYWxQcm9wcy5wb3N0ZXJMaXZlVXBkYXRlXG4gICAgfSksXG4gICAgYXN5bmMgKHsgdGh1bWJuYWlsLCBsaXZlLCBzZXRQb3N0ZXIsIHBvc3RlckxpdmVVcGRhdGUgfSkgPT4ge1xuICAgICAgY2xlYW51cFBvc3RlckltYWdlPy4oKTtcbiAgICAgIGlmICh0aHVtYm5haWwgJiYgbGl2ZSAmJiBwb3N0ZXJMaXZlVXBkYXRlID4gMCkge1xuICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICBjb25zdCB0aHVtYm5haWxVcmwgPSBuZXcgVVJMKHRodW1ibmFpbCk7XG4gICAgICAgICAgdGh1bWJuYWlsVXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJ2XCIsIERhdGUubm93KCkudG9GaXhlZCgwKSk7XG4gICAgICAgICAgc2V0UG9zdGVyKHRodW1ibmFpbFVybC50b1N0cmluZygpKTtcbiAgICAgICAgfSwgcG9zdGVyTGl2ZVVwZGF0ZSk7XG4gICAgICAgIGNsZWFudXBQb3N0ZXJJbWFnZSA9ICgpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgZXF1YWxpdHlGbjogKGEsIGIpID0+IGEudGh1bWJuYWlsID09PSBiLnRodW1ibmFpbCAmJiBhLmxpdmUgPT09IGIubGl2ZVxuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveVBsYXlQYXVzZSA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucmVxdWVzdGVkUGxheVBhdXNlTGFzdFRpbWUsXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKGVsZW1lbnQucGF1c2VkKSB7XG4gICAgICAgIGF3YWl0IGVsZW1lbnQucGxheSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgZWxlbWVudC5wYXVzZSgpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveVBsYXliYWNrUmF0ZSA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLnBsYXliYWNrUmF0ZSxcbiAgICAoY3VycmVudCkgPT4ge1xuICAgICAgZWxlbWVudC5wbGF5YmFja1JhdGUgPSBjdXJyZW50ID09PSBcImNvbnN0YW50XCIgPyAxIDogY3VycmVudDtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lWb2x1bWUgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiAoe1xuICAgICAgcGxheWluZzogc3RhdGUucGxheWluZyxcbiAgICAgIHZvbHVtZTogc3RhdGUudm9sdW1lLFxuICAgICAgaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWQ6IHN0YXRlLl9fZGV2aWNlLmlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkXG4gICAgfSksXG4gICAgKGN1cnJlbnQpID0+IHtcbiAgICAgIGlmIChjdXJyZW50LmlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkKSB7XG4gICAgICAgIGVsZW1lbnQudm9sdW1lID0gY3VycmVudC52b2x1bWU7XG4gICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBlcXVhbGl0eUZuOiAoYSwgYikgPT4gYS52b2x1bWUgPT09IGIudm9sdW1lICYmIGEucGxheWluZyA9PT0gYi5wbGF5aW5nICYmIGEuaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWQgPT09IGIuaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWRcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lNdXRlID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuX19jb250cm9scy5tdXRlZCxcbiAgICAoY3VycmVudCwgcHJldikgPT4ge1xuICAgICAgaWYgKGN1cnJlbnQgIT09IHByZXYpIHtcbiAgICAgICAgZWxlbWVudC5tdXRlZCA9IGN1cnJlbnQ7XG4gICAgICB9XG4gICAgfVxuICApO1xuICBjb25zdCBkZXN0cm95U2Vla2luZyA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucmVxdWVzdGVkUmFuZ2VUb1NlZWtUbyxcbiAgICAoY3VycmVudCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LnJlYWR5U3RhdGUgPT09IFwidW5kZWZpbmVkXCIgfHwgZWxlbWVudC5yZWFkeVN0YXRlID4gMCkge1xuICAgICAgICBlbGVtZW50LmN1cnJlbnRUaW1lID0gY3VycmVudDtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lGdWxsc2NyZWVuID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuX19jb250cm9scy5yZXF1ZXN0ZWRGdWxsc2NyZWVuTGFzdFRpbWUsXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaXNGdWxsc2NyZWVuID0gaXNDdXJyZW50bHlGdWxsc2NyZWVuKGVsZW1lbnQpO1xuICAgICAgaWYgKGlzRnVsbHNjcmVlbikgZXhpdEZ1bGxzY3JlZW4oZWxlbWVudCk7XG4gICAgICBlbHNlIGVudGVyRnVsbHNjcmVlbihlbGVtZW50KTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lQaWN0dXJlSW5QaWN0dXJlID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuX19jb250cm9scy5yZXF1ZXN0ZWRQaWN0dXJlSW5QaWN0dXJlTGFzdFRpbWUsXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaXNQaWN0dXJlSW5QaWN0dXJlID0gYXdhaXQgaXNDdXJyZW50bHlQaWN0dXJlSW5QaWN0dXJlKGVsZW1lbnQpO1xuICAgICAgICBpZiAoaXNQaWN0dXJlSW5QaWN0dXJlKSBhd2FpdCBleGl0UGljdHVyZUluUGljdHVyZShlbGVtZW50KTtcbiAgICAgICAgZWxzZSBhd2FpdCBlbnRlclBpY3R1cmVJblBpY3R1cmUoZWxlbWVudCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHdhcm4oZT8ubWVzc2FnZSA/PyBcIlBpY3R1cmUgaW4gcGljdHVyZSBpcyBub3Qgc3VwcG9ydGVkXCIpO1xuICAgICAgICBzdG9yZS5zZXRTdGF0ZSgoc3RhdGUpID0+ICh7XG4gICAgICAgICAgX19kZXZpY2U6IHtcbiAgICAgICAgICAgIC4uLnN0YXRlLl9fZGV2aWNlLFxuICAgICAgICAgICAgaXNQaWN0dXJlSW5QaWN0dXJlU3VwcG9ydGVkOiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveUF1dG9oaWRlID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gKHtcbiAgICAgIGxhc3RJbnRlcmFjdGlvbjogc3RhdGUuX19jb250cm9scy5sYXN0SW50ZXJhY3Rpb24sXG4gICAgICBhdXRvaGlkZTogc3RhdGUuX19jb250cm9scy5hdXRvaGlkZVxuICAgIH0pLFxuICAgIGFzeW5jICh7IGxhc3RJbnRlcmFjdGlvbiwgYXV0b2hpZGUgfSkgPT4ge1xuICAgICAgaWYgKGF1dG9oaWRlICYmIGxhc3RJbnRlcmFjdGlvbikge1xuICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0SGlkZGVuKGZhbHNlKTtcbiAgICAgICAgYXdhaXQgZGVsYXkoYXV0b2hpZGUpO1xuICAgICAgICBjb25zdCBwYXJlbnRFbGVtZW50T3JFbGVtZW50ID0gZWxlbWVudD8ucGFyZW50RWxlbWVudCA/PyBlbGVtZW50O1xuICAgICAgICBjb25zdCBvcGVuRWxlbWVudCA9IHBhcmVudEVsZW1lbnRPckVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3I/LihcbiAgICAgICAgICAnW2RhdGEtc3RhdGU9XCJvcGVuXCJdJ1xuICAgICAgICApO1xuICAgICAgICBpZiAoIW9wZW5FbGVtZW50ICYmICFzdG9yZS5nZXRTdGF0ZSgpLmhpZGRlbiAmJiBsYXN0SW50ZXJhY3Rpb24gPT09IHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5sYXN0SW50ZXJhY3Rpb24pIHtcbiAgICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0SGlkZGVuKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBlcXVhbGl0eUZuOiAoYSwgYikgPT4gYT8ubGFzdEludGVyYWN0aW9uID09PSBiPy5sYXN0SW50ZXJhY3Rpb24gJiYgYT8uYXV0b2hpZGUgPT09IGI/LmF1dG9oaWRlXG4gICAgfVxuICApO1xuICBjb25zdCBkZXN0cm95UmVxdWVzdFNpemluZyA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+ICh7XG4gICAgICBsYXN0VGltZTogc3RhdGUuX19jb250cm9scy5yZXF1ZXN0ZWRNZWFzdXJlTGFzdFRpbWUsXG4gICAgICBmdWxsc2NyZWVuOiBzdGF0ZS5mdWxsc2NyZWVuXG4gICAgfSksXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnNldFNpemUoe1xuICAgICAgICAuLi5lbGVtZW50Py52aWRlb0hlaWdodCAmJiBlbGVtZW50Py52aWRlb1dpZHRoID8ge1xuICAgICAgICAgIG1lZGlhOiB7XG4gICAgICAgICAgICBoZWlnaHQ6IGVsZW1lbnQudmlkZW9IZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogZWxlbWVudC52aWRlb1dpZHRoXG4gICAgICAgICAgfVxuICAgICAgICB9IDoge30sXG4gICAgICAgIC4uLmVsZW1lbnQ/LmNsaWVudEhlaWdodCAmJiBlbGVtZW50Py5jbGllbnRXaWR0aCA/IHtcbiAgICAgICAgICBjb250YWluZXI6IHtcbiAgICAgICAgICAgIGhlaWdodDogZWxlbWVudC5jbGllbnRIZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogZWxlbWVudC5jbGllbnRXaWR0aFxuICAgICAgICAgIH1cbiAgICAgICAgfSA6IHt9LFxuICAgICAgICAuLi50eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdz8uaW5uZXJIZWlnaHQgJiYgd2luZG93Py5pbm5lcldpZHRoID8ge1xuICAgICAgICAgIHdpbmRvdzoge1xuICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGhcbiAgICAgICAgICB9XG4gICAgICAgIH0gOiB7fVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB7XG4gICAgICBlcXVhbGl0eUZuOiAoYSwgYikgPT4gYT8uZnVsbHNjcmVlbiA9PT0gYj8uZnVsbHNjcmVlbiAmJiBhPy5sYXN0VGltZSA9PT0gYj8ubGFzdFRpbWVcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lNZWRpYVNpemluZyA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMuc2l6ZT8ubWVkaWEsXG4gICAgYXN5bmMgKG1lZGlhKSA9PiB7XG4gICAgICBjb25zdCBwYXJlbnRFbGVtZW50T3JFbGVtZW50ID0gZWxlbWVudD8ucGFyZW50RWxlbWVudCA/PyBlbGVtZW50O1xuICAgICAgaWYgKHBhcmVudEVsZW1lbnRPckVsZW1lbnQpIHtcbiAgICAgICAgaWYgKG1lZGlhPy5oZWlnaHQgJiYgbWVkaWE/LndpZHRoKSB7XG4gICAgICAgICAgY29uc3QgZWxlbWVudFN0eWxlID0gcGFyZW50RWxlbWVudE9yRWxlbWVudC5zdHlsZTtcbiAgICAgICAgICBlbGVtZW50U3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICAgICAgICBcIi0tbGl2ZXBlZXItbWVkaWEtaGVpZ2h0XCIsXG4gICAgICAgICAgICBgJHttZWRpYS5oZWlnaHR9cHhgXG4gICAgICAgICAgKTtcbiAgICAgICAgICBlbGVtZW50U3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICAgICAgICBcIi0tbGl2ZXBlZXItbWVkaWEtd2lkdGhcIixcbiAgICAgICAgICAgIGAke21lZGlhLndpZHRofXB4YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgIGVxdWFsaXR5Rm46IChhLCBiKSA9PiBhPy5oZWlnaHQgPT09IGI/LmhlaWdodCAmJiBhPy53aWR0aCA9PT0gYj8ud2lkdGhcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lDb250YWluZXJTaXppbmcgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiBzdGF0ZS5fX2NvbnRyb2xzLnNpemU/LmNvbnRhaW5lcixcbiAgICBhc3luYyAoY29udGFpbmVyKSA9PiB7XG4gICAgICBjb25zdCBwYXJlbnRFbGVtZW50T3JFbGVtZW50ID0gZWxlbWVudD8ucGFyZW50RWxlbWVudCA/PyBlbGVtZW50O1xuICAgICAgaWYgKHBhcmVudEVsZW1lbnRPckVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGNvbnRhaW5lcj8uaGVpZ2h0ICYmIGNvbnRhaW5lcj8ud2lkdGgpIHtcbiAgICAgICAgICBjb25zdCBlbGVtZW50U3R5bGUgPSBwYXJlbnRFbGVtZW50T3JFbGVtZW50LnN0eWxlO1xuICAgICAgICAgIGVsZW1lbnRTdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgICAgICAgIFwiLS1saXZlcGVlci1jb250YWluZXItaGVpZ2h0XCIsXG4gICAgICAgICAgICBgJHtjb250YWluZXIuaGVpZ2h0fXB4YFxuICAgICAgICAgICk7XG4gICAgICAgICAgZWxlbWVudFN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICAgICAgXCItLWxpdmVwZWVyLWNvbnRhaW5lci13aWR0aFwiLFxuICAgICAgICAgICAgYCR7Y29udGFpbmVyLndpZHRofXB4YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgIGVxdWFsaXR5Rm46IChhLCBiKSA9PiBhPy5oZWlnaHQgPT09IGI/LmhlaWdodCAmJiBhPy53aWR0aCA9PT0gYj8ud2lkdGhcbiAgICB9XG4gICk7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgZGVzdHJveUF1dG9oaWRlPy4oKTtcbiAgICBkZXN0cm95Q29udGFpbmVyU2l6aW5nPy4oKTtcbiAgICBkZXN0cm95RnVsbHNjcmVlbj8uKCk7XG4gICAgZGVzdHJveU1lZGlhU2l6aW5nPy4oKTtcbiAgICBkZXN0cm95TXV0ZT8uKCk7XG4gICAgZGVzdHJveVBpY3R1cmVJblBpY3R1cmU/LigpO1xuICAgIGRlc3Ryb3lQbGF5YmFja1JhdGU/LigpO1xuICAgIGRlc3Ryb3lQbGF5UGF1c2U/LigpO1xuICAgIGRlc3Ryb3lQb3N0ZXJJbWFnZT8uKCk7XG4gICAgZGVzdHJveVJlcXVlc3RTaXppbmc/LigpO1xuICAgIGRlc3Ryb3lTZWVraW5nPy4oKTtcbiAgICBkZXN0cm95Vm9sdW1lPy4oKTtcbiAgICBkZXN0cm95U291cmNlPy4oKTtcbiAgICBjbGVhbnVwUG9zdGVySW1hZ2U/LigpO1xuICAgIGNsZWFudXBTb3VyY2U/LigpO1xuICB9O1xufTtcblxuLy8gc3JjL21lZGlhL2NvbnRyb2xzL2RldmljZS50c1xudmFyIGdldERldmljZUluZm8gPSAodmVyc2lvbjIpID0+ICh7XG4gIHZlcnNpb246IHZlcnNpb24yLFxuICBpc0FuZHJvaWQ6IGlzQW5kcm9pZCgpLFxuICBpc0lvczogaXNJb3MoKSxcbiAgaXNNb2JpbGU6IGlzTW9iaWxlKCksXG4gIHVzZXJBZ2VudDogdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiA/IG5hdmlnYXRvci51c2VyQWdlbnQgOiBcIk5vZGUuanMgb3IgdW5rbm93blwiLFxuICBzY3JlZW5XaWR0aDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3c/LnNjcmVlbiA/IHdpbmRvdz8uc2NyZWVuPy53aWR0aCA/PyBudWxsIDogbnVsbCxcbiAgaXNGdWxsc2NyZWVuU3VwcG9ydGVkOiBpc0Z1bGxzY3JlZW5TdXBwb3J0ZWQoKSxcbiAgaXNXZWJSVENTdXBwb3J0ZWQ6IEJvb2xlYW4oZ2V0UlRDUGVlckNvbm5lY3Rpb25Db25zdHJ1Y3RvcigpKSxcbiAgaXNQaWN0dXJlSW5QaWN0dXJlU3VwcG9ydGVkOiBpc1BpY3R1cmVJblBpY3R1cmVTdXBwb3J0ZWQoKSxcbiAgaXNIbHNTdXBwb3J0ZWQ6IGlzSGxzU3VwcG9ydGVkKCksXG4gIGlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkOiB0cnVlXG59KTtcblxuLy8gc3JjL21lZGlhL21ldHJpY3MudHNcbmltcG9ydCB7XG4gIGFkZExlZ2FjeU1lZGlhTWV0cmljc1RvU3RvcmUsXG4gIGFkZE1ldHJpY3NUb1N0b3JlLFxuICBjcmVhdGVDb250cm9sbGVyU3RvcmVcbn0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL21lZGlhXCI7XG5pbXBvcnQgeyBjcmVhdGVTdG9yYWdlLCBub29wU3RvcmFnZSB9IGZyb20gXCJAbGl2ZXBlZXIvY29yZS9zdG9yYWdlXCI7XG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL3ZlcnNpb25cIjtcbmZ1bmN0aW9uIGFkZE1lZGlhTWV0cmljcyhlbGVtZW50LCBvcHRzID0ge30pIHtcbiAgaWYgKGVsZW1lbnQpIHtcbiAgICBjb25zdCBzb3VyY2UgPSBvcHRzPy5zcmMgPz8gZWxlbWVudD8uc3JjID8/IG51bGw7XG4gICAgY29uc3QgeyBzdG9yZSwgZGVzdHJveSB9ID0gY3JlYXRlQ29udHJvbGxlclN0b3JlKHtcbiAgICAgIHNyYzogc291cmNlLFxuICAgICAgcGxheWJhY2tJZDogb3B0cz8ucGxheWJhY2tJZCxcbiAgICAgIGRldmljZTogZ2V0RGV2aWNlSW5mbyh2ZXJzaW9uLmNvcmUpLFxuICAgICAgc3RvcmFnZTogY3JlYXRlU3RvcmFnZSh7IHN0b3JhZ2U6IG5vb3BTdG9yYWdlIH0pLFxuICAgICAgaW5pdGlhbFByb3BzOiB7XG4gICAgICAgIGF1dG9QbGF5OiBCb29sZWFuKGVsZW1lbnQ/LmF1dG9wbGF5KSxcbiAgICAgICAgdm9sdW1lOiBlbGVtZW50Py5tdXRlZCA/IDAgOiBlbGVtZW50Py52b2x1bWUsXG4gICAgICAgIHByZWxvYWQ6IGVsZW1lbnQ/LnByZWxvYWQgPT09IFwiXCIgPyBcImF1dG9cIiA6IGVsZW1lbnQ/LnByZWxvYWQsXG4gICAgICAgIHBsYXliYWNrUmF0ZTogZWxlbWVudD8ucGxheWJhY2tSYXRlLFxuICAgICAgICBob3RrZXlzOiBmYWxzZSxcbiAgICAgICAgcG9zdGVyTGl2ZVVwZGF0ZTogMCxcbiAgICAgICAgLi4ub3B0cyxcbiAgICAgICAgb25FcnJvcihlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgb3B0cz8ub25FcnJvcj8uKGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCB7IGRlc3Ryb3k6IGRlc3Ryb3lMaXN0ZW5lcnMgfSA9IGFkZEV2ZW50TGlzdGVuZXJzKGVsZW1lbnQsIHN0b3JlKTtcbiAgICBjb25zdCB7IGRlc3Ryb3k6IGRlc3Ryb3lNZXRyaWNzIH0gPSBhZGRNZXRyaWNzVG9TdG9yZShzdG9yZSwge1xuICAgICAgZGlzYWJsZVByb2dyZXNzTGlzdGVuZXI6IG9wdHMuZGlzYWJsZVByb2dyZXNzTGlzdGVuZXIsXG4gICAgICBpbnRlcnZhbDogb3B0cy5pbnRlcnZhbCxcbiAgICAgIG9uUGxheWJhY2tFdmVudHM6IG9wdHMub25QbGF5YmFja0V2ZW50c1xuICAgIH0pO1xuICAgIGNvbnN0IHsgZGVzdHJveTogZGVzdHJveUxlZ2FjeU1ldHJpY3MsIG1ldHJpY3M6IGxlZ2FjeU1ldHJpY3MgfSA9IGFkZExlZ2FjeU1lZGlhTWV0cmljc1RvU3RvcmUoc3RvcmUsIHtcbiAgICAgIGRpc2FibGVQcm9ncmVzc0xpc3RlbmVyOiBvcHRzLmRpc2FibGVQcm9ncmVzc0xpc3RlbmVyXG4gICAgfSk7XG4gICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLm9uRmluYWxVcmwoXG4gICAgICBzb3VyY2UgPz8gXCJodHRwczovL3ZvZC1jZG4ubHAtcGxheWJhY2suc3R1ZGlvXCJcbiAgICApO1xuICAgIHJldHVybiB7XG4gICAgICAvKiogQGRlcHJlY2F0ZWQgKi9cbiAgICAgIGxlZ2FjeU1ldHJpY3MsXG4gICAgICBkZXN0cm95OiAoKSA9PiB7XG4gICAgICAgIGRlc3Ryb3k/LigpO1xuICAgICAgICBkZXN0cm95TGlzdGVuZXJzPy4oKTtcbiAgICAgICAgZGVzdHJveU1ldHJpY3M/LigpO1xuICAgICAgICBkZXN0cm95TGVnYWN5TWV0cmljcz8uKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGRlc3Ryb3k6ICgpID0+IHtcbiAgICB9XG4gIH07XG59XG5leHBvcnQge1xuICBhZGRFdmVudExpc3RlbmVycyxcbiAgYWRkTWVkaWFNZXRyaWNzLFxuICBjYW5QbGF5TWVkaWFOYXRpdmVseSxcbiAgZ2V0RGV2aWNlSW5mb1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core-web/dist/browser/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/core/dist/errors/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@livepeer/core/dist/errors/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACCESS_CONTROL_ERROR_MESSAGE: () => (/* binding */ ACCESS_CONTROL_ERROR_MESSAGE),\n/* harmony export */   BFRAMES_ERROR_MESSAGE: () => (/* binding */ BFRAMES_ERROR_MESSAGE),\n/* harmony export */   NOT_ACCEPTABLE_ERROR_MESSAGE: () => (/* binding */ NOT_ACCEPTABLE_ERROR_MESSAGE),\n/* harmony export */   PERMISSIONS_ERROR_MESSAGE: () => (/* binding */ PERMISSIONS_ERROR_MESSAGE),\n/* harmony export */   STREAM_OFFLINE_ERROR_MESSAGE: () => (/* binding */ STREAM_OFFLINE_ERROR_MESSAGE),\n/* harmony export */   STREAM_OPEN_ERROR_MESSAGE: () => (/* binding */ STREAM_OPEN_ERROR_MESSAGE),\n/* harmony export */   isAccessControlError: () => (/* binding */ isAccessControlError),\n/* harmony export */   isBframesError: () => (/* binding */ isBframesError),\n/* harmony export */   isNotAcceptableError: () => (/* binding */ isNotAcceptableError),\n/* harmony export */   isPermissionsError: () => (/* binding */ isPermissionsError),\n/* harmony export */   isStreamOfflineError: () => (/* binding */ isStreamOfflineError)\n/* harmony export */ });\n// src/media/errors.ts\nvar STREAM_OPEN_ERROR_MESSAGE = \"stream open failed\";\nvar STREAM_OFFLINE_ERROR_MESSAGE = \"stream is offline\";\nvar STREAM_WAITING_FOR_DATA_ERROR_MESSAGE = \"stream is waiting for data\";\nvar ACCESS_CONTROL_ERROR_MESSAGE = \"shutting down since this session is not allowed to view this stream\";\nvar BFRAMES_ERROR_MESSAGE = \"metadata indicates that webrtc playback contains bframes\";\nvar NOT_ACCEPTABLE_ERROR_MESSAGE = \"response indicates unacceptable playback protocol\";\nvar PERMISSIONS_ERROR_MESSAGE = \"user did not allow the permissions request\";\nvar isStreamOfflineError = (error) => error.message.toLowerCase().includes(STREAM_OPEN_ERROR_MESSAGE) || error.message.toLowerCase().includes(STREAM_WAITING_FOR_DATA_ERROR_MESSAGE) || error.message.toLowerCase().includes(STREAM_OFFLINE_ERROR_MESSAGE);\nvar isAccessControlError = (error) => error.message.toLowerCase().includes(ACCESS_CONTROL_ERROR_MESSAGE);\nvar isBframesError = (error) => error.message.toLowerCase().includes(BFRAMES_ERROR_MESSAGE);\nvar isNotAcceptableError = (error) => error.message.toLowerCase().includes(NOT_ACCEPTABLE_ERROR_MESSAGE);\nvar isPermissionsError = (error) => error.message.toLowerCase().includes(PERMISSIONS_ERROR_MESSAGE);\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC9lcnJvcnMvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4vbm9kZV9tb2R1bGVzL0BsaXZlcGVlci9jb3JlL2Rpc3QvZXJyb3JzL2luZGV4LmpzP2EyYjIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL21lZGlhL2Vycm9ycy50c1xudmFyIFNUUkVBTV9PUEVOX0VSUk9SX01FU1NBR0UgPSBcInN0cmVhbSBvcGVuIGZhaWxlZFwiO1xudmFyIFNUUkVBTV9PRkZMSU5FX0VSUk9SX01FU1NBR0UgPSBcInN0cmVhbSBpcyBvZmZsaW5lXCI7XG52YXIgU1RSRUFNX1dBSVRJTkdfRk9SX0RBVEFfRVJST1JfTUVTU0FHRSA9IFwic3RyZWFtIGlzIHdhaXRpbmcgZm9yIGRhdGFcIjtcbnZhciBBQ0NFU1NfQ09OVFJPTF9FUlJPUl9NRVNTQUdFID0gXCJzaHV0dGluZyBkb3duIHNpbmNlIHRoaXMgc2Vzc2lvbiBpcyBub3QgYWxsb3dlZCB0byB2aWV3IHRoaXMgc3RyZWFtXCI7XG52YXIgQkZSQU1FU19FUlJPUl9NRVNTQUdFID0gXCJtZXRhZGF0YSBpbmRpY2F0ZXMgdGhhdCB3ZWJydGMgcGxheWJhY2sgY29udGFpbnMgYmZyYW1lc1wiO1xudmFyIE5PVF9BQ0NFUFRBQkxFX0VSUk9SX01FU1NBR0UgPSBcInJlc3BvbnNlIGluZGljYXRlcyB1bmFjY2VwdGFibGUgcGxheWJhY2sgcHJvdG9jb2xcIjtcbnZhciBQRVJNSVNTSU9OU19FUlJPUl9NRVNTQUdFID0gXCJ1c2VyIGRpZCBub3QgYWxsb3cgdGhlIHBlcm1pc3Npb25zIHJlcXVlc3RcIjtcbnZhciBpc1N0cmVhbU9mZmxpbmVFcnJvciA9IChlcnJvcikgPT4gZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFNUUkVBTV9PUEVOX0VSUk9SX01FU1NBR0UpIHx8IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhTVFJFQU1fV0FJVElOR19GT1JfREFUQV9FUlJPUl9NRVNTQUdFKSB8fCBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoU1RSRUFNX09GRkxJTkVfRVJST1JfTUVTU0FHRSk7XG52YXIgaXNBY2Nlc3NDb250cm9sRXJyb3IgPSAoZXJyb3IpID0+IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhBQ0NFU1NfQ09OVFJPTF9FUlJPUl9NRVNTQUdFKTtcbnZhciBpc0JmcmFtZXNFcnJvciA9IChlcnJvcikgPT4gZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKEJGUkFNRVNfRVJST1JfTUVTU0FHRSk7XG52YXIgaXNOb3RBY2NlcHRhYmxlRXJyb3IgPSAoZXJyb3IpID0+IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhOT1RfQUNDRVBUQUJMRV9FUlJPUl9NRVNTQUdFKTtcbnZhciBpc1Blcm1pc3Npb25zRXJyb3IgPSAoZXJyb3IpID0+IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhQRVJNSVNTSU9OU19FUlJPUl9NRVNTQUdFKTtcbmV4cG9ydCB7XG4gIEFDQ0VTU19DT05UUk9MX0VSUk9SX01FU1NBR0UsXG4gIEJGUkFNRVNfRVJST1JfTUVTU0FHRSxcbiAgTk9UX0FDQ0VQVEFCTEVfRVJST1JfTUVTU0FHRSxcbiAgUEVSTUlTU0lPTlNfRVJST1JfTUVTU0FHRSxcbiAgU1RSRUFNX09GRkxJTkVfRVJST1JfTUVTU0FHRSxcbiAgU1RSRUFNX09QRU5fRVJST1JfTUVTU0FHRSxcbiAgaXNBY2Nlc3NDb250cm9sRXJyb3IsXG4gIGlzQmZyYW1lc0Vycm9yLFxuICBpc05vdEFjY2VwdGFibGVFcnJvcixcbiAgaXNQZXJtaXNzaW9uc0Vycm9yLFxuICBpc1N0cmVhbU9mZmxpbmVFcnJvclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core/dist/errors/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/core/dist/media/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@livepeer/core/dist/media/index.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addLegacyMediaMetricsToStore: () => (/* binding */ addLegacyMediaMetricsToStore),\n/* harmony export */   addMetricsToStore: () => (/* binding */ addMetricsToStore),\n/* harmony export */   calculateVideoQualityDimensions: () => (/* binding */ calculateVideoQualityDimensions),\n/* harmony export */   createControllerStore: () => (/* binding */ createControllerStore),\n/* harmony export */   getBoundedVolume: () => (/* binding */ getBoundedVolume),\n/* harmony export */   getMediaSourceType: () => (/* binding */ getMediaSourceType)\n/* harmony export */ });\n/* harmony import */ var zustand_middleware__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zustand/middleware */ \"(ssr)/./node_modules/zustand/esm/middleware.mjs\");\n/* harmony import */ var zustand_vanilla__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zustand/vanilla */ \"(ssr)/./node_modules/zustand/esm/vanilla.mjs\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nanoid */ \"(ssr)/./node_modules/nanoid/index.js\");\n/* harmony import */ var multiformats_cid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! multiformats/cid */ \"(ssr)/./node_modules/multiformats/dist/src/cid.js\");\n// src/media/controller.ts\n\n\n\n// src/media/errors.ts\nvar STREAM_OPEN_ERROR_MESSAGE = \"stream open failed\";\nvar STREAM_OFFLINE_ERROR_MESSAGE = \"stream is offline\";\nvar STREAM_WAITING_FOR_DATA_ERROR_MESSAGE = \"stream is waiting for data\";\nvar ACCESS_CONTROL_ERROR_MESSAGE = \"shutting down since this session is not allowed to view this stream\";\nvar BFRAMES_ERROR_MESSAGE = \"metadata indicates that webrtc playback contains bframes\";\nvar NOT_ACCEPTABLE_ERROR_MESSAGE = \"response indicates unacceptable playback protocol\";\nvar PERMISSIONS_ERROR_MESSAGE = \"user did not allow the permissions request\";\nvar isStreamOfflineError = (error) => error.message.toLowerCase().includes(STREAM_OPEN_ERROR_MESSAGE) || error.message.toLowerCase().includes(STREAM_WAITING_FOR_DATA_ERROR_MESSAGE) || error.message.toLowerCase().includes(STREAM_OFFLINE_ERROR_MESSAGE);\nvar isAccessControlError = (error) => error.message.toLowerCase().includes(ACCESS_CONTROL_ERROR_MESSAGE);\nvar isBframesError = (error) => error.message.toLowerCase().includes(BFRAMES_ERROR_MESSAGE);\nvar isNotAcceptableError = (error) => error.message.toLowerCase().includes(NOT_ACCEPTABLE_ERROR_MESSAGE);\nvar isPermissionsError = (error) => error.message.toLowerCase().includes(PERMISSIONS_ERROR_MESSAGE);\n\n// src/media/utils.ts\n\n\n// src/media/metrics-utils.ts\nvar getMetricsReportingPOSTUrl = async (opts) => {\n  const resolvedReportingUrl = await getMetricsReportingUrl({\n    playbackUrl: opts.playbackUrl,\n    path: \"/analytics/log\"\n  });\n  if (!resolvedReportingUrl) {\n    return null;\n  }\n  return resolvedReportingUrl?.toString?.() ?? null;\n};\nvar getMetricsReportingWebsocketUrl = async (opts) => {\n  if (!opts.playbackId) {\n    return null;\n  }\n  const resolvedReportingUrl = await getMetricsReportingUrl({\n    playbackUrl: opts.playbackUrl,\n    path: `/json_video+${opts.playbackId}.js`\n  });\n  if (!resolvedReportingUrl) {\n    return null;\n  }\n  resolvedReportingUrl.protocol = \"wss:\";\n  if (resolvedReportingUrl && opts.sessionToken) {\n    resolvedReportingUrl.searchParams.set(\"tkn\", opts.sessionToken);\n  }\n  return resolvedReportingUrl?.toString?.() ?? null;\n};\nvar LP_DOMAINS = [\"livepeer\", \"livepeercdn\", \"lp-playback\"];\nvar getMetricsReportingUrl = async ({\n  playbackUrl,\n  path\n}) => {\n  try {\n    const parsedPlaybackUrl = new URL(playbackUrl);\n    const splitHost = parsedPlaybackUrl.host.split(\".\");\n    const includesDomain = LP_DOMAINS.includes(\n      splitHost?.[splitHost.length - 2] ?? \"\"\n    );\n    const tld = splitHost?.[splitHost?.length - 1] ?? null;\n    const tldMapped = tld === \"com\" ? \"studio\" : tld === \"studio\" ? \"studio\" : tld === \"fun\" ? \"fun:20443\" : tld === \"monster\" ? \"monster\" : null;\n    if (includesDomain && tldMapped) {\n      const isCatalystPlayback = parsedPlaybackUrl.host.includes(\"catalyst\");\n      try {\n        const getRedirectedUrl = async () => {\n          const response = await fetch(\n            `https://playback.livepeer.${tldMapped}${path}`\n          );\n          await response.text();\n          return response?.url ?? null;\n        };\n        const finalUrl = isCatalystPlayback ? `https://${parsedPlaybackUrl.host}${path}` : await getRedirectedUrl();\n        const url = finalUrl ? new URL(finalUrl) : null;\n        return url ?? null;\n      } catch (error) {\n        console.log(\"Could not fetch reporting URL.\", error);\n      }\n    }\n  } catch (error) {\n    console.error(error?.message);\n    return null;\n  }\n  return null;\n};\nvar ASSET_URL_PART_VALUE = \"hls\";\nvar FLV_URL_PART_VALUE = \"flv\";\nvar WEBRTC_URL_PART_VALUE = \"webrtc\";\nvar RECORDING_URL_PART_VALUE = \"recordings\";\nvar getPlaybackIdFromSourceUrl = (sourceUrl) => {\n  const parsedUrl = new URL(sourceUrl);\n  const parts = parsedUrl.pathname.split(\"/\");\n  const includesAssetUrl = parts.includes(ASSET_URL_PART_VALUE);\n  const includesWebRtcUrl = parts.includes(WEBRTC_URL_PART_VALUE);\n  const includesFlvUrl = parts.includes(FLV_URL_PART_VALUE);\n  const includesRecording = parts.includes(RECORDING_URL_PART_VALUE);\n  const playbackId = includesWebRtcUrl || includesFlvUrl ? parts?.[(parts?.length ?? 0) - 1] : includesRecording || includesAssetUrl ? parts?.[(parts?.length ?? 0) - 2] ?? null : null;\n  if (playbackId?.includes(\"+\")) {\n    const split = playbackId.split(\"+\")?.[1];\n    if (split) {\n      return split;\n    }\n  }\n  return playbackId ?? null;\n};\n\n// src/media/mime.ts\nvar getMimeType = (ending) => {\n  for (const value of Object.keys(mime)) {\n    if (mime[value]?.some((v) => v === ending)) {\n      return value;\n    }\n  }\n  return null;\n};\nvar mime = {\n  \"application/mp4\": [\"mp4s\", \"m4p\"],\n  \"application/ogg\": [\"ogx\"],\n  \"application/vnd.apple.mpegurl\": [\"m3u8\"],\n  \"audio/3gpp\": [\"*3gpp\"],\n  \"audio/adpcm\": [\"adp\"],\n  \"audio/amr\": [\"amr\"],\n  \"audio/basic\": [\"au\", \"snd\"],\n  \"audio/midi\": [\"mid\", \"midi\", \"kar\", \"rmi\"],\n  \"audio/mobile-xmf\": [\"mxmf\"],\n  \"audio/mp3\": [\"*mp3\"],\n  \"audio/mp4\": [\"m4a\", \"mp4a\"],\n  \"audio/mpeg\": [\"mpga\", \"mp2\", \"mp2a\", \"mp3\", \"m2a\", \"m3a\"],\n  \"audio/ogg\": [\"oga\", \"ogg\", \"spx\", \"opus\"],\n  \"audio/s3m\": [\"s3m\"],\n  \"audio/silk\": [\"sil\"],\n  \"audio/vnd.dece.audio\": [\"uva\", \"uvva\"],\n  \"audio/vnd.digital-winds\": [\"eol\"],\n  \"audio/vnd.dra\": [\"dra\"],\n  \"audio/vnd.dts.hd\": [\"dtshd\"],\n  \"audio/vnd.dts\": [\"dts\"],\n  \"audio/vnd.lucent.voice\": [\"lvp\"],\n  \"audio/vnd.ms-playready.media.pya\": [\"pya\"],\n  \"audio/vnd.nuera.ecelp4800\": [\"ecelp4800\"],\n  \"audio/vnd.nuera.ecelp7470\": [\"ecelp7470\"],\n  \"audio/vnd.nuera.ecelp9600\": [\"ecelp9600\"],\n  \"audio/vnd.rip\": [\"rip\"],\n  \"audio/wav\": [\"wav\"],\n  \"audio/wave\": [\"*wav\"],\n  \"audio/webm\": [\"weba\"],\n  \"audio/x-aac\": [\"aac\"],\n  \"audio/x-aiff\": [\"aif\", \"aiff\", \"aifc\"],\n  \"audio/x-caf\": [\"caf\"],\n  \"audio/x-flac\": [\"flac\"],\n  \"audio/x-m4a\": [\"*m4a\"],\n  \"audio/x-matroska\": [\"mka\"],\n  \"audio/x-mpegurl\": [\"m3u\"],\n  \"audio/x-ms-wax\": [\"wax\"],\n  \"audio/x-ms-wma\": [\"wma\"],\n  \"audio/x-pn-realaudio-plugin\": [\"rmp\"],\n  \"audio/x-pn-realaudio\": [\"ram\", \"ra\"],\n  \"audio/x-realaudio\": [\"*ra\"],\n  \"audio/x-wav\": [\"*wav\"],\n  \"audio/xm\": [\"xm\"],\n  \"video/3gpp\": [\"3gp\", \"3gpp\"],\n  \"video/3gpp2\": [\"3g2\"],\n  \"video/h261\": [\"h261\"],\n  \"video/h263\": [\"h263\"],\n  \"video/h264\": [\"h264\"],\n  \"video/iso.segment\": [\"m4s\"],\n  \"video/jpeg\": [\"jpgv\"],\n  \"video/jpm\": [\"*jpm\", \"jpgm\"],\n  \"video/mj2\": [\"mj2\", \"mjp2\"],\n  \"video/mp2t\": [\"ts\"],\n  \"video/mp4\": [\"mp4\", \"mp4v\", \"mpg4\"],\n  \"video/mpeg\": [\"mpeg\", \"mpg\", \"mpe\", \"m1v\", \"m2v\"],\n  \"video/ogg\": [\"ogv\"],\n  \"video/quicktime\": [\"qt\", \"mov\"],\n  \"video/vnd.dece.hd\": [\"uvh\", \"uvvh\"],\n  \"video/vnd.dece.mobile\": [\"uvm\", \"uvvm\"],\n  \"video/vnd.dece.pd\": [\"uvp\", \"uvvp\"],\n  \"video/vnd.dece.sd\": [\"uvs\", \"uvvs\"],\n  \"video/vnd.dece.video\": [\"uvv\", \"uvvv\"],\n  \"video/vnd.dvb.file\": [\"dvb\"],\n  \"video/vnd.fvt\": [\"fvt\"],\n  \"video/vnd.mpegurl\": [\"mxu\", \"m4u\"],\n  \"video/vnd.ms-playready.media.pyv\": [\"pyv\"],\n  \"video/vnd.uvvu.mp4\": [\"uvu\", \"uvvu\"],\n  \"video/vnd.vivo\": [\"viv\"],\n  \"video/vp8\": [\"vp8\"],\n  \"video/webm\": [\"webm\"],\n  \"video/x-f4v\": [\"f4v\"],\n  \"video/x-fli\": [\"fli\"],\n  \"video/x-flv\": [\"flv\"],\n  \"video/x-m4v\": [\"m4v\"],\n  \"video/x-matroska\": [\"mkv\", \"mk3d\", \"mks\"],\n  \"video/x-mng\": [\"mng\"],\n  \"video/x-ms-asf\": [\"asf\", \"asx\"],\n  \"video/x-ms-vob\": [\"vob\"],\n  \"video/x-ms-wm\": [\"wm\"],\n  \"video/x-ms-wmv\": [\"wmv\"],\n  \"video/x-ms-wmx\": [\"wmx\"],\n  \"video/x-ms-wvx\": [\"wvx\"],\n  \"video/x-msvideo\": [\"avi\"],\n  \"video/x-sgi-movie\": [\"movie\"],\n  \"video/x-smv\": [\"smv\"]\n};\n\n// src/media/src.ts\nvar audioExtensions = /\\.(m4a|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\\?)/i;\nvar base64String = /data:video/i;\nvar hlsExtensions = /\\.(m3u8)($|\\?)/i;\nvar flvExtensions = /\\/(flv)\\//i;\nvar imageExtensions = /\\.(jpg|jpeg|png|gif|bmp|webp)($|\\?)/i;\nvar vttExtensions = /\\.(vtt)($|\\?)/i;\nvar mimeFromBase64Pattern = /data:(.+?);base64/;\nvar videoExtensions = /\\.(mp4|ogv|webm|mov|m4v|avi|m3u8)($|\\?)/i;\nvar webrtcExtensions = /(webrtc|sdp)/i;\nvar getMediaSourceType = (src, opts) => {\n  if (!src) {\n    return null;\n  }\n  const sourceTest = src?.toLowerCase();\n  const base64Mime = sourceTest.match(mimeFromBase64Pattern);\n  const resolvedWidth = opts?.sizing?.width ?? null;\n  const resolvedHeight = opts?.sizing?.height ?? null;\n  return webrtcExtensions.test(sourceTest) ? {\n    type: \"webrtc\",\n    src,\n    mime: \"video/h264\",\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : hlsExtensions.test(sourceTest) ? {\n    type: \"hls\",\n    src,\n    mime: getMimeType(hlsExtensions.exec(sourceTest)?.[1] ?? \"\"),\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : videoExtensions.test(sourceTest) ? {\n    type: \"video\",\n    src,\n    mime: getMimeType(videoExtensions.exec(sourceTest)?.[1] ?? \"\"),\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : audioExtensions.test(sourceTest) ? {\n    type: \"audio\",\n    src,\n    mime: getMimeType(audioExtensions.exec(sourceTest)?.[1] ?? \"\"),\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : base64String.test(sourceTest) ? {\n    type: \"video\",\n    src,\n    mime: base64Mime ? base64Mime[1] : \"video/mp4\",\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : imageExtensions.test(sourceTest) ? {\n    type: \"image\",\n    src,\n    mime: getMimeType(\n      imageExtensions.exec(sourceTest)?.[1] ?? \"\"\n    ),\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : vttExtensions.test(sourceTest) ? {\n    type: \"vtt\",\n    src,\n    mime: getMimeType(\n      vttExtensions.exec(sourceTest)?.[1] ?? \"\"\n    ),\n    width: null,\n    height: null\n  } : flvExtensions.test(sourceTest) ? {\n    type: \"video\",\n    src,\n    mime: \"video/x-flv\",\n    width: resolvedWidth,\n    height: resolvedHeight\n  } : null;\n};\n\n// src/media/utils.ts\nvar DEFAULT_ASPECT_RATIO = 16 / 9;\nvar getFilteredNaN = (value) => value && !Number.isNaN(value) && Number.isFinite(value) ? value : 0;\nvar getBoundedSeek = (seek, duration) => Math.min(\n  Math.max(0, getFilteredNaN(seek)),\n  // seek to near the end\n  getFilteredNaN(duration) ? getFilteredNaN(duration) - 0.01 : 0\n);\nvar getBoundedRate = (rate) => {\n  if (typeof rate === \"number\") {\n    return Math.min(Math.max(0, getFilteredNaN(rate)), 20);\n  }\n  const match = String(rate).match(/(\\d+(\\.\\d+)?)/);\n  return match ? Math.min(Math.max(0, getFilteredNaN(Number.parseFloat(match[0]))), 20) : 1;\n};\nvar getBoundedVolume = (volume) => Math.min(Math.max(0, getFilteredNaN(volume)), 1);\nvar nanoid = (0,nanoid__WEBPACK_IMPORTED_MODULE_0__.customAlphabet)(\n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n  22\n);\nvar generateRandomToken = () => {\n  return nanoid();\n};\nvar getClipParams = ({\n  requestedTime,\n  clipLength,\n  playbackOffsetMs\n}) => {\n  const currentTime = requestedTime ?? Date.now();\n  const estimatedServerClipTime = currentTime - (playbackOffsetMs ?? 0);\n  const startTime = estimatedServerClipTime - clipLength * 1e3;\n  const endTime = estimatedServerClipTime;\n  return {\n    startTime,\n    endTime\n  };\n};\nvar getProgressAria = ({\n  progress,\n  duration,\n  live\n}) => {\n  const progressParsed = getHoursMinutesSeconds(progress ?? null);\n  const durationParsed = getHoursMinutesSeconds(duration ?? null);\n  const progressText = `${progressParsed.hours ? `${progressParsed.hours} hours ` : \"\"}${progressParsed.minutes ? `${progressParsed.minutes} minutes ` : \"\"}${progressParsed.seconds ? `${progressParsed.seconds} seconds` : \"\"}`;\n  const durationText = `${durationParsed.hours ? `${durationParsed.hours} hours ` : \"\"}${durationParsed.minutes ? `${durationParsed.minutes} minutes ` : \"\"}${durationParsed.seconds ? `${durationParsed.seconds} seconds` : \"\"}`;\n  const progressDisplay = live ? `Live ${progressText}` : `${progressText} of ${durationText}`;\n  const formattedTimeDisplay = getFormattedHoursMinutesSeconds(\n    progress ?? null\n  );\n  const formattedDuration = getFormattedHoursMinutesSeconds(duration ?? null);\n  const formattedTime = live ? formattedTimeDisplay : `${formattedTimeDisplay} / ${formattedDuration}`;\n  return {\n    progress: progressDisplay,\n    time: formattedTime\n  };\n};\nvar sortSources = ({\n  src,\n  videoQuality,\n  screenWidth,\n  aspectRatio,\n  lowLatency,\n  hasRecentWebRTCTimeout\n}) => {\n  if (!src) {\n    return null;\n  }\n  if (typeof src === \"string\") {\n    const mediaSourceType = getMediaSourceType(src);\n    return mediaSourceType ? [mediaSourceType] : null;\n  }\n  const filteredVideoSources = src.filter(\n    (s) => s.type === \"audio\" || s.type === \"hls\" || s.type === \"webrtc\" || s.type === \"video\"\n  ).filter((s) => {\n    if (s.type === \"hls\" && lowLatency === \"force\") {\n      return false;\n    }\n    if (s.type === \"webrtc\" && (lowLatency === false || hasRecentWebRTCTimeout)) {\n      return false;\n    }\n    return true;\n  });\n  const videoQualityDimensions = calculateVideoQualityDimensions(\n    videoQuality,\n    aspectRatio\n  );\n  const targetWidth = videoQualityDimensions?.width ?? screenWidth ?? 1280;\n  const sourceWithParentDelta = filteredVideoSources?.map(\n    (s) => s.type === \"hls\" || s.type === \"webrtc\" ? { ...s, parentWidthDelta: null } : {\n      ...s,\n      parentWidthDelta: (\n        // first we check if the URL contains the video quality selector\n        videoQuality && videoQuality !== \"auto\" && s?.src?.includes(videoQuality) ? 0 : (\n          // otherwise use the width of the src\n          s?.width ? Math.abs(targetWidth - s.width) : (\n            // otherwise guess the width of the src based on the url\n            s?.src.includes(\"static360p\") || s?.src.includes(\"low-bitrate\") ? Math.abs(targetWidth - 480) : s?.src.includes(\"static720p\") ? Math.abs(targetWidth - 1280) : s?.src.includes(\"static1080p\") ? Math.abs(targetWidth - 1920) : s?.src.includes(\"static2160p\") ? Math.abs(targetWidth - 3840) : null\n          )\n        )\n      )\n    }\n  ) ?? [];\n  const sortedSources = sourceWithParentDelta.sort((a, b) => {\n    if (a.type === \"video\" && b.type === \"video\") {\n      return b?.parentWidthDelta !== null && a?.parentWidthDelta !== null ? a.parentWidthDelta - b.parentWidthDelta : 1;\n    }\n    if (a.type === \"video\" && (b.type === \"hls\" || b.type === \"webrtc\")) {\n      return -1;\n    }\n    if (a.type === \"webrtc\" && b.type === \"hls\") {\n      return -1;\n    }\n    return 1;\n  });\n  return sortedSources;\n};\nvar parseCurrentSourceAndPlaybackId = ({\n  accessKey,\n  aspectRatio,\n  playbackRate,\n  isHlsSupported,\n  jwt,\n  sessionToken,\n  source,\n  videoQuality,\n  ingestPlayback\n}) => {\n  if (!source) {\n    return null;\n  }\n  const playbackId = getPlaybackIdFromSourceUrl(source.src);\n  const url = new URL(source.src);\n  if (sessionToken) {\n    url.searchParams.append(\"tkn\", sessionToken);\n  }\n  if (source.type !== \"webrtc\" && source.type !== \"hls\") {\n    if (jwt) {\n      url.searchParams.append(\"jwt\", jwt);\n    } else if (accessKey) {\n      url.searchParams.append(\"accessKey\", accessKey);\n    }\n  }\n  if (source.type === \"webrtc\") {\n    if (playbackRate === \"constant\") {\n      url.searchParams.append(\"constant\", \"true\");\n    }\n    const videoTrackSelector = getVideoTrackSelectorForQuality(\n      videoQuality,\n      aspectRatio\n    );\n    if (videoTrackSelector) {\n      url.searchParams.append(\"video\", videoTrackSelector);\n    }\n  }\n  if (ingestPlayback) {\n    url.searchParams.append(\"ingestpb\", String(ingestPlayback));\n  }\n  const newSrc = {\n    ...source,\n    src: url.toString()\n  };\n  const videoSourceIfHlsUnsupported = newSrc?.type === \"hls\" && !isHlsSupported ? {\n    ...newSrc,\n    type: \"video\"\n  } : newSrc;\n  return {\n    currentSource: videoSourceIfHlsUnsupported,\n    playbackId\n  };\n};\nvar getNewSource = ({\n  accessKey,\n  aspectRatio,\n  isHlsSupported,\n  jwt,\n  lowLatency,\n  playbackRate,\n  screenWidth,\n  sessionToken,\n  src,\n  videoQuality,\n  hasRecentWebRTCTimeout,\n  ingestPlayback\n}) => {\n  const sortedSources = sortSources({\n    src,\n    screenWidth,\n    videoQuality,\n    aspectRatio: aspectRatio ?? DEFAULT_ASPECT_RATIO,\n    lowLatency,\n    hasRecentWebRTCTimeout\n  });\n  const parsedSource = parseCurrentSourceAndPlaybackId({\n    accessKey: accessKey ?? null,\n    aspectRatio: aspectRatio ?? null,\n    isHlsSupported,\n    jwt: jwt ?? null,\n    playbackRate,\n    sessionToken,\n    source: sortedSources?.[0] ?? null,\n    videoQuality,\n    ingestPlayback\n  });\n  return {\n    currentSource: parsedSource?.currentSource ?? null,\n    playbackId: parsedSource?.playbackId ?? null,\n    sortedSources\n  };\n};\nvar getVideoTrackSelectorForQuality = (videoQuality, aspectRatio) => {\n  if (videoQuality === \"auto\") {\n    return null;\n  }\n  const videoQualityDimensions = calculateVideoQualityDimensions(\n    videoQuality,\n    aspectRatio\n  );\n  if (videoQualityDimensions?.width && videoQualityDimensions?.height) {\n    return `~${videoQualityDimensions.width}x${videoQualityDimensions.height}`;\n  }\n  return null;\n};\nfunction calculateVideoQualityDimensions(videoQuality, aspectRatio) {\n  const height = videoQuality === \"1080p\" ? 1080 : videoQuality === \"720p\" ? 720 : videoQuality === \"480p\" ? 480 : videoQuality === \"360p\" ? 360 : videoQuality === \"240p\" ? 240 : videoQuality === \"144p\" ? 144 : null;\n  return {\n    width: height !== null ? Math.round(height * (aspectRatio ?? 16 / 9)) : null,\n    height\n  };\n}\nvar getFormattedHoursMinutesSeconds = (valueInSeconds) => {\n  const hoursMinutesSeconds = getHoursMinutesSeconds(valueInSeconds);\n  if (hoursMinutesSeconds.seconds || hoursMinutesSeconds.minutes || hoursMinutesSeconds.hours) {\n    if (hoursMinutesSeconds.hours > 0) {\n      return `${hoursMinutesSeconds.hours}:${hoursMinutesSeconds.minutes.toString().padStart(2, \"0\")}:${hoursMinutesSeconds.seconds < 10 ? \"0\" : \"\"}${hoursMinutesSeconds.seconds}`;\n    }\n    return `${hoursMinutesSeconds.minutes}:${hoursMinutesSeconds.seconds.toString().padStart(2, \"0\")}`;\n  }\n  return \"0:00\";\n};\nvar getHoursMinutesSeconds = (valueInSeconds) => {\n  if (valueInSeconds !== void 0 && valueInSeconds !== null && !Number.isNaN(valueInSeconds) && Number.isFinite(valueInSeconds)) {\n    const roundedValue = Math.round(valueInSeconds);\n    const hours = Math.floor(roundedValue / 3600);\n    const seconds = Math.floor(roundedValue % 60);\n    if (hours > 0) {\n      const minutes2 = Math.floor(roundedValue % 3600 / 60);\n      return {\n        hours,\n        minutes: minutes2,\n        seconds\n      };\n    }\n    const minutes = Math.floor(roundedValue / 60);\n    return {\n      hours: 0,\n      minutes,\n      seconds\n    };\n  }\n  return {\n    hours: 0,\n    minutes: 0,\n    seconds: 0\n  };\n};\n\n// src/media/controller.ts\nvar DEFAULT_AUTOHIDE_TIME = 3e3;\nvar DEFAULT_SEEK_TIME = 5e3;\nvar DEFAULT_VOLUME_LEVEL = 1;\nvar webrtcTimeoutLastTime = null;\nvar getHasRecentWebRTCTimeout = (cacheWebRTCFailureMs) => {\n  if (!webrtcTimeoutLastTime || !cacheWebRTCFailureMs) return false;\n  return Date.now() - webrtcTimeoutLastTime < cacheWebRTCFailureMs;\n};\nvar createControllerStore = ({\n  device,\n  storage,\n  src,\n  initialProps,\n  playbackId\n}) => {\n  const initialPlaybackRate = initialProps?.playbackRate ?? 1;\n  const initialVolume = getBoundedVolume(\n    initialProps.volume ?? DEFAULT_VOLUME_LEVEL\n  );\n  const initialVideoQuality = initialProps.videoQuality ?? \"auto\";\n  const sessionToken = generateRandomToken();\n  const thumbnailSrc = typeof src === \"string\" ? null : src?.find?.((s) => s.type === \"image\");\n  const lowLatency = initialProps.lowLatency ?? true;\n  const parsedInputSource = getNewSource({\n    accessKey: initialProps?.accessKey,\n    aspectRatio: initialProps?.aspectRatio,\n    isHlsSupported: device.isHlsSupported,\n    jwt: initialProps?.jwt,\n    playbackRate: initialPlaybackRate,\n    lowLatency,\n    screenWidth: device.screenWidth,\n    sessionToken,\n    src,\n    videoQuality: initialVideoQuality,\n    hasRecentWebRTCTimeout: getHasRecentWebRTCTimeout(\n      initialProps.cacheWebRTCFailureMs\n    ),\n    ingestPlayback: initialProps.ingestPlayback ?? false\n  });\n  const initialControls = {\n    hlsConfig: null,\n    autohide: DEFAULT_AUTOHIDE_TIME,\n    lastError: 0,\n    lastInteraction: Date.now(),\n    requestedMeasureLastTime: 0,\n    muted: initialVolume === 0,\n    playbackId: playbackId ?? parsedInputSource?.playbackId ?? null,\n    playbackOffsetMs: null,\n    playLastTime: 0,\n    pauseLastTime: 0,\n    requestedClipParams: null,\n    requestedFullscreenLastTime: 0,\n    requestedPictureInPictureLastTime: 0,\n    requestedPlayPauseLastTime: 0,\n    requestedRangeToSeekTo: 0,\n    sessionToken,\n    size: null,\n    thumbnail: thumbnailSrc ?? null,\n    volume: initialVolume\n  };\n  const store = (0,zustand_vanilla__WEBPACK_IMPORTED_MODULE_1__.createStore)(\n    (0,zustand_middleware__WEBPACK_IMPORTED_MODULE_2__.subscribeWithSelector)(\n      (0,zustand_middleware__WEBPACK_IMPORTED_MODULE_2__.persist)(\n        (set, get) => ({\n          currentSource: parsedInputSource.currentSource,\n          canPlay: false,\n          hidden: false,\n          /** Current volume of the media. 0 if it is muted. */\n          volume: initialVolume,\n          /** The playback rate for the media. Defaults to 1. */\n          playbackRate: initialPlaybackRate,\n          videoQuality: \"auto\",\n          /** Current progress of the media (in seconds) */\n          progress: 0,\n          /** Current total duration of the media (in seconds) */\n          duration: 0,\n          /** Current buffered end time for the media (in seconds) */\n          buffered: 0,\n          /** Current buffered percent */\n          bufferedPercent: 0,\n          poster: thumbnailSrc?.src ?? null,\n          /** If the video element is mounted on the DOM */\n          mounted: false,\n          /** If the media is fullscreen. */\n          fullscreen: false,\n          /** If the media is in picture in picture mode */\n          pictureInPicture: false,\n          playing: false,\n          waiting: false,\n          stalled: false,\n          loading: true,\n          ended: false,\n          /** If the media has experienced an error. */\n          error: null,\n          errorCount: 0,\n          /** If the content is live media */\n          live: false,\n          /** If the media has been played yet. */\n          hasPlayed: false,\n          /** The sorted sources that were passed in to the Player */\n          sortedSources: parsedInputSource.sortedSources,\n          /** The final playback URL for the media that is playing, after redirects. */\n          currentUrl: null,\n          metricsReportingUrl: null,\n          aria: {\n            progress: \"No progress, content is loading\",\n            fullscreen: \"Full screen (f)\",\n            pictureInPicture: \"Mini player (i)\",\n            playPause: \"Play (k)\",\n            clip: initialProps.clipLength ? `Clip last ${Number(initialProps.clipLength).toFixed(\n              0\n            )} seconds (x)` : null,\n            time: \"0:00\"\n          },\n          __initialProps: {\n            accessKey: initialProps.accessKey ?? null,\n            aspectRatio: initialProps?.aspectRatio ?? null,\n            autoPlay: initialProps.autoPlay ?? false,\n            backoff: Math.max(initialProps.backoff ?? 500, 100),\n            backoffMax: Math.max(initialProps.backoffMax ?? 3e4, 1e4),\n            calculateDelay: initialProps.calculateDelay ?? ((count) => {\n              if (count === 0) {\n                return 0;\n              }\n              const delayTime = Math.min(\n                Math.max(initialProps.backoff ?? 500, 100) * 2 ** (count - 1),\n                Math.max(initialProps.backoffMax ?? 3e4, 1e4)\n              );\n              return delayTime;\n            }),\n            clipLength: initialProps.clipLength ?? null,\n            cacheWebRTCFailureMs: initialProps.cacheWebRTCFailureMs ?? null,\n            hotkeys: initialProps?.hotkeys ?? true,\n            jwt: initialProps.jwt ?? null,\n            lowLatency,\n            onError: initialProps?.onError ?? null,\n            playbackRate: initialPlaybackRate,\n            posterLiveUpdate: initialProps.posterLiveUpdate ?? 3e4,\n            preload: initialProps.preload ?? \"none\",\n            storage,\n            timeout: initialProps.timeout ?? 1e4,\n            videoQuality: initialVideoQuality,\n            viewerId: initialProps.viewerId ?? null,\n            volume: initialVolume ?? null,\n            ingestPlayback: initialProps.ingestPlayback ?? false,\n            iceServers: initialProps.iceServers\n          },\n          __device: device,\n          __controls: initialControls,\n          __metadata: null,\n          __controlsFunctions: {\n            setMounted: () => set(() => ({\n              mounted: true\n            })),\n            setPoster: (poster) => set(() => ({\n              poster\n            })),\n            setMetricsReportingUrl: (metricsReportingUrl) => set(() => ({\n              metricsReportingUrl\n            })),\n            onWebRTCTimeout: () => {\n              webrtcTimeoutLastTime = Date.now();\n            },\n            setAutohide: (autohide) => set(({ __controls }) => ({\n              __controls: {\n                ...__controls,\n                autohide\n              }\n            })),\n            setHlsConfig: (hlsConfig) => set(({ __controls }) => ({\n              __controls: {\n                ...__controls,\n                hlsConfig\n              }\n            })),\n            setHidden: (hidden) => set(({ playing }) => ({\n              hidden: playing ? hidden : false\n            })),\n            updateLastInteraction: () => set(({ __controls }) => ({\n              __controls: { ...__controls, lastInteraction: Date.now() }\n            })),\n            updatePlaybackOffsetMs: (offset) => set(({ __controls }) => ({\n              __controls: {\n                ...__controls,\n                playbackOffsetMs: offset\n              }\n            })),\n            onCanPlay: () => set(() => ({\n              canPlay: true,\n              loading: false\n            })),\n            onPlay: () => set(({ aria, __controls, __controlsFunctions }) => {\n              __controlsFunctions.onError(null);\n              const title = \"Pause (k)\";\n              return {\n                playing: true,\n                hasPlayed: true,\n                error: null,\n                errorCount: 0,\n                stalled: false,\n                waiting: false,\n                ended: false,\n                __controls: {\n                  ...__controls,\n                  playLastTime: Date.now()\n                },\n                aria: {\n                  ...aria,\n                  playPause: title\n                }\n              };\n            }),\n            onPause: () => set(({ aria, __controls }) => {\n              const title = \"Play (k)\";\n              return {\n                playing: false,\n                hidden: false,\n                stalled: false,\n                waiting: false,\n                ended: false,\n                aria: {\n                  ...aria,\n                  playPause: title\n                },\n                __controls: {\n                  ...__controls,\n                  pauseLastTime: Date.now()\n                }\n              };\n            }),\n            togglePlay: (force) => {\n              const { hidden, __device, __controlsFunctions } = store.getState();\n              if (!force && hidden && __device.isMobile) {\n                __controlsFunctions.setHidden(false);\n              } else {\n                set(({ __controls }) => ({\n                  __controls: {\n                    ...__controls,\n                    requestedPlayPauseLastTime: Date.now(),\n                    lastInteraction: Date.now()\n                  }\n                }));\n              }\n            },\n            onProgress: (time) => set(({ aria, progress, duration, live }) => {\n              const progressAria = getProgressAria({\n                progress,\n                duration,\n                live\n              });\n              const playPauseTitle = \"Pause (k)\";\n              return {\n                aria: {\n                  ...aria,\n                  progress: progressAria.progress,\n                  time: progressAria.time,\n                  playPause: playPauseTitle\n                },\n                progress: getFilteredNaN(time),\n                waiting: false,\n                stalled: false,\n                ended: false\n              };\n            }),\n            requestSeek: (time) => set(({ duration, __controls }) => ({\n              __controls: {\n                ...__controls,\n                requestedRangeToSeekTo: getBoundedSeek(time, duration)\n              },\n              progress: getBoundedSeek(time, duration)\n            })),\n            onDurationChange: (duration) => set(({ live }) => ({\n              duration,\n              live: duration === Number.POSITIVE_INFINITY ? true : live\n            })),\n            setWebsocketMetadata: (metadata) => set(() => ({ __metadata: metadata })),\n            updateBuffered: (buffered) => set(({ duration }) => {\n              const durationFiltered = getFilteredNaN(duration);\n              const percent = durationFiltered > 0 && buffered > 0 ? buffered / durationFiltered * 100 : 0;\n              return {\n                buffered,\n                bufferedPercent: Number(percent.toFixed(2))\n              };\n            }),\n            setVideoQuality: (videoQuality) => set(({ __initialProps, __controls, playbackRate, __device }) => {\n              const parsedSourceNew = getNewSource({\n                accessKey: __initialProps?.accessKey,\n                aspectRatio: __initialProps.aspectRatio,\n                isHlsSupported: __device.isHlsSupported,\n                jwt: __initialProps?.jwt,\n                lowLatency: __initialProps.lowLatency,\n                playbackRate,\n                screenWidth: device.screenWidth,\n                sessionToken: __controls.sessionToken,\n                src,\n                videoQuality,\n                hasRecentWebRTCTimeout: getHasRecentWebRTCTimeout(\n                  __initialProps.cacheWebRTCFailureMs\n                ),\n                ingestPlayback: __initialProps.ingestPlayback\n              });\n              return {\n                sortedSources: parsedSourceNew.sortedSources,\n                videoQuality,\n                currentSource: parsedSourceNew.currentSource,\n                __controls: {\n                  ...__controls,\n                  playbackId: playbackId ?? parsedSourceNew.playbackId\n                }\n              };\n            }),\n            setPlaybackRate: (rate) => set(() => ({\n              playbackRate: getBoundedRate(rate ?? 1)\n            })),\n            requestSeekDiff: (difference) => set(({ progress, duration, __controls }) => ({\n              __controls: {\n                ...__controls,\n                requestedRangeToSeekTo: getBoundedSeek(\n                  getFilteredNaN(progress) + difference / 1e3,\n                  duration\n                )\n              }\n            })),\n            requestSeekBack: (difference = DEFAULT_SEEK_TIME) => get().__controlsFunctions.requestSeekDiff(-difference),\n            requestSeekForward: (difference = DEFAULT_SEEK_TIME) => get().__controlsFunctions.requestSeekDiff(difference),\n            onFinalUrl: (currentUrl) => set(() => ({ currentUrl })),\n            requestMeasure: () => set(({ __controls }) => {\n              return {\n                __controls: {\n                  ...__controls,\n                  requestedMeasureLastTime: Date.now()\n                }\n              };\n            }),\n            setSize: (size) => set(({ __controls }) => {\n              return {\n                __controls: {\n                  ...__controls,\n                  size: {\n                    ...__controls.size,\n                    ...size\n                  }\n                }\n              };\n            }),\n            onWaiting: () => set(() => ({ waiting: true })),\n            onStalled: () => set(() => ({ stalled: true })),\n            onLoading: () => set(() => ({ loading: true })),\n            onEnded: () => set(() => ({ ended: true })),\n            setFullscreen: (fullscreen) => set(({ aria }) => {\n              const title = fullscreen ? \"Exit full screen (f)\" : \"Full screen (f)\";\n              return {\n                fullscreen,\n                aria: {\n                  ...aria,\n                  fullscreen: title\n                }\n              };\n            }),\n            requestToggleFullscreen: () => set(({ __controls }) => ({\n              __controls: {\n                ...__controls,\n                requestedFullscreenLastTime: Date.now()\n              }\n            })),\n            setPictureInPicture: (pictureInPicture) => set(({ aria }) => {\n              const title = pictureInPicture ? \"Exit mini player (i)\" : \"Mini player (i)\";\n              return {\n                pictureInPicture,\n                aria: {\n                  ...aria,\n                  pictureInPicture: title\n                }\n              };\n            }),\n            requestTogglePictureInPicture: () => set(({ __controls }) => ({\n              __controls: {\n                ...__controls,\n                requestedPictureInPictureLastTime: Date.now()\n              }\n            })),\n            setLive: (live) => set(() => ({ live })),\n            requestClip: () => set(({ __controls, __initialProps }) => ({\n              __controls: {\n                ...__controls,\n                requestedClipParams: __initialProps.clipLength ? getClipParams({\n                  requestedTime: Date.now(),\n                  clipLength: __initialProps.clipLength,\n                  playbackOffsetMs: __controls.playbackOffsetMs\n                }) : null\n              }\n            })),\n            requestVolume: (newVolume) => set(({ __controls }) => ({\n              volume: getBoundedVolume(newVolume),\n              __controls: {\n                ...__controls,\n                volume: newVolume === 0 ? newVolume : getBoundedVolume(newVolume),\n                muted: newVolume === 0\n              }\n            })),\n            setVolume: (newVolume) => set(({ __controls }) => ({\n              volume: getBoundedVolume(newVolume),\n              __controls: {\n                ...__controls,\n                muted: newVolume === 0\n              }\n            })),\n            requestToggleMute: (forceValue) => set(({ __controls }) => {\n              const previousVolume = getBoundedVolume(__controls.volume) || 0;\n              const nonMutedVolume = previousVolume > 0.01 ? previousVolume : DEFAULT_VOLUME_LEVEL;\n              const mutedVolume = 0;\n              const newMutedValue = forceValue ?? !__controls.muted;\n              return {\n                volume: newMutedValue ? mutedVolume : nonMutedVolume,\n                __controls: {\n                  ...__controls,\n                  muted: newMutedValue\n                }\n              };\n            }),\n            onError: (rawError) => set(\n              ({\n                currentSource,\n                sortedSources,\n                __controls,\n                errorCount,\n                __device,\n                __initialProps,\n                videoQuality,\n                playbackRate\n              }) => {\n                const msSinceLastError = Date.now() - __controls.lastError;\n                const error = rawError ? {\n                  type: isAccessControlError(rawError) ? \"access-control\" : isBframesError(rawError) || isNotAcceptableError(rawError) ? \"fallback\" : isStreamOfflineError(rawError) ? \"offline\" : isPermissionsError(rawError) ? \"permissions\" : \"unknown\",\n                  message: rawError?.message ?? \"Error with playback.\"\n                } : null;\n                if (__initialProps.onError) {\n                  try {\n                    __initialProps.onError(error);\n                  } catch (e) {\n                    console.error(e);\n                  }\n                }\n                const base = {\n                  error,\n                  ...error ? {\n                    errorCount: errorCount + 1,\n                    playing: false,\n                    __controls: {\n                      ...__controls,\n                      lastError: Date.now()\n                    }\n                  } : { __controls }\n                };\n                if (!error) {\n                  return base;\n                }\n                console.error(error);\n                if (error.type === \"offline\" || error.type === \"access-control\" || error.type === \"permissions\") {\n                  return base;\n                }\n                if (typeof sortedSources === \"string\" || !Array.isArray(sortedSources)) {\n                  return base;\n                }\n                if (msSinceLastError < errorCount * 500) {\n                  return base;\n                }\n                const currentSourceBaseUrl = currentSource ? new URL(currentSource.src) : \"\";\n                if (currentSourceBaseUrl) {\n                  currentSourceBaseUrl.search = \"\";\n                }\n                const currentSourceIndex = sortedSources.findIndex(\n                  (s) => s.src === currentSourceBaseUrl.toString()\n                );\n                const rotatedSources = [\n                  ...sortedSources.slice(currentSourceIndex + 1),\n                  ...sortedSources.slice(0, currentSourceIndex + 1)\n                ];\n                const hasRecentWebRTCTimeout = getHasRecentWebRTCTimeout(\n                  __initialProps.cacheWebRTCFailureMs\n                );\n                const canPlaySourceType = (src2) => {\n                  const hasOneWebRTCSource = sortedSources.some(\n                    (s) => s?.type === \"webrtc\"\n                  );\n                  if (__initialProps.lowLatency === \"force\" && hasOneWebRTCSource && src2.type !== \"webrtc\") {\n                    return false;\n                  }\n                  if (__initialProps.lowLatency === false) {\n                    return src2.type !== \"webrtc\";\n                  }\n                  if (hasRecentWebRTCTimeout) {\n                    return src2.type !== \"webrtc\";\n                  }\n                  return src2.type === \"webrtc\" ? __device.isWebRTCSupported : true;\n                };\n                const nextPlayableIndex = rotatedSources.findIndex(\n                  (s) => canPlaySourceType(s)\n                );\n                const nextSourceIndex = nextPlayableIndex !== -1 ? (currentSourceIndex + 1 + nextPlayableIndex) % sortedSources.length : -1;\n                const nextSource = nextSourceIndex !== -1 ? sortedSources[nextSourceIndex] : null;\n                const parsedSourceNew = parseCurrentSourceAndPlaybackId({\n                  accessKey: __initialProps?.accessKey ?? null,\n                  aspectRatio: __initialProps?.aspectRatio ?? null,\n                  isHlsSupported: __device.isHlsSupported,\n                  jwt: __initialProps?.jwt ?? null,\n                  playbackRate,\n                  sessionToken: __controls.sessionToken,\n                  source: nextSource,\n                  videoQuality,\n                  ingestPlayback: __initialProps.ingestPlayback\n                });\n                return {\n                  ...base,\n                  currentSource: parsedSourceNew?.currentSource ?? null,\n                  __controls: {\n                    ...base.__controls,\n                    playbackId: playbackId ?? parsedSourceNew?.playbackId ?? null\n                  }\n                };\n              }\n            )\n          }\n        }),\n        {\n          name: \"livepeer-media-controller\",\n          version: 2,\n          // since these values are persisted across media, only persist volume & videoQuality\n          partialize: ({ volume, videoQuality }) => ({\n            volume,\n            videoQuality\n          }),\n          storage: (0,zustand_middleware__WEBPACK_IMPORTED_MODULE_2__.createJSONStorage)(() => storage)\n        }\n      )\n    )\n  );\n  const destroy = store.persist.onFinishHydration(\n    ({ videoQuality, volume }) => {\n      if (videoQuality !== store.getState().videoQuality) {\n        store.getState().__controlsFunctions.setVideoQuality(videoQuality);\n      }\n      if (volume !== store.getState().volume) {\n        store.getState().__controlsFunctions.requestVolume(volume);\n      }\n    }\n  );\n  return { store, destroy };\n};\n\n// src/media/metrics.ts\nvar LegacyPlaybackMonitor = class {\n  active = false;\n  values = [];\n  score = null;\n  averagingSteps = 20;\n  store;\n  constructor(store) {\n    this.store = store;\n  }\n  init() {\n    if (!this.active) {\n      this.values = [];\n      this.score = null;\n      this.active = true;\n    }\n  }\n  reset() {\n    if (!this.active) {\n      this.init();\n    } else {\n      this.values = [];\n    }\n  }\n  destroy() {\n    if (this.active) {\n      this.values = [];\n      this.score = null;\n      this.active = false;\n    }\n  }\n  calculateScore() {\n    if (this.active) {\n      const latestPlaybackRecord = this.values.length > 0 ? this.values[this.values.length - 1] : void 0;\n      const currentValue = {\n        clockTime: Date.now() * 1e-3,\n        mediaTime: this.store.getState().progress,\n        score: latestPlaybackRecord ? this.valueToScore(latestPlaybackRecord) : 0\n      };\n      this.values.push(currentValue);\n      if (this.values.length < 2) {\n        return null;\n      }\n      const oldestValue = this.values[0];\n      if (oldestValue !== void 0) {\n        const averagedScore = this.valueToScore(oldestValue, currentValue);\n        if (this.values.length > this.averagingSteps) {\n          this.values.shift();\n        }\n        this.score = Math.max(averagedScore, currentValue.score);\n        return Math.round(this.score * 10) / 10;\n      }\n    }\n    return null;\n  }\n  valueToScore(a, b) {\n    const rate = this?.store?.getState?.()?.playbackRate ?? 1;\n    return (b?.mediaTime ?? this.store.getState().progress - a.mediaTime) / (b?.clockTime ?? Date.now() * 1e-3 - a.clockTime) / (rate === \"constant\" ? 1 : rate);\n  }\n};\nvar Timer = class {\n  totalTime = 0;\n  countStarts = 0;\n  startTime = 0;\n  start() {\n    this.startTime = Date.now();\n    this.countStarts++;\n  }\n  stop() {\n    this.totalTime += this.startTime > 0 ? Date.now() - this.startTime : 0;\n    this.startTime = 0;\n  }\n  getTotalTime() {\n    this.totalTime += this.startTime > 0 ? Date.now() - this.startTime : 0;\n    this.startTime = this.startTime > 0 ? Date.now() : 0;\n    return this.totalTime;\n  }\n  getCountStarts() {\n    return this.countStarts;\n  }\n};\nfunction isInIframe() {\n  try {\n    return typeof window !== \"undefined\" && window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nvar LegacyMetricsStatus = class {\n  requestedPlayTime = null;\n  firstFrameTime = null;\n  bootMs;\n  retryCount = 0;\n  connected = false;\n  store;\n  destroy;\n  currentMetrics;\n  previousMetrics = null;\n  timeWaiting = new Timer();\n  timeStalled = new Timer();\n  timeUnpaused = new Timer();\n  constructor(store, bootMs, opts) {\n    const currentState = store.getState();\n    this.store = store;\n    this.bootMs = bootMs;\n    const windowHref = typeof window !== \"undefined\" ? window?.location?.href ?? \"\" : \"\";\n    const pageUrl = isInIframe() ? typeof document !== \"undefined\" ? document?.referrer || windowHref : windowHref : windowHref;\n    const playerPrefix = currentState?.currentSource?.type ?? \"unknown\";\n    const version = currentState?.__device.version ?? \"unknown\";\n    this.currentMetrics = {\n      autoplay: currentState.__initialProps.autoPlay ? \"autoplay\" : currentState.__initialProps.preload === \"auto\" ? \"preload-full\" : currentState.__initialProps.preload === \"metadata\" ? \"preload-metadata\" : \"standard\",\n      duration: null,\n      firstPlayback: null,\n      nError: null,\n      nStalled: null,\n      nWaiting: null,\n      offset: null,\n      pageUrl,\n      playbackScore: null,\n      player: `${playerPrefix}-${version}`,\n      sourceType: currentState?.currentSource?.mime ?? \"unknown\",\n      sourceUrl: currentState?.currentSource?.src ?? null,\n      playerHeight: null,\n      playerWidth: null,\n      preloadTime: null,\n      timeStalled: 0,\n      timeUnpaused: 0,\n      timeWaiting: 0,\n      ttff: null,\n      uid: currentState.__initialProps.viewerId ?? \"\",\n      userAgent: String(currentState?.__device?.userAgent ?? \"\").replace(\n        /\\\\|\"/gm,\n        \"\"\n      ),\n      videoHeight: null,\n      videoWidth: null\n    };\n    this.destroy = store.subscribe((state, prevState) => {\n      if (this.requestedPlayTime === null && state.__controls.playLastTime !== 0) {\n        this.requestedPlayTime = Math.max(\n          state.__controls.playLastTime - bootMs,\n          0\n        );\n      }\n      if (state.currentSource?.src !== prevState.currentSource?.src) {\n        const playerPrefix2 = state?.currentSource?.type ?? \"unknown\";\n        const version2 = state?.__device.version ?? \"unknown\";\n        this.currentMetrics.player = `${playerPrefix2}-${version2}`;\n        this.currentMetrics.sourceType = state.currentSource?.mime ?? \"unknown\";\n        this.currentMetrics.sourceUrl = state.currentSource?.src ?? null;\n      }\n      if (state.playing !== prevState.playing) {\n        if (state.playing) {\n          this.timeStalled.stop();\n          this.timeWaiting.stop();\n          this.timeUnpaused.start();\n        } else {\n          this.timeUnpaused.stop();\n          this.timeStalled.stop();\n          this.timeWaiting.stop();\n        }\n      }\n      if (opts?.disableProgressListener !== true && state.progress !== prevState.progress && !this.timeUnpaused.startTime) {\n        this.timeStalled.stop();\n        this.timeWaiting.stop();\n        this.timeUnpaused.start();\n      }\n      if (state.stalled !== prevState.stalled) {\n        if (state.stalled) {\n          this.timeStalled.start();\n          this.timeUnpaused.stop();\n        } else if (state.playing) {\n          this.timeStalled.stop();\n          this.timeWaiting.stop();\n          this.timeUnpaused.start();\n        }\n      }\n      if (state.waiting !== prevState.waiting) {\n        if (state.waiting) {\n          this.timeWaiting.start();\n          this.timeUnpaused.stop();\n        } else if (state.playing) {\n          this.timeStalled.stop();\n          this.timeWaiting.stop();\n          this.timeUnpaused.start();\n        }\n      }\n    });\n  }\n  addError(error) {\n    this.currentMetrics.nError = (this.currentMetrics.nError ?? 0) + 1;\n    this.currentMetrics.lastError = error;\n  }\n  getFirstPlayback() {\n    return this.currentMetrics.firstPlayback;\n  }\n  setFirstPlayback() {\n    this.currentMetrics.firstPlayback = Date.now() - this.bootMs;\n  }\n  getFirstFrameTime() {\n    return this.firstFrameTime;\n  }\n  setFirstFrameTime() {\n    this.firstFrameTime = Date.now() - this.bootMs;\n  }\n  setPlaybackScore(playbackScore) {\n    this.currentMetrics.playbackScore = playbackScore;\n  }\n  setConnected(isConnected) {\n    this.connected = isConnected;\n  }\n  getMetrics() {\n    const currentMetrics = {\n      ...this.currentMetrics,\n      playerHeight: this.store.getState().__controls.size?.container?.height || null,\n      playerWidth: this.store.getState().__controls.size?.container?.width || null,\n      videoWidth: this.store.getState().__controls.size?.media?.width || null,\n      videoHeight: this.store.getState().__controls.size?.media?.height || null,\n      duration: this.store.getState().duration || null,\n      nWaiting: this.timeWaiting.getCountStarts(),\n      nStalled: this.timeStalled.getCountStarts(),\n      timeWaiting: this.timeWaiting.getTotalTime(),\n      timeStalled: this.timeStalled.getTotalTime(),\n      timeUnpaused: this.timeUnpaused.getTotalTime(),\n      offset: this.store.getState().__controls.playbackOffsetMs || null,\n      // this is the amount of time that a video has had to preload content, from boot until play was requested\n      preloadTime: this.requestedPlayTime,\n      // time from when the first `play` event is emitted and the first progress update\n      ttff: this.firstFrameTime && this.requestedPlayTime && this.firstFrameTime > 0 && this.requestedPlayTime > 0 ? Math.max(this.firstFrameTime - this.requestedPlayTime, 0) : null\n    };\n    const previousMetrics = this.previousMetrics;\n    this.previousMetrics = currentMetrics;\n    return {\n      current: currentMetrics,\n      previous: previousMetrics\n    };\n  }\n};\nfunction addLegacyMediaMetricsToStore(store, opts) {\n  const bootMs = Date.now();\n  const defaultResponse = {\n    metrics: null,\n    destroy: () => {\n    }\n  };\n  if (!store) {\n    return defaultResponse;\n  }\n  if (!WebSocket) {\n    console.log(\"Environment does not support WebSocket\");\n    return defaultResponse;\n  }\n  let websocketPromise = null;\n  let timer = null;\n  let reportingActive = true;\n  const metricsStatus = new LegacyMetricsStatus(store, bootMs, opts);\n  const monitor = new LegacyPlaybackMonitor(store);\n  const report = async () => {\n    const ws = await websocketPromise;\n    if (!reportingActive || !ws) {\n      return;\n    }\n    const playbackScore = monitor.calculateScore();\n    if (playbackScore !== null) {\n      metricsStatus.setPlaybackScore(playbackScore);\n    }\n    const metrics = metricsStatus.getMetrics();\n    const d = {};\n    let key;\n    for (key in metrics.current) {\n      const val = metrics.current[key];\n      const shouldSendValue = typeof val === \"number\" ? Number.isFinite(val) && !Number.isNaN(val) && val >= 0 : Boolean(val);\n      if (shouldSendValue && val !== metrics?.previous?.[key]) {\n        d[key] = val;\n      }\n    }\n    if (Object.keys(d).length > 0) {\n      send(ws, d);\n    }\n    if (timer) {\n      clearTimeout(timer);\n    }\n    timer = setTimeout(() => {\n      report();\n    }, 1e3);\n  };\n  const createNewWebSocket = async (playbackId, currentSource, numRetries = 0) => {\n    try {\n      if (!playbackId || !currentSource) {\n        return null;\n      }\n      const prevWebsocket = await websocketPromise;\n      prevWebsocket?.close?.(3077);\n      const reportingWebsocketUrl = await getMetricsReportingWebsocketUrl({\n        playbackId,\n        playbackUrl: currentSource,\n        sessionToken: store.getState().__controls.sessionToken\n      });\n      if (reportingWebsocketUrl) {\n        const newWebSocket = new WebSocket(reportingWebsocketUrl);\n        newWebSocket.addEventListener(\"open\", async () => {\n          report();\n        });\n        newWebSocket.addEventListener(\"message\", (event) => {\n          try {\n            if (event?.data) {\n              const json = JSON.parse(event.data);\n              store.getState().__controlsFunctions.setWebsocketMetadata(json);\n            }\n          } catch (e) {\n            console.warn(\"Failed to parse metadata from websocket.\");\n          }\n        });\n        newWebSocket.addEventListener(\"close\", () => {\n          if (timer) {\n            clearTimeout(timer);\n          }\n          setTimeout(\n            () => {\n              if (reportingActive) {\n                websocketPromise = createNewWebSocket(\n                  playbackId,\n                  currentSource,\n                  numRetries + 1\n                );\n              }\n            },\n            2 ** numRetries * 1e3\n          );\n        });\n        return newWebSocket;\n      }\n    } catch (e) {\n      console.error(e);\n    }\n    return null;\n  };\n  const destroyMetricsListener = store.subscribe(\n    (state) => ({\n      playbackId: state.__controls.playbackId,\n      finalUrl: state.currentUrl,\n      type: state.currentSource?.type\n    }),\n    (state) => {\n      if (state?.playbackId && state?.finalUrl) {\n        websocketPromise = createNewWebSocket(state.playbackId, state.finalUrl);\n      }\n    },\n    {\n      fireImmediately: true,\n      equalityFn: (a, b) => {\n        return a.playbackId === b.playbackId && Boolean(a.finalUrl);\n      }\n    }\n  );\n  try {\n    const destroyTtffListener = store.subscribe((state, prevState) => {\n      if (state.playing !== prevState.playing && metricsStatus.getFirstPlayback() === null) {\n        metricsStatus.setFirstPlayback();\n      }\n      if (state.progress !== prevState.progress && metricsStatus.getFirstFrameTime() === null) {\n        metricsStatus.setFirstFrameTime();\n      }\n      if (state.error?.message && state.error?.message !== prevState.error?.message) {\n        metricsStatus.addError(state.error.message);\n      }\n    });\n    const destroyMonitorListener = store.subscribe((state, prevState) => {\n      if (state.playing !== prevState.playing && state.playing || state.loading !== prevState.loading && state.loading) {\n        monitor.init();\n      }\n      if (state.__controls.requestedRangeToSeekTo !== prevState.__controls.requestedRangeToSeekTo) {\n        monitor.reset();\n      }\n      if (state.playing !== prevState.playing && !state.playing) {\n        monitor.destroy();\n      }\n    });\n    const destroy = () => {\n      reportingActive = false;\n      destroyMetricsListener?.();\n      destroyMonitorListener?.();\n      destroyTtffListener?.();\n      monitor?.destroy?.();\n      metricsStatus?.destroy?.();\n      if (timer) {\n        clearTimeout(timer);\n      }\n      if (websocketPromise) {\n        websocketPromise.then((websocket) => {\n          websocket?.close(3077);\n        });\n      }\n    };\n    return { metrics: metricsStatus, destroy };\n  } catch (e) {\n    console.error(e);\n  }\n  return defaultResponse;\n}\nfunction send(webSocket, metrics) {\n  if (webSocket.readyState !== webSocket.OPEN) {\n    return;\n  }\n  webSocket.send(JSON.stringify(metrics));\n}\n\n// src/utils/deepMerge.ts\nvar isObject = (obj) => {\n  if (typeof obj === \"object\" && obj !== null) {\n    if (typeof Object.getPrototypeOf === \"function\") {\n      const prototype = Object.getPrototypeOf(obj);\n      return prototype === Object.prototype || prototype === null;\n    }\n    return Object.prototype.toString.call(obj) === \"[object Object]\";\n  }\n  return false;\n};\nvar merge = (...objects) => objects.reduce((result, current) => {\n  if (Array.isArray(current)) {\n    throw new TypeError(\n      \"Arguments provided to ts-deepmerge must be objects, not arrays.\"\n    );\n  }\n  Object.keys(current).forEach((key) => {\n    if ([\"__proto__\", \"constructor\", \"prototype\"].includes(key)) {\n      return;\n    }\n    if (Array.isArray(result[key]) && Array.isArray(current[key])) {\n      result[key] = merge.options.mergeArrays ? Array.from(new Set(result[key].concat(current[key]))) : current[key];\n    } else if (isObject(result[key]) && isObject(current[key])) {\n      result[key] = merge(result[key], current[key]);\n    } else {\n      result[key] = current[key];\n    }\n  });\n  return result;\n}, {});\nvar defaultOptions = {\n  mergeArrays: true\n};\nmerge.options = defaultOptions;\nmerge.withOptions = (options, ...objects) => {\n  merge.options = {\n    mergeArrays: true,\n    ...options\n  };\n  const result = merge(...objects);\n  merge.options = defaultOptions;\n  return result;\n};\n\n// src/utils/storage/ipfs.ts\n\n\n// src/utils/warn.ts\nvar cache = /* @__PURE__ */ new Set();\nfunction warn(message, id) {\n  if (!cache.has(id ?? message)) {\n    console.warn(message);\n    cache.add(message);\n  }\n}\n\n// src/media/metrics-new.ts\nvar globalLoadTimestampMs = Date.now();\nfunction addMetricsToStore(store, opts) {\n  const defaultResponse = {\n    destroy: () => {\n    }\n  };\n  if (!store) {\n    return defaultResponse;\n  }\n  if (typeof window === \"undefined\") {\n    return defaultResponse;\n  }\n  const monitor = new MetricsMonitor(store, {\n    disableProgressListener: opts?.disableProgressListener\n  });\n  const isSendBeaconAvailable = \"sendBeacon\" in window.navigator;\n  const interval = opts?.interval ?? 5e3;\n  const eventBuffer = new PlaybackEventBuffer();\n  const destroyFinalUrlListener = store.subscribe(\n    (state) => ({\n      finalUrl: state.currentUrl\n    }),\n    async (state) => {\n      if (state?.finalUrl) {\n        const url = await getMetricsReportingPOSTUrl({\n          playbackUrl: state.finalUrl\n        });\n        if (url) {\n          store.getState().__controlsFunctions.setMetricsReportingUrl(url);\n        }\n      }\n    },\n    {\n      fireImmediately: true,\n      equalityFn: (a, b) => {\n        return a.finalUrl === b.finalUrl;\n      }\n    }\n  );\n  const destroyErrorListener = store.subscribe(\n    (state) => state.error,\n    async (error) => {\n      if (error) {\n        eventBuffer.addEvent(\n          error.type === \"offline\" || error.type === \"fallback\" ? {\n            id: generateRandomToken(),\n            type: \"warning\",\n            timestamp: Date.now(),\n            category: error.type,\n            message: error.message\n          } : {\n            id: generateRandomToken(),\n            type: \"error\",\n            timestamp: Date.now(),\n            category: error.type,\n            message: error.message\n          }\n        );\n      }\n    }\n  );\n  const destroyPlayListener = store.subscribe(\n    (state) => state.__controls.playLastTime,\n    async (timestamp) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"play\",\n        timestamp\n      });\n    }\n  );\n  const destroyPauseListener = store.subscribe(\n    (state) => state.__controls.pauseLastTime,\n    async (timestamp) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"pause\",\n        timestamp\n      });\n    }\n  );\n  const destroyClipListener = store.subscribe(\n    (state) => state.__controls.requestedClipParams,\n    async (params) => {\n      if (params) {\n        eventBuffer.addEvent({\n          id: generateRandomToken(),\n          type: \"clip\",\n          timestamp: Date.now(),\n          startTime: params.startTime,\n          endTime: params.endTime\n        });\n      }\n    }\n  );\n  const destroyPipListener = store.subscribe(\n    (state) => state.pictureInPicture,\n    async (pictureInPicture) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: pictureInPicture ? \"enter-pip\" : \"exit-pip\",\n        timestamp: Date.now()\n      });\n    }\n  );\n  const destroyFullscreenListener = store.subscribe(\n    (state) => state.fullscreen,\n    async (fullscreen) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: fullscreen ? \"enter-fullscreen\" : \"exit-fullscreen\",\n        timestamp: Date.now()\n      });\n    }\n  );\n  const destroyCanPlayListener = store.subscribe(\n    (state) => state.canPlay,\n    async (canPlay) => {\n      if (canPlay) {\n        eventBuffer.addEvent({\n          id: generateRandomToken(),\n          type: \"can-play\",\n          timestamp: Date.now()\n        });\n      }\n    }\n  );\n  const destroyEndedListener = store.subscribe(\n    (state) => state.ended,\n    async (ended) => {\n      if (ended) {\n        eventBuffer.addEvent({\n          id: generateRandomToken(),\n          type: \"ended\",\n          timestamp: Date.now()\n        });\n      }\n    }\n  );\n  const destroyRateChangeListener = store.subscribe(\n    (state) => state.playbackRate,\n    async (playbackRate) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"rate\",\n        timestamp: Date.now(),\n        payload: playbackRate\n      });\n    }\n  );\n  const destroyVideoQualityListener = store.subscribe(\n    (state) => state.videoQuality,\n    async (videoQuality) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"video-quality\",\n        timestamp: Date.now(),\n        payload: videoQuality\n      });\n    }\n  );\n  const destroySeekListener = store.subscribe(\n    (state) => state.__controls.requestedRangeToSeekTo,\n    async (rangeToSeekTo) => {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"seek\",\n        timestamp: Date.now(),\n        payload: rangeToSeekTo\n      });\n    }\n  );\n  const ic = new IncrementalCounter([\n    \"errors\",\n    \"warnings\",\n    \"stalled_count\",\n    \"waiting_count\",\n    \"time_warning_ms\",\n    \"time_errored_ms\",\n    \"time_stalled_ms\",\n    \"time_playing_ms\",\n    \"time_waiting_ms\"\n  ]);\n  const vct = new ValueChangeTracker([\n    \"autoplay_status\",\n    \"mount_to_first_frame_ms\",\n    \"mount_to_play_ms\",\n    \"play_to_first_frame_ms\",\n    \"duration_ms\",\n    \"offset_ms\",\n    \"video_height_px\",\n    \"video_width_px\",\n    \"player_width_px\",\n    \"player_height_px\",\n    \"window_height_px\",\n    \"window_width_px\"\n  ]);\n  let firstFrameSent = false;\n  const sendEvents = ({ isUnloading } = { isUnloading: false }) => async () => {\n    const currentState = store.getState();\n    const currentControlsState = currentState.__controls;\n    if (!currentState.currentSource) {\n      warn(\"Not sending metrics since no current playback source parsed.\");\n      return;\n    }\n    if (!currentControlsState.playbackId) {\n      warn(\"Not sending metrics since no playback ID parsed.\");\n      return;\n    }\n    const metricsSnapshot = monitor.getMetrics();\n    if (!firstFrameSent && monitor.firstFrameTimestamp) {\n      eventBuffer.addEvent({\n        id: generateRandomToken(),\n        type: \"first-frame\",\n        timestamp: monitor.firstFrameTimestamp\n      });\n      firstFrameSent = true;\n    }\n    eventBuffer.addEvent({\n      id: generateRandomToken(),\n      type: \"heartbeat\",\n      timestamp: Date.now(),\n      errors: ic.calculateIncrement(\"errors\", metricsSnapshot.errorCount),\n      warnings: ic.calculateIncrement(\n        \"warnings\",\n        metricsSnapshot.warningCount\n      ),\n      stalled_count: ic.calculateIncrement(\n        \"stalled_count\",\n        metricsSnapshot.stalledCount\n      ),\n      waiting_count: ic.calculateIncrement(\n        \"waiting_count\",\n        metricsSnapshot.waitingCount\n      ),\n      time_errored_ms: ic.calculateIncrement(\n        \"time_errored_ms\",\n        metricsSnapshot.timeErrored\n      ),\n      time_warning_ms: ic.calculateIncrement(\n        \"time_warning_ms\",\n        metricsSnapshot.timeWarning\n      ),\n      time_stalled_ms: ic.calculateIncrement(\n        \"time_stalled_ms\",\n        metricsSnapshot.timeStalled\n      ),\n      time_playing_ms: ic.calculateIncrement(\n        \"time_playing_ms\",\n        metricsSnapshot.timePlaying\n      ),\n      time_waiting_ms: ic.calculateIncrement(\n        \"time_waiting_ms\",\n        metricsSnapshot.timeWaiting\n      ),\n      // The properties below are only sent once.\n      autoplay_status: vct.sendIfChanged(\n        \"autoplay_status\",\n        currentState.__initialProps.autoPlay ? \"autoplay\" : \"none\"\n      ),\n      mount_to_play_ms: vct.sendIfChanged(\n        \"mount_to_play_ms\",\n        metricsSnapshot.mountToPlay ?? void 0\n      ),\n      mount_to_first_frame_ms: vct.sendIfChanged(\n        \"mount_to_first_frame_ms\",\n        metricsSnapshot.mountToFirstFrame ?? void 0\n      ),\n      play_to_first_frame_ms: vct.sendIfChanged(\n        \"play_to_first_frame_ms\",\n        metricsSnapshot.playToFirstFrame ?? void 0\n      ),\n      duration_ms: currentState?.live ? void 0 : vct.sendIfChanged(\n        \"duration_ms\",\n        metricsSnapshot.duration ?? void 0\n      ),\n      offset_ms: vct.sendIfChanged(\n        \"offset_ms\",\n        metricsSnapshot.offset ?? void 0\n      ),\n      // The properties below are only sent when they change.\n      video_height_px: vct.sendIfChanged(\n        \"video_height_px\",\n        metricsSnapshot.videoHeight ?? void 0\n      ),\n      video_width_px: vct.sendIfChanged(\n        \"video_width_px\",\n        metricsSnapshot.videoWidth ?? void 0\n      ),\n      player_height_px: vct.sendIfChanged(\n        \"player_height_px\",\n        metricsSnapshot.playerHeight ?? void 0\n      ),\n      player_width_px: vct.sendIfChanged(\n        \"player_width_px\",\n        metricsSnapshot.playerWidth ?? void 0\n      ),\n      window_height_px: vct.sendIfChanged(\n        \"window_height_px\",\n        metricsSnapshot.windowHeight ?? void 0\n      ),\n      window_width_px: vct.sendIfChanged(\n        \"window_width_px\",\n        metricsSnapshot.windowWidth ?? void 0\n      )\n    });\n    const internalEvents = eventBuffer.getInternalEvents();\n    try {\n      await opts?.onPlaybackEvents?.(internalEvents);\n    } catch (e) {\n      console.error(e);\n      eventBuffer.onInternalFailure(internalEvents);\n    }\n    const metricsUrl = currentState.metricsReportingUrl;\n    if (metricsUrl) {\n      const abortController = new AbortController();\n      const id = setTimeout(\n        () => abortController.abort(),\n        interval - 500\n        // we abort 500ms before the next request is scheduled\n      );\n      const externalEvents = eventBuffer.getExternalEvents();\n      if (isUnloading && externalEvents.length === 0) {\n        return;\n      }\n      try {\n        const windowHref = typeof window !== \"undefined\" ? window?.location?.href ?? null : null;\n        const pageUrlString = isInIframe2() ? typeof document !== \"undefined\" ? document?.referrer || windowHref : windowHref : windowHref;\n        const pageUrl = pageUrlString ? new URL(pageUrlString) : null;\n        const playerPrefix = currentState?.currentSource?.type ?? \"unknown\";\n        const version = currentState?.__device.version ?? \"unknown\";\n        const sessionData = {\n          live: currentState.live,\n          session_id: currentControlsState.sessionToken,\n          playback_id: currentControlsState.playbackId,\n          protocol: currentState.currentSource.mime ?? void 0,\n          domain: pageUrl?.hostname ?? null,\n          path: pageUrl?.pathname ?? null,\n          params: pageUrl?.search ?? null,\n          hash: pageUrl?.hash ?? null,\n          source_url: currentState.currentSource.src,\n          player: playerPrefix,\n          version,\n          user_agent: String(currentState?.__device?.userAgent ?? \"\").replace(\n            /\\\\|\"/gm,\n            \"\"\n          ),\n          uid: currentState.__initialProps.viewerId ?? void 0,\n          events: externalEvents\n        };\n        const data = JSON.stringify(sessionData);\n        if (isUnloading && isSendBeaconAvailable) {\n          const success = window?.navigator?.sendBeacon?.(metricsUrl, data);\n          if (!success) {\n            throw new Error(\"Beacon response was not OK\");\n          }\n        } else {\n          const response = await fetch(metricsUrl, {\n            method: \"POST\",\n            mode: \"cors\",\n            body: data,\n            signal: abortController.signal\n          });\n          await response.text();\n          if (!response.ok) {\n            throw new Error(\"Fetch response was not OK\");\n          }\n        }\n      } catch (e) {\n        console.error(\n          new Error(\n            e?.message ?? \"Error with metrics reporting, re-enqueuing events...\"\n          )\n        );\n        eventBuffer.onExternalFailure(externalEvents);\n      } finally {\n        clearTimeout(id);\n      }\n    }\n  };\n  const eventsTimer = setInterval(sendEvents(), interval);\n  const unloadEvent = \"onpagehide\" in self ? \"pagehide\" : \"unload\";\n  const unloadingCallback = sendEvents({ isUnloading: true });\n  window?.addEventListener?.(unloadEvent, unloadingCallback);\n  const onVisibilityChange = async () => {\n    if (document.visibilityState === \"hidden\") {\n      return unloadingCallback();\n    }\n  };\n  window?.addEventListener?.(\"visibilitychange\", onVisibilityChange);\n  return {\n    destroy: () => {\n      if (eventsTimer) {\n        clearInterval?.(eventsTimer);\n      }\n      destroyCanPlayListener?.();\n      destroyClipListener?.();\n      destroyEndedListener?.();\n      destroyErrorListener?.();\n      destroyFinalUrlListener?.();\n      destroyFullscreenListener?.();\n      destroyPipListener?.();\n      destroyPlayListener?.();\n      destroyPauseListener?.();\n      destroyRateChangeListener?.();\n      destroySeekListener?.();\n      destroyVideoQualityListener?.();\n      window?.removeEventListener?.(\"visibilitychange\", onVisibilityChange);\n    }\n  };\n}\nfunction isInIframe2() {\n  try {\n    return typeof window !== \"undefined\" && window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nvar PlaybackEventBuffer = class {\n  internalBuffer = [];\n  externalBuffer = [];\n  // we cap at 25k events, which assumed that each event could be max 200 bytes\n  // this should be revised when event structure changes\n  maxBufferSize = 25e3;\n  addEvent(event) {\n    this.addEvents([event]);\n  }\n  addEvents(events) {\n    for (const newEvent of [...events]) {\n      if (newEvent.type !== \"heartbeat\") {\n        this.externalBuffer.push(newEvent);\n        continue;\n      }\n      const existingEventIndex = this.externalBuffer.findIndex(\n        (event) => event.type === \"heartbeat\"\n      );\n      if (existingEventIndex === -1) {\n        this.externalBuffer.push(newEvent);\n      } else {\n        const existingEvent = this.externalBuffer[existingEventIndex];\n        const mergedEvent = {\n          ...existingEvent,\n          id: existingEvent.id,\n          timestamp: Math.max(existingEvent.timestamp, newEvent.timestamp),\n          oldest_buffer_timestamp: Math.min(\n            Math.min(\n              existingEvent.oldest_buffer_timestamp ?? Number.MAX_SAFE_INTEGER,\n              newEvent.timestamp ?? Number.MAX_SAFE_INTEGER\n            ),\n            existingEvent.timestamp\n          ),\n          errors: existingEvent.errors + newEvent.errors,\n          warnings: existingEvent.warnings + newEvent.warnings,\n          stalled_count: existingEvent.stalled_count + newEvent.stalled_count,\n          waiting_count: existingEvent.waiting_count + newEvent.waiting_count,\n          time_warning_ms: existingEvent.time_warning_ms + newEvent.time_warning_ms,\n          time_errored_ms: existingEvent.time_errored_ms + newEvent.time_errored_ms,\n          time_stalled_ms: existingEvent.time_stalled_ms + newEvent.time_stalled_ms,\n          time_playing_ms: existingEvent.time_playing_ms + newEvent.time_playing_ms,\n          time_waiting_ms: existingEvent.time_waiting_ms + newEvent.time_waiting_ms,\n          ...existingEvent.mount_to_first_frame_ms || newEvent.mount_to_first_frame_ms ? {\n            mount_to_first_frame_ms: (existingEvent.mount_to_first_frame_ms ?? 0) + (newEvent.mount_to_first_frame_ms ?? 0)\n          } : {},\n          ...existingEvent.mount_to_play_ms || newEvent.mount_to_play_ms ? {\n            mount_to_play_ms: (existingEvent.mount_to_play_ms ?? 0) + (newEvent.mount_to_play_ms ?? 0)\n          } : {},\n          ...existingEvent.play_to_first_frame_ms || newEvent.play_to_first_frame_ms ? {\n            play_to_first_frame_ms: (existingEvent.play_to_first_frame_ms ?? 0) + (newEvent.play_to_first_frame_ms ?? 0)\n          } : {}\n        };\n        this.externalBuffer[existingEventIndex] = mergedEvent;\n      }\n    }\n    this.internalBuffer = [...events, ...this.internalBuffer];\n    this.trimBuffer();\n  }\n  getInternalEvents() {\n    const eventsToSend = [...this.internalBuffer];\n    this.internalBuffer = [];\n    return eventsToSend;\n  }\n  getExternalEvents() {\n    const eventsToSend = [...this.externalBuffer];\n    this.externalBuffer = [];\n    return eventsToSend;\n  }\n  onInternalFailure(pendingEvents) {\n    this.internalBuffer = [...this.internalBuffer, ...pendingEvents];\n    this.trimBuffer();\n  }\n  onExternalFailure(pendingEvents) {\n    this.externalBuffer = [...this.externalBuffer, ...pendingEvents];\n    this.trimBuffer();\n  }\n  trimBuffer() {\n    if (this.internalBuffer.length > this.maxBufferSize) {\n      const excess = this.internalBuffer.length - this.maxBufferSize;\n      this.internalBuffer = this.internalBuffer.slice(excess);\n    }\n    if (this.externalBuffer.length > this.maxBufferSize) {\n      const excess = this.externalBuffer.length - this.maxBufferSize;\n      this.externalBuffer = this.externalBuffer.slice(excess);\n    }\n  }\n};\nvar IncrementalCounter = class {\n  counts;\n  constructor(keys) {\n    this.counts = keys.reduce(\n      (acc, key) => {\n        acc[key] = 0;\n        return acc;\n      },\n      {}\n    );\n  }\n  calculateIncrement(key, newCount) {\n    if (newCount < this.counts[key]) {\n      return 0;\n    }\n    const increment = newCount - this.counts[key];\n    this.counts[key] = newCount;\n    return increment;\n  }\n};\nvar ValueChangeTracker = class {\n  lastValues;\n  constructor(keys) {\n    this.lastValues = keys.reduce(\n      (acc, key) => {\n        acc[key] = void 0;\n        return acc;\n      },\n      {}\n    );\n  }\n  sendIfChanged(key, newValue) {\n    if (this.lastValues[key] !== newValue) {\n      this.lastValues[key] = newValue;\n      return newValue;\n    }\n    return void 0;\n  }\n};\nvar Timer2 = class {\n  totalTime = 0;\n  countStarts = 0;\n  startTime = 0;\n  start() {\n    this.startTime = Date.now();\n    this.countStarts++;\n  }\n  stop() {\n    this.totalTime += this.startTime > 0 ? Date.now() - this.startTime : 0;\n    this.startTime = 0;\n  }\n  getTotalTime() {\n    this.totalTime += this.startTime > 0 ? Date.now() - this.startTime : 0;\n    this.startTime = this.startTime > 0 ? Date.now() : 0;\n    return this.totalTime;\n  }\n  getCountStarts() {\n    return this.countStarts;\n  }\n};\nvar MetricsMonitor = class {\n  retryCount = 0;\n  connected = false;\n  store;\n  destroy;\n  firstFrameTimestamp = null;\n  currentMetrics;\n  previousMetrics = null;\n  timerErrored = new Timer2();\n  timerWaiting = new Timer2();\n  timerStalled = new Timer2();\n  timerWarning = new Timer2();\n  timerPlaying = new Timer2();\n  constructor(store, opts) {\n    this.store = store;\n    this.currentMetrics = {\n      mountToPlay: null,\n      mountToFirstFrame: null,\n      playToFirstFrame: null,\n      duration: null,\n      errorCount: 0,\n      warningCount: 0,\n      offset: null,\n      playerHeight: null,\n      playerWidth: null,\n      stalledCount: 0,\n      timeErrored: 0,\n      timeWarning: 0,\n      timeStalled: 0,\n      timePlaying: 0,\n      timeWaiting: 0,\n      videoHeight: null,\n      videoWidth: null,\n      waitingCount: 0,\n      windowHeight: null,\n      windowWidth: null\n    };\n    const destroyFirstPlayListener = store.subscribe(\n      (state) => state.__controls.playLastTime,\n      async (playLastTime) => {\n        if (playLastTime >= 0) {\n          if (this.currentMetrics.mountToPlay === null) {\n            this.currentMetrics.mountToPlay = Math.max(\n              playLastTime - globalLoadTimestampMs,\n              0\n            );\n          }\n        }\n      }\n    );\n    const destroyPlayingListener = store.subscribe(\n      (state) => state.playing,\n      async (playing) => {\n        if (playing) {\n          this.timerWarning.stop();\n          this.timerErrored.stop();\n          this.timerStalled.stop();\n          this.timerWaiting.stop();\n          this.timerPlaying.start();\n        } else {\n          this.timerPlaying.stop();\n        }\n      }\n    );\n    const destroyPlayLastTimeListener = store.subscribe(\n      (state) => state.__controls.playLastTime,\n      async (playLastTime) => {\n        if (playLastTime >= 0) {\n          this.timerWarning.stop();\n          this.timerErrored.stop();\n          this.timerStalled.stop();\n          this.timerWaiting.stop();\n          this.timerPlaying.start();\n        }\n      }\n    );\n    const destroyProgressListener = store.subscribe(\n      (state) => state.progress,\n      async () => {\n        if (opts.disableProgressListener !== true && !this.timerPlaying.startTime) {\n          this.timerWarning.stop();\n          this.timerErrored.stop();\n          this.timerStalled.stop();\n          this.timerWaiting.stop();\n          this.timerPlaying.start();\n        }\n        const now = Date.now();\n        if (this.currentMetrics.mountToFirstFrame === null) {\n          this.currentMetrics.mountToFirstFrame = Math.max(\n            now - globalLoadTimestampMs,\n            0\n          );\n        }\n        if (this.currentMetrics.playToFirstFrame === null && this.currentMetrics.mountToPlay !== null) {\n          this.currentMetrics.playToFirstFrame = Math.max(\n            now - this.currentMetrics.mountToPlay - globalLoadTimestampMs,\n            0\n          );\n          this.firstFrameTimestamp = now;\n        }\n      }\n    );\n    const destroyErroredListener = store.subscribe(\n      (state) => state.error,\n      async (error) => {\n        if (error?.type) {\n          const isWarning = error.type === \"offline\" || error.type === \"fallback\";\n          if (isWarning) {\n            this.timerWarning.start();\n          } else {\n            this.timerErrored.start();\n          }\n          this.timerPlaying.stop();\n          if (isWarning) {\n            this.addWarning();\n          } else {\n            this.addError();\n          }\n        }\n      }\n    );\n    const destroyStalledListener = store.subscribe(\n      (state) => state.stalled,\n      async (stalled) => {\n        if (stalled) {\n          this.timerStalled.start();\n          this.timerPlaying.stop();\n        }\n      }\n    );\n    const destroyWaitingListener = store.subscribe(\n      (state) => state.waiting,\n      async (waiting) => {\n        if (waiting) {\n          this.timerWaiting.start();\n          this.timerPlaying.stop();\n        }\n      }\n    );\n    this.destroy = () => {\n      destroyErroredListener?.();\n      destroyFirstPlayListener?.();\n      destroyPlayingListener?.();\n      destroyPlayLastTimeListener?.();\n      destroyProgressListener?.();\n      destroyStalledListener?.();\n      destroyWaitingListener?.();\n    };\n  }\n  addError() {\n    this.currentMetrics.errorCount = this.currentMetrics.errorCount + 1;\n  }\n  addWarning() {\n    this.currentMetrics.warningCount = this.currentMetrics.warningCount + 1;\n  }\n  setConnected(isConnected) {\n    this.connected = isConnected;\n  }\n  getMetrics() {\n    const duration = this.store.getState().duration;\n    const currentMetrics = {\n      ...this.currentMetrics,\n      playerHeight: this.store.getState().__controls.size?.container?.height || null,\n      playerWidth: this.store.getState().__controls.size?.container?.width || null,\n      videoWidth: this.store.getState().__controls.size?.media?.width || null,\n      videoHeight: this.store.getState().__controls.size?.media?.height || null,\n      windowWidth: this.store.getState().__controls.size?.window?.width || null,\n      windowHeight: this.store.getState().__controls.size?.window?.height || null,\n      duration: Number.isFinite(duration) && !Number.isNaN(duration) ? Math.floor(duration * 1e3) : null,\n      waitingCount: this.timerWaiting.getCountStarts(),\n      stalledCount: this.timerStalled.getCountStarts(),\n      timeWarning: this.timerWarning.getTotalTime(),\n      timeErrored: this.timerErrored.getTotalTime(),\n      timeWaiting: this.timerWaiting.getTotalTime(),\n      timeStalled: this.timerStalled.getTotalTime(),\n      timePlaying: this.timerPlaying.getTotalTime(),\n      offset: this.store.getState().__controls.playbackOffsetMs ?? null\n    };\n    return currentMetrics;\n  }\n};\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC9tZWRpYS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFLNEI7QUFDa0I7O0FBRTlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3dDOztBQUV4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsZ0JBQWdCO0FBQ3pDLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxVQUFVLEVBQUUsS0FBSztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCx1QkFBdUIsRUFBRSxLQUFLO0FBQ3ZGO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHNEQUFjO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSwwQkFBMEIsMEJBQTBCLHNCQUFzQixhQUFhLEVBQUUsNEJBQTRCLHdCQUF3QixlQUFlLEVBQUUsNEJBQTRCLHdCQUF3QixjQUFjO0FBQ2hPLDBCQUEwQiwwQkFBMEIsc0JBQXNCLGFBQWEsRUFBRSw0QkFBNEIsd0JBQXdCLGVBQWUsRUFBRSw0QkFBNEIsd0JBQXdCLGNBQWM7QUFDaE8seUNBQXlDLGFBQWEsT0FBTyxjQUFjLEtBQUssYUFBYTtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxzQkFBc0IsSUFBSSxrQkFBa0I7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELCtCQUErQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNkJBQTZCLEdBQUcsOEJBQThCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCLEdBQUcsd0RBQXdELEdBQUcsNENBQTRDLEVBQUUsNEJBQTRCO0FBQ2xMO0FBQ0EsY0FBYyw0QkFBNEIsR0FBRyx3REFBd0Q7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixhQUFhLEdBQUcsUUFBUTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsY0FBYyxHQUFHLFNBQVM7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQyxJQUFJO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDdUM7O0FBRXZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsY0FBYyxJQUFJLG9CQUFvQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxtQkFBbUI7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxJQUFJO0FBQ2hCO0FBQ0E7QUFDQSxZQUFZLElBQUk7QUFDaEI7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uL25vZGVfbW9kdWxlcy9AbGl2ZXBlZXIvY29yZS9kaXN0L21lZGlhL2luZGV4LmpzPzc1NGMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL21lZGlhL2NvbnRyb2xsZXIudHNcbmltcG9ydCB7XG4gIGNyZWF0ZUpTT05TdG9yYWdlLFxuICBwZXJzaXN0LFxuICBzdWJzY3JpYmVXaXRoU2VsZWN0b3Jcbn0gZnJvbSBcInp1c3RhbmQvbWlkZGxld2FyZVwiO1xuaW1wb3J0IHsgY3JlYXRlU3RvcmUgfSBmcm9tIFwienVzdGFuZC92YW5pbGxhXCI7XG5cbi8vIHNyYy9tZWRpYS9lcnJvcnMudHNcbnZhciBTVFJFQU1fT1BFTl9FUlJPUl9NRVNTQUdFID0gXCJzdHJlYW0gb3BlbiBmYWlsZWRcIjtcbnZhciBTVFJFQU1fT0ZGTElORV9FUlJPUl9NRVNTQUdFID0gXCJzdHJlYW0gaXMgb2ZmbGluZVwiO1xudmFyIFNUUkVBTV9XQUlUSU5HX0ZPUl9EQVRBX0VSUk9SX01FU1NBR0UgPSBcInN0cmVhbSBpcyB3YWl0aW5nIGZvciBkYXRhXCI7XG52YXIgQUNDRVNTX0NPTlRST0xfRVJST1JfTUVTU0FHRSA9IFwic2h1dHRpbmcgZG93biBzaW5jZSB0aGlzIHNlc3Npb24gaXMgbm90IGFsbG93ZWQgdG8gdmlldyB0aGlzIHN0cmVhbVwiO1xudmFyIEJGUkFNRVNfRVJST1JfTUVTU0FHRSA9IFwibWV0YWRhdGEgaW5kaWNhdGVzIHRoYXQgd2VicnRjIHBsYXliYWNrIGNvbnRhaW5zIGJmcmFtZXNcIjtcbnZhciBOT1RfQUNDRVBUQUJMRV9FUlJPUl9NRVNTQUdFID0gXCJyZXNwb25zZSBpbmRpY2F0ZXMgdW5hY2NlcHRhYmxlIHBsYXliYWNrIHByb3RvY29sXCI7XG52YXIgUEVSTUlTU0lPTlNfRVJST1JfTUVTU0FHRSA9IFwidXNlciBkaWQgbm90IGFsbG93IHRoZSBwZXJtaXNzaW9ucyByZXF1ZXN0XCI7XG52YXIgaXNTdHJlYW1PZmZsaW5lRXJyb3IgPSAoZXJyb3IpID0+IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhTVFJFQU1fT1BFTl9FUlJPUl9NRVNTQUdFKSB8fCBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoU1RSRUFNX1dBSVRJTkdfRk9SX0RBVEFfRVJST1JfTUVTU0FHRSkgfHwgZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFNUUkVBTV9PRkZMSU5FX0VSUk9SX01FU1NBR0UpO1xudmFyIGlzQWNjZXNzQ29udHJvbEVycm9yID0gKGVycm9yKSA9PiBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoQUNDRVNTX0NPTlRST0xfRVJST1JfTUVTU0FHRSk7XG52YXIgaXNCZnJhbWVzRXJyb3IgPSAoZXJyb3IpID0+IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhCRlJBTUVTX0VSUk9SX01FU1NBR0UpO1xudmFyIGlzTm90QWNjZXB0YWJsZUVycm9yID0gKGVycm9yKSA9PiBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoTk9UX0FDQ0VQVEFCTEVfRVJST1JfTUVTU0FHRSk7XG52YXIgaXNQZXJtaXNzaW9uc0Vycm9yID0gKGVycm9yKSA9PiBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoUEVSTUlTU0lPTlNfRVJST1JfTUVTU0FHRSk7XG5cbi8vIHNyYy9tZWRpYS91dGlscy50c1xuaW1wb3J0IHsgY3VzdG9tQWxwaGFiZXQgfSBmcm9tIFwibmFub2lkXCI7XG5cbi8vIHNyYy9tZWRpYS9tZXRyaWNzLXV0aWxzLnRzXG52YXIgZ2V0TWV0cmljc1JlcG9ydGluZ1BPU1RVcmwgPSBhc3luYyAob3B0cykgPT4ge1xuICBjb25zdCByZXNvbHZlZFJlcG9ydGluZ1VybCA9IGF3YWl0IGdldE1ldHJpY3NSZXBvcnRpbmdVcmwoe1xuICAgIHBsYXliYWNrVXJsOiBvcHRzLnBsYXliYWNrVXJsLFxuICAgIHBhdGg6IFwiL2FuYWx5dGljcy9sb2dcIlxuICB9KTtcbiAgaWYgKCFyZXNvbHZlZFJlcG9ydGluZ1VybCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiByZXNvbHZlZFJlcG9ydGluZ1VybD8udG9TdHJpbmc/LigpID8/IG51bGw7XG59O1xudmFyIGdldE1ldHJpY3NSZXBvcnRpbmdXZWJzb2NrZXRVcmwgPSBhc3luYyAob3B0cykgPT4ge1xuICBpZiAoIW9wdHMucGxheWJhY2tJZCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHJlc29sdmVkUmVwb3J0aW5nVXJsID0gYXdhaXQgZ2V0TWV0cmljc1JlcG9ydGluZ1VybCh7XG4gICAgcGxheWJhY2tVcmw6IG9wdHMucGxheWJhY2tVcmwsXG4gICAgcGF0aDogYC9qc29uX3ZpZGVvKyR7b3B0cy5wbGF5YmFja0lkfS5qc2BcbiAgfSk7XG4gIGlmICghcmVzb2x2ZWRSZXBvcnRpbmdVcmwpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXNvbHZlZFJlcG9ydGluZ1VybC5wcm90b2NvbCA9IFwid3NzOlwiO1xuICBpZiAocmVzb2x2ZWRSZXBvcnRpbmdVcmwgJiYgb3B0cy5zZXNzaW9uVG9rZW4pIHtcbiAgICByZXNvbHZlZFJlcG9ydGluZ1VybC5zZWFyY2hQYXJhbXMuc2V0KFwidGtuXCIsIG9wdHMuc2Vzc2lvblRva2VuKTtcbiAgfVxuICByZXR1cm4gcmVzb2x2ZWRSZXBvcnRpbmdVcmw/LnRvU3RyaW5nPy4oKSA/PyBudWxsO1xufTtcbnZhciBMUF9ET01BSU5TID0gW1wibGl2ZXBlZXJcIiwgXCJsaXZlcGVlcmNkblwiLCBcImxwLXBsYXliYWNrXCJdO1xudmFyIGdldE1ldHJpY3NSZXBvcnRpbmdVcmwgPSBhc3luYyAoe1xuICBwbGF5YmFja1VybCxcbiAgcGF0aFxufSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFBsYXliYWNrVXJsID0gbmV3IFVSTChwbGF5YmFja1VybCk7XG4gICAgY29uc3Qgc3BsaXRIb3N0ID0gcGFyc2VkUGxheWJhY2tVcmwuaG9zdC5zcGxpdChcIi5cIik7XG4gICAgY29uc3QgaW5jbHVkZXNEb21haW4gPSBMUF9ET01BSU5TLmluY2x1ZGVzKFxuICAgICAgc3BsaXRIb3N0Py5bc3BsaXRIb3N0Lmxlbmd0aCAtIDJdID8/IFwiXCJcbiAgICApO1xuICAgIGNvbnN0IHRsZCA9IHNwbGl0SG9zdD8uW3NwbGl0SG9zdD8ubGVuZ3RoIC0gMV0gPz8gbnVsbDtcbiAgICBjb25zdCB0bGRNYXBwZWQgPSB0bGQgPT09IFwiY29tXCIgPyBcInN0dWRpb1wiIDogdGxkID09PSBcInN0dWRpb1wiID8gXCJzdHVkaW9cIiA6IHRsZCA9PT0gXCJmdW5cIiA/IFwiZnVuOjIwNDQzXCIgOiB0bGQgPT09IFwibW9uc3RlclwiID8gXCJtb25zdGVyXCIgOiBudWxsO1xuICAgIGlmIChpbmNsdWRlc0RvbWFpbiAmJiB0bGRNYXBwZWQpIHtcbiAgICAgIGNvbnN0IGlzQ2F0YWx5c3RQbGF5YmFjayA9IHBhcnNlZFBsYXliYWNrVXJsLmhvc3QuaW5jbHVkZXMoXCJjYXRhbHlzdFwiKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGdldFJlZGlyZWN0ZWRVcmwgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICAgIGBodHRwczovL3BsYXliYWNrLmxpdmVwZWVyLiR7dGxkTWFwcGVkfSR7cGF0aH1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlPy51cmwgPz8gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZmluYWxVcmwgPSBpc0NhdGFseXN0UGxheWJhY2sgPyBgaHR0cHM6Ly8ke3BhcnNlZFBsYXliYWNrVXJsLmhvc3R9JHtwYXRofWAgOiBhd2FpdCBnZXRSZWRpcmVjdGVkVXJsKCk7XG4gICAgICAgIGNvbnN0IHVybCA9IGZpbmFsVXJsID8gbmV3IFVSTChmaW5hbFVybCkgOiBudWxsO1xuICAgICAgICByZXR1cm4gdXJsID8/IG51bGw7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkNvdWxkIG5vdCBmZXRjaCByZXBvcnRpbmcgVVJMLlwiLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3I/Lm1lc3NhZ2UpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbnZhciBBU1NFVF9VUkxfUEFSVF9WQUxVRSA9IFwiaGxzXCI7XG52YXIgRkxWX1VSTF9QQVJUX1ZBTFVFID0gXCJmbHZcIjtcbnZhciBXRUJSVENfVVJMX1BBUlRfVkFMVUUgPSBcIndlYnJ0Y1wiO1xudmFyIFJFQ09SRElOR19VUkxfUEFSVF9WQUxVRSA9IFwicmVjb3JkaW5nc1wiO1xudmFyIGdldFBsYXliYWNrSWRGcm9tU291cmNlVXJsID0gKHNvdXJjZVVybCkgPT4ge1xuICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHNvdXJjZVVybCk7XG4gIGNvbnN0IHBhcnRzID0gcGFyc2VkVXJsLnBhdGhuYW1lLnNwbGl0KFwiL1wiKTtcbiAgY29uc3QgaW5jbHVkZXNBc3NldFVybCA9IHBhcnRzLmluY2x1ZGVzKEFTU0VUX1VSTF9QQVJUX1ZBTFVFKTtcbiAgY29uc3QgaW5jbHVkZXNXZWJSdGNVcmwgPSBwYXJ0cy5pbmNsdWRlcyhXRUJSVENfVVJMX1BBUlRfVkFMVUUpO1xuICBjb25zdCBpbmNsdWRlc0ZsdlVybCA9IHBhcnRzLmluY2x1ZGVzKEZMVl9VUkxfUEFSVF9WQUxVRSk7XG4gIGNvbnN0IGluY2x1ZGVzUmVjb3JkaW5nID0gcGFydHMuaW5jbHVkZXMoUkVDT1JESU5HX1VSTF9QQVJUX1ZBTFVFKTtcbiAgY29uc3QgcGxheWJhY2tJZCA9IGluY2x1ZGVzV2ViUnRjVXJsIHx8IGluY2x1ZGVzRmx2VXJsID8gcGFydHM/LlsocGFydHM/Lmxlbmd0aCA/PyAwKSAtIDFdIDogaW5jbHVkZXNSZWNvcmRpbmcgfHwgaW5jbHVkZXNBc3NldFVybCA/IHBhcnRzPy5bKHBhcnRzPy5sZW5ndGggPz8gMCkgLSAyXSA/PyBudWxsIDogbnVsbDtcbiAgaWYgKHBsYXliYWNrSWQ/LmluY2x1ZGVzKFwiK1wiKSkge1xuICAgIGNvbnN0IHNwbGl0ID0gcGxheWJhY2tJZC5zcGxpdChcIitcIik/LlsxXTtcbiAgICBpZiAoc3BsaXQpIHtcbiAgICAgIHJldHVybiBzcGxpdDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBsYXliYWNrSWQgPz8gbnVsbDtcbn07XG5cbi8vIHNyYy9tZWRpYS9taW1lLnRzXG52YXIgZ2V0TWltZVR5cGUgPSAoZW5kaW5nKSA9PiB7XG4gIGZvciAoY29uc3QgdmFsdWUgb2YgT2JqZWN0LmtleXMobWltZSkpIHtcbiAgICBpZiAobWltZVt2YWx1ZV0/LnNvbWUoKHYpID0+IHYgPT09IGVuZGluZykpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xudmFyIG1pbWUgPSB7XG4gIFwiYXBwbGljYXRpb24vbXA0XCI6IFtcIm1wNHNcIiwgXCJtNHBcIl0sXG4gIFwiYXBwbGljYXRpb24vb2dnXCI6IFtcIm9neFwiXSxcbiAgXCJhcHBsaWNhdGlvbi92bmQuYXBwbGUubXBlZ3VybFwiOiBbXCJtM3U4XCJdLFxuICBcImF1ZGlvLzNncHBcIjogW1wiKjNncHBcIl0sXG4gIFwiYXVkaW8vYWRwY21cIjogW1wiYWRwXCJdLFxuICBcImF1ZGlvL2FtclwiOiBbXCJhbXJcIl0sXG4gIFwiYXVkaW8vYmFzaWNcIjogW1wiYXVcIiwgXCJzbmRcIl0sXG4gIFwiYXVkaW8vbWlkaVwiOiBbXCJtaWRcIiwgXCJtaWRpXCIsIFwia2FyXCIsIFwicm1pXCJdLFxuICBcImF1ZGlvL21vYmlsZS14bWZcIjogW1wibXhtZlwiXSxcbiAgXCJhdWRpby9tcDNcIjogW1wiKm1wM1wiXSxcbiAgXCJhdWRpby9tcDRcIjogW1wibTRhXCIsIFwibXA0YVwiXSxcbiAgXCJhdWRpby9tcGVnXCI6IFtcIm1wZ2FcIiwgXCJtcDJcIiwgXCJtcDJhXCIsIFwibXAzXCIsIFwibTJhXCIsIFwibTNhXCJdLFxuICBcImF1ZGlvL29nZ1wiOiBbXCJvZ2FcIiwgXCJvZ2dcIiwgXCJzcHhcIiwgXCJvcHVzXCJdLFxuICBcImF1ZGlvL3MzbVwiOiBbXCJzM21cIl0sXG4gIFwiYXVkaW8vc2lsa1wiOiBbXCJzaWxcIl0sXG4gIFwiYXVkaW8vdm5kLmRlY2UuYXVkaW9cIjogW1widXZhXCIsIFwidXZ2YVwiXSxcbiAgXCJhdWRpby92bmQuZGlnaXRhbC13aW5kc1wiOiBbXCJlb2xcIl0sXG4gIFwiYXVkaW8vdm5kLmRyYVwiOiBbXCJkcmFcIl0sXG4gIFwiYXVkaW8vdm5kLmR0cy5oZFwiOiBbXCJkdHNoZFwiXSxcbiAgXCJhdWRpby92bmQuZHRzXCI6IFtcImR0c1wiXSxcbiAgXCJhdWRpby92bmQubHVjZW50LnZvaWNlXCI6IFtcImx2cFwiXSxcbiAgXCJhdWRpby92bmQubXMtcGxheXJlYWR5Lm1lZGlhLnB5YVwiOiBbXCJweWFcIl0sXG4gIFwiYXVkaW8vdm5kLm51ZXJhLmVjZWxwNDgwMFwiOiBbXCJlY2VscDQ4MDBcIl0sXG4gIFwiYXVkaW8vdm5kLm51ZXJhLmVjZWxwNzQ3MFwiOiBbXCJlY2VscDc0NzBcIl0sXG4gIFwiYXVkaW8vdm5kLm51ZXJhLmVjZWxwOTYwMFwiOiBbXCJlY2VscDk2MDBcIl0sXG4gIFwiYXVkaW8vdm5kLnJpcFwiOiBbXCJyaXBcIl0sXG4gIFwiYXVkaW8vd2F2XCI6IFtcIndhdlwiXSxcbiAgXCJhdWRpby93YXZlXCI6IFtcIip3YXZcIl0sXG4gIFwiYXVkaW8vd2VibVwiOiBbXCJ3ZWJhXCJdLFxuICBcImF1ZGlvL3gtYWFjXCI6IFtcImFhY1wiXSxcbiAgXCJhdWRpby94LWFpZmZcIjogW1wiYWlmXCIsIFwiYWlmZlwiLCBcImFpZmNcIl0sXG4gIFwiYXVkaW8veC1jYWZcIjogW1wiY2FmXCJdLFxuICBcImF1ZGlvL3gtZmxhY1wiOiBbXCJmbGFjXCJdLFxuICBcImF1ZGlvL3gtbTRhXCI6IFtcIiptNGFcIl0sXG4gIFwiYXVkaW8veC1tYXRyb3NrYVwiOiBbXCJta2FcIl0sXG4gIFwiYXVkaW8veC1tcGVndXJsXCI6IFtcIm0zdVwiXSxcbiAgXCJhdWRpby94LW1zLXdheFwiOiBbXCJ3YXhcIl0sXG4gIFwiYXVkaW8veC1tcy13bWFcIjogW1wid21hXCJdLFxuICBcImF1ZGlvL3gtcG4tcmVhbGF1ZGlvLXBsdWdpblwiOiBbXCJybXBcIl0sXG4gIFwiYXVkaW8veC1wbi1yZWFsYXVkaW9cIjogW1wicmFtXCIsIFwicmFcIl0sXG4gIFwiYXVkaW8veC1yZWFsYXVkaW9cIjogW1wiKnJhXCJdLFxuICBcImF1ZGlvL3gtd2F2XCI6IFtcIip3YXZcIl0sXG4gIFwiYXVkaW8veG1cIjogW1wieG1cIl0sXG4gIFwidmlkZW8vM2dwcFwiOiBbXCIzZ3BcIiwgXCIzZ3BwXCJdLFxuICBcInZpZGVvLzNncHAyXCI6IFtcIjNnMlwiXSxcbiAgXCJ2aWRlby9oMjYxXCI6IFtcImgyNjFcIl0sXG4gIFwidmlkZW8vaDI2M1wiOiBbXCJoMjYzXCJdLFxuICBcInZpZGVvL2gyNjRcIjogW1wiaDI2NFwiXSxcbiAgXCJ2aWRlby9pc28uc2VnbWVudFwiOiBbXCJtNHNcIl0sXG4gIFwidmlkZW8vanBlZ1wiOiBbXCJqcGd2XCJdLFxuICBcInZpZGVvL2pwbVwiOiBbXCIqanBtXCIsIFwianBnbVwiXSxcbiAgXCJ2aWRlby9tajJcIjogW1wibWoyXCIsIFwibWpwMlwiXSxcbiAgXCJ2aWRlby9tcDJ0XCI6IFtcInRzXCJdLFxuICBcInZpZGVvL21wNFwiOiBbXCJtcDRcIiwgXCJtcDR2XCIsIFwibXBnNFwiXSxcbiAgXCJ2aWRlby9tcGVnXCI6IFtcIm1wZWdcIiwgXCJtcGdcIiwgXCJtcGVcIiwgXCJtMXZcIiwgXCJtMnZcIl0sXG4gIFwidmlkZW8vb2dnXCI6IFtcIm9ndlwiXSxcbiAgXCJ2aWRlby9xdWlja3RpbWVcIjogW1wicXRcIiwgXCJtb3ZcIl0sXG4gIFwidmlkZW8vdm5kLmRlY2UuaGRcIjogW1widXZoXCIsIFwidXZ2aFwiXSxcbiAgXCJ2aWRlby92bmQuZGVjZS5tb2JpbGVcIjogW1widXZtXCIsIFwidXZ2bVwiXSxcbiAgXCJ2aWRlby92bmQuZGVjZS5wZFwiOiBbXCJ1dnBcIiwgXCJ1dnZwXCJdLFxuICBcInZpZGVvL3ZuZC5kZWNlLnNkXCI6IFtcInV2c1wiLCBcInV2dnNcIl0sXG4gIFwidmlkZW8vdm5kLmRlY2UudmlkZW9cIjogW1widXZ2XCIsIFwidXZ2dlwiXSxcbiAgXCJ2aWRlby92bmQuZHZiLmZpbGVcIjogW1wiZHZiXCJdLFxuICBcInZpZGVvL3ZuZC5mdnRcIjogW1wiZnZ0XCJdLFxuICBcInZpZGVvL3ZuZC5tcGVndXJsXCI6IFtcIm14dVwiLCBcIm00dVwiXSxcbiAgXCJ2aWRlby92bmQubXMtcGxheXJlYWR5Lm1lZGlhLnB5dlwiOiBbXCJweXZcIl0sXG4gIFwidmlkZW8vdm5kLnV2dnUubXA0XCI6IFtcInV2dVwiLCBcInV2dnVcIl0sXG4gIFwidmlkZW8vdm5kLnZpdm9cIjogW1widml2XCJdLFxuICBcInZpZGVvL3ZwOFwiOiBbXCJ2cDhcIl0sXG4gIFwidmlkZW8vd2VibVwiOiBbXCJ3ZWJtXCJdLFxuICBcInZpZGVvL3gtZjR2XCI6IFtcImY0dlwiXSxcbiAgXCJ2aWRlby94LWZsaVwiOiBbXCJmbGlcIl0sXG4gIFwidmlkZW8veC1mbHZcIjogW1wiZmx2XCJdLFxuICBcInZpZGVvL3gtbTR2XCI6IFtcIm00dlwiXSxcbiAgXCJ2aWRlby94LW1hdHJvc2thXCI6IFtcIm1rdlwiLCBcIm1rM2RcIiwgXCJta3NcIl0sXG4gIFwidmlkZW8veC1tbmdcIjogW1wibW5nXCJdLFxuICBcInZpZGVvL3gtbXMtYXNmXCI6IFtcImFzZlwiLCBcImFzeFwiXSxcbiAgXCJ2aWRlby94LW1zLXZvYlwiOiBbXCJ2b2JcIl0sXG4gIFwidmlkZW8veC1tcy13bVwiOiBbXCJ3bVwiXSxcbiAgXCJ2aWRlby94LW1zLXdtdlwiOiBbXCJ3bXZcIl0sXG4gIFwidmlkZW8veC1tcy13bXhcIjogW1wid214XCJdLFxuICBcInZpZGVvL3gtbXMtd3Z4XCI6IFtcInd2eFwiXSxcbiAgXCJ2aWRlby94LW1zdmlkZW9cIjogW1wiYXZpXCJdLFxuICBcInZpZGVvL3gtc2dpLW1vdmllXCI6IFtcIm1vdmllXCJdLFxuICBcInZpZGVvL3gtc212XCI6IFtcInNtdlwiXVxufTtcblxuLy8gc3JjL21lZGlhL3NyYy50c1xudmFyIGF1ZGlvRXh0ZW5zaW9ucyA9IC9cXC4obTRhfG1wNGF8bXBnYXxtcDJ8bXAyYXxtcDN8bTJhfG0zYXx3YXZ8d2ViYXxhYWN8b2dhfHNweCkoJHxcXD8pL2k7XG52YXIgYmFzZTY0U3RyaW5nID0gL2RhdGE6dmlkZW8vaTtcbnZhciBobHNFeHRlbnNpb25zID0gL1xcLihtM3U4KSgkfFxcPykvaTtcbnZhciBmbHZFeHRlbnNpb25zID0gL1xcLyhmbHYpXFwvL2k7XG52YXIgaW1hZ2VFeHRlbnNpb25zID0gL1xcLihqcGd8anBlZ3xwbmd8Z2lmfGJtcHx3ZWJwKSgkfFxcPykvaTtcbnZhciB2dHRFeHRlbnNpb25zID0gL1xcLih2dHQpKCR8XFw/KS9pO1xudmFyIG1pbWVGcm9tQmFzZTY0UGF0dGVybiA9IC9kYXRhOiguKz8pO2Jhc2U2NC87XG52YXIgdmlkZW9FeHRlbnNpb25zID0gL1xcLihtcDR8b2d2fHdlYm18bW92fG00dnxhdml8bTN1OCkoJHxcXD8pL2k7XG52YXIgd2VicnRjRXh0ZW5zaW9ucyA9IC8od2VicnRjfHNkcCkvaTtcbnZhciBnZXRNZWRpYVNvdXJjZVR5cGUgPSAoc3JjLCBvcHRzKSA9PiB7XG4gIGlmICghc3JjKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3Qgc291cmNlVGVzdCA9IHNyYz8udG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgYmFzZTY0TWltZSA9IHNvdXJjZVRlc3QubWF0Y2gobWltZUZyb21CYXNlNjRQYXR0ZXJuKTtcbiAgY29uc3QgcmVzb2x2ZWRXaWR0aCA9IG9wdHM/LnNpemluZz8ud2lkdGggPz8gbnVsbDtcbiAgY29uc3QgcmVzb2x2ZWRIZWlnaHQgPSBvcHRzPy5zaXppbmc/LmhlaWdodCA/PyBudWxsO1xuICByZXR1cm4gd2VicnRjRXh0ZW5zaW9ucy50ZXN0KHNvdXJjZVRlc3QpID8ge1xuICAgIHR5cGU6IFwid2VicnRjXCIsXG4gICAgc3JjLFxuICAgIG1pbWU6IFwidmlkZW8vaDI2NFwiLFxuICAgIHdpZHRoOiByZXNvbHZlZFdpZHRoLFxuICAgIGhlaWdodDogcmVzb2x2ZWRIZWlnaHRcbiAgfSA6IGhsc0V4dGVuc2lvbnMudGVzdChzb3VyY2VUZXN0KSA/IHtcbiAgICB0eXBlOiBcImhsc1wiLFxuICAgIHNyYyxcbiAgICBtaW1lOiBnZXRNaW1lVHlwZShobHNFeHRlbnNpb25zLmV4ZWMoc291cmNlVGVzdCk/LlsxXSA/PyBcIlwiKSxcbiAgICB3aWR0aDogcmVzb2x2ZWRXaWR0aCxcbiAgICBoZWlnaHQ6IHJlc29sdmVkSGVpZ2h0XG4gIH0gOiB2aWRlb0V4dGVuc2lvbnMudGVzdChzb3VyY2VUZXN0KSA/IHtcbiAgICB0eXBlOiBcInZpZGVvXCIsXG4gICAgc3JjLFxuICAgIG1pbWU6IGdldE1pbWVUeXBlKHZpZGVvRXh0ZW5zaW9ucy5leGVjKHNvdXJjZVRlc3QpPy5bMV0gPz8gXCJcIiksXG4gICAgd2lkdGg6IHJlc29sdmVkV2lkdGgsXG4gICAgaGVpZ2h0OiByZXNvbHZlZEhlaWdodFxuICB9IDogYXVkaW9FeHRlbnNpb25zLnRlc3Qoc291cmNlVGVzdCkgPyB7XG4gICAgdHlwZTogXCJhdWRpb1wiLFxuICAgIHNyYyxcbiAgICBtaW1lOiBnZXRNaW1lVHlwZShhdWRpb0V4dGVuc2lvbnMuZXhlYyhzb3VyY2VUZXN0KT8uWzFdID8/IFwiXCIpLFxuICAgIHdpZHRoOiByZXNvbHZlZFdpZHRoLFxuICAgIGhlaWdodDogcmVzb2x2ZWRIZWlnaHRcbiAgfSA6IGJhc2U2NFN0cmluZy50ZXN0KHNvdXJjZVRlc3QpID8ge1xuICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICBzcmMsXG4gICAgbWltZTogYmFzZTY0TWltZSA/IGJhc2U2NE1pbWVbMV0gOiBcInZpZGVvL21wNFwiLFxuICAgIHdpZHRoOiByZXNvbHZlZFdpZHRoLFxuICAgIGhlaWdodDogcmVzb2x2ZWRIZWlnaHRcbiAgfSA6IGltYWdlRXh0ZW5zaW9ucy50ZXN0KHNvdXJjZVRlc3QpID8ge1xuICAgIHR5cGU6IFwiaW1hZ2VcIixcbiAgICBzcmMsXG4gICAgbWltZTogZ2V0TWltZVR5cGUoXG4gICAgICBpbWFnZUV4dGVuc2lvbnMuZXhlYyhzb3VyY2VUZXN0KT8uWzFdID8/IFwiXCJcbiAgICApLFxuICAgIHdpZHRoOiByZXNvbHZlZFdpZHRoLFxuICAgIGhlaWdodDogcmVzb2x2ZWRIZWlnaHRcbiAgfSA6IHZ0dEV4dGVuc2lvbnMudGVzdChzb3VyY2VUZXN0KSA/IHtcbiAgICB0eXBlOiBcInZ0dFwiLFxuICAgIHNyYyxcbiAgICBtaW1lOiBnZXRNaW1lVHlwZShcbiAgICAgIHZ0dEV4dGVuc2lvbnMuZXhlYyhzb3VyY2VUZXN0KT8uWzFdID8/IFwiXCJcbiAgICApLFxuICAgIHdpZHRoOiBudWxsLFxuICAgIGhlaWdodDogbnVsbFxuICB9IDogZmx2RXh0ZW5zaW9ucy50ZXN0KHNvdXJjZVRlc3QpID8ge1xuICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICBzcmMsXG4gICAgbWltZTogXCJ2aWRlby94LWZsdlwiLFxuICAgIHdpZHRoOiByZXNvbHZlZFdpZHRoLFxuICAgIGhlaWdodDogcmVzb2x2ZWRIZWlnaHRcbiAgfSA6IG51bGw7XG59O1xuXG4vLyBzcmMvbWVkaWEvdXRpbHMudHNcbnZhciBERUZBVUxUX0FTUEVDVF9SQVRJTyA9IDE2IC8gOTtcbnZhciBnZXRGaWx0ZXJlZE5hTiA9ICh2YWx1ZSkgPT4gdmFsdWUgJiYgIU51bWJlci5pc05hTih2YWx1ZSkgJiYgTnVtYmVyLmlzRmluaXRlKHZhbHVlKSA/IHZhbHVlIDogMDtcbnZhciBnZXRCb3VuZGVkU2VlayA9IChzZWVrLCBkdXJhdGlvbikgPT4gTWF0aC5taW4oXG4gIE1hdGgubWF4KDAsIGdldEZpbHRlcmVkTmFOKHNlZWspKSxcbiAgLy8gc2VlayB0byBuZWFyIHRoZSBlbmRcbiAgZ2V0RmlsdGVyZWROYU4oZHVyYXRpb24pID8gZ2V0RmlsdGVyZWROYU4oZHVyYXRpb24pIC0gMC4wMSA6IDBcbik7XG52YXIgZ2V0Qm91bmRlZFJhdGUgPSAocmF0ZSkgPT4ge1xuICBpZiAodHlwZW9mIHJhdGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoMCwgZ2V0RmlsdGVyZWROYU4ocmF0ZSkpLCAyMCk7XG4gIH1cbiAgY29uc3QgbWF0Y2ggPSBTdHJpbmcocmF0ZSkubWF0Y2goLyhcXGQrKFxcLlxcZCspPykvKTtcbiAgcmV0dXJuIG1hdGNoID8gTWF0aC5taW4oTWF0aC5tYXgoMCwgZ2V0RmlsdGVyZWROYU4oTnVtYmVyLnBhcnNlRmxvYXQobWF0Y2hbMF0pKSksIDIwKSA6IDE7XG59O1xudmFyIGdldEJvdW5kZWRWb2x1bWUgPSAodm9sdW1lKSA9PiBNYXRoLm1pbihNYXRoLm1heCgwLCBnZXRGaWx0ZXJlZE5hTih2b2x1bWUpKSwgMSk7XG52YXIgbmFub2lkID0gY3VzdG9tQWxwaGFiZXQoXG4gIFwiMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIixcbiAgMjJcbik7XG52YXIgZ2VuZXJhdGVSYW5kb21Ub2tlbiA9ICgpID0+IHtcbiAgcmV0dXJuIG5hbm9pZCgpO1xufTtcbnZhciBnZXRDbGlwUGFyYW1zID0gKHtcbiAgcmVxdWVzdGVkVGltZSxcbiAgY2xpcExlbmd0aCxcbiAgcGxheWJhY2tPZmZzZXRNc1xufSkgPT4ge1xuICBjb25zdCBjdXJyZW50VGltZSA9IHJlcXVlc3RlZFRpbWUgPz8gRGF0ZS5ub3coKTtcbiAgY29uc3QgZXN0aW1hdGVkU2VydmVyQ2xpcFRpbWUgPSBjdXJyZW50VGltZSAtIChwbGF5YmFja09mZnNldE1zID8/IDApO1xuICBjb25zdCBzdGFydFRpbWUgPSBlc3RpbWF0ZWRTZXJ2ZXJDbGlwVGltZSAtIGNsaXBMZW5ndGggKiAxZTM7XG4gIGNvbnN0IGVuZFRpbWUgPSBlc3RpbWF0ZWRTZXJ2ZXJDbGlwVGltZTtcbiAgcmV0dXJuIHtcbiAgICBzdGFydFRpbWUsXG4gICAgZW5kVGltZVxuICB9O1xufTtcbnZhciBnZXRQcm9ncmVzc0FyaWEgPSAoe1xuICBwcm9ncmVzcyxcbiAgZHVyYXRpb24sXG4gIGxpdmVcbn0pID0+IHtcbiAgY29uc3QgcHJvZ3Jlc3NQYXJzZWQgPSBnZXRIb3Vyc01pbnV0ZXNTZWNvbmRzKHByb2dyZXNzID8/IG51bGwpO1xuICBjb25zdCBkdXJhdGlvblBhcnNlZCA9IGdldEhvdXJzTWludXRlc1NlY29uZHMoZHVyYXRpb24gPz8gbnVsbCk7XG4gIGNvbnN0IHByb2dyZXNzVGV4dCA9IGAke3Byb2dyZXNzUGFyc2VkLmhvdXJzID8gYCR7cHJvZ3Jlc3NQYXJzZWQuaG91cnN9IGhvdXJzIGAgOiBcIlwifSR7cHJvZ3Jlc3NQYXJzZWQubWludXRlcyA/IGAke3Byb2dyZXNzUGFyc2VkLm1pbnV0ZXN9IG1pbnV0ZXMgYCA6IFwiXCJ9JHtwcm9ncmVzc1BhcnNlZC5zZWNvbmRzID8gYCR7cHJvZ3Jlc3NQYXJzZWQuc2Vjb25kc30gc2Vjb25kc2AgOiBcIlwifWA7XG4gIGNvbnN0IGR1cmF0aW9uVGV4dCA9IGAke2R1cmF0aW9uUGFyc2VkLmhvdXJzID8gYCR7ZHVyYXRpb25QYXJzZWQuaG91cnN9IGhvdXJzIGAgOiBcIlwifSR7ZHVyYXRpb25QYXJzZWQubWludXRlcyA/IGAke2R1cmF0aW9uUGFyc2VkLm1pbnV0ZXN9IG1pbnV0ZXMgYCA6IFwiXCJ9JHtkdXJhdGlvblBhcnNlZC5zZWNvbmRzID8gYCR7ZHVyYXRpb25QYXJzZWQuc2Vjb25kc30gc2Vjb25kc2AgOiBcIlwifWA7XG4gIGNvbnN0IHByb2dyZXNzRGlzcGxheSA9IGxpdmUgPyBgTGl2ZSAke3Byb2dyZXNzVGV4dH1gIDogYCR7cHJvZ3Jlc3NUZXh0fSBvZiAke2R1cmF0aW9uVGV4dH1gO1xuICBjb25zdCBmb3JtYXR0ZWRUaW1lRGlzcGxheSA9IGdldEZvcm1hdHRlZEhvdXJzTWludXRlc1NlY29uZHMoXG4gICAgcHJvZ3Jlc3MgPz8gbnVsbFxuICApO1xuICBjb25zdCBmb3JtYXR0ZWREdXJhdGlvbiA9IGdldEZvcm1hdHRlZEhvdXJzTWludXRlc1NlY29uZHMoZHVyYXRpb24gPz8gbnVsbCk7XG4gIGNvbnN0IGZvcm1hdHRlZFRpbWUgPSBsaXZlID8gZm9ybWF0dGVkVGltZURpc3BsYXkgOiBgJHtmb3JtYXR0ZWRUaW1lRGlzcGxheX0gLyAke2Zvcm1hdHRlZER1cmF0aW9ufWA7XG4gIHJldHVybiB7XG4gICAgcHJvZ3Jlc3M6IHByb2dyZXNzRGlzcGxheSxcbiAgICB0aW1lOiBmb3JtYXR0ZWRUaW1lXG4gIH07XG59O1xudmFyIHNvcnRTb3VyY2VzID0gKHtcbiAgc3JjLFxuICB2aWRlb1F1YWxpdHksXG4gIHNjcmVlbldpZHRoLFxuICBhc3BlY3RSYXRpbyxcbiAgbG93TGF0ZW5jeSxcbiAgaGFzUmVjZW50V2ViUlRDVGltZW91dFxufSkgPT4ge1xuICBpZiAoIXNyYykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmICh0eXBlb2Ygc3JjID09PSBcInN0cmluZ1wiKSB7XG4gICAgY29uc3QgbWVkaWFTb3VyY2VUeXBlID0gZ2V0TWVkaWFTb3VyY2VUeXBlKHNyYyk7XG4gICAgcmV0dXJuIG1lZGlhU291cmNlVHlwZSA/IFttZWRpYVNvdXJjZVR5cGVdIDogbnVsbDtcbiAgfVxuICBjb25zdCBmaWx0ZXJlZFZpZGVvU291cmNlcyA9IHNyYy5maWx0ZXIoXG4gICAgKHMpID0+IHMudHlwZSA9PT0gXCJhdWRpb1wiIHx8IHMudHlwZSA9PT0gXCJobHNcIiB8fCBzLnR5cGUgPT09IFwid2VicnRjXCIgfHwgcy50eXBlID09PSBcInZpZGVvXCJcbiAgKS5maWx0ZXIoKHMpID0+IHtcbiAgICBpZiAocy50eXBlID09PSBcImhsc1wiICYmIGxvd0xhdGVuY3kgPT09IFwiZm9yY2VcIikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAocy50eXBlID09PSBcIndlYnJ0Y1wiICYmIChsb3dMYXRlbmN5ID09PSBmYWxzZSB8fCBoYXNSZWNlbnRXZWJSVENUaW1lb3V0KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG4gIGNvbnN0IHZpZGVvUXVhbGl0eURpbWVuc2lvbnMgPSBjYWxjdWxhdGVWaWRlb1F1YWxpdHlEaW1lbnNpb25zKFxuICAgIHZpZGVvUXVhbGl0eSxcbiAgICBhc3BlY3RSYXRpb1xuICApO1xuICBjb25zdCB0YXJnZXRXaWR0aCA9IHZpZGVvUXVhbGl0eURpbWVuc2lvbnM/LndpZHRoID8/IHNjcmVlbldpZHRoID8/IDEyODA7XG4gIGNvbnN0IHNvdXJjZVdpdGhQYXJlbnREZWx0YSA9IGZpbHRlcmVkVmlkZW9Tb3VyY2VzPy5tYXAoXG4gICAgKHMpID0+IHMudHlwZSA9PT0gXCJobHNcIiB8fCBzLnR5cGUgPT09IFwid2VicnRjXCIgPyB7IC4uLnMsIHBhcmVudFdpZHRoRGVsdGE6IG51bGwgfSA6IHtcbiAgICAgIC4uLnMsXG4gICAgICBwYXJlbnRXaWR0aERlbHRhOiAoXG4gICAgICAgIC8vIGZpcnN0IHdlIGNoZWNrIGlmIHRoZSBVUkwgY29udGFpbnMgdGhlIHZpZGVvIHF1YWxpdHkgc2VsZWN0b3JcbiAgICAgICAgdmlkZW9RdWFsaXR5ICYmIHZpZGVvUXVhbGl0eSAhPT0gXCJhdXRvXCIgJiYgcz8uc3JjPy5pbmNsdWRlcyh2aWRlb1F1YWxpdHkpID8gMCA6IChcbiAgICAgICAgICAvLyBvdGhlcndpc2UgdXNlIHRoZSB3aWR0aCBvZiB0aGUgc3JjXG4gICAgICAgICAgcz8ud2lkdGggPyBNYXRoLmFicyh0YXJnZXRXaWR0aCAtIHMud2lkdGgpIDogKFxuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGd1ZXNzIHRoZSB3aWR0aCBvZiB0aGUgc3JjIGJhc2VkIG9uIHRoZSB1cmxcbiAgICAgICAgICAgIHM/LnNyYy5pbmNsdWRlcyhcInN0YXRpYzM2MHBcIikgfHwgcz8uc3JjLmluY2x1ZGVzKFwibG93LWJpdHJhdGVcIikgPyBNYXRoLmFicyh0YXJnZXRXaWR0aCAtIDQ4MCkgOiBzPy5zcmMuaW5jbHVkZXMoXCJzdGF0aWM3MjBwXCIpID8gTWF0aC5hYnModGFyZ2V0V2lkdGggLSAxMjgwKSA6IHM/LnNyYy5pbmNsdWRlcyhcInN0YXRpYzEwODBwXCIpID8gTWF0aC5hYnModGFyZ2V0V2lkdGggLSAxOTIwKSA6IHM/LnNyYy5pbmNsdWRlcyhcInN0YXRpYzIxNjBwXCIpID8gTWF0aC5hYnModGFyZ2V0V2lkdGggLSAzODQwKSA6IG51bGxcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIClcbiAgICB9XG4gICkgPz8gW107XG4gIGNvbnN0IHNvcnRlZFNvdXJjZXMgPSBzb3VyY2VXaXRoUGFyZW50RGVsdGEuc29ydCgoYSwgYikgPT4ge1xuICAgIGlmIChhLnR5cGUgPT09IFwidmlkZW9cIiAmJiBiLnR5cGUgPT09IFwidmlkZW9cIikge1xuICAgICAgcmV0dXJuIGI/LnBhcmVudFdpZHRoRGVsdGEgIT09IG51bGwgJiYgYT8ucGFyZW50V2lkdGhEZWx0YSAhPT0gbnVsbCA/IGEucGFyZW50V2lkdGhEZWx0YSAtIGIucGFyZW50V2lkdGhEZWx0YSA6IDE7XG4gICAgfVxuICAgIGlmIChhLnR5cGUgPT09IFwidmlkZW9cIiAmJiAoYi50eXBlID09PSBcImhsc1wiIHx8IGIudHlwZSA9PT0gXCJ3ZWJydGNcIikpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKGEudHlwZSA9PT0gXCJ3ZWJydGNcIiAmJiBiLnR5cGUgPT09IFwiaGxzXCIpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDE7XG4gIH0pO1xuICByZXR1cm4gc29ydGVkU291cmNlcztcbn07XG52YXIgcGFyc2VDdXJyZW50U291cmNlQW5kUGxheWJhY2tJZCA9ICh7XG4gIGFjY2Vzc0tleSxcbiAgYXNwZWN0UmF0aW8sXG4gIHBsYXliYWNrUmF0ZSxcbiAgaXNIbHNTdXBwb3J0ZWQsXG4gIGp3dCxcbiAgc2Vzc2lvblRva2VuLFxuICBzb3VyY2UsXG4gIHZpZGVvUXVhbGl0eSxcbiAgaW5nZXN0UGxheWJhY2tcbn0pID0+IHtcbiAgaWYgKCFzb3VyY2UpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBwbGF5YmFja0lkID0gZ2V0UGxheWJhY2tJZEZyb21Tb3VyY2VVcmwoc291cmNlLnNyYyk7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoc291cmNlLnNyYyk7XG4gIGlmIChzZXNzaW9uVG9rZW4pIHtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLmFwcGVuZChcInRrblwiLCBzZXNzaW9uVG9rZW4pO1xuICB9XG4gIGlmIChzb3VyY2UudHlwZSAhPT0gXCJ3ZWJydGNcIiAmJiBzb3VyY2UudHlwZSAhPT0gXCJobHNcIikge1xuICAgIGlmIChqd3QpIHtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKFwiand0XCIsIGp3dCk7XG4gICAgfSBlbHNlIGlmIChhY2Nlc3NLZXkpIHtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKFwiYWNjZXNzS2V5XCIsIGFjY2Vzc0tleSk7XG4gICAgfVxuICB9XG4gIGlmIChzb3VyY2UudHlwZSA9PT0gXCJ3ZWJydGNcIikge1xuICAgIGlmIChwbGF5YmFja1JhdGUgPT09IFwiY29uc3RhbnRcIikge1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJjb25zdGFudFwiLCBcInRydWVcIik7XG4gICAgfVxuICAgIGNvbnN0IHZpZGVvVHJhY2tTZWxlY3RvciA9IGdldFZpZGVvVHJhY2tTZWxlY3RvckZvclF1YWxpdHkoXG4gICAgICB2aWRlb1F1YWxpdHksXG4gICAgICBhc3BlY3RSYXRpb1xuICAgICk7XG4gICAgaWYgKHZpZGVvVHJhY2tTZWxlY3Rvcikge1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJ2aWRlb1wiLCB2aWRlb1RyYWNrU2VsZWN0b3IpO1xuICAgIH1cbiAgfVxuICBpZiAoaW5nZXN0UGxheWJhY2spIHtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLmFwcGVuZChcImluZ2VzdHBiXCIsIFN0cmluZyhpbmdlc3RQbGF5YmFjaykpO1xuICB9XG4gIGNvbnN0IG5ld1NyYyA9IHtcbiAgICAuLi5zb3VyY2UsXG4gICAgc3JjOiB1cmwudG9TdHJpbmcoKVxuICB9O1xuICBjb25zdCB2aWRlb1NvdXJjZUlmSGxzVW5zdXBwb3J0ZWQgPSBuZXdTcmM/LnR5cGUgPT09IFwiaGxzXCIgJiYgIWlzSGxzU3VwcG9ydGVkID8ge1xuICAgIC4uLm5ld1NyYyxcbiAgICB0eXBlOiBcInZpZGVvXCJcbiAgfSA6IG5ld1NyYztcbiAgcmV0dXJuIHtcbiAgICBjdXJyZW50U291cmNlOiB2aWRlb1NvdXJjZUlmSGxzVW5zdXBwb3J0ZWQsXG4gICAgcGxheWJhY2tJZFxuICB9O1xufTtcbnZhciBnZXROZXdTb3VyY2UgPSAoe1xuICBhY2Nlc3NLZXksXG4gIGFzcGVjdFJhdGlvLFxuICBpc0hsc1N1cHBvcnRlZCxcbiAgand0LFxuICBsb3dMYXRlbmN5LFxuICBwbGF5YmFja1JhdGUsXG4gIHNjcmVlbldpZHRoLFxuICBzZXNzaW9uVG9rZW4sXG4gIHNyYyxcbiAgdmlkZW9RdWFsaXR5LFxuICBoYXNSZWNlbnRXZWJSVENUaW1lb3V0LFxuICBpbmdlc3RQbGF5YmFja1xufSkgPT4ge1xuICBjb25zdCBzb3J0ZWRTb3VyY2VzID0gc29ydFNvdXJjZXMoe1xuICAgIHNyYyxcbiAgICBzY3JlZW5XaWR0aCxcbiAgICB2aWRlb1F1YWxpdHksXG4gICAgYXNwZWN0UmF0aW86IGFzcGVjdFJhdGlvID8/IERFRkFVTFRfQVNQRUNUX1JBVElPLFxuICAgIGxvd0xhdGVuY3ksXG4gICAgaGFzUmVjZW50V2ViUlRDVGltZW91dFxuICB9KTtcbiAgY29uc3QgcGFyc2VkU291cmNlID0gcGFyc2VDdXJyZW50U291cmNlQW5kUGxheWJhY2tJZCh7XG4gICAgYWNjZXNzS2V5OiBhY2Nlc3NLZXkgPz8gbnVsbCxcbiAgICBhc3BlY3RSYXRpbzogYXNwZWN0UmF0aW8gPz8gbnVsbCxcbiAgICBpc0hsc1N1cHBvcnRlZCxcbiAgICBqd3Q6IGp3dCA/PyBudWxsLFxuICAgIHBsYXliYWNrUmF0ZSxcbiAgICBzZXNzaW9uVG9rZW4sXG4gICAgc291cmNlOiBzb3J0ZWRTb3VyY2VzPy5bMF0gPz8gbnVsbCxcbiAgICB2aWRlb1F1YWxpdHksXG4gICAgaW5nZXN0UGxheWJhY2tcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgY3VycmVudFNvdXJjZTogcGFyc2VkU291cmNlPy5jdXJyZW50U291cmNlID8/IG51bGwsXG4gICAgcGxheWJhY2tJZDogcGFyc2VkU291cmNlPy5wbGF5YmFja0lkID8/IG51bGwsXG4gICAgc29ydGVkU291cmNlc1xuICB9O1xufTtcbnZhciBnZXRWaWRlb1RyYWNrU2VsZWN0b3JGb3JRdWFsaXR5ID0gKHZpZGVvUXVhbGl0eSwgYXNwZWN0UmF0aW8pID0+IHtcbiAgaWYgKHZpZGVvUXVhbGl0eSA9PT0gXCJhdXRvXCIpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB2aWRlb1F1YWxpdHlEaW1lbnNpb25zID0gY2FsY3VsYXRlVmlkZW9RdWFsaXR5RGltZW5zaW9ucyhcbiAgICB2aWRlb1F1YWxpdHksXG4gICAgYXNwZWN0UmF0aW9cbiAgKTtcbiAgaWYgKHZpZGVvUXVhbGl0eURpbWVuc2lvbnM/LndpZHRoICYmIHZpZGVvUXVhbGl0eURpbWVuc2lvbnM/LmhlaWdodCkge1xuICAgIHJldHVybiBgfiR7dmlkZW9RdWFsaXR5RGltZW5zaW9ucy53aWR0aH14JHt2aWRlb1F1YWxpdHlEaW1lbnNpb25zLmhlaWdodH1gO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbmZ1bmN0aW9uIGNhbGN1bGF0ZVZpZGVvUXVhbGl0eURpbWVuc2lvbnModmlkZW9RdWFsaXR5LCBhc3BlY3RSYXRpbykge1xuICBjb25zdCBoZWlnaHQgPSB2aWRlb1F1YWxpdHkgPT09IFwiMTA4MHBcIiA/IDEwODAgOiB2aWRlb1F1YWxpdHkgPT09IFwiNzIwcFwiID8gNzIwIDogdmlkZW9RdWFsaXR5ID09PSBcIjQ4MHBcIiA/IDQ4MCA6IHZpZGVvUXVhbGl0eSA9PT0gXCIzNjBwXCIgPyAzNjAgOiB2aWRlb1F1YWxpdHkgPT09IFwiMjQwcFwiID8gMjQwIDogdmlkZW9RdWFsaXR5ID09PSBcIjE0NHBcIiA/IDE0NCA6IG51bGw7XG4gIHJldHVybiB7XG4gICAgd2lkdGg6IGhlaWdodCAhPT0gbnVsbCA/IE1hdGgucm91bmQoaGVpZ2h0ICogKGFzcGVjdFJhdGlvID8/IDE2IC8gOSkpIDogbnVsbCxcbiAgICBoZWlnaHRcbiAgfTtcbn1cbnZhciBnZXRGb3JtYXR0ZWRIb3Vyc01pbnV0ZXNTZWNvbmRzID0gKHZhbHVlSW5TZWNvbmRzKSA9PiB7XG4gIGNvbnN0IGhvdXJzTWludXRlc1NlY29uZHMgPSBnZXRIb3Vyc01pbnV0ZXNTZWNvbmRzKHZhbHVlSW5TZWNvbmRzKTtcbiAgaWYgKGhvdXJzTWludXRlc1NlY29uZHMuc2Vjb25kcyB8fCBob3Vyc01pbnV0ZXNTZWNvbmRzLm1pbnV0ZXMgfHwgaG91cnNNaW51dGVzU2Vjb25kcy5ob3Vycykge1xuICAgIGlmIChob3Vyc01pbnV0ZXNTZWNvbmRzLmhvdXJzID4gMCkge1xuICAgICAgcmV0dXJuIGAke2hvdXJzTWludXRlc1NlY29uZHMuaG91cnN9OiR7aG91cnNNaW51dGVzU2Vjb25kcy5taW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfToke2hvdXJzTWludXRlc1NlY29uZHMuc2Vjb25kcyA8IDEwID8gXCIwXCIgOiBcIlwifSR7aG91cnNNaW51dGVzU2Vjb25kcy5zZWNvbmRzfWA7XG4gICAgfVxuICAgIHJldHVybiBgJHtob3Vyc01pbnV0ZXNTZWNvbmRzLm1pbnV0ZXN9OiR7aG91cnNNaW51dGVzU2Vjb25kcy5zZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfWA7XG4gIH1cbiAgcmV0dXJuIFwiMDowMFwiO1xufTtcbnZhciBnZXRIb3Vyc01pbnV0ZXNTZWNvbmRzID0gKHZhbHVlSW5TZWNvbmRzKSA9PiB7XG4gIGlmICh2YWx1ZUluU2Vjb25kcyAhPT0gdm9pZCAwICYmIHZhbHVlSW5TZWNvbmRzICE9PSBudWxsICYmICFOdW1iZXIuaXNOYU4odmFsdWVJblNlY29uZHMpICYmIE51bWJlci5pc0Zpbml0ZSh2YWx1ZUluU2Vjb25kcykpIHtcbiAgICBjb25zdCByb3VuZGVkVmFsdWUgPSBNYXRoLnJvdW5kKHZhbHVlSW5TZWNvbmRzKTtcbiAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Iocm91bmRlZFZhbHVlIC8gMzYwMCk7XG4gICAgY29uc3Qgc2Vjb25kcyA9IE1hdGguZmxvb3Iocm91bmRlZFZhbHVlICUgNjApO1xuICAgIGlmIChob3VycyA+IDApIHtcbiAgICAgIGNvbnN0IG1pbnV0ZXMyID0gTWF0aC5mbG9vcihyb3VuZGVkVmFsdWUgJSAzNjAwIC8gNjApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaG91cnMsXG4gICAgICAgIG1pbnV0ZXM6IG1pbnV0ZXMyLFxuICAgICAgICBzZWNvbmRzXG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihyb3VuZGVkVmFsdWUgLyA2MCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGhvdXJzOiAwLFxuICAgICAgbWludXRlcyxcbiAgICAgIHNlY29uZHNcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgaG91cnM6IDAsXG4gICAgbWludXRlczogMCxcbiAgICBzZWNvbmRzOiAwXG4gIH07XG59O1xuXG4vLyBzcmMvbWVkaWEvY29udHJvbGxlci50c1xudmFyIERFRkFVTFRfQVVUT0hJREVfVElNRSA9IDNlMztcbnZhciBERUZBVUxUX1NFRUtfVElNRSA9IDVlMztcbnZhciBERUZBVUxUX1ZPTFVNRV9MRVZFTCA9IDE7XG52YXIgd2VicnRjVGltZW91dExhc3RUaW1lID0gbnVsbDtcbnZhciBnZXRIYXNSZWNlbnRXZWJSVENUaW1lb3V0ID0gKGNhY2hlV2ViUlRDRmFpbHVyZU1zKSA9PiB7XG4gIGlmICghd2VicnRjVGltZW91dExhc3RUaW1lIHx8ICFjYWNoZVdlYlJUQ0ZhaWx1cmVNcykgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gRGF0ZS5ub3coKSAtIHdlYnJ0Y1RpbWVvdXRMYXN0VGltZSA8IGNhY2hlV2ViUlRDRmFpbHVyZU1zO1xufTtcbnZhciBjcmVhdGVDb250cm9sbGVyU3RvcmUgPSAoe1xuICBkZXZpY2UsXG4gIHN0b3JhZ2UsXG4gIHNyYyxcbiAgaW5pdGlhbFByb3BzLFxuICBwbGF5YmFja0lkXG59KSA9PiB7XG4gIGNvbnN0IGluaXRpYWxQbGF5YmFja1JhdGUgPSBpbml0aWFsUHJvcHM/LnBsYXliYWNrUmF0ZSA/PyAxO1xuICBjb25zdCBpbml0aWFsVm9sdW1lID0gZ2V0Qm91bmRlZFZvbHVtZShcbiAgICBpbml0aWFsUHJvcHMudm9sdW1lID8/IERFRkFVTFRfVk9MVU1FX0xFVkVMXG4gICk7XG4gIGNvbnN0IGluaXRpYWxWaWRlb1F1YWxpdHkgPSBpbml0aWFsUHJvcHMudmlkZW9RdWFsaXR5ID8/IFwiYXV0b1wiO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBnZW5lcmF0ZVJhbmRvbVRva2VuKCk7XG4gIGNvbnN0IHRodW1ibmFpbFNyYyA9IHR5cGVvZiBzcmMgPT09IFwic3RyaW5nXCIgPyBudWxsIDogc3JjPy5maW5kPy4oKHMpID0+IHMudHlwZSA9PT0gXCJpbWFnZVwiKTtcbiAgY29uc3QgbG93TGF0ZW5jeSA9IGluaXRpYWxQcm9wcy5sb3dMYXRlbmN5ID8/IHRydWU7XG4gIGNvbnN0IHBhcnNlZElucHV0U291cmNlID0gZ2V0TmV3U291cmNlKHtcbiAgICBhY2Nlc3NLZXk6IGluaXRpYWxQcm9wcz8uYWNjZXNzS2V5LFxuICAgIGFzcGVjdFJhdGlvOiBpbml0aWFsUHJvcHM/LmFzcGVjdFJhdGlvLFxuICAgIGlzSGxzU3VwcG9ydGVkOiBkZXZpY2UuaXNIbHNTdXBwb3J0ZWQsXG4gICAgand0OiBpbml0aWFsUHJvcHM/Lmp3dCxcbiAgICBwbGF5YmFja1JhdGU6IGluaXRpYWxQbGF5YmFja1JhdGUsXG4gICAgbG93TGF0ZW5jeSxcbiAgICBzY3JlZW5XaWR0aDogZGV2aWNlLnNjcmVlbldpZHRoLFxuICAgIHNlc3Npb25Ub2tlbixcbiAgICBzcmMsXG4gICAgdmlkZW9RdWFsaXR5OiBpbml0aWFsVmlkZW9RdWFsaXR5LFxuICAgIGhhc1JlY2VudFdlYlJUQ1RpbWVvdXQ6IGdldEhhc1JlY2VudFdlYlJUQ1RpbWVvdXQoXG4gICAgICBpbml0aWFsUHJvcHMuY2FjaGVXZWJSVENGYWlsdXJlTXNcbiAgICApLFxuICAgIGluZ2VzdFBsYXliYWNrOiBpbml0aWFsUHJvcHMuaW5nZXN0UGxheWJhY2sgPz8gZmFsc2VcbiAgfSk7XG4gIGNvbnN0IGluaXRpYWxDb250cm9scyA9IHtcbiAgICBobHNDb25maWc6IG51bGwsXG4gICAgYXV0b2hpZGU6IERFRkFVTFRfQVVUT0hJREVfVElNRSxcbiAgICBsYXN0RXJyb3I6IDAsXG4gICAgbGFzdEludGVyYWN0aW9uOiBEYXRlLm5vdygpLFxuICAgIHJlcXVlc3RlZE1lYXN1cmVMYXN0VGltZTogMCxcbiAgICBtdXRlZDogaW5pdGlhbFZvbHVtZSA9PT0gMCxcbiAgICBwbGF5YmFja0lkOiBwbGF5YmFja0lkID8/IHBhcnNlZElucHV0U291cmNlPy5wbGF5YmFja0lkID8/IG51bGwsXG4gICAgcGxheWJhY2tPZmZzZXRNczogbnVsbCxcbiAgICBwbGF5TGFzdFRpbWU6IDAsXG4gICAgcGF1c2VMYXN0VGltZTogMCxcbiAgICByZXF1ZXN0ZWRDbGlwUGFyYW1zOiBudWxsLFxuICAgIHJlcXVlc3RlZEZ1bGxzY3JlZW5MYXN0VGltZTogMCxcbiAgICByZXF1ZXN0ZWRQaWN0dXJlSW5QaWN0dXJlTGFzdFRpbWU6IDAsXG4gICAgcmVxdWVzdGVkUGxheVBhdXNlTGFzdFRpbWU6IDAsXG4gICAgcmVxdWVzdGVkUmFuZ2VUb1NlZWtUbzogMCxcbiAgICBzZXNzaW9uVG9rZW4sXG4gICAgc2l6ZTogbnVsbCxcbiAgICB0aHVtYm5haWw6IHRodW1ibmFpbFNyYyA/PyBudWxsLFxuICAgIHZvbHVtZTogaW5pdGlhbFZvbHVtZVxuICB9O1xuICBjb25zdCBzdG9yZSA9IGNyZWF0ZVN0b3JlKFxuICAgIHN1YnNjcmliZVdpdGhTZWxlY3RvcihcbiAgICAgIHBlcnNpc3QoXG4gICAgICAgIChzZXQsIGdldCkgPT4gKHtcbiAgICAgICAgICBjdXJyZW50U291cmNlOiBwYXJzZWRJbnB1dFNvdXJjZS5jdXJyZW50U291cmNlLFxuICAgICAgICAgIGNhblBsYXk6IGZhbHNlLFxuICAgICAgICAgIGhpZGRlbjogZmFsc2UsXG4gICAgICAgICAgLyoqIEN1cnJlbnQgdm9sdW1lIG9mIHRoZSBtZWRpYS4gMCBpZiBpdCBpcyBtdXRlZC4gKi9cbiAgICAgICAgICB2b2x1bWU6IGluaXRpYWxWb2x1bWUsXG4gICAgICAgICAgLyoqIFRoZSBwbGF5YmFjayByYXRlIGZvciB0aGUgbWVkaWEuIERlZmF1bHRzIHRvIDEuICovXG4gICAgICAgICAgcGxheWJhY2tSYXRlOiBpbml0aWFsUGxheWJhY2tSYXRlLFxuICAgICAgICAgIHZpZGVvUXVhbGl0eTogXCJhdXRvXCIsXG4gICAgICAgICAgLyoqIEN1cnJlbnQgcHJvZ3Jlc3Mgb2YgdGhlIG1lZGlhIChpbiBzZWNvbmRzKSAqL1xuICAgICAgICAgIHByb2dyZXNzOiAwLFxuICAgICAgICAgIC8qKiBDdXJyZW50IHRvdGFsIGR1cmF0aW9uIG9mIHRoZSBtZWRpYSAoaW4gc2Vjb25kcykgKi9cbiAgICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgICAvKiogQ3VycmVudCBidWZmZXJlZCBlbmQgdGltZSBmb3IgdGhlIG1lZGlhIChpbiBzZWNvbmRzKSAqL1xuICAgICAgICAgIGJ1ZmZlcmVkOiAwLFxuICAgICAgICAgIC8qKiBDdXJyZW50IGJ1ZmZlcmVkIHBlcmNlbnQgKi9cbiAgICAgICAgICBidWZmZXJlZFBlcmNlbnQ6IDAsXG4gICAgICAgICAgcG9zdGVyOiB0aHVtYm5haWxTcmM/LnNyYyA/PyBudWxsLFxuICAgICAgICAgIC8qKiBJZiB0aGUgdmlkZW8gZWxlbWVudCBpcyBtb3VudGVkIG9uIHRoZSBET00gKi9cbiAgICAgICAgICBtb3VudGVkOiBmYWxzZSxcbiAgICAgICAgICAvKiogSWYgdGhlIG1lZGlhIGlzIGZ1bGxzY3JlZW4uICovXG4gICAgICAgICAgZnVsbHNjcmVlbjogZmFsc2UsXG4gICAgICAgICAgLyoqIElmIHRoZSBtZWRpYSBpcyBpbiBwaWN0dXJlIGluIHBpY3R1cmUgbW9kZSAqL1xuICAgICAgICAgIHBpY3R1cmVJblBpY3R1cmU6IGZhbHNlLFxuICAgICAgICAgIHBsYXlpbmc6IGZhbHNlLFxuICAgICAgICAgIHdhaXRpbmc6IGZhbHNlLFxuICAgICAgICAgIHN0YWxsZWQ6IGZhbHNlLFxuICAgICAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICAgICAgZW5kZWQ6IGZhbHNlLFxuICAgICAgICAgIC8qKiBJZiB0aGUgbWVkaWEgaGFzIGV4cGVyaWVuY2VkIGFuIGVycm9yLiAqL1xuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIGVycm9yQ291bnQ6IDAsXG4gICAgICAgICAgLyoqIElmIHRoZSBjb250ZW50IGlzIGxpdmUgbWVkaWEgKi9cbiAgICAgICAgICBsaXZlOiBmYWxzZSxcbiAgICAgICAgICAvKiogSWYgdGhlIG1lZGlhIGhhcyBiZWVuIHBsYXllZCB5ZXQuICovXG4gICAgICAgICAgaGFzUGxheWVkOiBmYWxzZSxcbiAgICAgICAgICAvKiogVGhlIHNvcnRlZCBzb3VyY2VzIHRoYXQgd2VyZSBwYXNzZWQgaW4gdG8gdGhlIFBsYXllciAqL1xuICAgICAgICAgIHNvcnRlZFNvdXJjZXM6IHBhcnNlZElucHV0U291cmNlLnNvcnRlZFNvdXJjZXMsXG4gICAgICAgICAgLyoqIFRoZSBmaW5hbCBwbGF5YmFjayBVUkwgZm9yIHRoZSBtZWRpYSB0aGF0IGlzIHBsYXlpbmcsIGFmdGVyIHJlZGlyZWN0cy4gKi9cbiAgICAgICAgICBjdXJyZW50VXJsOiBudWxsLFxuICAgICAgICAgIG1ldHJpY3NSZXBvcnRpbmdVcmw6IG51bGwsXG4gICAgICAgICAgYXJpYToge1xuICAgICAgICAgICAgcHJvZ3Jlc3M6IFwiTm8gcHJvZ3Jlc3MsIGNvbnRlbnQgaXMgbG9hZGluZ1wiLFxuICAgICAgICAgICAgZnVsbHNjcmVlbjogXCJGdWxsIHNjcmVlbiAoZilcIixcbiAgICAgICAgICAgIHBpY3R1cmVJblBpY3R1cmU6IFwiTWluaSBwbGF5ZXIgKGkpXCIsXG4gICAgICAgICAgICBwbGF5UGF1c2U6IFwiUGxheSAoaylcIixcbiAgICAgICAgICAgIGNsaXA6IGluaXRpYWxQcm9wcy5jbGlwTGVuZ3RoID8gYENsaXAgbGFzdCAke051bWJlcihpbml0aWFsUHJvcHMuY2xpcExlbmd0aCkudG9GaXhlZChcbiAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgKX0gc2Vjb25kcyAoeClgIDogbnVsbCxcbiAgICAgICAgICAgIHRpbWU6IFwiMDowMFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfX2luaXRpYWxQcm9wczoge1xuICAgICAgICAgICAgYWNjZXNzS2V5OiBpbml0aWFsUHJvcHMuYWNjZXNzS2V5ID8/IG51bGwsXG4gICAgICAgICAgICBhc3BlY3RSYXRpbzogaW5pdGlhbFByb3BzPy5hc3BlY3RSYXRpbyA/PyBudWxsLFxuICAgICAgICAgICAgYXV0b1BsYXk6IGluaXRpYWxQcm9wcy5hdXRvUGxheSA/PyBmYWxzZSxcbiAgICAgICAgICAgIGJhY2tvZmY6IE1hdGgubWF4KGluaXRpYWxQcm9wcy5iYWNrb2ZmID8/IDUwMCwgMTAwKSxcbiAgICAgICAgICAgIGJhY2tvZmZNYXg6IE1hdGgubWF4KGluaXRpYWxQcm9wcy5iYWNrb2ZmTWF4ID8/IDNlNCwgMWU0KSxcbiAgICAgICAgICAgIGNhbGN1bGF0ZURlbGF5OiBpbml0aWFsUHJvcHMuY2FsY3VsYXRlRGVsYXkgPz8gKChjb3VudCkgPT4ge1xuICAgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCBkZWxheVRpbWUgPSBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICBNYXRoLm1heChpbml0aWFsUHJvcHMuYmFja29mZiA/PyA1MDAsIDEwMCkgKiAyICoqIChjb3VudCAtIDEpLFxuICAgICAgICAgICAgICAgIE1hdGgubWF4KGluaXRpYWxQcm9wcy5iYWNrb2ZmTWF4ID8/IDNlNCwgMWU0KVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICByZXR1cm4gZGVsYXlUaW1lO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBjbGlwTGVuZ3RoOiBpbml0aWFsUHJvcHMuY2xpcExlbmd0aCA/PyBudWxsLFxuICAgICAgICAgICAgY2FjaGVXZWJSVENGYWlsdXJlTXM6IGluaXRpYWxQcm9wcy5jYWNoZVdlYlJUQ0ZhaWx1cmVNcyA/PyBudWxsLFxuICAgICAgICAgICAgaG90a2V5czogaW5pdGlhbFByb3BzPy5ob3RrZXlzID8/IHRydWUsXG4gICAgICAgICAgICBqd3Q6IGluaXRpYWxQcm9wcy5qd3QgPz8gbnVsbCxcbiAgICAgICAgICAgIGxvd0xhdGVuY3ksXG4gICAgICAgICAgICBvbkVycm9yOiBpbml0aWFsUHJvcHM/Lm9uRXJyb3IgPz8gbnVsbCxcbiAgICAgICAgICAgIHBsYXliYWNrUmF0ZTogaW5pdGlhbFBsYXliYWNrUmF0ZSxcbiAgICAgICAgICAgIHBvc3RlckxpdmVVcGRhdGU6IGluaXRpYWxQcm9wcy5wb3N0ZXJMaXZlVXBkYXRlID8/IDNlNCxcbiAgICAgICAgICAgIHByZWxvYWQ6IGluaXRpYWxQcm9wcy5wcmVsb2FkID8/IFwibm9uZVwiLFxuICAgICAgICAgICAgc3RvcmFnZSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IGluaXRpYWxQcm9wcy50aW1lb3V0ID8/IDFlNCxcbiAgICAgICAgICAgIHZpZGVvUXVhbGl0eTogaW5pdGlhbFZpZGVvUXVhbGl0eSxcbiAgICAgICAgICAgIHZpZXdlcklkOiBpbml0aWFsUHJvcHMudmlld2VySWQgPz8gbnVsbCxcbiAgICAgICAgICAgIHZvbHVtZTogaW5pdGlhbFZvbHVtZSA/PyBudWxsLFxuICAgICAgICAgICAgaW5nZXN0UGxheWJhY2s6IGluaXRpYWxQcm9wcy5pbmdlc3RQbGF5YmFjayA/PyBmYWxzZSxcbiAgICAgICAgICAgIGljZVNlcnZlcnM6IGluaXRpYWxQcm9wcy5pY2VTZXJ2ZXJzXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfX2RldmljZTogZGV2aWNlLFxuICAgICAgICAgIF9fY29udHJvbHM6IGluaXRpYWxDb250cm9scyxcbiAgICAgICAgICBfX21ldGFkYXRhOiBudWxsLFxuICAgICAgICAgIF9fY29udHJvbHNGdW5jdGlvbnM6IHtcbiAgICAgICAgICAgIHNldE1vdW50ZWQ6ICgpID0+IHNldCgoKSA9PiAoe1xuICAgICAgICAgICAgICBtb3VudGVkOiB0cnVlXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICBzZXRQb3N0ZXI6IChwb3N0ZXIpID0+IHNldCgoKSA9PiAoe1xuICAgICAgICAgICAgICBwb3N0ZXJcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHNldE1ldHJpY3NSZXBvcnRpbmdVcmw6IChtZXRyaWNzUmVwb3J0aW5nVXJsKSA9PiBzZXQoKCkgPT4gKHtcbiAgICAgICAgICAgICAgbWV0cmljc1JlcG9ydGluZ1VybFxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgb25XZWJSVENUaW1lb3V0OiAoKSA9PiB7XG4gICAgICAgICAgICAgIHdlYnJ0Y1RpbWVvdXRMYXN0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0QXV0b2hpZGU6IChhdXRvaGlkZSkgPT4gc2V0KCh7IF9fY29udHJvbHMgfSkgPT4gKHtcbiAgICAgICAgICAgICAgX19jb250cm9sczoge1xuICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgYXV0b2hpZGVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgc2V0SGxzQ29uZmlnOiAoaGxzQ29uZmlnKSA9PiBzZXQoKHsgX19jb250cm9scyB9KSA9PiAoe1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICBobHNDb25maWdcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgc2V0SGlkZGVuOiAoaGlkZGVuKSA9PiBzZXQoKHsgcGxheWluZyB9KSA9PiAoe1xuICAgICAgICAgICAgICBoaWRkZW46IHBsYXlpbmcgPyBoaWRkZW4gOiBmYWxzZVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgdXBkYXRlTGFzdEludGVyYWN0aW9uOiAoKSA9PiBzZXQoKHsgX19jb250cm9scyB9KSA9PiAoe1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7IC4uLl9fY29udHJvbHMsIGxhc3RJbnRlcmFjdGlvbjogRGF0ZS5ub3coKSB9XG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB1cGRhdGVQbGF5YmFja09mZnNldE1zOiAob2Zmc2V0KSA9PiBzZXQoKHsgX19jb250cm9scyB9KSA9PiAoe1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICBwbGF5YmFja09mZnNldE1zOiBvZmZzZXRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgb25DYW5QbGF5OiAoKSA9PiBzZXQoKCkgPT4gKHtcbiAgICAgICAgICAgICAgY2FuUGxheTogdHJ1ZSxcbiAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2VcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIG9uUGxheTogKCkgPT4gc2V0KCh7IGFyaWEsIF9fY29udHJvbHMsIF9fY29udHJvbHNGdW5jdGlvbnMgfSkgPT4ge1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzRnVuY3Rpb25zLm9uRXJyb3IobnVsbCk7XG4gICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gXCJQYXVzZSAoaylcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwbGF5aW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhhc1BsYXllZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgICBlcnJvckNvdW50OiAwLFxuICAgICAgICAgICAgICAgIHN0YWxsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdhaXRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVuZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgcGxheUxhc3RUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhcmlhOiB7XG4gICAgICAgICAgICAgICAgICAuLi5hcmlhLFxuICAgICAgICAgICAgICAgICAgcGxheVBhdXNlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25QYXVzZTogKCkgPT4gc2V0KCh7IGFyaWEsIF9fY29udHJvbHMgfSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IFwiUGxheSAoaylcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwbGF5aW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0YWxsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdhaXRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVuZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBhcmlhOiB7XG4gICAgICAgICAgICAgICAgICAuLi5hcmlhLFxuICAgICAgICAgICAgICAgICAgcGxheVBhdXNlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgX19jb250cm9sczoge1xuICAgICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICAgIHBhdXNlTGFzdFRpbWU6IERhdGUubm93KClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHRvZ2dsZVBsYXk6IChmb3JjZSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB7IGhpZGRlbiwgX19kZXZpY2UsIF9fY29udHJvbHNGdW5jdGlvbnMgfSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgICAgICAgICAgIGlmICghZm9yY2UgJiYgaGlkZGVuICYmIF9fZGV2aWNlLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgX19jb250cm9sc0Z1bmN0aW9ucy5zZXRIaWRkZW4oZmFsc2UpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldCgoeyBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZFBsYXlQYXVzZUxhc3RUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgICAgICBsYXN0SW50ZXJhY3Rpb246IERhdGUubm93KClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvblByb2dyZXNzOiAodGltZSkgPT4gc2V0KCh7IGFyaWEsIHByb2dyZXNzLCBkdXJhdGlvbiwgbGl2ZSB9KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQXJpYSA9IGdldFByb2dyZXNzQXJpYSh7XG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgbGl2ZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgY29uc3QgcGxheVBhdXNlVGl0bGUgPSBcIlBhdXNlIChrKVwiO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFyaWE6IHtcbiAgICAgICAgICAgICAgICAgIC4uLmFyaWEsXG4gICAgICAgICAgICAgICAgICBwcm9ncmVzczogcHJvZ3Jlc3NBcmlhLnByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgdGltZTogcHJvZ3Jlc3NBcmlhLnRpbWUsXG4gICAgICAgICAgICAgICAgICBwbGF5UGF1c2U6IHBsYXlQYXVzZVRpdGxlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogZ2V0RmlsdGVyZWROYU4odGltZSksXG4gICAgICAgICAgICAgICAgd2FpdGluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgc3RhbGxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZW5kZWQ6IGZhbHNlXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlcXVlc3RTZWVrOiAodGltZSkgPT4gc2V0KCh7IGR1cmF0aW9uLCBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZFJhbmdlVG9TZWVrVG86IGdldEJvdW5kZWRTZWVrKHRpbWUsIGR1cmF0aW9uKVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9ncmVzczogZ2V0Qm91bmRlZFNlZWsodGltZSwgZHVyYXRpb24pXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICBvbkR1cmF0aW9uQ2hhbmdlOiAoZHVyYXRpb24pID0+IHNldCgoeyBsaXZlIH0pID0+ICh7XG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBsaXZlOiBkdXJhdGlvbiA9PT0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZID8gdHJ1ZSA6IGxpdmVcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHNldFdlYnNvY2tldE1ldGFkYXRhOiAobWV0YWRhdGEpID0+IHNldCgoKSA9PiAoeyBfX21ldGFkYXRhOiBtZXRhZGF0YSB9KSksXG4gICAgICAgICAgICB1cGRhdGVCdWZmZXJlZDogKGJ1ZmZlcmVkKSA9PiBzZXQoKHsgZHVyYXRpb24gfSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkdXJhdGlvbkZpbHRlcmVkID0gZ2V0RmlsdGVyZWROYU4oZHVyYXRpb24pO1xuICAgICAgICAgICAgICBjb25zdCBwZXJjZW50ID0gZHVyYXRpb25GaWx0ZXJlZCA+IDAgJiYgYnVmZmVyZWQgPiAwID8gYnVmZmVyZWQgLyBkdXJhdGlvbkZpbHRlcmVkICogMTAwIDogMDtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBidWZmZXJlZCxcbiAgICAgICAgICAgICAgICBidWZmZXJlZFBlcmNlbnQ6IE51bWJlcihwZXJjZW50LnRvRml4ZWQoMikpXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNldFZpZGVvUXVhbGl0eTogKHZpZGVvUXVhbGl0eSkgPT4gc2V0KCh7IF9faW5pdGlhbFByb3BzLCBfX2NvbnRyb2xzLCBwbGF5YmFja1JhdGUsIF9fZGV2aWNlIH0pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgcGFyc2VkU291cmNlTmV3ID0gZ2V0TmV3U291cmNlKHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NLZXk6IF9faW5pdGlhbFByb3BzPy5hY2Nlc3NLZXksXG4gICAgICAgICAgICAgICAgYXNwZWN0UmF0aW86IF9faW5pdGlhbFByb3BzLmFzcGVjdFJhdGlvLFxuICAgICAgICAgICAgICAgIGlzSGxzU3VwcG9ydGVkOiBfX2RldmljZS5pc0hsc1N1cHBvcnRlZCxcbiAgICAgICAgICAgICAgICBqd3Q6IF9faW5pdGlhbFByb3BzPy5qd3QsXG4gICAgICAgICAgICAgICAgbG93TGF0ZW5jeTogX19pbml0aWFsUHJvcHMubG93TGF0ZW5jeSxcbiAgICAgICAgICAgICAgICBwbGF5YmFja1JhdGUsXG4gICAgICAgICAgICAgICAgc2NyZWVuV2lkdGg6IGRldmljZS5zY3JlZW5XaWR0aCxcbiAgICAgICAgICAgICAgICBzZXNzaW9uVG9rZW46IF9fY29udHJvbHMuc2Vzc2lvblRva2VuLFxuICAgICAgICAgICAgICAgIHNyYyxcbiAgICAgICAgICAgICAgICB2aWRlb1F1YWxpdHksXG4gICAgICAgICAgICAgICAgaGFzUmVjZW50V2ViUlRDVGltZW91dDogZ2V0SGFzUmVjZW50V2ViUlRDVGltZW91dChcbiAgICAgICAgICAgICAgICAgIF9faW5pdGlhbFByb3BzLmNhY2hlV2ViUlRDRmFpbHVyZU1zXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBpbmdlc3RQbGF5YmFjazogX19pbml0aWFsUHJvcHMuaW5nZXN0UGxheWJhY2tcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc29ydGVkU291cmNlczogcGFyc2VkU291cmNlTmV3LnNvcnRlZFNvdXJjZXMsXG4gICAgICAgICAgICAgICAgdmlkZW9RdWFsaXR5LFxuICAgICAgICAgICAgICAgIGN1cnJlbnRTb3VyY2U6IHBhcnNlZFNvdXJjZU5ldy5jdXJyZW50U291cmNlLFxuICAgICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgICBwbGF5YmFja0lkOiBwbGF5YmFja0lkID8/IHBhcnNlZFNvdXJjZU5ldy5wbGF5YmFja0lkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzZXRQbGF5YmFja1JhdGU6IChyYXRlKSA9PiBzZXQoKCkgPT4gKHtcbiAgICAgICAgICAgICAgcGxheWJhY2tSYXRlOiBnZXRCb3VuZGVkUmF0ZShyYXRlID8/IDEpXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICByZXF1ZXN0U2Vla0RpZmY6IChkaWZmZXJlbmNlKSA9PiBzZXQoKHsgcHJvZ3Jlc3MsIGR1cmF0aW9uLCBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZFJhbmdlVG9TZWVrVG86IGdldEJvdW5kZWRTZWVrKFxuICAgICAgICAgICAgICAgICAgZ2V0RmlsdGVyZWROYU4ocHJvZ3Jlc3MpICsgZGlmZmVyZW5jZSAvIDFlMyxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICByZXF1ZXN0U2Vla0JhY2s6IChkaWZmZXJlbmNlID0gREVGQVVMVF9TRUVLX1RJTUUpID0+IGdldCgpLl9fY29udHJvbHNGdW5jdGlvbnMucmVxdWVzdFNlZWtEaWZmKC1kaWZmZXJlbmNlKSxcbiAgICAgICAgICAgIHJlcXVlc3RTZWVrRm9yd2FyZDogKGRpZmZlcmVuY2UgPSBERUZBVUxUX1NFRUtfVElNRSkgPT4gZ2V0KCkuX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0U2Vla0RpZmYoZGlmZmVyZW5jZSksXG4gICAgICAgICAgICBvbkZpbmFsVXJsOiAoY3VycmVudFVybCkgPT4gc2V0KCgpID0+ICh7IGN1cnJlbnRVcmwgfSkpLFxuICAgICAgICAgICAgcmVxdWVzdE1lYXN1cmU6ICgpID0+IHNldCgoeyBfX2NvbnRyb2xzIH0pID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkTWVhc3VyZUxhc3RUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzZXRTaXplOiAoc2l6ZSkgPT4gc2V0KCh7IF9fY29udHJvbHMgfSkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgICBzaXplOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMuc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgLi4uc2l6ZVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25XYWl0aW5nOiAoKSA9PiBzZXQoKCkgPT4gKHsgd2FpdGluZzogdHJ1ZSB9KSksXG4gICAgICAgICAgICBvblN0YWxsZWQ6ICgpID0+IHNldCgoKSA9PiAoeyBzdGFsbGVkOiB0cnVlIH0pKSxcbiAgICAgICAgICAgIG9uTG9hZGluZzogKCkgPT4gc2V0KCgpID0+ICh7IGxvYWRpbmc6IHRydWUgfSkpLFxuICAgICAgICAgICAgb25FbmRlZDogKCkgPT4gc2V0KCgpID0+ICh7IGVuZGVkOiB0cnVlIH0pKSxcbiAgICAgICAgICAgIHNldEZ1bGxzY3JlZW46IChmdWxsc2NyZWVuKSA9PiBzZXQoKHsgYXJpYSB9KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gZnVsbHNjcmVlbiA/IFwiRXhpdCBmdWxsIHNjcmVlbiAoZilcIiA6IFwiRnVsbCBzY3JlZW4gKGYpXCI7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbixcbiAgICAgICAgICAgICAgICBhcmlhOiB7XG4gICAgICAgICAgICAgICAgICAuLi5hcmlhLFxuICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbjogdGl0bGVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlcXVlc3RUb2dnbGVGdWxsc2NyZWVuOiAoKSA9PiBzZXQoKHsgX19jb250cm9scyB9KSA9PiAoe1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRGdWxsc2NyZWVuTGFzdFRpbWU6IERhdGUubm93KClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgc2V0UGljdHVyZUluUGljdHVyZTogKHBpY3R1cmVJblBpY3R1cmUpID0+IHNldCgoeyBhcmlhIH0pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBwaWN0dXJlSW5QaWN0dXJlID8gXCJFeGl0IG1pbmkgcGxheWVyIChpKVwiIDogXCJNaW5pIHBsYXllciAoaSlcIjtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwaWN0dXJlSW5QaWN0dXJlLFxuICAgICAgICAgICAgICAgIGFyaWE6IHtcbiAgICAgICAgICAgICAgICAgIC4uLmFyaWEsXG4gICAgICAgICAgICAgICAgICBwaWN0dXJlSW5QaWN0dXJlOiB0aXRsZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcmVxdWVzdFRvZ2dsZVBpY3R1cmVJblBpY3R1cmU6ICgpID0+IHNldCgoeyBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZFBpY3R1cmVJblBpY3R1cmVMYXN0VGltZTogRGF0ZS5ub3coKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICBzZXRMaXZlOiAobGl2ZSkgPT4gc2V0KCgpID0+ICh7IGxpdmUgfSkpLFxuICAgICAgICAgICAgcmVxdWVzdENsaXA6ICgpID0+IHNldCgoeyBfX2NvbnRyb2xzLCBfX2luaXRpYWxQcm9wcyB9KSA9PiAoe1xuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRDbGlwUGFyYW1zOiBfX2luaXRpYWxQcm9wcy5jbGlwTGVuZ3RoID8gZ2V0Q2xpcFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgICAgY2xpcExlbmd0aDogX19pbml0aWFsUHJvcHMuY2xpcExlbmd0aCxcbiAgICAgICAgICAgICAgICAgIHBsYXliYWNrT2Zmc2V0TXM6IF9fY29udHJvbHMucGxheWJhY2tPZmZzZXRNc1xuICAgICAgICAgICAgICAgIH0pIDogbnVsbFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICByZXF1ZXN0Vm9sdW1lOiAobmV3Vm9sdW1lKSA9PiBzZXQoKHsgX19jb250cm9scyB9KSA9PiAoe1xuICAgICAgICAgICAgICB2b2x1bWU6IGdldEJvdW5kZWRWb2x1bWUobmV3Vm9sdW1lKSxcbiAgICAgICAgICAgICAgX19jb250cm9sczoge1xuICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgdm9sdW1lOiBuZXdWb2x1bWUgPT09IDAgPyBuZXdWb2x1bWUgOiBnZXRCb3VuZGVkVm9sdW1lKG5ld1ZvbHVtZSksXG4gICAgICAgICAgICAgICAgbXV0ZWQ6IG5ld1ZvbHVtZSA9PT0gMFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICBzZXRWb2x1bWU6IChuZXdWb2x1bWUpID0+IHNldCgoeyBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICAgICAgICAgIHZvbHVtZTogZ2V0Qm91bmRlZFZvbHVtZShuZXdWb2x1bWUpLFxuICAgICAgICAgICAgICBfX2NvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgLi4uX19jb250cm9scyxcbiAgICAgICAgICAgICAgICBtdXRlZDogbmV3Vm9sdW1lID09PSAwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHJlcXVlc3RUb2dnbGVNdXRlOiAoZm9yY2VWYWx1ZSkgPT4gc2V0KCh7IF9fY29udHJvbHMgfSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c1ZvbHVtZSA9IGdldEJvdW5kZWRWb2x1bWUoX19jb250cm9scy52b2x1bWUpIHx8IDA7XG4gICAgICAgICAgICAgIGNvbnN0IG5vbk11dGVkVm9sdW1lID0gcHJldmlvdXNWb2x1bWUgPiAwLjAxID8gcHJldmlvdXNWb2x1bWUgOiBERUZBVUxUX1ZPTFVNRV9MRVZFTDtcbiAgICAgICAgICAgICAgY29uc3QgbXV0ZWRWb2x1bWUgPSAwO1xuICAgICAgICAgICAgICBjb25zdCBuZXdNdXRlZFZhbHVlID0gZm9yY2VWYWx1ZSA/PyAhX19jb250cm9scy5tdXRlZDtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2b2x1bWU6IG5ld011dGVkVmFsdWUgPyBtdXRlZFZvbHVtZSA6IG5vbk11dGVkVm9sdW1lLFxuICAgICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAgIC4uLl9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgICBtdXRlZDogbmV3TXV0ZWRWYWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25FcnJvcjogKHJhd0Vycm9yKSA9PiBzZXQoXG4gICAgICAgICAgICAgICh7XG4gICAgICAgICAgICAgICAgY3VycmVudFNvdXJjZSxcbiAgICAgICAgICAgICAgICBzb3J0ZWRTb3VyY2VzLFxuICAgICAgICAgICAgICAgIF9fY29udHJvbHMsXG4gICAgICAgICAgICAgICAgZXJyb3JDb3VudCxcbiAgICAgICAgICAgICAgICBfX2RldmljZSxcbiAgICAgICAgICAgICAgICBfX2luaXRpYWxQcm9wcyxcbiAgICAgICAgICAgICAgICB2aWRlb1F1YWxpdHksXG4gICAgICAgICAgICAgICAgcGxheWJhY2tSYXRlXG4gICAgICAgICAgICAgIH0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtc1NpbmNlTGFzdEVycm9yID0gRGF0ZS5ub3coKSAtIF9fY29udHJvbHMubGFzdEVycm9yO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gcmF3RXJyb3IgPyB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBpc0FjY2Vzc0NvbnRyb2xFcnJvcihyYXdFcnJvcikgPyBcImFjY2Vzcy1jb250cm9sXCIgOiBpc0JmcmFtZXNFcnJvcihyYXdFcnJvcikgfHwgaXNOb3RBY2NlcHRhYmxlRXJyb3IocmF3RXJyb3IpID8gXCJmYWxsYmFja1wiIDogaXNTdHJlYW1PZmZsaW5lRXJyb3IocmF3RXJyb3IpID8gXCJvZmZsaW5lXCIgOiBpc1Blcm1pc3Npb25zRXJyb3IocmF3RXJyb3IpID8gXCJwZXJtaXNzaW9uc1wiIDogXCJ1bmtub3duXCIsXG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiByYXdFcnJvcj8ubWVzc2FnZSA/PyBcIkVycm9yIHdpdGggcGxheWJhY2suXCJcbiAgICAgICAgICAgICAgICB9IDogbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoX19pbml0aWFsUHJvcHMub25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgX19pbml0aWFsUHJvcHMub25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGJhc2UgPSB7XG4gICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgIC4uLmVycm9yID8ge1xuICAgICAgICAgICAgICAgICAgICBlcnJvckNvdW50OiBlcnJvckNvdW50ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgcGxheWluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAuLi5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgICAgIGxhc3RFcnJvcjogRGF0ZS5ub3coKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IDogeyBfX2NvbnRyb2xzIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBiYXNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IudHlwZSA9PT0gXCJvZmZsaW5lXCIgfHwgZXJyb3IudHlwZSA9PT0gXCJhY2Nlc3MtY29udHJvbFwiIHx8IGVycm9yLnR5cGUgPT09IFwicGVybWlzc2lvbnNcIikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc29ydGVkU291cmNlcyA9PT0gXCJzdHJpbmdcIiB8fCAhQXJyYXkuaXNBcnJheShzb3J0ZWRTb3VyY2VzKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtc1NpbmNlTGFzdEVycm9yIDwgZXJyb3JDb3VudCAqIDUwMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTb3VyY2VCYXNlVXJsID0gY3VycmVudFNvdXJjZSA/IG5ldyBVUkwoY3VycmVudFNvdXJjZS5zcmMpIDogXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFNvdXJjZUJhc2VVcmwpIHtcbiAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb3VyY2VCYXNlVXJsLnNlYXJjaCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTb3VyY2VJbmRleCA9IHNvcnRlZFNvdXJjZXMuZmluZEluZGV4KFxuICAgICAgICAgICAgICAgICAgKHMpID0+IHMuc3JjID09PSBjdXJyZW50U291cmNlQmFzZVVybC50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCByb3RhdGVkU291cmNlcyA9IFtcbiAgICAgICAgICAgICAgICAgIC4uLnNvcnRlZFNvdXJjZXMuc2xpY2UoY3VycmVudFNvdXJjZUluZGV4ICsgMSksXG4gICAgICAgICAgICAgICAgICAuLi5zb3J0ZWRTb3VyY2VzLnNsaWNlKDAsIGN1cnJlbnRTb3VyY2VJbmRleCArIDEpXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNSZWNlbnRXZWJSVENUaW1lb3V0ID0gZ2V0SGFzUmVjZW50V2ViUlRDVGltZW91dChcbiAgICAgICAgICAgICAgICAgIF9faW5pdGlhbFByb3BzLmNhY2hlV2ViUlRDRmFpbHVyZU1zXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW5QbGF5U291cmNlVHlwZSA9IChzcmMyKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBoYXNPbmVXZWJSVENTb3VyY2UgPSBzb3J0ZWRTb3VyY2VzLnNvbWUoXG4gICAgICAgICAgICAgICAgICAgIChzKSA9PiBzPy50eXBlID09PSBcIndlYnJ0Y1wiXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgaWYgKF9faW5pdGlhbFByb3BzLmxvd0xhdGVuY3kgPT09IFwiZm9yY2VcIiAmJiBoYXNPbmVXZWJSVENTb3VyY2UgJiYgc3JjMi50eXBlICE9PSBcIndlYnJ0Y1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGlmIChfX2luaXRpYWxQcm9wcy5sb3dMYXRlbmN5ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3JjMi50eXBlICE9PSBcIndlYnJ0Y1wiO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgaWYgKGhhc1JlY2VudFdlYlJUQ1RpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNyYzIudHlwZSAhPT0gXCJ3ZWJydGNcIjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBzcmMyLnR5cGUgPT09IFwid2VicnRjXCIgPyBfX2RldmljZS5pc1dlYlJUQ1N1cHBvcnRlZCA6IHRydWU7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0UGxheWFibGVJbmRleCA9IHJvdGF0ZWRTb3VyY2VzLmZpbmRJbmRleChcbiAgICAgICAgICAgICAgICAgIChzKSA9PiBjYW5QbGF5U291cmNlVHlwZShzKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dFNvdXJjZUluZGV4ID0gbmV4dFBsYXlhYmxlSW5kZXggIT09IC0xID8gKGN1cnJlbnRTb3VyY2VJbmRleCArIDEgKyBuZXh0UGxheWFibGVJbmRleCkgJSBzb3J0ZWRTb3VyY2VzLmxlbmd0aCA6IC0xO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTb3VyY2UgPSBuZXh0U291cmNlSW5kZXggIT09IC0xID8gc29ydGVkU291cmNlc1tuZXh0U291cmNlSW5kZXhdIDogbnVsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRTb3VyY2VOZXcgPSBwYXJzZUN1cnJlbnRTb3VyY2VBbmRQbGF5YmFja0lkKHtcbiAgICAgICAgICAgICAgICAgIGFjY2Vzc0tleTogX19pbml0aWFsUHJvcHM/LmFjY2Vzc0tleSA/PyBudWxsLFxuICAgICAgICAgICAgICAgICAgYXNwZWN0UmF0aW86IF9faW5pdGlhbFByb3BzPy5hc3BlY3RSYXRpbyA/PyBudWxsLFxuICAgICAgICAgICAgICAgICAgaXNIbHNTdXBwb3J0ZWQ6IF9fZGV2aWNlLmlzSGxzU3VwcG9ydGVkLFxuICAgICAgICAgICAgICAgICAgand0OiBfX2luaXRpYWxQcm9wcz8uand0ID8/IG51bGwsXG4gICAgICAgICAgICAgICAgICBwbGF5YmFja1JhdGUsXG4gICAgICAgICAgICAgICAgICBzZXNzaW9uVG9rZW46IF9fY29udHJvbHMuc2Vzc2lvblRva2VuLFxuICAgICAgICAgICAgICAgICAgc291cmNlOiBuZXh0U291cmNlLFxuICAgICAgICAgICAgICAgICAgdmlkZW9RdWFsaXR5LFxuICAgICAgICAgICAgICAgICAgaW5nZXN0UGxheWJhY2s6IF9faW5pdGlhbFByb3BzLmluZ2VzdFBsYXliYWNrXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIC4uLmJhc2UsXG4gICAgICAgICAgICAgICAgICBjdXJyZW50U291cmNlOiBwYXJzZWRTb3VyY2VOZXc/LmN1cnJlbnRTb3VyY2UgPz8gbnVsbCxcbiAgICAgICAgICAgICAgICAgIF9fY29udHJvbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4uYmFzZS5fX2NvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgICBwbGF5YmFja0lkOiBwbGF5YmFja0lkID8/IHBhcnNlZFNvdXJjZU5ldz8ucGxheWJhY2tJZCA/PyBudWxsXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiBcImxpdmVwZWVyLW1lZGlhLWNvbnRyb2xsZXJcIixcbiAgICAgICAgICB2ZXJzaW9uOiAyLFxuICAgICAgICAgIC8vIHNpbmNlIHRoZXNlIHZhbHVlcyBhcmUgcGVyc2lzdGVkIGFjcm9zcyBtZWRpYSwgb25seSBwZXJzaXN0IHZvbHVtZSAmIHZpZGVvUXVhbGl0eVxuICAgICAgICAgIHBhcnRpYWxpemU6ICh7IHZvbHVtZSwgdmlkZW9RdWFsaXR5IH0pID0+ICh7XG4gICAgICAgICAgICB2b2x1bWUsXG4gICAgICAgICAgICB2aWRlb1F1YWxpdHlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBzdG9yYWdlOiBjcmVhdGVKU09OU3RvcmFnZSgoKSA9PiBzdG9yYWdlKVxuICAgICAgICB9XG4gICAgICApXG4gICAgKVxuICApO1xuICBjb25zdCBkZXN0cm95ID0gc3RvcmUucGVyc2lzdC5vbkZpbmlzaEh5ZHJhdGlvbihcbiAgICAoeyB2aWRlb1F1YWxpdHksIHZvbHVtZSB9KSA9PiB7XG4gICAgICBpZiAodmlkZW9RdWFsaXR5ICE9PSBzdG9yZS5nZXRTdGF0ZSgpLnZpZGVvUXVhbGl0eSkge1xuICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0VmlkZW9RdWFsaXR5KHZpZGVvUXVhbGl0eSk7XG4gICAgICB9XG4gICAgICBpZiAodm9sdW1lICE9PSBzdG9yZS5nZXRTdGF0ZSgpLnZvbHVtZSkge1xuICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMucmVxdWVzdFZvbHVtZSh2b2x1bWUpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgcmV0dXJuIHsgc3RvcmUsIGRlc3Ryb3kgfTtcbn07XG5cbi8vIHNyYy9tZWRpYS9tZXRyaWNzLnRzXG52YXIgTGVnYWN5UGxheWJhY2tNb25pdG9yID0gY2xhc3Mge1xuICBhY3RpdmUgPSBmYWxzZTtcbiAgdmFsdWVzID0gW107XG4gIHNjb3JlID0gbnVsbDtcbiAgYXZlcmFnaW5nU3RlcHMgPSAyMDtcbiAgc3RvcmU7XG4gIGNvbnN0cnVjdG9yKHN0b3JlKSB7XG4gICAgdGhpcy5zdG9yZSA9IHN0b3JlO1xuICB9XG4gIGluaXQoKSB7XG4gICAgaWYgKCF0aGlzLmFjdGl2ZSkge1xuICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgIHRoaXMuc2NvcmUgPSBudWxsO1xuICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgIH1cbiAgfVxuICByZXNldCgpIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICB9XG4gIH1cbiAgZGVzdHJveSgpIHtcbiAgICBpZiAodGhpcy5hY3RpdmUpIHtcbiAgICAgIHRoaXMudmFsdWVzID0gW107XG4gICAgICB0aGlzLnNjb3JlID0gbnVsbDtcbiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGNhbGN1bGF0ZVNjb3JlKCkge1xuICAgIGlmICh0aGlzLmFjdGl2ZSkge1xuICAgICAgY29uc3QgbGF0ZXN0UGxheWJhY2tSZWNvcmQgPSB0aGlzLnZhbHVlcy5sZW5ndGggPiAwID8gdGhpcy52YWx1ZXNbdGhpcy52YWx1ZXMubGVuZ3RoIC0gMV0gOiB2b2lkIDA7XG4gICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB7XG4gICAgICAgIGNsb2NrVGltZTogRGF0ZS5ub3coKSAqIDFlLTMsXG4gICAgICAgIG1lZGlhVGltZTogdGhpcy5zdG9yZS5nZXRTdGF0ZSgpLnByb2dyZXNzLFxuICAgICAgICBzY29yZTogbGF0ZXN0UGxheWJhY2tSZWNvcmQgPyB0aGlzLnZhbHVlVG9TY29yZShsYXRlc3RQbGF5YmFja1JlY29yZCkgOiAwXG4gICAgICB9O1xuICAgICAgdGhpcy52YWx1ZXMucHVzaChjdXJyZW50VmFsdWUpO1xuICAgICAgaWYgKHRoaXMudmFsdWVzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBvbGRlc3RWYWx1ZSA9IHRoaXMudmFsdWVzWzBdO1xuICAgICAgaWYgKG9sZGVzdFZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgICAgY29uc3QgYXZlcmFnZWRTY29yZSA9IHRoaXMudmFsdWVUb1Njb3JlKG9sZGVzdFZhbHVlLCBjdXJyZW50VmFsdWUpO1xuICAgICAgICBpZiAodGhpcy52YWx1ZXMubGVuZ3RoID4gdGhpcy5hdmVyYWdpbmdTdGVwcykge1xuICAgICAgICAgIHRoaXMudmFsdWVzLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY29yZSA9IE1hdGgubWF4KGF2ZXJhZ2VkU2NvcmUsIGN1cnJlbnRWYWx1ZS5zY29yZSk7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRoaXMuc2NvcmUgKiAxMCkgLyAxMDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgdmFsdWVUb1Njb3JlKGEsIGIpIHtcbiAgICBjb25zdCByYXRlID0gdGhpcz8uc3RvcmU/LmdldFN0YXRlPy4oKT8ucGxheWJhY2tSYXRlID8/IDE7XG4gICAgcmV0dXJuIChiPy5tZWRpYVRpbWUgPz8gdGhpcy5zdG9yZS5nZXRTdGF0ZSgpLnByb2dyZXNzIC0gYS5tZWRpYVRpbWUpIC8gKGI/LmNsb2NrVGltZSA/PyBEYXRlLm5vdygpICogMWUtMyAtIGEuY2xvY2tUaW1lKSAvIChyYXRlID09PSBcImNvbnN0YW50XCIgPyAxIDogcmF0ZSk7XG4gIH1cbn07XG52YXIgVGltZXIgPSBjbGFzcyB7XG4gIHRvdGFsVGltZSA9IDA7XG4gIGNvdW50U3RhcnRzID0gMDtcbiAgc3RhcnRUaW1lID0gMDtcbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuY291bnRTdGFydHMrKztcbiAgfVxuICBzdG9wKCkge1xuICAgIHRoaXMudG90YWxUaW1lICs9IHRoaXMuc3RhcnRUaW1lID4gMCA/IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZSA6IDA7XG4gICAgdGhpcy5zdGFydFRpbWUgPSAwO1xuICB9XG4gIGdldFRvdGFsVGltZSgpIHtcbiAgICB0aGlzLnRvdGFsVGltZSArPSB0aGlzLnN0YXJ0VGltZSA+IDAgPyBEYXRlLm5vdygpIC0gdGhpcy5zdGFydFRpbWUgOiAwO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5zdGFydFRpbWUgPiAwID8gRGF0ZS5ub3coKSA6IDA7XG4gICAgcmV0dXJuIHRoaXMudG90YWxUaW1lO1xuICB9XG4gIGdldENvdW50U3RhcnRzKCkge1xuICAgIHJldHVybiB0aGlzLmNvdW50U3RhcnRzO1xuICB9XG59O1xuZnVuY3Rpb24gaXNJbklmcmFtZSgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG52YXIgTGVnYWN5TWV0cmljc1N0YXR1cyA9IGNsYXNzIHtcbiAgcmVxdWVzdGVkUGxheVRpbWUgPSBudWxsO1xuICBmaXJzdEZyYW1lVGltZSA9IG51bGw7XG4gIGJvb3RNcztcbiAgcmV0cnlDb3VudCA9IDA7XG4gIGNvbm5lY3RlZCA9IGZhbHNlO1xuICBzdG9yZTtcbiAgZGVzdHJveTtcbiAgY3VycmVudE1ldHJpY3M7XG4gIHByZXZpb3VzTWV0cmljcyA9IG51bGw7XG4gIHRpbWVXYWl0aW5nID0gbmV3IFRpbWVyKCk7XG4gIHRpbWVTdGFsbGVkID0gbmV3IFRpbWVyKCk7XG4gIHRpbWVVbnBhdXNlZCA9IG5ldyBUaW1lcigpO1xuICBjb25zdHJ1Y3RvcihzdG9yZSwgYm9vdE1zLCBvcHRzKSB7XG4gICAgY29uc3QgY3VycmVudFN0YXRlID0gc3RvcmUuZ2V0U3RhdGUoKTtcbiAgICB0aGlzLnN0b3JlID0gc3RvcmU7XG4gICAgdGhpcy5ib290TXMgPSBib290TXM7XG4gICAgY29uc3Qgd2luZG93SHJlZiA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3c/LmxvY2F0aW9uPy5ocmVmID8/IFwiXCIgOiBcIlwiO1xuICAgIGNvbnN0IHBhZ2VVcmwgPSBpc0luSWZyYW1lKCkgPyB0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIgPyBkb2N1bWVudD8ucmVmZXJyZXIgfHwgd2luZG93SHJlZiA6IHdpbmRvd0hyZWYgOiB3aW5kb3dIcmVmO1xuICAgIGNvbnN0IHBsYXllclByZWZpeCA9IGN1cnJlbnRTdGF0ZT8uY3VycmVudFNvdXJjZT8udHlwZSA/PyBcInVua25vd25cIjtcbiAgICBjb25zdCB2ZXJzaW9uID0gY3VycmVudFN0YXRlPy5fX2RldmljZS52ZXJzaW9uID8/IFwidW5rbm93blwiO1xuICAgIHRoaXMuY3VycmVudE1ldHJpY3MgPSB7XG4gICAgICBhdXRvcGxheTogY3VycmVudFN0YXRlLl9faW5pdGlhbFByb3BzLmF1dG9QbGF5ID8gXCJhdXRvcGxheVwiIDogY3VycmVudFN0YXRlLl9faW5pdGlhbFByb3BzLnByZWxvYWQgPT09IFwiYXV0b1wiID8gXCJwcmVsb2FkLWZ1bGxcIiA6IGN1cnJlbnRTdGF0ZS5fX2luaXRpYWxQcm9wcy5wcmVsb2FkID09PSBcIm1ldGFkYXRhXCIgPyBcInByZWxvYWQtbWV0YWRhdGFcIiA6IFwic3RhbmRhcmRcIixcbiAgICAgIGR1cmF0aW9uOiBudWxsLFxuICAgICAgZmlyc3RQbGF5YmFjazogbnVsbCxcbiAgICAgIG5FcnJvcjogbnVsbCxcbiAgICAgIG5TdGFsbGVkOiBudWxsLFxuICAgICAgbldhaXRpbmc6IG51bGwsXG4gICAgICBvZmZzZXQ6IG51bGwsXG4gICAgICBwYWdlVXJsLFxuICAgICAgcGxheWJhY2tTY29yZTogbnVsbCxcbiAgICAgIHBsYXllcjogYCR7cGxheWVyUHJlZml4fS0ke3ZlcnNpb259YCxcbiAgICAgIHNvdXJjZVR5cGU6IGN1cnJlbnRTdGF0ZT8uY3VycmVudFNvdXJjZT8ubWltZSA/PyBcInVua25vd25cIixcbiAgICAgIHNvdXJjZVVybDogY3VycmVudFN0YXRlPy5jdXJyZW50U291cmNlPy5zcmMgPz8gbnVsbCxcbiAgICAgIHBsYXllckhlaWdodDogbnVsbCxcbiAgICAgIHBsYXllcldpZHRoOiBudWxsLFxuICAgICAgcHJlbG9hZFRpbWU6IG51bGwsXG4gICAgICB0aW1lU3RhbGxlZDogMCxcbiAgICAgIHRpbWVVbnBhdXNlZDogMCxcbiAgICAgIHRpbWVXYWl0aW5nOiAwLFxuICAgICAgdHRmZjogbnVsbCxcbiAgICAgIHVpZDogY3VycmVudFN0YXRlLl9faW5pdGlhbFByb3BzLnZpZXdlcklkID8/IFwiXCIsXG4gICAgICB1c2VyQWdlbnQ6IFN0cmluZyhjdXJyZW50U3RhdGU/Ll9fZGV2aWNlPy51c2VyQWdlbnQgPz8gXCJcIikucmVwbGFjZShcbiAgICAgICAgL1xcXFx8XCIvZ20sXG4gICAgICAgIFwiXCJcbiAgICAgICksXG4gICAgICB2aWRlb0hlaWdodDogbnVsbCxcbiAgICAgIHZpZGVvV2lkdGg6IG51bGxcbiAgICB9O1xuICAgIHRoaXMuZGVzdHJveSA9IHN0b3JlLnN1YnNjcmliZSgoc3RhdGUsIHByZXZTdGF0ZSkgPT4ge1xuICAgICAgaWYgKHRoaXMucmVxdWVzdGVkUGxheVRpbWUgPT09IG51bGwgJiYgc3RhdGUuX19jb250cm9scy5wbGF5TGFzdFRpbWUgIT09IDApIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0ZWRQbGF5VGltZSA9IE1hdGgubWF4KFxuICAgICAgICAgIHN0YXRlLl9fY29udHJvbHMucGxheUxhc3RUaW1lIC0gYm9vdE1zLFxuICAgICAgICAgIDBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5jdXJyZW50U291cmNlPy5zcmMgIT09IHByZXZTdGF0ZS5jdXJyZW50U291cmNlPy5zcmMpIHtcbiAgICAgICAgY29uc3QgcGxheWVyUHJlZml4MiA9IHN0YXRlPy5jdXJyZW50U291cmNlPy50eXBlID8/IFwidW5rbm93blwiO1xuICAgICAgICBjb25zdCB2ZXJzaW9uMiA9IHN0YXRlPy5fX2RldmljZS52ZXJzaW9uID8/IFwidW5rbm93blwiO1xuICAgICAgICB0aGlzLmN1cnJlbnRNZXRyaWNzLnBsYXllciA9IGAke3BsYXllclByZWZpeDJ9LSR7dmVyc2lvbjJ9YDtcbiAgICAgICAgdGhpcy5jdXJyZW50TWV0cmljcy5zb3VyY2VUeXBlID0gc3RhdGUuY3VycmVudFNvdXJjZT8ubWltZSA/PyBcInVua25vd25cIjtcbiAgICAgICAgdGhpcy5jdXJyZW50TWV0cmljcy5zb3VyY2VVcmwgPSBzdGF0ZS5jdXJyZW50U291cmNlPy5zcmMgPz8gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5wbGF5aW5nICE9PSBwcmV2U3RhdGUucGxheWluZykge1xuICAgICAgICBpZiAoc3RhdGUucGxheWluZykge1xuICAgICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVdhaXRpbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVVucGF1c2VkLnN0YXJ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50aW1lVW5wYXVzZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVdhaXRpbmcuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAob3B0cz8uZGlzYWJsZVByb2dyZXNzTGlzdGVuZXIgIT09IHRydWUgJiYgc3RhdGUucHJvZ3Jlc3MgIT09IHByZXZTdGF0ZS5wcm9ncmVzcyAmJiAhdGhpcy50aW1lVW5wYXVzZWQuc3RhcnRUaW1lKSB7XG4gICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RvcCgpO1xuICAgICAgICB0aGlzLnRpbWVXYWl0aW5nLnN0b3AoKTtcbiAgICAgICAgdGhpcy50aW1lVW5wYXVzZWQuc3RhcnQoKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5zdGFsbGVkICE9PSBwcmV2U3RhdGUuc3RhbGxlZCkge1xuICAgICAgICBpZiAoc3RhdGUuc3RhbGxlZCkge1xuICAgICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RhcnQoKTtcbiAgICAgICAgICB0aGlzLnRpbWVVbnBhdXNlZC5zdG9wKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdGUucGxheWluZykge1xuICAgICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVdhaXRpbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVVucGF1c2VkLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS53YWl0aW5nICE9PSBwcmV2U3RhdGUud2FpdGluZykge1xuICAgICAgICBpZiAoc3RhdGUud2FpdGluZykge1xuICAgICAgICAgIHRoaXMudGltZVdhaXRpbmcuc3RhcnQoKTtcbiAgICAgICAgICB0aGlzLnRpbWVVbnBhdXNlZC5zdG9wKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdGUucGxheWluZykge1xuICAgICAgICAgIHRoaXMudGltZVN0YWxsZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVdhaXRpbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZVVucGF1c2VkLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhZGRFcnJvcihlcnJvcikge1xuICAgIHRoaXMuY3VycmVudE1ldHJpY3MubkVycm9yID0gKHRoaXMuY3VycmVudE1ldHJpY3MubkVycm9yID8/IDApICsgMTtcbiAgICB0aGlzLmN1cnJlbnRNZXRyaWNzLmxhc3RFcnJvciA9IGVycm9yO1xuICB9XG4gIGdldEZpcnN0UGxheWJhY2soKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudE1ldHJpY3MuZmlyc3RQbGF5YmFjaztcbiAgfVxuICBzZXRGaXJzdFBsYXliYWNrKCkge1xuICAgIHRoaXMuY3VycmVudE1ldHJpY3MuZmlyc3RQbGF5YmFjayA9IERhdGUubm93KCkgLSB0aGlzLmJvb3RNcztcbiAgfVxuICBnZXRGaXJzdEZyYW1lVGltZSgpIHtcbiAgICByZXR1cm4gdGhpcy5maXJzdEZyYW1lVGltZTtcbiAgfVxuICBzZXRGaXJzdEZyYW1lVGltZSgpIHtcbiAgICB0aGlzLmZpcnN0RnJhbWVUaW1lID0gRGF0ZS5ub3coKSAtIHRoaXMuYm9vdE1zO1xuICB9XG4gIHNldFBsYXliYWNrU2NvcmUocGxheWJhY2tTY29yZSkge1xuICAgIHRoaXMuY3VycmVudE1ldHJpY3MucGxheWJhY2tTY29yZSA9IHBsYXliYWNrU2NvcmU7XG4gIH1cbiAgc2V0Q29ubmVjdGVkKGlzQ29ubmVjdGVkKSB7XG4gICAgdGhpcy5jb25uZWN0ZWQgPSBpc0Nvbm5lY3RlZDtcbiAgfVxuICBnZXRNZXRyaWNzKCkge1xuICAgIGNvbnN0IGN1cnJlbnRNZXRyaWNzID0ge1xuICAgICAgLi4udGhpcy5jdXJyZW50TWV0cmljcyxcbiAgICAgIHBsYXllckhlaWdodDogdGhpcy5zdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHMuc2l6ZT8uY29udGFpbmVyPy5oZWlnaHQgfHwgbnVsbCxcbiAgICAgIHBsYXllcldpZHRoOiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zaXplPy5jb250YWluZXI/LndpZHRoIHx8IG51bGwsXG4gICAgICB2aWRlb1dpZHRoOiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zaXplPy5tZWRpYT8ud2lkdGggfHwgbnVsbCxcbiAgICAgIHZpZGVvSGVpZ2h0OiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zaXplPy5tZWRpYT8uaGVpZ2h0IHx8IG51bGwsXG4gICAgICBkdXJhdGlvbjogdGhpcy5zdG9yZS5nZXRTdGF0ZSgpLmR1cmF0aW9uIHx8IG51bGwsXG4gICAgICBuV2FpdGluZzogdGhpcy50aW1lV2FpdGluZy5nZXRDb3VudFN0YXJ0cygpLFxuICAgICAgblN0YWxsZWQ6IHRoaXMudGltZVN0YWxsZWQuZ2V0Q291bnRTdGFydHMoKSxcbiAgICAgIHRpbWVXYWl0aW5nOiB0aGlzLnRpbWVXYWl0aW5nLmdldFRvdGFsVGltZSgpLFxuICAgICAgdGltZVN0YWxsZWQ6IHRoaXMudGltZVN0YWxsZWQuZ2V0VG90YWxUaW1lKCksXG4gICAgICB0aW1lVW5wYXVzZWQ6IHRoaXMudGltZVVucGF1c2VkLmdldFRvdGFsVGltZSgpLFxuICAgICAgb2Zmc2V0OiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5wbGF5YmFja09mZnNldE1zIHx8IG51bGwsXG4gICAgICAvLyB0aGlzIGlzIHRoZSBhbW91bnQgb2YgdGltZSB0aGF0IGEgdmlkZW8gaGFzIGhhZCB0byBwcmVsb2FkIGNvbnRlbnQsIGZyb20gYm9vdCB1bnRpbCBwbGF5IHdhcyByZXF1ZXN0ZWRcbiAgICAgIHByZWxvYWRUaW1lOiB0aGlzLnJlcXVlc3RlZFBsYXlUaW1lLFxuICAgICAgLy8gdGltZSBmcm9tIHdoZW4gdGhlIGZpcnN0IGBwbGF5YCBldmVudCBpcyBlbWl0dGVkIGFuZCB0aGUgZmlyc3QgcHJvZ3Jlc3MgdXBkYXRlXG4gICAgICB0dGZmOiB0aGlzLmZpcnN0RnJhbWVUaW1lICYmIHRoaXMucmVxdWVzdGVkUGxheVRpbWUgJiYgdGhpcy5maXJzdEZyYW1lVGltZSA+IDAgJiYgdGhpcy5yZXF1ZXN0ZWRQbGF5VGltZSA+IDAgPyBNYXRoLm1heCh0aGlzLmZpcnN0RnJhbWVUaW1lIC0gdGhpcy5yZXF1ZXN0ZWRQbGF5VGltZSwgMCkgOiBudWxsXG4gICAgfTtcbiAgICBjb25zdCBwcmV2aW91c01ldHJpY3MgPSB0aGlzLnByZXZpb3VzTWV0cmljcztcbiAgICB0aGlzLnByZXZpb3VzTWV0cmljcyA9IGN1cnJlbnRNZXRyaWNzO1xuICAgIHJldHVybiB7XG4gICAgICBjdXJyZW50OiBjdXJyZW50TWV0cmljcyxcbiAgICAgIHByZXZpb3VzOiBwcmV2aW91c01ldHJpY3NcbiAgICB9O1xuICB9XG59O1xuZnVuY3Rpb24gYWRkTGVnYWN5TWVkaWFNZXRyaWNzVG9TdG9yZShzdG9yZSwgb3B0cykge1xuICBjb25zdCBib290TXMgPSBEYXRlLm5vdygpO1xuICBjb25zdCBkZWZhdWx0UmVzcG9uc2UgPSB7XG4gICAgbWV0cmljczogbnVsbCxcbiAgICBkZXN0cm95OiAoKSA9PiB7XG4gICAgfVxuICB9O1xuICBpZiAoIXN0b3JlKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRSZXNwb25zZTtcbiAgfVxuICBpZiAoIVdlYlNvY2tldCkge1xuICAgIGNvbnNvbGUubG9nKFwiRW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCBXZWJTb2NrZXRcIik7XG4gICAgcmV0dXJuIGRlZmF1bHRSZXNwb25zZTtcbiAgfVxuICBsZXQgd2Vic29ja2V0UHJvbWlzZSA9IG51bGw7XG4gIGxldCB0aW1lciA9IG51bGw7XG4gIGxldCByZXBvcnRpbmdBY3RpdmUgPSB0cnVlO1xuICBjb25zdCBtZXRyaWNzU3RhdHVzID0gbmV3IExlZ2FjeU1ldHJpY3NTdGF0dXMoc3RvcmUsIGJvb3RNcywgb3B0cyk7XG4gIGNvbnN0IG1vbml0b3IgPSBuZXcgTGVnYWN5UGxheWJhY2tNb25pdG9yKHN0b3JlKTtcbiAgY29uc3QgcmVwb3J0ID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHdzID0gYXdhaXQgd2Vic29ja2V0UHJvbWlzZTtcbiAgICBpZiAoIXJlcG9ydGluZ0FjdGl2ZSB8fCAhd3MpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgcGxheWJhY2tTY29yZSA9IG1vbml0b3IuY2FsY3VsYXRlU2NvcmUoKTtcbiAgICBpZiAocGxheWJhY2tTY29yZSAhPT0gbnVsbCkge1xuICAgICAgbWV0cmljc1N0YXR1cy5zZXRQbGF5YmFja1Njb3JlKHBsYXliYWNrU2NvcmUpO1xuICAgIH1cbiAgICBjb25zdCBtZXRyaWNzID0gbWV0cmljc1N0YXR1cy5nZXRNZXRyaWNzKCk7XG4gICAgY29uc3QgZCA9IHt9O1xuICAgIGxldCBrZXk7XG4gICAgZm9yIChrZXkgaW4gbWV0cmljcy5jdXJyZW50KSB7XG4gICAgICBjb25zdCB2YWwgPSBtZXRyaWNzLmN1cnJlbnRba2V5XTtcbiAgICAgIGNvbnN0IHNob3VsZFNlbmRWYWx1ZSA9IHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIgPyBOdW1iZXIuaXNGaW5pdGUodmFsKSAmJiAhTnVtYmVyLmlzTmFOKHZhbCkgJiYgdmFsID49IDAgOiBCb29sZWFuKHZhbCk7XG4gICAgICBpZiAoc2hvdWxkU2VuZFZhbHVlICYmIHZhbCAhPT0gbWV0cmljcz8ucHJldmlvdXM/LltrZXldKSB7XG4gICAgICAgIGRba2V5XSA9IHZhbDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKGQpLmxlbmd0aCA+IDApIHtcbiAgICAgIHNlbmQod3MsIGQpO1xuICAgIH1cbiAgICBpZiAodGltZXIpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgfVxuICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXBvcnQoKTtcbiAgICB9LCAxZTMpO1xuICB9O1xuICBjb25zdCBjcmVhdGVOZXdXZWJTb2NrZXQgPSBhc3luYyAocGxheWJhY2tJZCwgY3VycmVudFNvdXJjZSwgbnVtUmV0cmllcyA9IDApID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFwbGF5YmFja0lkIHx8ICFjdXJyZW50U291cmNlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJldldlYnNvY2tldCA9IGF3YWl0IHdlYnNvY2tldFByb21pc2U7XG4gICAgICBwcmV2V2Vic29ja2V0Py5jbG9zZT8uKDMwNzcpO1xuICAgICAgY29uc3QgcmVwb3J0aW5nV2Vic29ja2V0VXJsID0gYXdhaXQgZ2V0TWV0cmljc1JlcG9ydGluZ1dlYnNvY2tldFVybCh7XG4gICAgICAgIHBsYXliYWNrSWQsXG4gICAgICAgIHBsYXliYWNrVXJsOiBjdXJyZW50U291cmNlLFxuICAgICAgICBzZXNzaW9uVG9rZW46IHN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zZXNzaW9uVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKHJlcG9ydGluZ1dlYnNvY2tldFVybCkge1xuICAgICAgICBjb25zdCBuZXdXZWJTb2NrZXQgPSBuZXcgV2ViU29ja2V0KHJlcG9ydGluZ1dlYnNvY2tldFVybCk7XG4gICAgICAgIG5ld1dlYlNvY2tldC5hZGRFdmVudExpc3RlbmVyKFwib3BlblwiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgcmVwb3J0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBuZXdXZWJTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChldmVudD8uZGF0YSkge1xuICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcbiAgICAgICAgICAgICAgc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnNldFdlYnNvY2tldE1ldGFkYXRhKGpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBwYXJzZSBtZXRhZGF0YSBmcm9tIHdlYnNvY2tldC5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbmV3V2ViU29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbG9zZVwiLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHRpbWVyKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZXRUaW1lb3V0KFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBpZiAocmVwb3J0aW5nQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgd2Vic29ja2V0UHJvbWlzZSA9IGNyZWF0ZU5ld1dlYlNvY2tldChcbiAgICAgICAgICAgICAgICAgIHBsYXliYWNrSWQsXG4gICAgICAgICAgICAgICAgICBjdXJyZW50U291cmNlLFxuICAgICAgICAgICAgICAgICAgbnVtUmV0cmllcyArIDFcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMiAqKiBudW1SZXRyaWVzICogMWUzXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXdXZWJTb2NrZXQ7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG4gIGNvbnN0IGRlc3Ryb3lNZXRyaWNzTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiAoe1xuICAgICAgcGxheWJhY2tJZDogc3RhdGUuX19jb250cm9scy5wbGF5YmFja0lkLFxuICAgICAgZmluYWxVcmw6IHN0YXRlLmN1cnJlbnRVcmwsXG4gICAgICB0eXBlOiBzdGF0ZS5jdXJyZW50U291cmNlPy50eXBlXG4gICAgfSksXG4gICAgKHN0YXRlKSA9PiB7XG4gICAgICBpZiAoc3RhdGU/LnBsYXliYWNrSWQgJiYgc3RhdGU/LmZpbmFsVXJsKSB7XG4gICAgICAgIHdlYnNvY2tldFByb21pc2UgPSBjcmVhdGVOZXdXZWJTb2NrZXQoc3RhdGUucGxheWJhY2tJZCwgc3RhdGUuZmluYWxVcmwpO1xuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgZmlyZUltbWVkaWF0ZWx5OiB0cnVlLFxuICAgICAgZXF1YWxpdHlGbjogKGEsIGIpID0+IHtcbiAgICAgICAgcmV0dXJuIGEucGxheWJhY2tJZCA9PT0gYi5wbGF5YmFja0lkICYmIEJvb2xlYW4oYS5maW5hbFVybCk7XG4gICAgICB9XG4gICAgfVxuICApO1xuICB0cnkge1xuICAgIGNvbnN0IGRlc3Ryb3lUdGZmTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoKHN0YXRlLCBwcmV2U3RhdGUpID0+IHtcbiAgICAgIGlmIChzdGF0ZS5wbGF5aW5nICE9PSBwcmV2U3RhdGUucGxheWluZyAmJiBtZXRyaWNzU3RhdHVzLmdldEZpcnN0UGxheWJhY2soKSA9PT0gbnVsbCkge1xuICAgICAgICBtZXRyaWNzU3RhdHVzLnNldEZpcnN0UGxheWJhY2soKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5wcm9ncmVzcyAhPT0gcHJldlN0YXRlLnByb2dyZXNzICYmIG1ldHJpY3NTdGF0dXMuZ2V0Rmlyc3RGcmFtZVRpbWUoKSA9PT0gbnVsbCkge1xuICAgICAgICBtZXRyaWNzU3RhdHVzLnNldEZpcnN0RnJhbWVUaW1lKCk7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUuZXJyb3I/Lm1lc3NhZ2UgJiYgc3RhdGUuZXJyb3I/Lm1lc3NhZ2UgIT09IHByZXZTdGF0ZS5lcnJvcj8ubWVzc2FnZSkge1xuICAgICAgICBtZXRyaWNzU3RhdHVzLmFkZEVycm9yKHN0YXRlLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IGRlc3Ryb3lNb25pdG9yTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoKHN0YXRlLCBwcmV2U3RhdGUpID0+IHtcbiAgICAgIGlmIChzdGF0ZS5wbGF5aW5nICE9PSBwcmV2U3RhdGUucGxheWluZyAmJiBzdGF0ZS5wbGF5aW5nIHx8IHN0YXRlLmxvYWRpbmcgIT09IHByZXZTdGF0ZS5sb2FkaW5nICYmIHN0YXRlLmxvYWRpbmcpIHtcbiAgICAgICAgbW9uaXRvci5pbml0KCk7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUuX19jb250cm9scy5yZXF1ZXN0ZWRSYW5nZVRvU2Vla1RvICE9PSBwcmV2U3RhdGUuX19jb250cm9scy5yZXF1ZXN0ZWRSYW5nZVRvU2Vla1RvKSB7XG4gICAgICAgIG1vbml0b3IucmVzZXQoKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5wbGF5aW5nICE9PSBwcmV2U3RhdGUucGxheWluZyAmJiAhc3RhdGUucGxheWluZykge1xuICAgICAgICBtb25pdG9yLmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCBkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgcmVwb3J0aW5nQWN0aXZlID0gZmFsc2U7XG4gICAgICBkZXN0cm95TWV0cmljc0xpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lNb25pdG9yTGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVR0ZmZMaXN0ZW5lcj8uKCk7XG4gICAgICBtb25pdG9yPy5kZXN0cm95Py4oKTtcbiAgICAgIG1ldHJpY3NTdGF0dXM/LmRlc3Ryb3k/LigpO1xuICAgICAgaWYgKHRpbWVyKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB9XG4gICAgICBpZiAod2Vic29ja2V0UHJvbWlzZSkge1xuICAgICAgICB3ZWJzb2NrZXRQcm9taXNlLnRoZW4oKHdlYnNvY2tldCkgPT4ge1xuICAgICAgICAgIHdlYnNvY2tldD8uY2xvc2UoMzA3Nyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHsgbWV0cmljczogbWV0cmljc1N0YXR1cywgZGVzdHJveSB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihlKTtcbiAgfVxuICByZXR1cm4gZGVmYXVsdFJlc3BvbnNlO1xufVxuZnVuY3Rpb24gc2VuZCh3ZWJTb2NrZXQsIG1ldHJpY3MpIHtcbiAgaWYgKHdlYlNvY2tldC5yZWFkeVN0YXRlICE9PSB3ZWJTb2NrZXQuT1BFTikge1xuICAgIHJldHVybjtcbiAgfVxuICB3ZWJTb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShtZXRyaWNzKSk7XG59XG5cbi8vIHNyYy91dGlscy9kZWVwTWVyZ2UudHNcbnZhciBpc09iamVjdCA9IChvYmopID0+IHtcbiAgaWYgKHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgJiYgb2JqICE9PSBudWxsKSB7XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0UHJvdG90eXBlT2YgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY29uc3QgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaik7XG4gICAgICByZXR1cm4gcHJvdG90eXBlID09PSBPYmplY3QucHJvdG90eXBlIHx8IHByb3RvdHlwZSA9PT0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgT2JqZWN0XVwiO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG52YXIgbWVyZ2UgPSAoLi4ub2JqZWN0cykgPT4gb2JqZWN0cy5yZWR1Y2UoKHJlc3VsdCwgY3VycmVudCkgPT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShjdXJyZW50KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBcIkFyZ3VtZW50cyBwcm92aWRlZCB0byB0cy1kZWVwbWVyZ2UgbXVzdCBiZSBvYmplY3RzLCBub3QgYXJyYXlzLlwiXG4gICAgKTtcbiAgfVxuICBPYmplY3Qua2V5cyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBpZiAoW1wiX19wcm90b19fXCIsIFwiY29uc3RydWN0b3JcIiwgXCJwcm90b3R5cGVcIl0uaW5jbHVkZXMoa2V5KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHRba2V5XSkgJiYgQXJyYXkuaXNBcnJheShjdXJyZW50W2tleV0pKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlLm9wdGlvbnMubWVyZ2VBcnJheXMgPyBBcnJheS5mcm9tKG5ldyBTZXQocmVzdWx0W2tleV0uY29uY2F0KGN1cnJlbnRba2V5XSkpKSA6IGN1cnJlbnRba2V5XTtcbiAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KHJlc3VsdFtrZXldKSAmJiBpc09iamVjdChjdXJyZW50W2tleV0pKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlKHJlc3VsdFtrZXldLCBjdXJyZW50W2tleV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRba2V5XSA9IGN1cnJlbnRba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufSwge30pO1xudmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICBtZXJnZUFycmF5czogdHJ1ZVxufTtcbm1lcmdlLm9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbm1lcmdlLndpdGhPcHRpb25zID0gKG9wdGlvbnMsIC4uLm9iamVjdHMpID0+IHtcbiAgbWVyZ2Uub3B0aW9ucyA9IHtcbiAgICBtZXJnZUFycmF5czogdHJ1ZSxcbiAgICAuLi5vcHRpb25zXG4gIH07XG4gIGNvbnN0IHJlc3VsdCA9IG1lcmdlKC4uLm9iamVjdHMpO1xuICBtZXJnZS5vcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyBzcmMvdXRpbHMvc3RvcmFnZS9pcGZzLnRzXG5pbXBvcnQgeyBDSUQgfSBmcm9tIFwibXVsdGlmb3JtYXRzL2NpZFwiO1xuXG4vLyBzcmMvdXRpbHMvd2Fybi50c1xudmFyIGNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHdhcm4obWVzc2FnZSwgaWQpIHtcbiAgaWYgKCFjYWNoZS5oYXMoaWQgPz8gbWVzc2FnZSkpIHtcbiAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG4gICAgY2FjaGUuYWRkKG1lc3NhZ2UpO1xuICB9XG59XG5cbi8vIHNyYy9tZWRpYS9tZXRyaWNzLW5ldy50c1xudmFyIGdsb2JhbExvYWRUaW1lc3RhbXBNcyA9IERhdGUubm93KCk7XG5mdW5jdGlvbiBhZGRNZXRyaWNzVG9TdG9yZShzdG9yZSwgb3B0cykge1xuICBjb25zdCBkZWZhdWx0UmVzcG9uc2UgPSB7XG4gICAgZGVzdHJveTogKCkgPT4ge1xuICAgIH1cbiAgfTtcbiAgaWYgKCFzdG9yZSkge1xuICAgIHJldHVybiBkZWZhdWx0UmVzcG9uc2U7XG4gIH1cbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gZGVmYXVsdFJlc3BvbnNlO1xuICB9XG4gIGNvbnN0IG1vbml0b3IgPSBuZXcgTWV0cmljc01vbml0b3Ioc3RvcmUsIHtcbiAgICBkaXNhYmxlUHJvZ3Jlc3NMaXN0ZW5lcjogb3B0cz8uZGlzYWJsZVByb2dyZXNzTGlzdGVuZXJcbiAgfSk7XG4gIGNvbnN0IGlzU2VuZEJlYWNvbkF2YWlsYWJsZSA9IFwic2VuZEJlYWNvblwiIGluIHdpbmRvdy5uYXZpZ2F0b3I7XG4gIGNvbnN0IGludGVydmFsID0gb3B0cz8uaW50ZXJ2YWwgPz8gNWUzO1xuICBjb25zdCBldmVudEJ1ZmZlciA9IG5ldyBQbGF5YmFja0V2ZW50QnVmZmVyKCk7XG4gIGNvbnN0IGRlc3Ryb3lGaW5hbFVybExpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gKHtcbiAgICAgIGZpbmFsVXJsOiBzdGF0ZS5jdXJyZW50VXJsXG4gICAgfSksXG4gICAgYXN5bmMgKHN0YXRlKSA9PiB7XG4gICAgICBpZiAoc3RhdGU/LmZpbmFsVXJsKSB7XG4gICAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGdldE1ldHJpY3NSZXBvcnRpbmdQT1NUVXJsKHtcbiAgICAgICAgICBwbGF5YmFja1VybDogc3RhdGUuZmluYWxVcmxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgICBzdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0TWV0cmljc1JlcG9ydGluZ1VybCh1cmwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBmaXJlSW1tZWRpYXRlbHk6IHRydWUsXG4gICAgICBlcXVhbGl0eUZuOiAoYSwgYikgPT4ge1xuICAgICAgICByZXR1cm4gYS5maW5hbFVybCA9PT0gYi5maW5hbFVybDtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lFcnJvckxpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuZXJyb3IsXG4gICAgYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoXG4gICAgICAgICAgZXJyb3IudHlwZSA9PT0gXCJvZmZsaW5lXCIgfHwgZXJyb3IudHlwZSA9PT0gXCJmYWxsYmFja1wiID8ge1xuICAgICAgICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgICAgICAgIHR5cGU6IFwid2FybmluZ1wiLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgY2F0ZWdvcnk6IGVycm9yLnR5cGUsXG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgIGlkOiBnZW5lcmF0ZVJhbmRvbVRva2VuKCksXG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjYXRlZ29yeTogZXJyb3IudHlwZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICApO1xuICBjb25zdCBkZXN0cm95UGxheUxpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuX19jb250cm9scy5wbGF5TGFzdFRpbWUsXG4gICAgYXN5bmMgKHRpbWVzdGFtcCkgPT4ge1xuICAgICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoe1xuICAgICAgICBpZDogZ2VuZXJhdGVSYW5kb21Ub2tlbigpLFxuICAgICAgICB0eXBlOiBcInBsYXlcIixcbiAgICAgICAgdGltZXN0YW1wXG4gICAgICB9KTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lQYXVzZUxpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgIChzdGF0ZSkgPT4gc3RhdGUuX19jb250cm9scy5wYXVzZUxhc3RUaW1lLFxuICAgIGFzeW5jICh0aW1lc3RhbXApID0+IHtcbiAgICAgIGV2ZW50QnVmZmVyLmFkZEV2ZW50KHtcbiAgICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgICAgdHlwZTogXCJwYXVzZVwiLFxuICAgICAgICB0aW1lc3RhbXBcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveUNsaXBMaXN0ZW5lciA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucmVxdWVzdGVkQ2xpcFBhcmFtcyxcbiAgICBhc3luYyAocGFyYW1zKSA9PiB7XG4gICAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgIGV2ZW50QnVmZmVyLmFkZEV2ZW50KHtcbiAgICAgICAgICBpZDogZ2VuZXJhdGVSYW5kb21Ub2tlbigpLFxuICAgICAgICAgIHR5cGU6IFwiY2xpcFwiLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICBzdGFydFRpbWU6IHBhcmFtcy5zdGFydFRpbWUsXG4gICAgICAgICAgZW5kVGltZTogcGFyYW1zLmVuZFRpbWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICApO1xuICBjb25zdCBkZXN0cm95UGlwTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiBzdGF0ZS5waWN0dXJlSW5QaWN0dXJlLFxuICAgIGFzeW5jIChwaWN0dXJlSW5QaWN0dXJlKSA9PiB7XG4gICAgICBldmVudEJ1ZmZlci5hZGRFdmVudCh7XG4gICAgICAgIGlkOiBnZW5lcmF0ZVJhbmRvbVRva2VuKCksXG4gICAgICAgIHR5cGU6IHBpY3R1cmVJblBpY3R1cmUgPyBcImVudGVyLXBpcFwiIDogXCJleGl0LXBpcFwiLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveUZ1bGxzY3JlZW5MaXN0ZW5lciA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLmZ1bGxzY3JlZW4sXG4gICAgYXN5bmMgKGZ1bGxzY3JlZW4pID0+IHtcbiAgICAgIGV2ZW50QnVmZmVyLmFkZEV2ZW50KHtcbiAgICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgICAgdHlwZTogZnVsbHNjcmVlbiA/IFwiZW50ZXItZnVsbHNjcmVlblwiIDogXCJleGl0LWZ1bGxzY3JlZW5cIixcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICB9KTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGRlc3Ryb3lDYW5QbGF5TGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiBzdGF0ZS5jYW5QbGF5LFxuICAgIGFzeW5jIChjYW5QbGF5KSA9PiB7XG4gICAgICBpZiAoY2FuUGxheSkge1xuICAgICAgICBldmVudEJ1ZmZlci5hZGRFdmVudCh7XG4gICAgICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgICAgICB0eXBlOiBcImNhbi1wbGF5XCIsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveUVuZGVkTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiBzdGF0ZS5lbmRlZCxcbiAgICBhc3luYyAoZW5kZWQpID0+IHtcbiAgICAgIGlmIChlbmRlZCkge1xuICAgICAgICBldmVudEJ1ZmZlci5hZGRFdmVudCh7XG4gICAgICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgICAgICB0eXBlOiBcImVuZGVkXCIsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveVJhdGVDaGFuZ2VMaXN0ZW5lciA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLnBsYXliYWNrUmF0ZSxcbiAgICBhc3luYyAocGxheWJhY2tSYXRlKSA9PiB7XG4gICAgICBldmVudEJ1ZmZlci5hZGRFdmVudCh7XG4gICAgICAgIGlkOiBnZW5lcmF0ZVJhbmRvbVRva2VuKCksXG4gICAgICAgIHR5cGU6IFwicmF0ZVwiLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIHBheWxvYWQ6IHBsYXliYWNrUmF0ZVxuICAgICAgfSk7XG4gICAgfVxuICApO1xuICBjb25zdCBkZXN0cm95VmlkZW9RdWFsaXR5TGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgKHN0YXRlKSA9PiBzdGF0ZS52aWRlb1F1YWxpdHksXG4gICAgYXN5bmMgKHZpZGVvUXVhbGl0eSkgPT4ge1xuICAgICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoe1xuICAgICAgICBpZDogZ2VuZXJhdGVSYW5kb21Ub2tlbigpLFxuICAgICAgICB0eXBlOiBcInZpZGVvLXF1YWxpdHlcIixcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBwYXlsb2FkOiB2aWRlb1F1YWxpdHlcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVzdHJveVNlZWtMaXN0ZW5lciA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucmVxdWVzdGVkUmFuZ2VUb1NlZWtUbyxcbiAgICBhc3luYyAocmFuZ2VUb1NlZWtUbykgPT4ge1xuICAgICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoe1xuICAgICAgICBpZDogZ2VuZXJhdGVSYW5kb21Ub2tlbigpLFxuICAgICAgICB0eXBlOiBcInNlZWtcIixcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBwYXlsb2FkOiByYW5nZVRvU2Vla1RvXG4gICAgICB9KTtcbiAgICB9XG4gICk7XG4gIGNvbnN0IGljID0gbmV3IEluY3JlbWVudGFsQ291bnRlcihbXG4gICAgXCJlcnJvcnNcIixcbiAgICBcIndhcm5pbmdzXCIsXG4gICAgXCJzdGFsbGVkX2NvdW50XCIsXG4gICAgXCJ3YWl0aW5nX2NvdW50XCIsXG4gICAgXCJ0aW1lX3dhcm5pbmdfbXNcIixcbiAgICBcInRpbWVfZXJyb3JlZF9tc1wiLFxuICAgIFwidGltZV9zdGFsbGVkX21zXCIsXG4gICAgXCJ0aW1lX3BsYXlpbmdfbXNcIixcbiAgICBcInRpbWVfd2FpdGluZ19tc1wiXG4gIF0pO1xuICBjb25zdCB2Y3QgPSBuZXcgVmFsdWVDaGFuZ2VUcmFja2VyKFtcbiAgICBcImF1dG9wbGF5X3N0YXR1c1wiLFxuICAgIFwibW91bnRfdG9fZmlyc3RfZnJhbWVfbXNcIixcbiAgICBcIm1vdW50X3RvX3BsYXlfbXNcIixcbiAgICBcInBsYXlfdG9fZmlyc3RfZnJhbWVfbXNcIixcbiAgICBcImR1cmF0aW9uX21zXCIsXG4gICAgXCJvZmZzZXRfbXNcIixcbiAgICBcInZpZGVvX2hlaWdodF9weFwiLFxuICAgIFwidmlkZW9fd2lkdGhfcHhcIixcbiAgICBcInBsYXllcl93aWR0aF9weFwiLFxuICAgIFwicGxheWVyX2hlaWdodF9weFwiLFxuICAgIFwid2luZG93X2hlaWdodF9weFwiLFxuICAgIFwid2luZG93X3dpZHRoX3B4XCJcbiAgXSk7XG4gIGxldCBmaXJzdEZyYW1lU2VudCA9IGZhbHNlO1xuICBjb25zdCBzZW5kRXZlbnRzID0gKHsgaXNVbmxvYWRpbmcgfSA9IHsgaXNVbmxvYWRpbmc6IGZhbHNlIH0pID0+IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjdXJyZW50U3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICAgIGNvbnN0IGN1cnJlbnRDb250cm9sc1N0YXRlID0gY3VycmVudFN0YXRlLl9fY29udHJvbHM7XG4gICAgaWYgKCFjdXJyZW50U3RhdGUuY3VycmVudFNvdXJjZSkge1xuICAgICAgd2FybihcIk5vdCBzZW5kaW5nIG1ldHJpY3Mgc2luY2Ugbm8gY3VycmVudCBwbGF5YmFjayBzb3VyY2UgcGFyc2VkLlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFjdXJyZW50Q29udHJvbHNTdGF0ZS5wbGF5YmFja0lkKSB7XG4gICAgICB3YXJuKFwiTm90IHNlbmRpbmcgbWV0cmljcyBzaW5jZSBubyBwbGF5YmFjayBJRCBwYXJzZWQuXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZXRyaWNzU25hcHNob3QgPSBtb25pdG9yLmdldE1ldHJpY3MoKTtcbiAgICBpZiAoIWZpcnN0RnJhbWVTZW50ICYmIG1vbml0b3IuZmlyc3RGcmFtZVRpbWVzdGFtcCkge1xuICAgICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoe1xuICAgICAgICBpZDogZ2VuZXJhdGVSYW5kb21Ub2tlbigpLFxuICAgICAgICB0eXBlOiBcImZpcnN0LWZyYW1lXCIsXG4gICAgICAgIHRpbWVzdGFtcDogbW9uaXRvci5maXJzdEZyYW1lVGltZXN0YW1wXG4gICAgICB9KTtcbiAgICAgIGZpcnN0RnJhbWVTZW50ID0gdHJ1ZTtcbiAgICB9XG4gICAgZXZlbnRCdWZmZXIuYWRkRXZlbnQoe1xuICAgICAgaWQ6IGdlbmVyYXRlUmFuZG9tVG9rZW4oKSxcbiAgICAgIHR5cGU6IFwiaGVhcnRiZWF0XCIsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBlcnJvcnM6IGljLmNhbGN1bGF0ZUluY3JlbWVudChcImVycm9yc1wiLCBtZXRyaWNzU25hcHNob3QuZXJyb3JDb3VudCksXG4gICAgICB3YXJuaW5nczogaWMuY2FsY3VsYXRlSW5jcmVtZW50KFxuICAgICAgICBcIndhcm5pbmdzXCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC53YXJuaW5nQ291bnRcbiAgICAgICksXG4gICAgICBzdGFsbGVkX2NvdW50OiBpYy5jYWxjdWxhdGVJbmNyZW1lbnQoXG4gICAgICAgIFwic3RhbGxlZF9jb3VudFwiLFxuICAgICAgICBtZXRyaWNzU25hcHNob3Quc3RhbGxlZENvdW50XG4gICAgICApLFxuICAgICAgd2FpdGluZ19jb3VudDogaWMuY2FsY3VsYXRlSW5jcmVtZW50KFxuICAgICAgICBcIndhaXRpbmdfY291bnRcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LndhaXRpbmdDb3VudFxuICAgICAgKSxcbiAgICAgIHRpbWVfZXJyb3JlZF9tczogaWMuY2FsY3VsYXRlSW5jcmVtZW50KFxuICAgICAgICBcInRpbWVfZXJyb3JlZF9tc1wiLFxuICAgICAgICBtZXRyaWNzU25hcHNob3QudGltZUVycm9yZWRcbiAgICAgICksXG4gICAgICB0aW1lX3dhcm5pbmdfbXM6IGljLmNhbGN1bGF0ZUluY3JlbWVudChcbiAgICAgICAgXCJ0aW1lX3dhcm5pbmdfbXNcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LnRpbWVXYXJuaW5nXG4gICAgICApLFxuICAgICAgdGltZV9zdGFsbGVkX21zOiBpYy5jYWxjdWxhdGVJbmNyZW1lbnQoXG4gICAgICAgIFwidGltZV9zdGFsbGVkX21zXCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC50aW1lU3RhbGxlZFxuICAgICAgKSxcbiAgICAgIHRpbWVfcGxheWluZ19tczogaWMuY2FsY3VsYXRlSW5jcmVtZW50KFxuICAgICAgICBcInRpbWVfcGxheWluZ19tc1wiLFxuICAgICAgICBtZXRyaWNzU25hcHNob3QudGltZVBsYXlpbmdcbiAgICAgICksXG4gICAgICB0aW1lX3dhaXRpbmdfbXM6IGljLmNhbGN1bGF0ZUluY3JlbWVudChcbiAgICAgICAgXCJ0aW1lX3dhaXRpbmdfbXNcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LnRpbWVXYWl0aW5nXG4gICAgICApLFxuICAgICAgLy8gVGhlIHByb3BlcnRpZXMgYmVsb3cgYXJlIG9ubHkgc2VudCBvbmNlLlxuICAgICAgYXV0b3BsYXlfc3RhdHVzOiB2Y3Quc2VuZElmQ2hhbmdlZChcbiAgICAgICAgXCJhdXRvcGxheV9zdGF0dXNcIixcbiAgICAgICAgY3VycmVudFN0YXRlLl9faW5pdGlhbFByb3BzLmF1dG9QbGF5ID8gXCJhdXRvcGxheVwiIDogXCJub25lXCJcbiAgICAgICksXG4gICAgICBtb3VudF90b19wbGF5X21zOiB2Y3Quc2VuZElmQ2hhbmdlZChcbiAgICAgICAgXCJtb3VudF90b19wbGF5X21zXCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC5tb3VudFRvUGxheSA/PyB2b2lkIDBcbiAgICAgICksXG4gICAgICBtb3VudF90b19maXJzdF9mcmFtZV9tczogdmN0LnNlbmRJZkNoYW5nZWQoXG4gICAgICAgIFwibW91bnRfdG9fZmlyc3RfZnJhbWVfbXNcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90Lm1vdW50VG9GaXJzdEZyYW1lID8/IHZvaWQgMFxuICAgICAgKSxcbiAgICAgIHBsYXlfdG9fZmlyc3RfZnJhbWVfbXM6IHZjdC5zZW5kSWZDaGFuZ2VkKFxuICAgICAgICBcInBsYXlfdG9fZmlyc3RfZnJhbWVfbXNcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LnBsYXlUb0ZpcnN0RnJhbWUgPz8gdm9pZCAwXG4gICAgICApLFxuICAgICAgZHVyYXRpb25fbXM6IGN1cnJlbnRTdGF0ZT8ubGl2ZSA/IHZvaWQgMCA6IHZjdC5zZW5kSWZDaGFuZ2VkKFxuICAgICAgICBcImR1cmF0aW9uX21zXCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC5kdXJhdGlvbiA/PyB2b2lkIDBcbiAgICAgICksXG4gICAgICBvZmZzZXRfbXM6IHZjdC5zZW5kSWZDaGFuZ2VkKFxuICAgICAgICBcIm9mZnNldF9tc1wiLFxuICAgICAgICBtZXRyaWNzU25hcHNob3Qub2Zmc2V0ID8/IHZvaWQgMFxuICAgICAgKSxcbiAgICAgIC8vIFRoZSBwcm9wZXJ0aWVzIGJlbG93IGFyZSBvbmx5IHNlbnQgd2hlbiB0aGV5IGNoYW5nZS5cbiAgICAgIHZpZGVvX2hlaWdodF9weDogdmN0LnNlbmRJZkNoYW5nZWQoXG4gICAgICAgIFwidmlkZW9faGVpZ2h0X3B4XCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC52aWRlb0hlaWdodCA/PyB2b2lkIDBcbiAgICAgICksXG4gICAgICB2aWRlb193aWR0aF9weDogdmN0LnNlbmRJZkNoYW5nZWQoXG4gICAgICAgIFwidmlkZW9fd2lkdGhfcHhcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LnZpZGVvV2lkdGggPz8gdm9pZCAwXG4gICAgICApLFxuICAgICAgcGxheWVyX2hlaWdodF9weDogdmN0LnNlbmRJZkNoYW5nZWQoXG4gICAgICAgIFwicGxheWVyX2hlaWdodF9weFwiLFxuICAgICAgICBtZXRyaWNzU25hcHNob3QucGxheWVySGVpZ2h0ID8/IHZvaWQgMFxuICAgICAgKSxcbiAgICAgIHBsYXllcl93aWR0aF9weDogdmN0LnNlbmRJZkNoYW5nZWQoXG4gICAgICAgIFwicGxheWVyX3dpZHRoX3B4XCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC5wbGF5ZXJXaWR0aCA/PyB2b2lkIDBcbiAgICAgICksXG4gICAgICB3aW5kb3dfaGVpZ2h0X3B4OiB2Y3Quc2VuZElmQ2hhbmdlZChcbiAgICAgICAgXCJ3aW5kb3dfaGVpZ2h0X3B4XCIsXG4gICAgICAgIG1ldHJpY3NTbmFwc2hvdC53aW5kb3dIZWlnaHQgPz8gdm9pZCAwXG4gICAgICApLFxuICAgICAgd2luZG93X3dpZHRoX3B4OiB2Y3Quc2VuZElmQ2hhbmdlZChcbiAgICAgICAgXCJ3aW5kb3dfd2lkdGhfcHhcIixcbiAgICAgICAgbWV0cmljc1NuYXBzaG90LndpbmRvd1dpZHRoID8/IHZvaWQgMFxuICAgICAgKVxuICAgIH0pO1xuICAgIGNvbnN0IGludGVybmFsRXZlbnRzID0gZXZlbnRCdWZmZXIuZ2V0SW50ZXJuYWxFdmVudHMoKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgb3B0cz8ub25QbGF5YmFja0V2ZW50cz8uKGludGVybmFsRXZlbnRzKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgZXZlbnRCdWZmZXIub25JbnRlcm5hbEZhaWx1cmUoaW50ZXJuYWxFdmVudHMpO1xuICAgIH1cbiAgICBjb25zdCBtZXRyaWNzVXJsID0gY3VycmVudFN0YXRlLm1ldHJpY3NSZXBvcnRpbmdVcmw7XG4gICAgaWYgKG1ldHJpY3NVcmwpIHtcbiAgICAgIGNvbnN0IGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgIGNvbnN0IGlkID0gc2V0VGltZW91dChcbiAgICAgICAgKCkgPT4gYWJvcnRDb250cm9sbGVyLmFib3J0KCksXG4gICAgICAgIGludGVydmFsIC0gNTAwXG4gICAgICAgIC8vIHdlIGFib3J0IDUwMG1zIGJlZm9yZSB0aGUgbmV4dCByZXF1ZXN0IGlzIHNjaGVkdWxlZFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGV4dGVybmFsRXZlbnRzID0gZXZlbnRCdWZmZXIuZ2V0RXh0ZXJuYWxFdmVudHMoKTtcbiAgICAgIGlmIChpc1VubG9hZGluZyAmJiBleHRlcm5hbEV2ZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgd2luZG93SHJlZiA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3c/LmxvY2F0aW9uPy5ocmVmID8/IG51bGwgOiBudWxsO1xuICAgICAgICBjb25zdCBwYWdlVXJsU3RyaW5nID0gaXNJbklmcmFtZTIoKSA/IHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiA/IGRvY3VtZW50Py5yZWZlcnJlciB8fCB3aW5kb3dIcmVmIDogd2luZG93SHJlZiA6IHdpbmRvd0hyZWY7XG4gICAgICAgIGNvbnN0IHBhZ2VVcmwgPSBwYWdlVXJsU3RyaW5nID8gbmV3IFVSTChwYWdlVXJsU3RyaW5nKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IHBsYXllclByZWZpeCA9IGN1cnJlbnRTdGF0ZT8uY3VycmVudFNvdXJjZT8udHlwZSA/PyBcInVua25vd25cIjtcbiAgICAgICAgY29uc3QgdmVyc2lvbiA9IGN1cnJlbnRTdGF0ZT8uX19kZXZpY2UudmVyc2lvbiA/PyBcInVua25vd25cIjtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSB7XG4gICAgICAgICAgbGl2ZTogY3VycmVudFN0YXRlLmxpdmUsXG4gICAgICAgICAgc2Vzc2lvbl9pZDogY3VycmVudENvbnRyb2xzU3RhdGUuc2Vzc2lvblRva2VuLFxuICAgICAgICAgIHBsYXliYWNrX2lkOiBjdXJyZW50Q29udHJvbHNTdGF0ZS5wbGF5YmFja0lkLFxuICAgICAgICAgIHByb3RvY29sOiBjdXJyZW50U3RhdGUuY3VycmVudFNvdXJjZS5taW1lID8/IHZvaWQgMCxcbiAgICAgICAgICBkb21haW46IHBhZ2VVcmw/Lmhvc3RuYW1lID8/IG51bGwsXG4gICAgICAgICAgcGF0aDogcGFnZVVybD8ucGF0aG5hbWUgPz8gbnVsbCxcbiAgICAgICAgICBwYXJhbXM6IHBhZ2VVcmw/LnNlYXJjaCA/PyBudWxsLFxuICAgICAgICAgIGhhc2g6IHBhZ2VVcmw/Lmhhc2ggPz8gbnVsbCxcbiAgICAgICAgICBzb3VyY2VfdXJsOiBjdXJyZW50U3RhdGUuY3VycmVudFNvdXJjZS5zcmMsXG4gICAgICAgICAgcGxheWVyOiBwbGF5ZXJQcmVmaXgsXG4gICAgICAgICAgdmVyc2lvbixcbiAgICAgICAgICB1c2VyX2FnZW50OiBTdHJpbmcoY3VycmVudFN0YXRlPy5fX2RldmljZT8udXNlckFnZW50ID8/IFwiXCIpLnJlcGxhY2UoXG4gICAgICAgICAgICAvXFxcXHxcIi9nbSxcbiAgICAgICAgICAgIFwiXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHVpZDogY3VycmVudFN0YXRlLl9faW5pdGlhbFByb3BzLnZpZXdlcklkID8/IHZvaWQgMCxcbiAgICAgICAgICBldmVudHM6IGV4dGVybmFsRXZlbnRzXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeShzZXNzaW9uRGF0YSk7XG4gICAgICAgIGlmIChpc1VubG9hZGluZyAmJiBpc1NlbmRCZWFjb25BdmFpbGFibGUpIHtcbiAgICAgICAgICBjb25zdCBzdWNjZXNzID0gd2luZG93Py5uYXZpZ2F0b3I/LnNlbmRCZWFjb24/LihtZXRyaWNzVXJsLCBkYXRhKTtcbiAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkJlYWNvbiByZXNwb25zZSB3YXMgbm90IE9LXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKG1ldHJpY3NVcmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBtb2RlOiBcImNvcnNcIixcbiAgICAgICAgICAgIGJvZHk6IGRhdGEsXG4gICAgICAgICAgICBzaWduYWw6IGFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmV0Y2ggcmVzcG9uc2Ugd2FzIG5vdCBPS1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBuZXcgRXJyb3IoXG4gICAgICAgICAgICBlPy5tZXNzYWdlID8/IFwiRXJyb3Igd2l0aCBtZXRyaWNzIHJlcG9ydGluZywgcmUtZW5xdWV1aW5nIGV2ZW50cy4uLlwiXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgICBldmVudEJ1ZmZlci5vbkV4dGVybmFsRmFpbHVyZShleHRlcm5hbEV2ZW50cyk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhclRpbWVvdXQoaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgZXZlbnRzVGltZXIgPSBzZXRJbnRlcnZhbChzZW5kRXZlbnRzKCksIGludGVydmFsKTtcbiAgY29uc3QgdW5sb2FkRXZlbnQgPSBcIm9ucGFnZWhpZGVcIiBpbiBzZWxmID8gXCJwYWdlaGlkZVwiIDogXCJ1bmxvYWRcIjtcbiAgY29uc3QgdW5sb2FkaW5nQ2FsbGJhY2sgPSBzZW5kRXZlbnRzKHsgaXNVbmxvYWRpbmc6IHRydWUgfSk7XG4gIHdpbmRvdz8uYWRkRXZlbnRMaXN0ZW5lcj8uKHVubG9hZEV2ZW50LCB1bmxvYWRpbmdDYWxsYmFjayk7XG4gIGNvbnN0IG9uVmlzaWJpbGl0eUNoYW5nZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSBcImhpZGRlblwiKSB7XG4gICAgICByZXR1cm4gdW5sb2FkaW5nQ2FsbGJhY2soKTtcbiAgICB9XG4gIH07XG4gIHdpbmRvdz8uYWRkRXZlbnRMaXN0ZW5lcj8uKFwidmlzaWJpbGl0eWNoYW5nZVwiLCBvblZpc2liaWxpdHlDaGFuZ2UpO1xuICByZXR1cm4ge1xuICAgIGRlc3Ryb3k6ICgpID0+IHtcbiAgICAgIGlmIChldmVudHNUaW1lcikge1xuICAgICAgICBjbGVhckludGVydmFsPy4oZXZlbnRzVGltZXIpO1xuICAgICAgfVxuICAgICAgZGVzdHJveUNhblBsYXlMaXN0ZW5lcj8uKCk7XG4gICAgICBkZXN0cm95Q2xpcExpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lFbmRlZExpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lFcnJvckxpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lGaW5hbFVybExpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lGdWxsc2NyZWVuTGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVBpcExpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lQbGF5TGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVBhdXNlTGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVJhdGVDaGFuZ2VMaXN0ZW5lcj8uKCk7XG4gICAgICBkZXN0cm95U2Vla0xpc3RlbmVyPy4oKTtcbiAgICAgIGRlc3Ryb3lWaWRlb1F1YWxpdHlMaXN0ZW5lcj8uKCk7XG4gICAgICB3aW5kb3c/LnJlbW92ZUV2ZW50TGlzdGVuZXI/LihcInZpc2liaWxpdHljaGFuZ2VcIiwgb25WaXNpYmlsaXR5Q2hhbmdlKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBpc0luSWZyYW1lMigpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG52YXIgUGxheWJhY2tFdmVudEJ1ZmZlciA9IGNsYXNzIHtcbiAgaW50ZXJuYWxCdWZmZXIgPSBbXTtcbiAgZXh0ZXJuYWxCdWZmZXIgPSBbXTtcbiAgLy8gd2UgY2FwIGF0IDI1ayBldmVudHMsIHdoaWNoIGFzc3VtZWQgdGhhdCBlYWNoIGV2ZW50IGNvdWxkIGJlIG1heCAyMDAgYnl0ZXNcbiAgLy8gdGhpcyBzaG91bGQgYmUgcmV2aXNlZCB3aGVuIGV2ZW50IHN0cnVjdHVyZSBjaGFuZ2VzXG4gIG1heEJ1ZmZlclNpemUgPSAyNWUzO1xuICBhZGRFdmVudChldmVudCkge1xuICAgIHRoaXMuYWRkRXZlbnRzKFtldmVudF0pO1xuICB9XG4gIGFkZEV2ZW50cyhldmVudHMpIHtcbiAgICBmb3IgKGNvbnN0IG5ld0V2ZW50IG9mIFsuLi5ldmVudHNdKSB7XG4gICAgICBpZiAobmV3RXZlbnQudHlwZSAhPT0gXCJoZWFydGJlYXRcIikge1xuICAgICAgICB0aGlzLmV4dGVybmFsQnVmZmVyLnB1c2gobmV3RXZlbnQpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4aXN0aW5nRXZlbnRJbmRleCA9IHRoaXMuZXh0ZXJuYWxCdWZmZXIuZmluZEluZGV4KFxuICAgICAgICAoZXZlbnQpID0+IGV2ZW50LnR5cGUgPT09IFwiaGVhcnRiZWF0XCJcbiAgICAgICk7XG4gICAgICBpZiAoZXhpc3RpbmdFdmVudEluZGV4ID09PSAtMSkge1xuICAgICAgICB0aGlzLmV4dGVybmFsQnVmZmVyLnB1c2gobmV3RXZlbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdFdmVudCA9IHRoaXMuZXh0ZXJuYWxCdWZmZXJbZXhpc3RpbmdFdmVudEluZGV4XTtcbiAgICAgICAgY29uc3QgbWVyZ2VkRXZlbnQgPSB7XG4gICAgICAgICAgLi4uZXhpc3RpbmdFdmVudCxcbiAgICAgICAgICBpZDogZXhpc3RpbmdFdmVudC5pZCxcbiAgICAgICAgICB0aW1lc3RhbXA6IE1hdGgubWF4KGV4aXN0aW5nRXZlbnQudGltZXN0YW1wLCBuZXdFdmVudC50aW1lc3RhbXApLFxuICAgICAgICAgIG9sZGVzdF9idWZmZXJfdGltZXN0YW1wOiBNYXRoLm1pbihcbiAgICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgICBleGlzdGluZ0V2ZW50Lm9sZGVzdF9idWZmZXJfdGltZXN0YW1wID8/IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLFxuICAgICAgICAgICAgICBuZXdFdmVudC50aW1lc3RhbXAgPz8gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBleGlzdGluZ0V2ZW50LnRpbWVzdGFtcFxuICAgICAgICAgICksXG4gICAgICAgICAgZXJyb3JzOiBleGlzdGluZ0V2ZW50LmVycm9ycyArIG5ld0V2ZW50LmVycm9ycyxcbiAgICAgICAgICB3YXJuaW5nczogZXhpc3RpbmdFdmVudC53YXJuaW5ncyArIG5ld0V2ZW50Lndhcm5pbmdzLFxuICAgICAgICAgIHN0YWxsZWRfY291bnQ6IGV4aXN0aW5nRXZlbnQuc3RhbGxlZF9jb3VudCArIG5ld0V2ZW50LnN0YWxsZWRfY291bnQsXG4gICAgICAgICAgd2FpdGluZ19jb3VudDogZXhpc3RpbmdFdmVudC53YWl0aW5nX2NvdW50ICsgbmV3RXZlbnQud2FpdGluZ19jb3VudCxcbiAgICAgICAgICB0aW1lX3dhcm5pbmdfbXM6IGV4aXN0aW5nRXZlbnQudGltZV93YXJuaW5nX21zICsgbmV3RXZlbnQudGltZV93YXJuaW5nX21zLFxuICAgICAgICAgIHRpbWVfZXJyb3JlZF9tczogZXhpc3RpbmdFdmVudC50aW1lX2Vycm9yZWRfbXMgKyBuZXdFdmVudC50aW1lX2Vycm9yZWRfbXMsXG4gICAgICAgICAgdGltZV9zdGFsbGVkX21zOiBleGlzdGluZ0V2ZW50LnRpbWVfc3RhbGxlZF9tcyArIG5ld0V2ZW50LnRpbWVfc3RhbGxlZF9tcyxcbiAgICAgICAgICB0aW1lX3BsYXlpbmdfbXM6IGV4aXN0aW5nRXZlbnQudGltZV9wbGF5aW5nX21zICsgbmV3RXZlbnQudGltZV9wbGF5aW5nX21zLFxuICAgICAgICAgIHRpbWVfd2FpdGluZ19tczogZXhpc3RpbmdFdmVudC50aW1lX3dhaXRpbmdfbXMgKyBuZXdFdmVudC50aW1lX3dhaXRpbmdfbXMsXG4gICAgICAgICAgLi4uZXhpc3RpbmdFdmVudC5tb3VudF90b19maXJzdF9mcmFtZV9tcyB8fCBuZXdFdmVudC5tb3VudF90b19maXJzdF9mcmFtZV9tcyA/IHtcbiAgICAgICAgICAgIG1vdW50X3RvX2ZpcnN0X2ZyYW1lX21zOiAoZXhpc3RpbmdFdmVudC5tb3VudF90b19maXJzdF9mcmFtZV9tcyA/PyAwKSArIChuZXdFdmVudC5tb3VudF90b19maXJzdF9mcmFtZV9tcyA/PyAwKVxuICAgICAgICAgIH0gOiB7fSxcbiAgICAgICAgICAuLi5leGlzdGluZ0V2ZW50Lm1vdW50X3RvX3BsYXlfbXMgfHwgbmV3RXZlbnQubW91bnRfdG9fcGxheV9tcyA/IHtcbiAgICAgICAgICAgIG1vdW50X3RvX3BsYXlfbXM6IChleGlzdGluZ0V2ZW50Lm1vdW50X3RvX3BsYXlfbXMgPz8gMCkgKyAobmV3RXZlbnQubW91bnRfdG9fcGxheV9tcyA/PyAwKVxuICAgICAgICAgIH0gOiB7fSxcbiAgICAgICAgICAuLi5leGlzdGluZ0V2ZW50LnBsYXlfdG9fZmlyc3RfZnJhbWVfbXMgfHwgbmV3RXZlbnQucGxheV90b19maXJzdF9mcmFtZV9tcyA/IHtcbiAgICAgICAgICAgIHBsYXlfdG9fZmlyc3RfZnJhbWVfbXM6IChleGlzdGluZ0V2ZW50LnBsYXlfdG9fZmlyc3RfZnJhbWVfbXMgPz8gMCkgKyAobmV3RXZlbnQucGxheV90b19maXJzdF9mcmFtZV9tcyA/PyAwKVxuICAgICAgICAgIH0gOiB7fVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmV4dGVybmFsQnVmZmVyW2V4aXN0aW5nRXZlbnRJbmRleF0gPSBtZXJnZWRFdmVudDtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5pbnRlcm5hbEJ1ZmZlciA9IFsuLi5ldmVudHMsIC4uLnRoaXMuaW50ZXJuYWxCdWZmZXJdO1xuICAgIHRoaXMudHJpbUJ1ZmZlcigpO1xuICB9XG4gIGdldEludGVybmFsRXZlbnRzKCkge1xuICAgIGNvbnN0IGV2ZW50c1RvU2VuZCA9IFsuLi50aGlzLmludGVybmFsQnVmZmVyXTtcbiAgICB0aGlzLmludGVybmFsQnVmZmVyID0gW107XG4gICAgcmV0dXJuIGV2ZW50c1RvU2VuZDtcbiAgfVxuICBnZXRFeHRlcm5hbEV2ZW50cygpIHtcbiAgICBjb25zdCBldmVudHNUb1NlbmQgPSBbLi4udGhpcy5leHRlcm5hbEJ1ZmZlcl07XG4gICAgdGhpcy5leHRlcm5hbEJ1ZmZlciA9IFtdO1xuICAgIHJldHVybiBldmVudHNUb1NlbmQ7XG4gIH1cbiAgb25JbnRlcm5hbEZhaWx1cmUocGVuZGluZ0V2ZW50cykge1xuICAgIHRoaXMuaW50ZXJuYWxCdWZmZXIgPSBbLi4udGhpcy5pbnRlcm5hbEJ1ZmZlciwgLi4ucGVuZGluZ0V2ZW50c107XG4gICAgdGhpcy50cmltQnVmZmVyKCk7XG4gIH1cbiAgb25FeHRlcm5hbEZhaWx1cmUocGVuZGluZ0V2ZW50cykge1xuICAgIHRoaXMuZXh0ZXJuYWxCdWZmZXIgPSBbLi4udGhpcy5leHRlcm5hbEJ1ZmZlciwgLi4ucGVuZGluZ0V2ZW50c107XG4gICAgdGhpcy50cmltQnVmZmVyKCk7XG4gIH1cbiAgdHJpbUJ1ZmZlcigpIHtcbiAgICBpZiAodGhpcy5pbnRlcm5hbEJ1ZmZlci5sZW5ndGggPiB0aGlzLm1heEJ1ZmZlclNpemUpIHtcbiAgICAgIGNvbnN0IGV4Y2VzcyA9IHRoaXMuaW50ZXJuYWxCdWZmZXIubGVuZ3RoIC0gdGhpcy5tYXhCdWZmZXJTaXplO1xuICAgICAgdGhpcy5pbnRlcm5hbEJ1ZmZlciA9IHRoaXMuaW50ZXJuYWxCdWZmZXIuc2xpY2UoZXhjZXNzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZXh0ZXJuYWxCdWZmZXIubGVuZ3RoID4gdGhpcy5tYXhCdWZmZXJTaXplKSB7XG4gICAgICBjb25zdCBleGNlc3MgPSB0aGlzLmV4dGVybmFsQnVmZmVyLmxlbmd0aCAtIHRoaXMubWF4QnVmZmVyU2l6ZTtcbiAgICAgIHRoaXMuZXh0ZXJuYWxCdWZmZXIgPSB0aGlzLmV4dGVybmFsQnVmZmVyLnNsaWNlKGV4Y2Vzcyk7XG4gICAgfVxuICB9XG59O1xudmFyIEluY3JlbWVudGFsQ291bnRlciA9IGNsYXNzIHtcbiAgY291bnRzO1xuICBjb25zdHJ1Y3RvcihrZXlzKSB7XG4gICAgdGhpcy5jb3VudHMgPSBrZXlzLnJlZHVjZShcbiAgICAgIChhY2MsIGtleSkgPT4ge1xuICAgICAgICBhY2Nba2V5XSA9IDA7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LFxuICAgICAge31cbiAgICApO1xuICB9XG4gIGNhbGN1bGF0ZUluY3JlbWVudChrZXksIG5ld0NvdW50KSB7XG4gICAgaWYgKG5ld0NvdW50IDwgdGhpcy5jb3VudHNba2V5XSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGNvbnN0IGluY3JlbWVudCA9IG5ld0NvdW50IC0gdGhpcy5jb3VudHNba2V5XTtcbiAgICB0aGlzLmNvdW50c1trZXldID0gbmV3Q291bnQ7XG4gICAgcmV0dXJuIGluY3JlbWVudDtcbiAgfVxufTtcbnZhciBWYWx1ZUNoYW5nZVRyYWNrZXIgPSBjbGFzcyB7XG4gIGxhc3RWYWx1ZXM7XG4gIGNvbnN0cnVjdG9yKGtleXMpIHtcbiAgICB0aGlzLmxhc3RWYWx1ZXMgPSBrZXlzLnJlZHVjZShcbiAgICAgIChhY2MsIGtleSkgPT4ge1xuICAgICAgICBhY2Nba2V5XSA9IHZvaWQgMDtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gIH1cbiAgc2VuZElmQ2hhbmdlZChrZXksIG5ld1ZhbHVlKSB7XG4gICAgaWYgKHRoaXMubGFzdFZhbHVlc1trZXldICE9PSBuZXdWYWx1ZSkge1xuICAgICAgdGhpcy5sYXN0VmFsdWVzW2tleV0gPSBuZXdWYWx1ZTtcbiAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxufTtcbnZhciBUaW1lcjIgPSBjbGFzcyB7XG4gIHRvdGFsVGltZSA9IDA7XG4gIGNvdW50U3RhcnRzID0gMDtcbiAgc3RhcnRUaW1lID0gMDtcbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuY291bnRTdGFydHMrKztcbiAgfVxuICBzdG9wKCkge1xuICAgIHRoaXMudG90YWxUaW1lICs9IHRoaXMuc3RhcnRUaW1lID4gMCA/IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZSA6IDA7XG4gICAgdGhpcy5zdGFydFRpbWUgPSAwO1xuICB9XG4gIGdldFRvdGFsVGltZSgpIHtcbiAgICB0aGlzLnRvdGFsVGltZSArPSB0aGlzLnN0YXJ0VGltZSA+IDAgPyBEYXRlLm5vdygpIC0gdGhpcy5zdGFydFRpbWUgOiAwO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5zdGFydFRpbWUgPiAwID8gRGF0ZS5ub3coKSA6IDA7XG4gICAgcmV0dXJuIHRoaXMudG90YWxUaW1lO1xuICB9XG4gIGdldENvdW50U3RhcnRzKCkge1xuICAgIHJldHVybiB0aGlzLmNvdW50U3RhcnRzO1xuICB9XG59O1xudmFyIE1ldHJpY3NNb25pdG9yID0gY2xhc3Mge1xuICByZXRyeUNvdW50ID0gMDtcbiAgY29ubmVjdGVkID0gZmFsc2U7XG4gIHN0b3JlO1xuICBkZXN0cm95O1xuICBmaXJzdEZyYW1lVGltZXN0YW1wID0gbnVsbDtcbiAgY3VycmVudE1ldHJpY3M7XG4gIHByZXZpb3VzTWV0cmljcyA9IG51bGw7XG4gIHRpbWVyRXJyb3JlZCA9IG5ldyBUaW1lcjIoKTtcbiAgdGltZXJXYWl0aW5nID0gbmV3IFRpbWVyMigpO1xuICB0aW1lclN0YWxsZWQgPSBuZXcgVGltZXIyKCk7XG4gIHRpbWVyV2FybmluZyA9IG5ldyBUaW1lcjIoKTtcbiAgdGltZXJQbGF5aW5nID0gbmV3IFRpbWVyMigpO1xuICBjb25zdHJ1Y3RvcihzdG9yZSwgb3B0cykge1xuICAgIHRoaXMuc3RvcmUgPSBzdG9yZTtcbiAgICB0aGlzLmN1cnJlbnRNZXRyaWNzID0ge1xuICAgICAgbW91bnRUb1BsYXk6IG51bGwsXG4gICAgICBtb3VudFRvRmlyc3RGcmFtZTogbnVsbCxcbiAgICAgIHBsYXlUb0ZpcnN0RnJhbWU6IG51bGwsXG4gICAgICBkdXJhdGlvbjogbnVsbCxcbiAgICAgIGVycm9yQ291bnQ6IDAsXG4gICAgICB3YXJuaW5nQ291bnQ6IDAsXG4gICAgICBvZmZzZXQ6IG51bGwsXG4gICAgICBwbGF5ZXJIZWlnaHQ6IG51bGwsXG4gICAgICBwbGF5ZXJXaWR0aDogbnVsbCxcbiAgICAgIHN0YWxsZWRDb3VudDogMCxcbiAgICAgIHRpbWVFcnJvcmVkOiAwLFxuICAgICAgdGltZVdhcm5pbmc6IDAsXG4gICAgICB0aW1lU3RhbGxlZDogMCxcbiAgICAgIHRpbWVQbGF5aW5nOiAwLFxuICAgICAgdGltZVdhaXRpbmc6IDAsXG4gICAgICB2aWRlb0hlaWdodDogbnVsbCxcbiAgICAgIHZpZGVvV2lkdGg6IG51bGwsXG4gICAgICB3YWl0aW5nQ291bnQ6IDAsXG4gICAgICB3aW5kb3dIZWlnaHQ6IG51bGwsXG4gICAgICB3aW5kb3dXaWR0aDogbnVsbFxuICAgIH07XG4gICAgY29uc3QgZGVzdHJveUZpcnN0UGxheUxpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgICAgKHN0YXRlKSA9PiBzdGF0ZS5fX2NvbnRyb2xzLnBsYXlMYXN0VGltZSxcbiAgICAgIGFzeW5jIChwbGF5TGFzdFRpbWUpID0+IHtcbiAgICAgICAgaWYgKHBsYXlMYXN0VGltZSA+PSAwKSB7XG4gICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1ldHJpY3MubW91bnRUb1BsYXkgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE1ldHJpY3MubW91bnRUb1BsYXkgPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgcGxheUxhc3RUaW1lIC0gZ2xvYmFsTG9hZFRpbWVzdGFtcE1zLFxuICAgICAgICAgICAgICAwXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG4gICAgY29uc3QgZGVzdHJveVBsYXlpbmdMaXN0ZW5lciA9IHN0b3JlLnN1YnNjcmliZShcbiAgICAgIChzdGF0ZSkgPT4gc3RhdGUucGxheWluZyxcbiAgICAgIGFzeW5jIChwbGF5aW5nKSA9PiB7XG4gICAgICAgIGlmIChwbGF5aW5nKSB7XG4gICAgICAgICAgdGhpcy50aW1lcldhcm5pbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZXJFcnJvcmVkLnN0b3AoKTtcbiAgICAgICAgICB0aGlzLnRpbWVyU3RhbGxlZC5zdG9wKCk7XG4gICAgICAgICAgdGhpcy50aW1lcldhaXRpbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZXJQbGF5aW5nLnN0YXJ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50aW1lclBsYXlpbmcuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgICBjb25zdCBkZXN0cm95UGxheUxhc3RUaW1lTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucGxheUxhc3RUaW1lLFxuICAgICAgYXN5bmMgKHBsYXlMYXN0VGltZSkgPT4ge1xuICAgICAgICBpZiAocGxheUxhc3RUaW1lID49IDApIHtcbiAgICAgICAgICB0aGlzLnRpbWVyV2FybmluZy5zdG9wKCk7XG4gICAgICAgICAgdGhpcy50aW1lckVycm9yZWQuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZXJTdGFsbGVkLnN0b3AoKTtcbiAgICAgICAgICB0aGlzLnRpbWVyV2FpdGluZy5zdG9wKCk7XG4gICAgICAgICAgdGhpcy50aW1lclBsYXlpbmcuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG4gICAgY29uc3QgZGVzdHJveVByb2dyZXNzTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgICAoc3RhdGUpID0+IHN0YXRlLnByb2dyZXNzLFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAob3B0cy5kaXNhYmxlUHJvZ3Jlc3NMaXN0ZW5lciAhPT0gdHJ1ZSAmJiAhdGhpcy50aW1lclBsYXlpbmcuc3RhcnRUaW1lKSB7XG4gICAgICAgICAgdGhpcy50aW1lcldhcm5pbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZXJFcnJvcmVkLnN0b3AoKTtcbiAgICAgICAgICB0aGlzLnRpbWVyU3RhbGxlZC5zdG9wKCk7XG4gICAgICAgICAgdGhpcy50aW1lcldhaXRpbmcuc3RvcCgpO1xuICAgICAgICAgIHRoaXMudGltZXJQbGF5aW5nLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudE1ldHJpY3MubW91bnRUb0ZpcnN0RnJhbWUgPT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRNZXRyaWNzLm1vdW50VG9GaXJzdEZyYW1lID0gTWF0aC5tYXgoXG4gICAgICAgICAgICBub3cgLSBnbG9iYWxMb2FkVGltZXN0YW1wTXMsXG4gICAgICAgICAgICAwXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXJyZW50TWV0cmljcy5wbGF5VG9GaXJzdEZyYW1lID09PSBudWxsICYmIHRoaXMuY3VycmVudE1ldHJpY3MubW91bnRUb1BsYXkgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRNZXRyaWNzLnBsYXlUb0ZpcnN0RnJhbWUgPSBNYXRoLm1heChcbiAgICAgICAgICAgIG5vdyAtIHRoaXMuY3VycmVudE1ldHJpY3MubW91bnRUb1BsYXkgLSBnbG9iYWxMb2FkVGltZXN0YW1wTXMsXG4gICAgICAgICAgICAwXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLmZpcnN0RnJhbWVUaW1lc3RhbXAgPSBub3c7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICAgIGNvbnN0IGRlc3Ryb3lFcnJvcmVkTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgICAoc3RhdGUpID0+IHN0YXRlLmVycm9yLFxuICAgICAgYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcj8udHlwZSkge1xuICAgICAgICAgIGNvbnN0IGlzV2FybmluZyA9IGVycm9yLnR5cGUgPT09IFwib2ZmbGluZVwiIHx8IGVycm9yLnR5cGUgPT09IFwiZmFsbGJhY2tcIjtcbiAgICAgICAgICBpZiAoaXNXYXJuaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyV2FybmluZy5zdGFydCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyRXJyb3JlZC5zdGFydCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnRpbWVyUGxheWluZy5zdG9wKCk7XG4gICAgICAgICAgaWYgKGlzV2FybmluZykge1xuICAgICAgICAgICAgdGhpcy5hZGRXYXJuaW5nKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkRXJyb3IoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICAgIGNvbnN0IGRlc3Ryb3lTdGFsbGVkTGlzdGVuZXIgPSBzdG9yZS5zdWJzY3JpYmUoXG4gICAgICAoc3RhdGUpID0+IHN0YXRlLnN0YWxsZWQsXG4gICAgICBhc3luYyAoc3RhbGxlZCkgPT4ge1xuICAgICAgICBpZiAoc3RhbGxlZCkge1xuICAgICAgICAgIHRoaXMudGltZXJTdGFsbGVkLnN0YXJ0KCk7XG4gICAgICAgICAgdGhpcy50aW1lclBsYXlpbmcuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgICBjb25zdCBkZXN0cm95V2FpdGluZ0xpc3RlbmVyID0gc3RvcmUuc3Vic2NyaWJlKFxuICAgICAgKHN0YXRlKSA9PiBzdGF0ZS53YWl0aW5nLFxuICAgICAgYXN5bmMgKHdhaXRpbmcpID0+IHtcbiAgICAgICAgaWYgKHdhaXRpbmcpIHtcbiAgICAgICAgICB0aGlzLnRpbWVyV2FpdGluZy5zdGFydCgpO1xuICAgICAgICAgIHRoaXMudGltZXJQbGF5aW5nLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG4gICAgdGhpcy5kZXN0cm95ID0gKCkgPT4ge1xuICAgICAgZGVzdHJveUVycm9yZWRMaXN0ZW5lcj8uKCk7XG4gICAgICBkZXN0cm95Rmlyc3RQbGF5TGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVBsYXlpbmdMaXN0ZW5lcj8uKCk7XG4gICAgICBkZXN0cm95UGxheUxhc3RUaW1lTGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVByb2dyZXNzTGlzdGVuZXI/LigpO1xuICAgICAgZGVzdHJveVN0YWxsZWRMaXN0ZW5lcj8uKCk7XG4gICAgICBkZXN0cm95V2FpdGluZ0xpc3RlbmVyPy4oKTtcbiAgICB9O1xuICB9XG4gIGFkZEVycm9yKCkge1xuICAgIHRoaXMuY3VycmVudE1ldHJpY3MuZXJyb3JDb3VudCA9IHRoaXMuY3VycmVudE1ldHJpY3MuZXJyb3JDb3VudCArIDE7XG4gIH1cbiAgYWRkV2FybmluZygpIHtcbiAgICB0aGlzLmN1cnJlbnRNZXRyaWNzLndhcm5pbmdDb3VudCA9IHRoaXMuY3VycmVudE1ldHJpY3Mud2FybmluZ0NvdW50ICsgMTtcbiAgfVxuICBzZXRDb25uZWN0ZWQoaXNDb25uZWN0ZWQpIHtcbiAgICB0aGlzLmNvbm5lY3RlZCA9IGlzQ29ubmVjdGVkO1xuICB9XG4gIGdldE1ldHJpY3MoKSB7XG4gICAgY29uc3QgZHVyYXRpb24gPSB0aGlzLnN0b3JlLmdldFN0YXRlKCkuZHVyYXRpb247XG4gICAgY29uc3QgY3VycmVudE1ldHJpY3MgPSB7XG4gICAgICAuLi50aGlzLmN1cnJlbnRNZXRyaWNzLFxuICAgICAgcGxheWVySGVpZ2h0OiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zaXplPy5jb250YWluZXI/LmhlaWdodCB8fCBudWxsLFxuICAgICAgcGxheWVyV2lkdGg6IHRoaXMuc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzLnNpemU/LmNvbnRhaW5lcj8ud2lkdGggfHwgbnVsbCxcbiAgICAgIHZpZGVvV2lkdGg6IHRoaXMuc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzLnNpemU/Lm1lZGlhPy53aWR0aCB8fCBudWxsLFxuICAgICAgdmlkZW9IZWlnaHQ6IHRoaXMuc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzLnNpemU/Lm1lZGlhPy5oZWlnaHQgfHwgbnVsbCxcbiAgICAgIHdpbmRvd1dpZHRoOiB0aGlzLnN0b3JlLmdldFN0YXRlKCkuX19jb250cm9scy5zaXplPy53aW5kb3c/LndpZHRoIHx8IG51bGwsXG4gICAgICB3aW5kb3dIZWlnaHQ6IHRoaXMuc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzLnNpemU/LndpbmRvdz8uaGVpZ2h0IHx8IG51bGwsXG4gICAgICBkdXJhdGlvbjogTnVtYmVyLmlzRmluaXRlKGR1cmF0aW9uKSAmJiAhTnVtYmVyLmlzTmFOKGR1cmF0aW9uKSA/IE1hdGguZmxvb3IoZHVyYXRpb24gKiAxZTMpIDogbnVsbCxcbiAgICAgIHdhaXRpbmdDb3VudDogdGhpcy50aW1lcldhaXRpbmcuZ2V0Q291bnRTdGFydHMoKSxcbiAgICAgIHN0YWxsZWRDb3VudDogdGhpcy50aW1lclN0YWxsZWQuZ2V0Q291bnRTdGFydHMoKSxcbiAgICAgIHRpbWVXYXJuaW5nOiB0aGlzLnRpbWVyV2FybmluZy5nZXRUb3RhbFRpbWUoKSxcbiAgICAgIHRpbWVFcnJvcmVkOiB0aGlzLnRpbWVyRXJyb3JlZC5nZXRUb3RhbFRpbWUoKSxcbiAgICAgIHRpbWVXYWl0aW5nOiB0aGlzLnRpbWVyV2FpdGluZy5nZXRUb3RhbFRpbWUoKSxcbiAgICAgIHRpbWVTdGFsbGVkOiB0aGlzLnRpbWVyU3RhbGxlZC5nZXRUb3RhbFRpbWUoKSxcbiAgICAgIHRpbWVQbGF5aW5nOiB0aGlzLnRpbWVyUGxheWluZy5nZXRUb3RhbFRpbWUoKSxcbiAgICAgIG9mZnNldDogdGhpcy5zdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHMucGxheWJhY2tPZmZzZXRNcyA/PyBudWxsXG4gICAgfTtcbiAgICByZXR1cm4gY3VycmVudE1ldHJpY3M7XG4gIH1cbn07XG5leHBvcnQge1xuICBhZGRMZWdhY3lNZWRpYU1ldHJpY3NUb1N0b3JlLFxuICBhZGRNZXRyaWNzVG9TdG9yZSxcbiAgY2FsY3VsYXRlVmlkZW9RdWFsaXR5RGltZW5zaW9ucyxcbiAgY3JlYXRlQ29udHJvbGxlclN0b3JlLFxuICBnZXRCb3VuZGVkVm9sdW1lLFxuICBnZXRNZWRpYVNvdXJjZVR5cGVcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core/dist/media/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/core/dist/storage/index.js":
/*!***********************************************************!*\
  !*** ./node_modules/@livepeer/core/dist/storage/index.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createStorage: () => (/* binding */ createStorage),\n/* harmony export */   noopStorage: () => (/* binding */ noopStorage)\n/* harmony export */ });\n// src/media/storage.ts\nvar noopStorage = {\n  getItem: (_key) => \"\",\n  setItem: (_key, _value) => {\n  },\n  removeItem: (_key) => {\n  }\n};\nfunction createStorage({\n  storage = noopStorage,\n  key: prefix = \"livepeer\"\n}) {\n  return {\n    getItem: async (key, defaultState = null) => {\n      try {\n        const value = await storage.getItem(`${prefix}.${key}`);\n        return value ? JSON.parse(value) : defaultState;\n      } catch (error) {\n        console.warn(error);\n        return defaultState;\n      }\n    },\n    setItem: async (key, value) => {\n      if (value === null) {\n        await storage.removeItem(`${prefix}.${key}`);\n      } else {\n        try {\n          await storage.setItem(`${prefix}.${key}`, JSON.stringify(value));\n        } catch (err) {\n          console.error(err);\n        }\n      }\n    },\n    removeItem: async (key) => storage.removeItem(`${prefix}.${key}`)\n  };\n}\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC9zdG9yYWdlL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxPQUFPLEdBQUcsSUFBSTtBQUM3RDtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLG9DQUFvQyxPQUFPLEdBQUcsSUFBSTtBQUNsRCxRQUFRO0FBQ1I7QUFDQSxtQ0FBbUMsT0FBTyxHQUFHLElBQUk7QUFDakQsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxxREFBcUQsT0FBTyxHQUFHLElBQUk7QUFDbkU7QUFDQTtBQUlFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4vbm9kZV9tb2R1bGVzL0BsaXZlcGVlci9jb3JlL2Rpc3Qvc3RvcmFnZS9pbmRleC5qcz83MGVkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9tZWRpYS9zdG9yYWdlLnRzXG52YXIgbm9vcFN0b3JhZ2UgPSB7XG4gIGdldEl0ZW06IChfa2V5KSA9PiBcIlwiLFxuICBzZXRJdGVtOiAoX2tleSwgX3ZhbHVlKSA9PiB7XG4gIH0sXG4gIHJlbW92ZUl0ZW06IChfa2V5KSA9PiB7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVTdG9yYWdlKHtcbiAgc3RvcmFnZSA9IG5vb3BTdG9yYWdlLFxuICBrZXk6IHByZWZpeCA9IFwibGl2ZXBlZXJcIlxufSkge1xuICByZXR1cm4ge1xuICAgIGdldEl0ZW06IGFzeW5jIChrZXksIGRlZmF1bHRTdGF0ZSA9IG51bGwpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgc3RvcmFnZS5nZXRJdGVtKGAke3ByZWZpeH0uJHtrZXl9YCk7XG4gICAgICAgIHJldHVybiB2YWx1ZSA/IEpTT04ucGFyc2UodmFsdWUpIDogZGVmYXVsdFN0YXRlO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRTdGF0ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNldEl0ZW06IGFzeW5jIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgYXdhaXQgc3RvcmFnZS5yZW1vdmVJdGVtKGAke3ByZWZpeH0uJHtrZXl9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0SXRlbShgJHtwcmVmaXh9LiR7a2V5fWAsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgcmVtb3ZlSXRlbTogYXN5bmMgKGtleSkgPT4gc3RvcmFnZS5yZW1vdmVJdGVtKGAke3ByZWZpeH0uJHtrZXl9YClcbiAgfTtcbn1cbmV4cG9ydCB7XG4gIGNyZWF0ZVN0b3JhZ2UsXG4gIG5vb3BTdG9yYWdlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core/dist/storage/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/core/dist/utils/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@livepeer/core/dist/utils/index.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   b64Decode: () => (/* binding */ b64Decode),\n/* harmony export */   b64Encode: () => (/* binding */ b64Encode),\n/* harmony export */   b64UrlDecode: () => (/* binding */ b64UrlDecode),\n/* harmony export */   b64UrlEncode: () => (/* binding */ b64UrlEncode),\n/* harmony export */   deepMerge: () => (/* binding */ deepMerge),\n/* harmony export */   noop: () => (/* binding */ noop),\n/* harmony export */   omit: () => (/* binding */ omit),\n/* harmony export */   parseArweaveTxId: () => (/* binding */ parseArweaveTxId),\n/* harmony export */   parseCid: () => (/* binding */ parseCid),\n/* harmony export */   pick: () => (/* binding */ pick),\n/* harmony export */   warn: () => (/* binding */ warn)\n/* harmony export */ });\n/* harmony import */ var multiformats_cid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! multiformats/cid */ \"(ssr)/./node_modules/multiformats/dist/src/cid.js\");\n// src/utils/deepMerge.ts\nvar isObject = (obj) => {\n  if (typeof obj === \"object\" && obj !== null) {\n    if (typeof Object.getPrototypeOf === \"function\") {\n      const prototype = Object.getPrototypeOf(obj);\n      return prototype === Object.prototype || prototype === null;\n    }\n    return Object.prototype.toString.call(obj) === \"[object Object]\";\n  }\n  return false;\n};\nvar merge = (...objects) => objects.reduce((result, current) => {\n  if (Array.isArray(current)) {\n    throw new TypeError(\n      \"Arguments provided to ts-deepmerge must be objects, not arrays.\"\n    );\n  }\n  Object.keys(current).forEach((key) => {\n    if ([\"__proto__\", \"constructor\", \"prototype\"].includes(key)) {\n      return;\n    }\n    if (Array.isArray(result[key]) && Array.isArray(current[key])) {\n      result[key] = merge.options.mergeArrays ? Array.from(new Set(result[key].concat(current[key]))) : current[key];\n    } else if (isObject(result[key]) && isObject(current[key])) {\n      result[key] = merge(result[key], current[key]);\n    } else {\n      result[key] = current[key];\n    }\n  });\n  return result;\n}, {});\nvar defaultOptions = {\n  mergeArrays: true\n};\nmerge.options = defaultOptions;\nmerge.withOptions = (options, ...objects) => {\n  merge.options = {\n    mergeArrays: true,\n    ...options\n  };\n  const result = merge(...objects);\n  merge.options = defaultOptions;\n  return result;\n};\nvar deepMerge = merge;\n\n// src/utils/omick.ts\nvar pick = (obj, ...keys) => {\n  try {\n    const objectKeys = Object.keys(obj);\n    return keys.filter((key) => objectKeys.includes(key)).reduce(\n      (prev, curr) => ({\n        // biome-ignore lint/performance/noAccumulatingSpread: <explanation>\n        ...prev,\n        [curr]: obj[curr]\n      }),\n      {}\n    );\n  } catch (e) {\n    throw new Error(\"Could not pick keys for object.\");\n  }\n};\nfunction omit(obj, ...keys) {\n  try {\n    const objectKeys = Object.keys(obj);\n    return objectKeys.filter((objectKey) => !keys.some((key) => String(key) === objectKey)).reduce(\n      (prev, curr) => ({\n        // biome-ignore lint/performance/noAccumulatingSpread: <explanation>\n        ...prev,\n        [curr]: obj[curr]\n      }),\n      {}\n    );\n  } catch (e) {\n    throw new Error(\"Could not omit keys for object.\");\n  }\n}\n\n// src/utils/storage/arweave.ts\nvar arweaveProtocolPattern = /^(ar):\\/\\/([^/?#]+)(.*)$/;\nvar pathGatewayPattern = /^https:\\/\\/(arweave\\.net|arweave\\.dev)\\/([^/?#]+)(.*)$/;\nvar subdomainGatewayPattern = /^https:\\/\\/([^/]+)\\.(arweave\\.net|arweave\\.dev)\\/([^/?#]+)(.*)$/;\nvar parseArweaveTxId = (possibleArweaveString) => {\n  if (!possibleArweaveString) {\n    return null;\n  }\n  const arweaveProtocolHash = possibleArweaveString.match(\n    arweaveProtocolPattern\n  )?.[2];\n  const arweaveProtocolUrlIndicators = possibleArweaveString.match(\n    arweaveProtocolPattern\n  )?.[3];\n  if (arweaveProtocolHash) {\n    return formatReturnHash(arweaveProtocolHash, arweaveProtocolUrlIndicators);\n  }\n  const subdomainGatewayHash = possibleArweaveString.match(\n    subdomainGatewayPattern\n  )?.[3];\n  const subdomainGatewayUrlIndicators = possibleArweaveString.match(\n    subdomainGatewayPattern\n  )?.[4];\n  if (subdomainGatewayHash) {\n    return formatReturnHash(\n      subdomainGatewayHash,\n      subdomainGatewayUrlIndicators\n    );\n  }\n  const pathGatewayHash = possibleArweaveString.match(pathGatewayPattern)?.[2];\n  const pathGatewayUrlIndicators = possibleArweaveString.match(pathGatewayPattern)?.[3];\n  if (pathGatewayHash) {\n    return formatReturnHash(pathGatewayHash, pathGatewayUrlIndicators);\n  }\n  return null;\n};\nvar formatReturnHash = (hash, urlIndicators) => {\n  const hashWithUrlIndicators = `${hash}${urlIndicators ?? \"\"}`;\n  return {\n    url: `ar://${hashWithUrlIndicators}`,\n    id: hashWithUrlIndicators\n  };\n};\n\n// src/utils/storage/ipfs.ts\n\nvar ipfsCidPattern = /^([^/?#]+)$/;\nvar ipfsProtocolPattern = /^(ipfs):\\/\\/([^/?#]+)(.*)$/;\nvar pathGatewayPattern2 = /^https?:\\/\\/[^/]+\\/(ipfs)\\/([^/?#]+)(.*)$/;\nvar subdomainGatewayPattern2 = /^https?:\\/\\/([^/]+)\\.(ipfs)\\.[^/?#]+(.*)$/;\nvar parseCid = (possibleIpfsString) => {\n  if (!possibleIpfsString) {\n    return null;\n  }\n  const ipfsProtocolCid = possibleIpfsString.match(ipfsProtocolPattern)?.[2];\n  const ipfsProtocolUrlIndicators = possibleIpfsString.match(ipfsProtocolPattern)?.[3];\n  if (isCid(ipfsProtocolCid)) {\n    return formatReturnCid(ipfsProtocolCid, ipfsProtocolUrlIndicators);\n  }\n  const subdomainGatewayCid = possibleIpfsString.match(\n    subdomainGatewayPattern2\n  )?.[1];\n  const subdomainGatewayUrlIndicators = possibleIpfsString.match(\n    subdomainGatewayPattern2\n  )?.[3];\n  if (isCid(subdomainGatewayCid)) {\n    return formatReturnCid(subdomainGatewayCid, subdomainGatewayUrlIndicators);\n  }\n  const pathGatewayCid = possibleIpfsString.match(pathGatewayPattern2)?.[2];\n  const pathGatewayUrlIndicators = possibleIpfsString.match(pathGatewayPattern2)?.[3];\n  if (isCid(pathGatewayCid)) {\n    return formatReturnCid(pathGatewayCid, pathGatewayUrlIndicators);\n  }\n  const ipfsCid = possibleIpfsString.match(ipfsCidPattern)?.[1];\n  if (isCid(ipfsCid)) {\n    return formatReturnCid(ipfsCid);\n  }\n  return null;\n};\nvar isCid = (hash) => {\n  try {\n    if (!hash) {\n      return false;\n    }\n    if (typeof hash === \"string\") {\n      return Boolean(multiformats_cid__WEBPACK_IMPORTED_MODULE_0__.CID.parse(hash));\n    }\n    if (hash instanceof Uint8Array) {\n      return Boolean(multiformats_cid__WEBPACK_IMPORTED_MODULE_0__.CID.decode(hash));\n    }\n    return Boolean(multiformats_cid__WEBPACK_IMPORTED_MODULE_0__.CID.asCID(hash));\n  } catch {\n    return false;\n  }\n};\nvar formatReturnCid = (cid, urlIndicators) => {\n  const cidWithUrlIndicators = `${cid}${urlIndicators ?? \"\"}`;\n  return {\n    url: `ipfs://${cidWithUrlIndicators}`,\n    id: cidWithUrlIndicators\n  };\n};\n\n// src/utils/string.ts\nvar b64Encode = (input) => {\n  try {\n    if (typeof window !== \"undefined\" && \"btoa\" in window) {\n      return window?.btoa?.(input) ?? null;\n    }\n    return Buffer?.from(input, \"binary\")?.toString(\"base64\") ?? null;\n  } catch (e) {\n    return null;\n  }\n};\nvar b64Decode = (input) => {\n  try {\n    if (typeof window !== \"undefined\" && \"atob\" in window) {\n      return window?.atob?.(input) ?? null;\n    }\n    return Buffer?.from(input, \"base64\")?.toString(\"binary\") ?? null;\n  } catch (e) {\n    return null;\n  }\n};\nvar b64UrlEncode = (input) => {\n  return escapeInput(b64Encode(input));\n};\nvar b64UrlDecode = (input) => {\n  const unescaped = unescapeInput(input);\n  if (unescaped) {\n    return b64Decode(unescaped);\n  }\n  return null;\n};\nvar unescapeInput = (input) => {\n  return input ? (input + \"===\".slice((input.length + 3) % 4)).replace(/-/g, \"+\").replace(/_/g, \"/\") : null;\n};\nvar escapeInput = (input) => {\n  return input?.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\") ?? null;\n};\n\n// src/utils/types.ts\nvar noop = (..._args) => {\n};\n\n// src/utils/warn.ts\nvar cache = /* @__PURE__ */ new Set();\nfunction warn(message, id) {\n  if (!cache.has(id ?? message)) {\n    console.warn(message);\n    cache.add(message);\n  }\n}\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC91dGlscy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsS0FBSyxFQUFFLG9CQUFvQjtBQUM5RDtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkM7QUFDQTtBQUNBOztBQUVBO0FBQ3VDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixpREFBRztBQUN4QjtBQUNBO0FBQ0EscUJBQXFCLGlEQUFHO0FBQ3hCO0FBQ0EsbUJBQW1CLGlEQUFHO0FBQ3RCLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxJQUFJLEVBQUUsb0JBQW9CO0FBQzVEO0FBQ0EsbUJBQW1CLHFCQUFxQjtBQUN4QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC91dGlscy9pbmRleC5qcz9mYzNlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy91dGlscy9kZWVwTWVyZ2UudHNcbnZhciBpc09iamVjdCA9IChvYmopID0+IHtcbiAgaWYgKHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgJiYgb2JqICE9PSBudWxsKSB7XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0UHJvdG90eXBlT2YgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY29uc3QgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaik7XG4gICAgICByZXR1cm4gcHJvdG90eXBlID09PSBPYmplY3QucHJvdG90eXBlIHx8IHByb3RvdHlwZSA9PT0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgT2JqZWN0XVwiO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG52YXIgbWVyZ2UgPSAoLi4ub2JqZWN0cykgPT4gb2JqZWN0cy5yZWR1Y2UoKHJlc3VsdCwgY3VycmVudCkgPT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShjdXJyZW50KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBcIkFyZ3VtZW50cyBwcm92aWRlZCB0byB0cy1kZWVwbWVyZ2UgbXVzdCBiZSBvYmplY3RzLCBub3QgYXJyYXlzLlwiXG4gICAgKTtcbiAgfVxuICBPYmplY3Qua2V5cyhjdXJyZW50KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBpZiAoW1wiX19wcm90b19fXCIsIFwiY29uc3RydWN0b3JcIiwgXCJwcm90b3R5cGVcIl0uaW5jbHVkZXMoa2V5KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHRba2V5XSkgJiYgQXJyYXkuaXNBcnJheShjdXJyZW50W2tleV0pKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlLm9wdGlvbnMubWVyZ2VBcnJheXMgPyBBcnJheS5mcm9tKG5ldyBTZXQocmVzdWx0W2tleV0uY29uY2F0KGN1cnJlbnRba2V5XSkpKSA6IGN1cnJlbnRba2V5XTtcbiAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KHJlc3VsdFtrZXldKSAmJiBpc09iamVjdChjdXJyZW50W2tleV0pKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlKHJlc3VsdFtrZXldLCBjdXJyZW50W2tleV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRba2V5XSA9IGN1cnJlbnRba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufSwge30pO1xudmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICBtZXJnZUFycmF5czogdHJ1ZVxufTtcbm1lcmdlLm9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbm1lcmdlLndpdGhPcHRpb25zID0gKG9wdGlvbnMsIC4uLm9iamVjdHMpID0+IHtcbiAgbWVyZ2Uub3B0aW9ucyA9IHtcbiAgICBtZXJnZUFycmF5czogdHJ1ZSxcbiAgICAuLi5vcHRpb25zXG4gIH07XG4gIGNvbnN0IHJlc3VsdCA9IG1lcmdlKC4uLm9iamVjdHMpO1xuICBtZXJnZS5vcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gIHJldHVybiByZXN1bHQ7XG59O1xudmFyIGRlZXBNZXJnZSA9IG1lcmdlO1xuXG4vLyBzcmMvdXRpbHMvb21pY2sudHNcbnZhciBwaWNrID0gKG9iaiwgLi4ua2V5cykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuICAgIHJldHVybiBrZXlzLmZpbHRlcigoa2V5KSA9PiBvYmplY3RLZXlzLmluY2x1ZGVzKGtleSkpLnJlZHVjZShcbiAgICAgIChwcmV2LCBjdXJyKSA9PiAoe1xuICAgICAgICAvLyBiaW9tZS1pZ25vcmUgbGludC9wZXJmb3JtYW5jZS9ub0FjY3VtdWxhdGluZ1NwcmVhZDogPGV4cGxhbmF0aW9uPlxuICAgICAgICAuLi5wcmV2LFxuICAgICAgICBbY3Vycl06IG9ialtjdXJyXVxuICAgICAgfSksXG4gICAgICB7fVxuICAgICk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgcGljayBrZXlzIGZvciBvYmplY3QuXCIpO1xuICB9XG59O1xuZnVuY3Rpb24gb21pdChvYmosIC4uLmtleXMpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgICByZXR1cm4gb2JqZWN0S2V5cy5maWx0ZXIoKG9iamVjdEtleSkgPT4gIWtleXMuc29tZSgoa2V5KSA9PiBTdHJpbmcoa2V5KSA9PT0gb2JqZWN0S2V5KSkucmVkdWNlKFxuICAgICAgKHByZXYsIGN1cnIpID0+ICh7XG4gICAgICAgIC8vIGJpb21lLWlnbm9yZSBsaW50L3BlcmZvcm1hbmNlL25vQWNjdW11bGF0aW5nU3ByZWFkOiA8ZXhwbGFuYXRpb24+XG4gICAgICAgIC4uLnByZXYsXG4gICAgICAgIFtjdXJyXTogb2JqW2N1cnJdXG4gICAgICB9KSxcbiAgICAgIHt9XG4gICAgKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBvbWl0IGtleXMgZm9yIG9iamVjdC5cIik7XG4gIH1cbn1cblxuLy8gc3JjL3V0aWxzL3N0b3JhZ2UvYXJ3ZWF2ZS50c1xudmFyIGFyd2VhdmVQcm90b2NvbFBhdHRlcm4gPSAvXihhcik6XFwvXFwvKFteLz8jXSspKC4qKSQvO1xudmFyIHBhdGhHYXRld2F5UGF0dGVybiA9IC9eaHR0cHM6XFwvXFwvKGFyd2VhdmVcXC5uZXR8YXJ3ZWF2ZVxcLmRldilcXC8oW14vPyNdKykoLiopJC87XG52YXIgc3ViZG9tYWluR2F0ZXdheVBhdHRlcm4gPSAvXmh0dHBzOlxcL1xcLyhbXi9dKylcXC4oYXJ3ZWF2ZVxcLm5ldHxhcndlYXZlXFwuZGV2KVxcLyhbXi8/I10rKSguKikkLztcbnZhciBwYXJzZUFyd2VhdmVUeElkID0gKHBvc3NpYmxlQXJ3ZWF2ZVN0cmluZykgPT4ge1xuICBpZiAoIXBvc3NpYmxlQXJ3ZWF2ZVN0cmluZykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGFyd2VhdmVQcm90b2NvbEhhc2ggPSBwb3NzaWJsZUFyd2VhdmVTdHJpbmcubWF0Y2goXG4gICAgYXJ3ZWF2ZVByb3RvY29sUGF0dGVyblxuICApPy5bMl07XG4gIGNvbnN0IGFyd2VhdmVQcm90b2NvbFVybEluZGljYXRvcnMgPSBwb3NzaWJsZUFyd2VhdmVTdHJpbmcubWF0Y2goXG4gICAgYXJ3ZWF2ZVByb3RvY29sUGF0dGVyblxuICApPy5bM107XG4gIGlmIChhcndlYXZlUHJvdG9jb2xIYXNoKSB7XG4gICAgcmV0dXJuIGZvcm1hdFJldHVybkhhc2goYXJ3ZWF2ZVByb3RvY29sSGFzaCwgYXJ3ZWF2ZVByb3RvY29sVXJsSW5kaWNhdG9ycyk7XG4gIH1cbiAgY29uc3Qgc3ViZG9tYWluR2F0ZXdheUhhc2ggPSBwb3NzaWJsZUFyd2VhdmVTdHJpbmcubWF0Y2goXG4gICAgc3ViZG9tYWluR2F0ZXdheVBhdHRlcm5cbiAgKT8uWzNdO1xuICBjb25zdCBzdWJkb21haW5HYXRld2F5VXJsSW5kaWNhdG9ycyA9IHBvc3NpYmxlQXJ3ZWF2ZVN0cmluZy5tYXRjaChcbiAgICBzdWJkb21haW5HYXRld2F5UGF0dGVyblxuICApPy5bNF07XG4gIGlmIChzdWJkb21haW5HYXRld2F5SGFzaCkge1xuICAgIHJldHVybiBmb3JtYXRSZXR1cm5IYXNoKFxuICAgICAgc3ViZG9tYWluR2F0ZXdheUhhc2gsXG4gICAgICBzdWJkb21haW5HYXRld2F5VXJsSW5kaWNhdG9yc1xuICAgICk7XG4gIH1cbiAgY29uc3QgcGF0aEdhdGV3YXlIYXNoID0gcG9zc2libGVBcndlYXZlU3RyaW5nLm1hdGNoKHBhdGhHYXRld2F5UGF0dGVybik/LlsyXTtcbiAgY29uc3QgcGF0aEdhdGV3YXlVcmxJbmRpY2F0b3JzID0gcG9zc2libGVBcndlYXZlU3RyaW5nLm1hdGNoKHBhdGhHYXRld2F5UGF0dGVybik/LlszXTtcbiAgaWYgKHBhdGhHYXRld2F5SGFzaCkge1xuICAgIHJldHVybiBmb3JtYXRSZXR1cm5IYXNoKHBhdGhHYXRld2F5SGFzaCwgcGF0aEdhdGV3YXlVcmxJbmRpY2F0b3JzKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG52YXIgZm9ybWF0UmV0dXJuSGFzaCA9IChoYXNoLCB1cmxJbmRpY2F0b3JzKSA9PiB7XG4gIGNvbnN0IGhhc2hXaXRoVXJsSW5kaWNhdG9ycyA9IGAke2hhc2h9JHt1cmxJbmRpY2F0b3JzID8/IFwiXCJ9YDtcbiAgcmV0dXJuIHtcbiAgICB1cmw6IGBhcjovLyR7aGFzaFdpdGhVcmxJbmRpY2F0b3JzfWAsXG4gICAgaWQ6IGhhc2hXaXRoVXJsSW5kaWNhdG9yc1xuICB9O1xufTtcblxuLy8gc3JjL3V0aWxzL3N0b3JhZ2UvaXBmcy50c1xuaW1wb3J0IHsgQ0lEIH0gZnJvbSBcIm11bHRpZm9ybWF0cy9jaWRcIjtcbnZhciBpcGZzQ2lkUGF0dGVybiA9IC9eKFteLz8jXSspJC87XG52YXIgaXBmc1Byb3RvY29sUGF0dGVybiA9IC9eKGlwZnMpOlxcL1xcLyhbXi8/I10rKSguKikkLztcbnZhciBwYXRoR2F0ZXdheVBhdHRlcm4yID0gL15odHRwcz86XFwvXFwvW14vXStcXC8oaXBmcylcXC8oW14vPyNdKykoLiopJC87XG52YXIgc3ViZG9tYWluR2F0ZXdheVBhdHRlcm4yID0gL15odHRwcz86XFwvXFwvKFteL10rKVxcLihpcGZzKVxcLlteLz8jXSsoLiopJC87XG52YXIgcGFyc2VDaWQgPSAocG9zc2libGVJcGZzU3RyaW5nKSA9PiB7XG4gIGlmICghcG9zc2libGVJcGZzU3RyaW5nKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgaXBmc1Byb3RvY29sQ2lkID0gcG9zc2libGVJcGZzU3RyaW5nLm1hdGNoKGlwZnNQcm90b2NvbFBhdHRlcm4pPy5bMl07XG4gIGNvbnN0IGlwZnNQcm90b2NvbFVybEluZGljYXRvcnMgPSBwb3NzaWJsZUlwZnNTdHJpbmcubWF0Y2goaXBmc1Byb3RvY29sUGF0dGVybik/LlszXTtcbiAgaWYgKGlzQ2lkKGlwZnNQcm90b2NvbENpZCkpIHtcbiAgICByZXR1cm4gZm9ybWF0UmV0dXJuQ2lkKGlwZnNQcm90b2NvbENpZCwgaXBmc1Byb3RvY29sVXJsSW5kaWNhdG9ycyk7XG4gIH1cbiAgY29uc3Qgc3ViZG9tYWluR2F0ZXdheUNpZCA9IHBvc3NpYmxlSXBmc1N0cmluZy5tYXRjaChcbiAgICBzdWJkb21haW5HYXRld2F5UGF0dGVybjJcbiAgKT8uWzFdO1xuICBjb25zdCBzdWJkb21haW5HYXRld2F5VXJsSW5kaWNhdG9ycyA9IHBvc3NpYmxlSXBmc1N0cmluZy5tYXRjaChcbiAgICBzdWJkb21haW5HYXRld2F5UGF0dGVybjJcbiAgKT8uWzNdO1xuICBpZiAoaXNDaWQoc3ViZG9tYWluR2F0ZXdheUNpZCkpIHtcbiAgICByZXR1cm4gZm9ybWF0UmV0dXJuQ2lkKHN1YmRvbWFpbkdhdGV3YXlDaWQsIHN1YmRvbWFpbkdhdGV3YXlVcmxJbmRpY2F0b3JzKTtcbiAgfVxuICBjb25zdCBwYXRoR2F0ZXdheUNpZCA9IHBvc3NpYmxlSXBmc1N0cmluZy5tYXRjaChwYXRoR2F0ZXdheVBhdHRlcm4yKT8uWzJdO1xuICBjb25zdCBwYXRoR2F0ZXdheVVybEluZGljYXRvcnMgPSBwb3NzaWJsZUlwZnNTdHJpbmcubWF0Y2gocGF0aEdhdGV3YXlQYXR0ZXJuMik/LlszXTtcbiAgaWYgKGlzQ2lkKHBhdGhHYXRld2F5Q2lkKSkge1xuICAgIHJldHVybiBmb3JtYXRSZXR1cm5DaWQocGF0aEdhdGV3YXlDaWQsIHBhdGhHYXRld2F5VXJsSW5kaWNhdG9ycyk7XG4gIH1cbiAgY29uc3QgaXBmc0NpZCA9IHBvc3NpYmxlSXBmc1N0cmluZy5tYXRjaChpcGZzQ2lkUGF0dGVybik/LlsxXTtcbiAgaWYgKGlzQ2lkKGlwZnNDaWQpKSB7XG4gICAgcmV0dXJuIGZvcm1hdFJldHVybkNpZChpcGZzQ2lkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG52YXIgaXNDaWQgPSAoaGFzaCkgPT4ge1xuICB0cnkge1xuICAgIGlmICghaGFzaCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGhhc2ggPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKENJRC5wYXJzZShoYXNoKSk7XG4gICAgfVxuICAgIGlmIChoYXNoIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4oQ0lELmRlY29kZShoYXNoKSk7XG4gICAgfVxuICAgIHJldHVybiBCb29sZWFuKENJRC5hc0NJRChoYXNoKSk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcbnZhciBmb3JtYXRSZXR1cm5DaWQgPSAoY2lkLCB1cmxJbmRpY2F0b3JzKSA9PiB7XG4gIGNvbnN0IGNpZFdpdGhVcmxJbmRpY2F0b3JzID0gYCR7Y2lkfSR7dXJsSW5kaWNhdG9ycyA/PyBcIlwifWA7XG4gIHJldHVybiB7XG4gICAgdXJsOiBgaXBmczovLyR7Y2lkV2l0aFVybEluZGljYXRvcnN9YCxcbiAgICBpZDogY2lkV2l0aFVybEluZGljYXRvcnNcbiAgfTtcbn07XG5cbi8vIHNyYy91dGlscy9zdHJpbmcudHNcbnZhciBiNjRFbmNvZGUgPSAoaW5wdXQpID0+IHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcImJ0b2FcIiBpbiB3aW5kb3cpIHtcbiAgICAgIHJldHVybiB3aW5kb3c/LmJ0b2E/LihpbnB1dCkgPz8gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIEJ1ZmZlcj8uZnJvbShpbnB1dCwgXCJiaW5hcnlcIik/LnRvU3RyaW5nKFwiYmFzZTY0XCIpID8/IG51bGw7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcbnZhciBiNjREZWNvZGUgPSAoaW5wdXQpID0+IHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcImF0b2JcIiBpbiB3aW5kb3cpIHtcbiAgICAgIHJldHVybiB3aW5kb3c/LmF0b2I/LihpbnB1dCkgPz8gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIEJ1ZmZlcj8uZnJvbShpbnB1dCwgXCJiYXNlNjRcIik/LnRvU3RyaW5nKFwiYmluYXJ5XCIpID8/IG51bGw7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcbnZhciBiNjRVcmxFbmNvZGUgPSAoaW5wdXQpID0+IHtcbiAgcmV0dXJuIGVzY2FwZUlucHV0KGI2NEVuY29kZShpbnB1dCkpO1xufTtcbnZhciBiNjRVcmxEZWNvZGUgPSAoaW5wdXQpID0+IHtcbiAgY29uc3QgdW5lc2NhcGVkID0gdW5lc2NhcGVJbnB1dChpbnB1dCk7XG4gIGlmICh1bmVzY2FwZWQpIHtcbiAgICByZXR1cm4gYjY0RGVjb2RlKHVuZXNjYXBlZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xudmFyIHVuZXNjYXBlSW5wdXQgPSAoaW5wdXQpID0+IHtcbiAgcmV0dXJuIGlucHV0ID8gKGlucHV0ICsgXCI9PT1cIi5zbGljZSgoaW5wdXQubGVuZ3RoICsgMykgJSA0KSkucmVwbGFjZSgvLS9nLCBcIitcIikucmVwbGFjZSgvXy9nLCBcIi9cIikgOiBudWxsO1xufTtcbnZhciBlc2NhcGVJbnB1dCA9IChpbnB1dCkgPT4ge1xuICByZXR1cm4gaW5wdXQ/LnJlcGxhY2UoL1xcKy9nLCBcIi1cIikucmVwbGFjZSgvXFwvL2csIFwiX1wiKS5yZXBsYWNlKC89L2csIFwiXCIpID8/IG51bGw7XG59O1xuXG4vLyBzcmMvdXRpbHMvdHlwZXMudHNcbnZhciBub29wID0gKC4uLl9hcmdzKSA9PiB7XG59O1xuXG4vLyBzcmMvdXRpbHMvd2Fybi50c1xudmFyIGNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHdhcm4obWVzc2FnZSwgaWQpIHtcbiAgaWYgKCFjYWNoZS5oYXMoaWQgPz8gbWVzc2FnZSkpIHtcbiAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG4gICAgY2FjaGUuYWRkKG1lc3NhZ2UpO1xuICB9XG59XG5leHBvcnQge1xuICBiNjREZWNvZGUsXG4gIGI2NEVuY29kZSxcbiAgYjY0VXJsRGVjb2RlLFxuICBiNjRVcmxFbmNvZGUsXG4gIGRlZXBNZXJnZSxcbiAgbm9vcCxcbiAgb21pdCxcbiAgcGFyc2VBcndlYXZlVHhJZCxcbiAgcGFyc2VDaWQsXG4gIHBpY2ssXG4gIHdhcm5cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core/dist/utils/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/core/dist/version/index.js":
/*!***********************************************************!*\
  !*** ./node_modules/@livepeer/core/dist/version/index.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n// src/version.ts\nvar core = \"@livepeer/core@3.3.1\";\nvar react = \"@livepeer/react@4.3.4\";\nvar version = {\n  core,\n  react\n};\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL2NvcmUvZGlzdC92ZXJzaW9uL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4vbm9kZV9tb2R1bGVzL0BsaXZlcGVlci9jb3JlL2Rpc3QvdmVyc2lvbi9pbmRleC5qcz83ZTdlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy92ZXJzaW9uLnRzXG52YXIgY29yZSA9IFwiQGxpdmVwZWVyL2NvcmVAMy4zLjFcIjtcbnZhciByZWFjdCA9IFwiQGxpdmVwZWVyL3JlYWN0QDQuMy40XCI7XG52YXIgdmVyc2lvbiA9IHtcbiAgY29yZSxcbiAgcmVhY3Rcbn07XG5leHBvcnQge1xuICB2ZXJzaW9uXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/core/dist/version/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@livepeer/react/dist/player/index.js":
/*!***********************************************************!*\
  !*** ./node_modules/@livepeer/react/dist/player/index.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ClipTrigger: () => (/* binding */ ClipTrigger),\n/* harmony export */   Container: () => (/* binding */ Container),\n/* harmony export */   Controls: () => (/* binding */ Controls),\n/* harmony export */   ErrorIndicator: () => (/* binding */ ErrorIndicator),\n/* harmony export */   FullscreenIndicator: () => (/* binding */ FullscreenIndicator),\n/* harmony export */   FullscreenTrigger: () => (/* binding */ FullscreenTrigger),\n/* harmony export */   LiveIndicator: () => (/* binding */ LiveIndicator),\n/* harmony export */   LoadingIndicator: () => (/* binding */ LoadingIndicator),\n/* harmony export */   MediaProvider: () => (/* binding */ MediaProvider),\n/* harmony export */   MuteTrigger: () => (/* binding */ MuteTrigger),\n/* harmony export */   PictureInPictureTrigger: () => (/* binding */ PictureInPictureTrigger),\n/* harmony export */   PlayPauseTrigger: () => (/* binding */ PlayPauseTrigger),\n/* harmony export */   PlayingIndicator: () => (/* binding */ PlayingIndicator),\n/* harmony export */   Portal: () => (/* binding */ Portal),\n/* harmony export */   Poster: () => (/* binding */ Poster),\n/* harmony export */   Range: () => (/* binding */ Range2),\n/* harmony export */   RateSelect: () => (/* binding */ RateSelect),\n/* harmony export */   RateSelectItem: () => (/* binding */ RateSelectItem),\n/* harmony export */   Root: () => (/* binding */ Root),\n/* harmony export */   Seek: () => (/* binding */ Seek),\n/* harmony export */   SeekBuffer: () => (/* binding */ SeekBuffer),\n/* harmony export */   SelectArrow: () => (/* binding */ SelectArrow2),\n/* harmony export */   SelectContent: () => (/* binding */ SelectContent2),\n/* harmony export */   SelectGroup: () => (/* binding */ SelectGroup2),\n/* harmony export */   SelectIcon: () => (/* binding */ SelectIcon2),\n/* harmony export */   SelectItemIndicator: () => (/* binding */ SelectItemIndicator2),\n/* harmony export */   SelectItemText: () => (/* binding */ SelectItemText2),\n/* harmony export */   SelectLabel: () => (/* binding */ SelectLabel2),\n/* harmony export */   SelectPortal: () => (/* binding */ SelectPortal2),\n/* harmony export */   SelectScrollDownButton: () => (/* binding */ SelectScrollDownButton2),\n/* harmony export */   SelectScrollUpButton: () => (/* binding */ SelectScrollUpButton2),\n/* harmony export */   SelectSeparator: () => (/* binding */ SelectSeparator2),\n/* harmony export */   SelectTrigger: () => (/* binding */ SelectTrigger2),\n/* harmony export */   SelectValue: () => (/* binding */ SelectValue2),\n/* harmony export */   SelectViewport: () => (/* binding */ SelectViewport2),\n/* harmony export */   Thumb: () => (/* binding */ Thumb2),\n/* harmony export */   Time: () => (/* binding */ Time),\n/* harmony export */   Track: () => (/* binding */ Track2),\n/* harmony export */   Video: () => (/* binding */ Video),\n/* harmony export */   VideoQualitySelect: () => (/* binding */ VideoQualitySelect),\n/* harmony export */   VideoQualitySelectItem: () => (/* binding */ VideoQualitySelectItem),\n/* harmony export */   Volume: () => (/* binding */ Volume),\n/* harmony export */   VolumeIndicator: () => (/* binding */ VolumeIndicator),\n/* harmony export */   createMediaScope: () => (/* binding */ createMediaScope),\n/* harmony export */   useMediaContext: () => (/* binding */ useMediaContext),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var _radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @radix-ui/primitive */ \"(ssr)/./node_modules/@radix-ui/primitive/dist/index.mjs\");\n/* harmony import */ var _radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @radix-ui/react-presence */ \"(ssr)/./node_modules/@radix-ui/react-presence/dist/index.mjs\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var zustand__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zustand */ \"(ssr)/./node_modules/zustand/esm/index.mjs\");\n/* harmony import */ var zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zustand/react/shallow */ \"(ssr)/./node_modules/zustand/esm/react/shallow.mjs\");\n/* harmony import */ var _radix_ui_react_context__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @radix-ui/react-context */ \"(ssr)/./node_modules/@radix-ui/react-context/dist/index.mjs\");\n/* harmony import */ var _radix_ui_react_slot__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @radix-ui/react-slot */ \"(ssr)/./node_modules/@radix-ui/react-slot/dist/index.mjs\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var _livepeer_core_media__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @livepeer/core/media */ \"(ssr)/./node_modules/@livepeer/core/dist/media/index.js\");\n/* harmony import */ var _livepeer_core_storage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @livepeer/core/storage */ \"(ssr)/./node_modules/@livepeer/core/dist/storage/index.js\");\n/* harmony import */ var _livepeer_core_version__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @livepeer/core/version */ \"(ssr)/./node_modules/@livepeer/core/dist/version/index.js\");\n/* harmony import */ var _livepeer_core_web_browser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @livepeer/core-web/browser */ \"(ssr)/./node_modules/@livepeer/core-web/dist/browser/index.js\");\n/* harmony import */ var _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @radix-ui/react-select */ \"(ssr)/./node_modules/@radix-ui/react-select/dist/index.mjs\");\n/* harmony import */ var _radix_ui_react_slider__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @radix-ui/react-slider */ \"(ssr)/./node_modules/@radix-ui/react-slider/dist/index.mjs\");\n/* harmony import */ var _radix_ui_react_compose_refs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @radix-ui/react-compose-refs */ \"(ssr)/./node_modules/@radix-ui/react-compose-refs/dist/index.mjs\");\n/* harmony import */ var _livepeer_core_utils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @livepeer/core/utils */ \"(ssr)/./node_modules/@livepeer/core/dist/utils/index.js\");\n/* harmony import */ var _radix_ui_react_aspect_ratio__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @radix-ui/react-aspect-ratio */ \"(ssr)/./node_modules/@radix-ui/react-aspect-ratio/dist/index.mjs\");\n/* harmony import */ var _radix_ui_react_portal__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @radix-ui/react-portal */ \"(ssr)/./node_modules/@radix-ui/react-portal/dist/index.mjs\");\n/* __next_internal_client_entry_do_not_use__ ClipTrigger,Container,Controls,ErrorIndicator,FullscreenIndicator,FullscreenTrigger,LiveIndicator,LoadingIndicator,MediaProvider,MuteTrigger,PictureInPictureTrigger,PlayPauseTrigger,PlayingIndicator,Portal,Poster,Range,RateSelect,RateSelectItem,Root,Seek,SeekBuffer,SelectArrow,SelectContent,SelectGroup,SelectIcon,SelectItemIndicator,SelectItemText,SelectLabel,SelectPortal,SelectScrollDownButton,SelectScrollUpButton,SelectSeparator,SelectTrigger,SelectValue,SelectViewport,Thumb,Time,Track,Video,VideoQualitySelect,VideoQualitySelectItem,Volume,VolumeIndicator,createMediaScope,useMediaContext,useStore auto */ // src/player/ClipTrigger.tsx\n\n\n\n\n\n// src/shared/context.tsx\n\n\nvar MEDIA_NAME = \"Media\";\nvar [createMediaContext, createMediaScope] = (0,_radix_ui_react_context__WEBPACK_IMPORTED_MODULE_1__.createContextScope)(MEDIA_NAME);\nvar [MediaProvider, useMediaContext] = createMediaContext(MEDIA_NAME);\nvar useStore = zustand__WEBPACK_IMPORTED_MODULE_2__.useStore;\n// src/shared/primitive.tsx\n\n\n\nvar NODES = [\n    \"a\",\n    \"audio\",\n    \"button\",\n    \"div\",\n    \"form\",\n    \"h2\",\n    \"h3\",\n    \"img\",\n    \"input\",\n    \"label\",\n    \"li\",\n    \"nav\",\n    \"ol\",\n    \"p\",\n    \"span\",\n    \"svg\",\n    \"ul\",\n    \"video\"\n];\nvar Primitive = NODES.reduce((primitive, node)=>{\n    const Node = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(// biome-ignore lint/suspicious/noExplicitAny: any\n    (props, forwardedRef)=>{\n        const { asChild, ...primitiveProps } = props;\n        const Comp = asChild ? _radix_ui_react_slot__WEBPACK_IMPORTED_MODULE_4__.Slot : node;\n        react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{\n            window[Symbol.for(\"radix-ui\")] = true;\n        }, []);\n        return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Comp, {\n            ...primitiveProps,\n            ref: forwardedRef\n        });\n    });\n    Node.displayName = `Primitive.${node}`;\n    return {\n        ...primitive,\n        [node]: Node\n    };\n}, {});\n// src/shared/utils.ts\nvar noPropagate = (cb)=>(event)=>{\n        event.stopPropagation();\n        return cb();\n    };\n// src/player/ClipTrigger.tsx\nvar CLIP_TRIGGER_NAME = \"ClipTrigger\";\nvar ClipTrigger = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, onClip, ...clipTriggerProps } = props;\n    const context = useMediaContext(CLIP_TRIGGER_NAME, __scopeMedia);\n    const { clipLength, requestClip, playbackId, title } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ __controls, __controlsFunctions, aria, __initialProps })=>({\n            requestClip: __controlsFunctions.requestClip,\n            playbackId: __controls.playbackId,\n            clipLength: __initialProps.clipLength,\n            title: aria.clip\n        })));\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (playbackId) {\n            return context.store.subscribe((state)=>state.__controls.requestedClipParams, (params)=>{\n                if (params) {\n                    onClip({\n                        playbackId,\n                        ...params\n                    });\n                }\n            });\n        }\n    }, [\n        playbackId\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || Boolean(clipLength)\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.button, {\n        type: \"button\",\n        \"aria-label\": title ?? void 0,\n        title: title ?? void 0,\n        disabled: !playbackId || !requestClip,\n        ...clipTriggerProps,\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(props.onClick, noPropagate(requestClip)),\n        ref: forwardedRef,\n        \"data-livepeer-controls-clip-button\": \"\",\n        \"data-visible\": String(Boolean(clipLength))\n    }));\n});\nClipTrigger.displayName = CLIP_TRIGGER_NAME;\n// src/player/Controls.tsx\n\n\n\n\n\nvar CONTROLS_NAME = \"Controls\";\nvar Controls = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { forceMount, __scopeMedia, onClick, style, autoHide, ...controlsProps } = props;\n    const context = useMediaContext(CONTROLS_NAME, __scopeMedia);\n    const { hidden, loading, togglePlay, error } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ hidden: hidden2, loading: loading2, __controlsFunctions, error: error2 })=>({\n            hidden: hidden2,\n            loading: loading2,\n            togglePlay: __controlsFunctions.togglePlay,\n            error: error2?.type ?? null\n        })));\n    const shown = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>!hidden && !loading && !error, [\n        hidden,\n        loading,\n        error\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (autoHide !== void 0) {\n            context.store.getState().__controlsFunctions.setAutohide(autoHide);\n        }\n    }, []);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || shown\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...controlsProps,\n        ref: forwardedRef,\n        \"data-livepeer-controls\": \"\",\n        \"data-visible\": String(shown),\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(onClick, noPropagate(togglePlay)),\n        style: {\n            ...style,\n            // ensures controls expands in ratio\n            position: \"absolute\",\n            inset: 0\n        }\n    }));\n});\nControls.displayName = CONTROLS_NAME;\n// src/player/LiveIndicator.tsx\n\n\n\nvar LIVE_INDICATOR_NAME = \"LiveIndicator\";\nvar LiveIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher = true, ...liveIndicatorProps } = props;\n    const context = useMediaContext(LIVE_INDICATOR_NAME, __scopeMedia);\n    const live = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, ({ live: live2 })=>live2);\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>typeof matcher === \"function\" ? matcher(live) : matcher === live, [\n        matcher,\n        live\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.span, {\n        \"aria-label\": \"live\",\n        ...liveIndicatorProps,\n        ref: forwardedRef,\n        \"data-livepeer-controls-live-indicator\": \"\",\n        \"data-live\": String(Boolean(live)),\n        \"data-visible\": String(isPresent)\n    }));\n});\nLiveIndicator.displayName = LIVE_INDICATOR_NAME;\n// src/player/MuteTrigger.tsx\n\n\n\n\nvar MUTE_TRIGGER_NAME = \"MuteTrigger\";\nvar MuteTrigger = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...playProps } = props;\n    const context = useMediaContext(MUTE_TRIGGER_NAME, __scopeMedia);\n    const { muted, toggleMute } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ __controls, __controlsFunctions })=>({\n            muted: __controls.muted,\n            toggleMute: __controlsFunctions.requestToggleMute\n        })));\n    const title = react__WEBPACK_IMPORTED_MODULE_0__.useMemo(()=>muted ? \"Unmute (m)\" : \"Mute (m)\", [\n        muted\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.button, {\n        type: \"button\",\n        \"aria-pressed\": muted,\n        \"aria-label\": title,\n        title,\n        ...playProps,\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(props.onClick, noPropagate(toggleMute)),\n        ref: forwardedRef,\n        \"data-livepeer-controls-mute-trigger\": \"\",\n        \"data-muted\": String(muted)\n    });\n});\nMuteTrigger.displayName = MUTE_TRIGGER_NAME;\n// src/player/Play.tsx\n\n\n\n\n\nvar PLAY_PAUSE_TRIGGER_NAME = \"PlayPauseTrigger\";\nvar PlayPauseTrigger = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...playProps } = props;\n    const context = useMediaContext(PLAY_PAUSE_TRIGGER_NAME, __scopeMedia);\n    const { playing, togglePlay, title } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ playing: playing2, __controlsFunctions, aria })=>({\n            playing: playing2,\n            togglePlay: __controlsFunctions.togglePlay,\n            title: aria.playPause\n        })));\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.button, {\n        type: \"button\",\n        \"aria-pressed\": playing,\n        \"aria-label\": title ?? void 0,\n        title: title ?? void 0,\n        ...playProps,\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(props.onClick, noPropagate(togglePlay)),\n        ref: forwardedRef,\n        \"data-livepeer-controls-play-pause-trigger\": \"\",\n        \"data-playing\": String(playing)\n    });\n});\nPlayPauseTrigger.displayName = PLAY_PAUSE_TRIGGER_NAME;\nvar PLAYING_INDICATOR_NAME = \"PlayingIndicator\";\nvar PlayingIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher = true, ...playPauseIndicatorProps } = props;\n    const context = useMediaContext(PLAYING_INDICATOR_NAME, __scopeMedia);\n    const playing = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ playing: playing2 })=>playing2));\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>typeof matcher === \"boolean\" ? matcher === playing : matcher(playing), [\n        playing,\n        matcher\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...playPauseIndicatorProps,\n        ref: forwardedRef,\n        \"data-livepeer-controls-play-pause-indicator\": \"\",\n        \"data-playing\": String(playing),\n        \"data-visible\": String(isPresent)\n    }));\n});\nPlayingIndicator.displayName = PLAYING_INDICATOR_NAME;\n// src/player/Player.tsx\n\n\n\n\n\nvar Player = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.memo((props)=>{\n    const { aspectRatio = 16 / 9, src, children, jwt, accessKey, storage, onPlaybackEvents, metricsInterval, playbackId, ...rest } = props;\n    const store = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)((0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_8__.createControllerStore)({\n        device: (0,_livepeer_core_web_browser__WEBPACK_IMPORTED_MODULE_11__.getDeviceInfo)(_livepeer_core_version__WEBPACK_IMPORTED_MODULE_10__.version.react),\n        storage: storage ?? (0,_livepeer_core_storage__WEBPACK_IMPORTED_MODULE_9__.createStorage)(storage !== null && \"undefined\" !== \"undefined\" ? 0 : {\n            storage: _livepeer_core_storage__WEBPACK_IMPORTED_MODULE_9__.noopStorage\n        }),\n        src,\n        playbackId,\n        initialProps: {\n            aspectRatio,\n            jwt,\n            accessKey,\n            ...rest\n        }\n    }));\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (jwt) {\n            store?.current?.store.setState((prev)=>({\n                    __initialProps: {\n                        ...prev.__initialProps,\n                        jwt\n                    }\n                }));\n        }\n    }, [\n        jwt\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (accessKey) {\n            store?.current?.store.setState((prev)=>({\n                    __initialProps: {\n                        ...prev.__initialProps,\n                        accessKey\n                    }\n                }));\n        }\n    }, [\n        accessKey\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        return ()=>{\n            store?.current?.destroy?.();\n        };\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const metrics = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_8__.addLegacyMediaMetricsToStore)(store.current.store);\n        return ()=>{\n            metrics.destroy();\n        };\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const metrics = (0,_livepeer_core_media__WEBPACK_IMPORTED_MODULE_8__.addMetricsToStore)(store.current.store, {\n            onPlaybackEvents,\n            interval: metricsInterval\n        });\n        return ()=>{\n            metrics.destroy();\n        };\n    }, []);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(MediaProvider, {\n        store: store.current.store,\n        scope: props.__scopeMedia\n    }, children);\n});\nPlayer.displayName = \"Player\";\nvar Root = Player;\n// src/player/Poster.tsx\n\n\n\nvar POSTER_NAME = \"Poster\";\nvar Poster = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, src, ...posterProps } = props;\n    const context = useMediaContext(POSTER_NAME, __scopeMedia);\n    const poster = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, ({ poster: poster2 })=>poster2);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || Boolean(src || poster)\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.img, {\n        alt: \"Poster for video\",\n        \"aria-hidden\": \"true\",\n        ...posterProps,\n        src: src || poster || void 0,\n        ref: forwardedRef,\n        \"data-livepeer-poster\": \"\",\n        \"data-visible\": String(Boolean(src || poster))\n    }));\n});\nPoster.displayName = POSTER_NAME;\n// src/player/RateSelect.tsx\n\n\n\n// src/shared/Select.tsx\n\nvar SelectRoot = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.Root;\nvar SelectTrigger2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectTrigger;\nvar SelectValue2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectValue;\nvar SelectIcon2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectIcon;\nvar SelectPortal2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectPortal;\nvar SelectContent2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectContent;\nvar SelectViewport2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectViewport;\nvar SelectGroup2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectGroup;\nvar SelectLabel2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectLabel;\nvar SelectItem2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectItem;\nvar SelectItemText2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectItemText;\nvar SelectItemIndicator2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectItemIndicator;\nvar SelectScrollUpButton2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectScrollUpButton;\nvar SelectScrollDownButton2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectScrollDownButton;\nvar SelectSeparator2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectSeparator;\nvar SelectArrow2 = _radix_ui_react_select__WEBPACK_IMPORTED_MODULE_12__.SelectArrow;\n// src/player/RateSelect.tsx\nvar RATE_SELECT_NAME = \"RateSelect\";\nvar RateSelect = (props)=>{\n    const { __scopeMedia, defaultValue, ...rateSelectProps } = props;\n    const context = useMediaContext(RATE_SELECT_NAME, __scopeMedia);\n    const { playbackRate, setPlaybackRate } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ playbackRate: playbackRate2, __controlsFunctions })=>({\n            playbackRate: playbackRate2,\n            setPlaybackRate: __controlsFunctions.setPlaybackRate\n        })));\n    const onValueChangeComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        setPlaybackRate(value);\n        props.onValueChange?.(value);\n    }, [\n        props.onValueChange,\n        setPlaybackRate\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectRoot, {\n        ...rateSelectProps,\n        value: playbackRate === \"constant\" ? \"constant\" : playbackRate.toFixed(2),\n        onValueChange: onValueChangeComposed,\n        \"data-livepeer-rate-select\": \"\",\n        \"data-rate\": String(playbackRate)\n    });\n};\nRateSelect.displayName = RATE_SELECT_NAME;\nvar RATE_SELECT_ITEM_NAME = \"RateSelectItem\";\nvar RateSelectItem = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, value, ...rateSelectItemProps } = props;\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectItem2, {\n        ...rateSelectItemProps,\n        ref: forwardedRef,\n        value: Number(value).toFixed(2),\n        \"data-livepeer-rate-select-item\": \"\"\n    });\n});\nRateSelectItem.displayName = RATE_SELECT_ITEM_NAME;\n// src/player/Seek.tsx\n\n\n\n\n// src/shared/Slider.tsx\n\nvar Root4 = _radix_ui_react_slider__WEBPACK_IMPORTED_MODULE_13__.Root;\nvar Track2 = _radix_ui_react_slider__WEBPACK_IMPORTED_MODULE_13__.Track;\nvar Range2 = _radix_ui_react_slider__WEBPACK_IMPORTED_MODULE_13__.Range;\nvar Thumb2 = _radix_ui_react_slider__WEBPACK_IMPORTED_MODULE_13__.Thumb;\n// src/player/Seek.tsx\nvar SEEK_NAME = \"Seek\";\nvar Seek = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, style, ...seekProps } = props;\n    const context = useMediaContext(SEEK_NAME, __scopeMedia);\n    const { ariaProgress, duration, buffered, bufferedPercent, progress, live, seek } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ aria, duration: duration2, buffered: buffered2, bufferedPercent: bufferedPercent2, progress: progress2, live: live2, __controlsFunctions })=>({\n            ariaProgress: aria.progress,\n            duration: duration2,\n            buffered: buffered2,\n            bufferedPercent: bufferedPercent2,\n            progress: progress2,\n            live: live2,\n            seek: __controlsFunctions.requestSeek\n        })));\n    const onValueChange = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(([value])=>seek(value), [\n        seek\n    ]);\n    const onValueCommit = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(([value])=>seek(value), [\n        seek\n    ]);\n    const onValueChangeComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        if (props.onValueChange) {\n            props.onValueChange(value);\n        }\n        onValueChange(value);\n    }, [\n        props.onValueChange,\n        onValueChange\n    ]);\n    const onValueCommitComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        if (props.onValueCommit) {\n            props.onValueCommit(value);\n        }\n        onValueCommit(value);\n    }, [\n        props.onValueCommit,\n        onValueCommit\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || !live\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root4, {\n        \"aria-label\": live ? \"Live Seek Slider\" : \"Video Seek Slider\",\n        \"aria-valuetext\": ariaProgress ?? void 0,\n        step: 0.1,\n        max: duration,\n        value: [\n            progress\n        ],\n        role: \"slider\",\n        ...seekProps,\n        onValueChange: onValueChangeComposed,\n        onValueCommit: onValueCommitComposed,\n        onClick: noPropagate(()=>{}),\n        ref: forwardedRef,\n        \"data-livepeer-controls-seek\": \"\",\n        \"data-duration\": duration,\n        \"data-progress\": progress,\n        \"data-live\": String(live),\n        \"data-buffered\": buffered,\n        \"data-visible\": String(!live),\n        style: {\n            // biome-ignore lint/suspicious/noExplicitAny: player container css var\n            [\"--livepeer-player-buffering-width\"]: `${bufferedPercent ?? 0}%`,\n            ...style\n        }\n    }));\n});\nSeek.displayName = SEEK_NAME;\nvar SEEK_BUFFER_NAME = \"SeekBuffer\";\nvar SeekBuffer = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, style, ...bufferProps } = props;\n    const context = useMediaContext(SEEK_BUFFER_NAME, __scopeMedia);\n    const { bufferedPercent, buffered } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ bufferedPercent: bufferedPercent2, buffered: buffered2 })=>({\n            buffered: buffered2,\n            bufferedPercent: bufferedPercent2\n        })));\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Track2, {\n        ...bufferProps,\n        ref: forwardedRef,\n        style: {\n            left: 0,\n            right: `${100 - (bufferedPercent ?? 0)}%`,\n            ...style\n        },\n        \"data-livepeer-controls-seek-buffer\": \"\",\n        \"data-buffered\": buffered\n    });\n});\nSeekBuffer.displayName = SEEK_BUFFER_NAME;\n// src/player/Video.tsx\n\n\n\n\n\nvar VIDEO_NAME = \"Video\";\nvar Video = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, style, poster, hlsConfig, title, ...videoProps } = props;\n    const context = useMediaContext(VIDEO_NAME, __scopeMedia);\n    const ref = react__WEBPACK_IMPORTED_MODULE_0__.useRef(null);\n    const composedRefs = (0,_radix_ui_react_compose_refs__WEBPACK_IMPORTED_MODULE_14__.useComposedRefs)(forwardedRef, ref);\n    const { currentSource, setMounted, autoPlay, preload, thumbnailPoster, volume, requestToggleMute } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ __controlsFunctions, __initialProps, currentSource: currentSource2, live, poster: poster2, volume: volume2 })=>({\n            autoPlay: __initialProps.autoPlay,\n            currentSource: currentSource2,\n            live,\n            preload: __initialProps.preload,\n            setMounted: __controlsFunctions.setMounted,\n            thumbnailPoster: poster2,\n            volume: volume2,\n            requestToggleMute: __controlsFunctions.requestToggleMute\n        })));\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (ref.current) {\n            const { destroy } = (0,_livepeer_core_web_browser__WEBPACK_IMPORTED_MODULE_11__.addEventListeners)(ref.current, context.store);\n            return destroy;\n        }\n    }, [\n        context?.store\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (hlsConfig) {\n            context.store.getState().__controlsFunctions.setHlsConfig(hlsConfig);\n        }\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        setMounted();\n    }, [\n        setMounted\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (typeof videoProps.muted !== \"undefined\") {\n            requestToggleMute(videoProps.muted);\n        }\n    }, [\n        videoProps.muted,\n        requestToggleMute\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.video, {\n        playsInline: true,\n        poster: poster === null ? void 0 : poster ?? thumbnailPoster ?? void 0,\n        muted: volume === 0,\n        ...videoProps,\n        \"aria-label\": title ?? videoProps[\"aria-label\"],\n        autoPlay,\n        preload,\n        ref: composedRefs,\n        \"data-livepeer-video\": \"\",\n        \"data-livepeer-source-type\": currentSource?.type ?? \"none\",\n        style: {\n            ...style,\n            // ensures video expands in ratio\n            position: \"absolute\",\n            inset: 0\n        }\n    });\n});\nVideo.displayName = VIDEO_NAME;\n// src/player/VideoQualitySelect.tsx\n\n\n\nvar VIDEO_QUALITY_SELECT_NAME = \"VideoQualitySelect\";\nvar VideoQualitySelect = (props)=>{\n    const { __scopeMedia, defaultValue, ...videoQualitySelectProps } = props;\n    const context = useMediaContext(VIDEO_QUALITY_SELECT_NAME, __scopeMedia);\n    const { videoQuality, setVideoQuality } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ videoQuality: videoQuality2, __controlsFunctions })=>({\n            videoQuality: videoQuality2,\n            setVideoQuality: __controlsFunctions.setVideoQuality\n        })));\n    const onValueChangeComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        if (props.onValueChange) {\n            props.onValueChange(value);\n        }\n        setVideoQuality(value);\n    }, [\n        props.onValueChange,\n        setVideoQuality\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectRoot, {\n        ...videoQualitySelectProps,\n        value: videoQuality,\n        onValueChange: onValueChangeComposed,\n        \"data-livepeer-quality-select\": \"\",\n        \"data-video-quality\": String(videoQuality)\n    });\n};\nVideoQualitySelect.displayName = VIDEO_QUALITY_SELECT_NAME;\nvar VIDEO_QUALITY_SELECT_ITEM_NAME = \"VideoQualitySelectItem\";\nvar VideoQualitySelectItem = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...videoQualitySelectItemProps } = props;\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(SelectItem2, {\n        ...videoQualitySelectItemProps,\n        ref: forwardedRef,\n        \"data-livepeer-quality-select-item\": \"\"\n    });\n});\nVideoQualitySelectItem.displayName = VIDEO_QUALITY_SELECT_ITEM_NAME;\n// src/player/Volume.tsx\n\n\n\n\n\nvar VOLUME_NAME = \"Volume\";\nvar Volume = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, ...volumeProps } = props;\n    const context = useMediaContext(VOLUME_NAME, __scopeMedia);\n    const { volume, requestVolume, isVolumeChangeSupported } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ volume: volume2, __controlsFunctions, __device })=>({\n            volume: volume2,\n            requestVolume: __controlsFunctions.requestVolume,\n            isVolumeChangeSupported: __device.isVolumeChangeSupported\n        })));\n    const onValueChange = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(([value])=>requestVolume(value), [\n        requestVolume\n    ]);\n    const onValueCommit = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(([value])=>requestVolume(value), [\n        requestVolume\n    ]);\n    const onValueChangeComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        if (props.onValueChange) {\n            props.onValueChange(value);\n        }\n        onValueChange(value);\n    }, [\n        props.onValueChange,\n        onValueChange\n    ]);\n    const onValueCommitComposed = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value)=>{\n        if (props.onValueCommit) {\n            props.onValueCommit(value);\n        }\n        onValueCommit(value);\n    }, [\n        props.onValueCommit,\n        onValueCommit\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isVolumeChangeSupported\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root4, {\n        \"aria-label\": \"Volume Slider\",\n        step: 0.01,\n        max: 1,\n        value: [\n            volume\n        ],\n        ...volumeProps,\n        onClick: noPropagate(()=>{}),\n        onValueChange: onValueChangeComposed,\n        onValueCommit: onValueCommitComposed,\n        ref: forwardedRef,\n        \"data-livepeer-controls-volume\": \"\",\n        \"data-livepeer-muted\": String(volume === 0),\n        \"data-livepeer-volume\": String((100 * volume).toFixed(0)),\n        \"data-visible\": String(Boolean(isVolumeChangeSupported))\n    }));\n});\nVolume.displayName = VOLUME_NAME;\nvar VOLUME_INDICATOR_NAME = \"VolumeIndicator\";\nvar VolumeIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher = false, ...volumeIndicatorProps } = props;\n    const context = useMediaContext(VOLUME_INDICATOR_NAME, __scopeMedia);\n    const { volume, muted, isVolumeChangeSupported } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ volume: volume2, __device, __controls })=>({\n            volume: volume2,\n            muted: __controls.muted,\n            isVolumeChangeSupported: __device.isVolumeChangeSupported\n        })));\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>matcher !== void 0 ? typeof matcher === \"boolean\" ? matcher ? !muted : muted : matcher(volume) : muted, [\n        volume,\n        matcher,\n        muted\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (isVolumeChangeSupported && typeof matcher !== \"boolean\") {\n            (0,_livepeer_core_utils__WEBPACK_IMPORTED_MODULE_15__.warn)(\"Volume change is not supported on this device.\");\n        }\n    }, [\n        isVolumeChangeSupported,\n        matcher\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...volumeIndicatorProps,\n        ref: forwardedRef,\n        \"data-livepeer-muted\": String(muted),\n        \"data-livepeer-volume\": String((100 * volume).toFixed(0)),\n        \"data-livepeer-controls-volume-indicator\": \"\",\n        \"data-visible\": String(isPresent)\n    }));\n});\nVolumeIndicator.displayName = VOLUME_INDICATOR_NAME;\n// src/shared/Container.tsx\n\n\n\n\nvar CONTAINER_NAME = \"Container\";\nvar Container = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.memo(/*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...aspectRatioProps } = props;\n    const context = useMediaContext(CONTAINER_NAME, __scopeMedia);\n    const { aspectRatio, fullscreen, playing, canPlay, rate, error, live, hasPlayed, hidden, pictureInPicture, loading, videoQuality } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ __initialProps, fullscreen: fullscreen2, playing: playing2, canPlay: canPlay2, playbackRate, error: error2, live: live2, hasPlayed: hasPlayed2, hidden: hidden2, pictureInPicture: pictureInPicture2, loading: loading2, videoQuality: videoQuality2 })=>({\n            aspectRatio: __initialProps.aspectRatio,\n            fullscreen: fullscreen2,\n            playing: playing2,\n            canPlay: canPlay2,\n            error: Boolean(error2),\n            rate: playbackRate === \"constant\" ? \"constant\" : playbackRate > 1 ? \"fast\" : playbackRate < 1 ? \"slow\" : \"normal\",\n            live: live2,\n            hasPlayed: hasPlayed2,\n            hidden: hidden2,\n            pictureInPicture: pictureInPicture2,\n            loading: loading2,\n            videoQuality: videoQuality2\n        })));\n    return aspectRatio ? /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_aspect_ratio__WEBPACK_IMPORTED_MODULE_16__.Root, {\n        ratio: aspectRatio,\n        ...aspectRatioProps,\n        ref: forwardedRef,\n        \"data-livepeer-aspect-ratio\": \"\",\n        \"data-fullscreen\": String(fullscreen),\n        \"data-playing\": String(playing),\n        \"data-can-play\": String(canPlay),\n        \"data-playback-rate\": rate,\n        \"data-error\": String(error),\n        \"data-loading\": String(loading),\n        \"data-live\": String(live),\n        \"data-has-played\": String(hasPlayed),\n        \"data-controls-hidden\": String(hidden),\n        \"data-picture-in-picture\": String(pictureInPicture),\n        \"data-video-quality\": String(videoQuality)\n    }) : /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...aspectRatioProps,\n        ref: forwardedRef,\n        \"data-livepeer-wrapper\": \"\",\n        \"data-fullscreen\": String(fullscreen),\n        \"data-playing\": String(playing),\n        \"data-can-play\": String(canPlay),\n        \"data-playback-rate\": rate,\n        \"data-error\": String(error),\n        \"data-loading\": String(loading),\n        \"data-live\": String(live),\n        \"data-has-played\": String(hasPlayed),\n        \"data-controls-hidden\": String(hidden),\n        \"data-picture-in-picture\": String(pictureInPicture),\n        \"data-video-quality\": String(videoQuality)\n    });\n}));\nContainer.displayName = CONTAINER_NAME;\n// src/shared/ErrorIndicator.tsx\n\n\n\nvar ERROR_INDICATOR_NAME = \"ErrorIndicator\";\nvar ErrorIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher, ...offlineErrorProps } = props;\n    const context = useMediaContext(ERROR_INDICATOR_NAME, __scopeMedia);\n    const error = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, ({ error: error2 })=>error2);\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>error ? typeof matcher === \"string\" ? matcher === \"all\" ? true : matcher === \"not-permissions\" ? error.type !== \"permissions\" : matcher === error.type : matcher(error.type) : false, [\n        error,\n        matcher\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...offlineErrorProps,\n        ref: forwardedRef,\n        \"data-livepeer-error-indicator\": \"\",\n        \"data-error-state\": String(Boolean(error)),\n        \"data-error-type\": error?.type ?? \"none\",\n        \"data-visible\": String(isPresent)\n    }));\n});\nErrorIndicator.displayName = ERROR_INDICATOR_NAME;\n// src/shared/Fullscreen.tsx\n\n\n\n\n\nvar FULLSCREEN_INDICATOR_NAME = \"FullscreenIndicator\";\nvar FullscreenIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher = true, ...fullscreenIndicatorProps } = props;\n    const context = useMediaContext(FULLSCREEN_INDICATOR_NAME, __scopeMedia);\n    const fullscreen = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ fullscreen: fullscreen2 })=>fullscreen2));\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>typeof matcher === \"function\" ? matcher(fullscreen) : matcher === fullscreen, [\n        matcher,\n        fullscreen\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        ...fullscreenIndicatorProps,\n        ref: forwardedRef,\n        \"data-livepeer-controls-fullscreen-indicator\": \"\",\n        \"data-fullscreen\": String(Boolean(fullscreen)),\n        \"data-visible\": String(isPresent)\n    }));\n});\nFullscreenIndicator.displayName = FULLSCREEN_INDICATOR_NAME;\nvar FULLSCREEN_TRIGGER_NAME = \"FullscreenTrigger\";\nvar FullscreenTrigger = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...fullscreenProps } = props;\n    const context = useMediaContext(FULLSCREEN_TRIGGER_NAME, __scopeMedia);\n    const { title, fullscreen, requestToggleFullscreen } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ fullscreen: fullscreen2, __controlsFunctions, aria })=>({\n            fullscreen: fullscreen2,\n            requestToggleFullscreen: __controlsFunctions.requestToggleFullscreen,\n            title: aria.fullscreen\n        })));\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.button, {\n        type: \"button\",\n        \"aria-pressed\": fullscreen,\n        \"aria-label\": title ?? void 0,\n        title: title ?? void 0,\n        ...fullscreenProps,\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(props.onClick, noPropagate(requestToggleFullscreen)),\n        ref: forwardedRef,\n        \"data-livepeer-controls-fullscreen-trigger\": \"\",\n        \"data-fullscreen-state\": String(Boolean(fullscreen))\n    });\n});\nFullscreenTrigger.displayName = FULLSCREEN_TRIGGER_NAME;\n// src/shared/LoadingIndicator.tsx\n\n\n\nvar LOADING_INDICATOR_NAME = \"LoadingIndicator\";\nvar LoadingIndicator = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, matcher = true, ...offlineErrorProps } = props;\n    const context = useMediaContext(LOADING_INDICATOR_NAME, __scopeMedia);\n    const loading = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, ({ loading: loading2 })=>loading2);\n    const isPresent = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>typeof matcher === \"function\" ? matcher(loading) : matcher === loading, [\n        matcher,\n        loading\n    ]);\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPresent\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.div, {\n        \"aria-label\": \"Loading\",\n        ...offlineErrorProps,\n        ref: forwardedRef,\n        \"data-livepeer-loading-indicator\": \"\",\n        \"data-loading\": String(Boolean(loading)),\n        \"data-visible\": String(isPresent)\n    }));\n});\nLoadingIndicator.displayName = LOADING_INDICATOR_NAME;\n// src/shared/PictureInPictureTrigger.tsx\n\n\n\n\n\nvar PICTURE_IN_PICTURE_TRIGGER_NAME = \"PictureInPictureTrigger\";\nvar PictureInPictureTrigger = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, forceMount, ...pictureInPictureProps } = props;\n    const context = useMediaContext(PICTURE_IN_PICTURE_TRIGGER_NAME, __scopeMedia);\n    const { pictureInPicture, requestTogglePictureInPicture, isPictureInPictureSupported, fullscreen, title } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ pictureInPicture: pictureInPicture2, __controlsFunctions, __device, fullscreen: fullscreen2, aria })=>({\n            pictureInPicture: pictureInPicture2,\n            requestTogglePictureInPicture: __controlsFunctions.requestTogglePictureInPicture,\n            isPictureInPictureSupported: __device.isPictureInPictureSupported,\n            fullscreen: fullscreen2,\n            title: aria.pictureInPicture\n        })));\n    return(// do not show button if it is not supported or if currently fullscreen\n    /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_presence__WEBPACK_IMPORTED_MODULE_6__.Presence, {\n        present: forceMount || isPictureInPictureSupported && !fullscreen\n    }, /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.button, {\n        type: \"button\",\n        \"aria-pressed\": pictureInPicture,\n        \"aria-label\": title ?? void 0,\n        title: title ?? void 0,\n        ...pictureInPictureProps,\n        onClick: (0,_radix_ui_primitive__WEBPACK_IMPORTED_MODULE_7__.composeEventHandlers)(props.onClick, noPropagate(requestTogglePictureInPicture)),\n        ref: forwardedRef,\n        \"data-livepeer-controls-picture-in-picture-trigger\": \"\",\n        \"data-picture-in-picture\": String(Boolean(pictureInPicture)),\n        \"data-visible\": String(isPictureInPictureSupported && !fullscreen)\n    })));\n});\nPictureInPictureTrigger.displayName = PICTURE_IN_PICTURE_TRIGGER_NAME;\n// src/shared/Portal.tsx\n\n\nvar PORTAL_NAME = \"Portal\";\nvar Portal = (props)=>{\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(_radix_ui_react_portal__WEBPACK_IMPORTED_MODULE_17__.Root, {\n        ...props\n    });\n};\nPortal.displayName = PORTAL_NAME;\n// src/shared/Time.tsx\n\n\n\nvar TIME_NAME = \"Time\";\nvar Time = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((props, forwardedRef)=>{\n    const { __scopeMedia, ...timeProps } = props;\n    const context = useMediaContext(TIME_NAME, __scopeMedia);\n    const { progress, duration, live, formattedTime } = (0,zustand__WEBPACK_IMPORTED_MODULE_2__.useStore)(context.store, (0,zustand_react_shallow__WEBPACK_IMPORTED_MODULE_5__.useShallow)(({ progress: progress2, duration: duration2, live: live2, aria })=>({\n            formattedTime: aria.time,\n            progress: progress2,\n            duration: duration2,\n            live: live2\n        })));\n    return /* @__PURE__ */ /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(Primitive.span, {\n        \"aria-label\": formattedTime ?? void 0,\n        title: formattedTime ?? void 0,\n        ...timeProps,\n        ref: forwardedRef,\n        \"data-livepeer-controls-time\": \"\",\n        \"data-duration\": duration,\n        \"data-progress\": progress,\n        \"data-live\": String(live)\n    }, formattedTime);\n});\nTime.displayName = TIME_NAME;\n //# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGxpdmVwZWVyL3JlYWN0L2Rpc3QvcGxheWVyL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRXFDO0FBQ1o7QUFFUTtBQUNSO0FBQ0U7O0FDTFE7QUFDUztBQUU1QyxJQUFNUSxhQUFhO0FBSW5CLElBQU0sQ0FBQ0Msb0JBQW9CQyxpQkFBZ0IsR0FBSUosMkVBQWtCQSxDQUFDRTtBQU1sRSxJQUFNLENBQUNHLGVBQWVDLGdCQUFlLEdBQ25DSCxtQkFBc0NEO0FBRXhDLElBQU1KLFdBQVdHLDZDQUFlQTs7QUNsQlg7QUFDRTtBQUNHO0FBRTFCLElBQU1RLFFBQVE7SUFDWjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRjtBQTZCQSxJQUFNQyxZQUFZRCxNQUFNRSxNQUFBLENBQU8sQ0FBQ0MsV0FBV0M7SUFDekMsTUFBTUMscUJBQWFsQiw2Q0FBQTtJQUVqQixDQUFDb0IsT0FBMkNDO1FBQzFDLE1BQU0sRUFBRUMsT0FBQSxFQUFTLEdBQUdDLGdCQUFlLEdBQUlIO1FBRXZDLE1BQU1JLE9BQVlGLFVBQVVYLHNEQUFJQSxHQUFHTTtRQUU3QmpCLDRDQUFBLENBQVU7WUFFYnlCLE1BQUEsQ0FBZUMsT0FBT0MsR0FBQSxDQUFJLFlBQVcsR0FBSTtRQUM1QyxHQUFHLEVBQUU7UUFFTCxPQUFPLDhCQUFBM0IsZ0RBQUEsQ0FBQ3dCLE1BQUE7WUFBTSxHQUFHRCxjQUFBO1lBQWdCTSxLQUFLUjtRQUFBO0lBQ3hDO0lBR0ZILEtBQUtZLFdBQUEsR0FBYyxhQUFhYixLQUFJO0lBR3BDLE9BQU87UUFBRSxHQUFHRCxTQUFBO1FBQVcsQ0FBQ0MsS0FBSSxFQUFHQztJQUFLO0FBQ3RDLEdBQUcsQ0FBQzs7QUN6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RXJCZ0w7QUFHUDtBQUdGRixLQUFLbk8sV0FBQSxHQUFja08iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9wbGF5ZXIvQ2xpcFRyaWdnZXIudHN4PzE1ZjUiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvc2hhcmVkL2NvbnRleHQudHN4P2VjMmMiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvc2hhcmVkL3ByaW1pdGl2ZS50c3g/OGUxMCIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvdXRpbHMudHM/MTgxYyIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9wbGF5ZXIvQ29udHJvbHMudHN4PzUzOWIiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvcGxheWVyL0xpdmVJbmRpY2F0b3IudHN4P2ZmY2YiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvcGxheWVyL011dGVUcmlnZ2VyLnRzeD8zYzBlIiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3BsYXllci9QbGF5LnRzeD84MDY3Iiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3BsYXllci9QbGF5ZXIudHN4Pzk2Y2YiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvcGxheWVyL1Bvc3Rlci50c3g/OWZjZSIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9wbGF5ZXIvUmF0ZVNlbGVjdC50c3g/OGVlMyIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvU2VsZWN0LnRzeD8yMDhlIiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3BsYXllci9TZWVrLnRzeD8wYzZhIiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3NoYXJlZC9TbGlkZXIudHN4P2ExMzciLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvcGxheWVyL1ZpZGVvLnRzeD85YmQxIiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3BsYXllci9WaWRlb1F1YWxpdHlTZWxlY3QudHN4PzgzZWQiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvcGxheWVyL1ZvbHVtZS50c3g/ZDhiOSIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvQ29udGFpbmVyLnRzeD9mODRiIiwid2VicGFjazovL3Rpa3Rvay10b2tlbi1sYXVuY2hwYWQvLi4vLi4vc3JjL3NoYXJlZC9FcnJvckluZGljYXRvci50c3g/YmI4NiIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvRnVsbHNjcmVlbi50c3g/ODQ0ZSIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvTG9hZGluZ0luZGljYXRvci50c3g/OWNmZiIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvUGljdHVyZUluUGljdHVyZVRyaWdnZXIudHN4P2JkYTAiLCJ3ZWJwYWNrOi8vdGlrdG9rLXRva2VuLWxhdW5jaHBhZC8uLi8uLi9zcmMvc2hhcmVkL1BvcnRhbC50c3g/ODY2MCIsIndlYnBhY2s6Ly90aWt0b2stdG9rZW4tbGF1bmNocGFkLy4uLy4uL3NyYy9zaGFyZWQvVGltZS50c3g/ZjVhNCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgY29tcG9zZUV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiQHJhZGl4LXVpL3ByaW1pdGl2ZVwiO1xuaW1wb3J0IHsgUHJlc2VuY2UgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXByZXNlbmNlXCI7XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHVzZVNoYWxsb3cgfSBmcm9tIFwienVzdGFuZC9yZWFjdC9zaGFsbG93XCI7XG5pbXBvcnQgeyB0eXBlIE1lZGlhU2NvcGVkUHJvcHMsIHVzZU1lZGlhQ29udGV4dCB9IGZyb20gXCIuLi9zaGFyZWQvY29udGV4dFwiO1xuaW1wb3J0ICogYXMgUmFkaXggZnJvbSBcIi4uL3NoYXJlZC9wcmltaXRpdmVcIjtcbmltcG9ydCB7IG5vUHJvcGFnYXRlIH0gZnJvbSBcIi4uL3NoYXJlZC91dGlsc1wiO1xuXG5jb25zdCBDTElQX1RSSUdHRVJfTkFNRSA9IFwiQ2xpcFRyaWdnZXJcIjtcblxudHlwZSBDbGlwVHJpZ2dlckVsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuYnV0dG9uPjtcblxuaW50ZXJmYWNlIENsaXBUcmlnZ2VyUHJvcHNcbiAgZXh0ZW5kcyBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5idXR0b24+IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gZm9yY2UgbW91bnRpbmcgd2hlbiBtb3JlIGNvbnRyb2wgaXMgbmVlZGVkLiBVc2VmdWwgd2hlblxuICAgKiBjb250cm9sbGluZyBhbmltYXRpb24gd2l0aCBSZWFjdCBhbmltYXRpb24gbGlicmFyaWVzLlxuICAgKi9cbiAgZm9yY2VNb3VudD86IHRydWU7XG5cbiAgb25DbGlwOiAob3B0czoge1xuICAgIC8qKlxuICAgICAqIFBsYXliYWNrIElEIG9mIHRoZSBzdHJlYW0gb3IgYXNzZXQgdG8gY2xpcFxuICAgICAqL1xuICAgIHBsYXliYWNrSWQ6IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBTdGFydCB0aW1lIG9mIHRoZSBjbGlwIGluIG1pbGxpc2Vjb25kc1xuICAgICAqL1xuICAgIHN0YXJ0VGltZTogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIEVuZCB0aW1lIG9mIHRoZSBjbGlwIGluIG1pbGxpc2Vjb25kc1xuICAgICAqL1xuICAgIGVuZFRpbWU6IG51bWJlcjtcbiAgfSkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQ7XG59XG5cbmNvbnN0IENsaXBUcmlnZ2VyID0gUmVhY3QuZm9yd2FyZFJlZjxDbGlwVHJpZ2dlckVsZW1lbnQsIENsaXBUcmlnZ2VyUHJvcHM+KFxuICAocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8Q2xpcFRyaWdnZXJQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICAgIGNvbnN0IHsgX19zY29wZU1lZGlhLCBmb3JjZU1vdW50LCBvbkNsaXAsIC4uLmNsaXBUcmlnZ2VyUHJvcHMgfSA9IHByb3BzO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChDTElQX1RSSUdHRVJfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICAgIGNvbnN0IHsgY2xpcExlbmd0aCwgcmVxdWVzdENsaXAsIHBsYXliYWNrSWQsIHRpdGxlIH0gPSB1c2VTdG9yZShcbiAgICAgIGNvbnRleHQuc3RvcmUsXG4gICAgICB1c2VTaGFsbG93KFxuICAgICAgICAoeyBfX2NvbnRyb2xzLCBfX2NvbnRyb2xzRnVuY3Rpb25zLCBhcmlhLCBfX2luaXRpYWxQcm9wcyB9KSA9PiAoe1xuICAgICAgICAgIHJlcXVlc3RDbGlwOiBfX2NvbnRyb2xzRnVuY3Rpb25zLnJlcXVlc3RDbGlwLFxuICAgICAgICAgIHBsYXliYWNrSWQ6IF9fY29udHJvbHMucGxheWJhY2tJZCxcbiAgICAgICAgICBjbGlwTGVuZ3RoOiBfX2luaXRpYWxQcm9wcy5jbGlwTGVuZ3RoLFxuICAgICAgICAgIHRpdGxlOiBhcmlhLmNsaXAsXG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3MvdXNlRXhoYXVzdGl2ZURlcGVuZGVuY2llczogbm8gZGVwZW5kZW5jaWVzXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChwbGF5YmFja0lkKSB7XG4gICAgICAgIHJldHVybiBjb250ZXh0LnN0b3JlLnN1YnNjcmliZShcbiAgICAgICAgICAoc3RhdGUpID0+IHN0YXRlLl9fY29udHJvbHMucmVxdWVzdGVkQ2xpcFBhcmFtcyxcbiAgICAgICAgICAocGFyYW1zKSA9PiB7XG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgIG9uQ2xpcCh7IHBsYXliYWNrSWQsIC4uLnBhcmFtcyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0sIFtwbGF5YmFja0lkXSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFByZXNlbmNlIHByZXNlbnQ9e2ZvcmNlTW91bnQgfHwgQm9vbGVhbihjbGlwTGVuZ3RoKX0+XG4gICAgICAgIDxSYWRpeC5QcmltaXRpdmUuYnV0dG9uXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgYXJpYS1sYWJlbD17dGl0bGUgPz8gdW5kZWZpbmVkfVxuICAgICAgICAgIHRpdGxlPXt0aXRsZSA/PyB1bmRlZmluZWR9XG4gICAgICAgICAgZGlzYWJsZWQ9eyFwbGF5YmFja0lkIHx8ICFyZXF1ZXN0Q2xpcH1cbiAgICAgICAgICB7Li4uY2xpcFRyaWdnZXJQcm9wc31cbiAgICAgICAgICBvbkNsaWNrPXtjb21wb3NlRXZlbnRIYW5kbGVycyhcbiAgICAgICAgICAgIHByb3BzLm9uQ2xpY2ssXG4gICAgICAgICAgICBub1Byb3BhZ2F0ZShyZXF1ZXN0Q2xpcCksXG4gICAgICAgICAgKX1cbiAgICAgICAgICByZWY9e2ZvcndhcmRlZFJlZn1cbiAgICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLWNsaXAtYnV0dG9uPVwiXCJcbiAgICAgICAgICBkYXRhLXZpc2libGU9e1N0cmluZyhCb29sZWFuKGNsaXBMZW5ndGgpKX1cbiAgICAgICAgLz5cbiAgICAgIDwvUHJlc2VuY2U+XG4gICAgKTtcbiAgfSxcbik7XG5cbkNsaXBUcmlnZ2VyLmRpc3BsYXlOYW1lID0gQ0xJUF9UUklHR0VSX05BTUU7XG5cbmV4cG9ydCB7IENsaXBUcmlnZ2VyIH07XG5leHBvcnQgdHlwZSB7IENsaXBUcmlnZ2VyUHJvcHMgfTtcbiIsImltcG9ydCB0eXBlIHsgTWVkaWFDb250cm9sbGVyU3RvcmUgfSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUvbWVkaWFcIjtcbmltcG9ydCB0eXBlIHsgU2NvcGUgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LWNvbnRleHRcIjtcbmltcG9ydCB7IGNyZWF0ZUNvbnRleHRTY29wZSB9IGZyb20gXCJAcmFkaXgtdWkvcmVhY3QtY29udGV4dFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgYXMgdXNlU3RvcmVadXN0YW5kIH0gZnJvbSBcInp1c3RhbmRcIjtcblxuY29uc3QgTUVESUFfTkFNRSA9IFwiTWVkaWFcIjtcblxuLy8gYmlvbWUtaWdub3JlIGxpbnQvY29tcGxleGl0eS9ub0Jhbm5lZFR5cGVzOiBhbGxvdyB7fVxudHlwZSBNZWRpYVNjb3BlZFByb3BzPFAgPSB7fT4gPSBQICYgeyBfX3Njb3BlTWVkaWE/OiBTY29wZSB9O1xuY29uc3QgW2NyZWF0ZU1lZGlhQ29udGV4dCwgY3JlYXRlTWVkaWFTY29wZV0gPSBjcmVhdGVDb250ZXh0U2NvcGUoTUVESUFfTkFNRSk7XG5cbnR5cGUgTWVkaWFDb250ZXh0VmFsdWUgPSB7XG4gIHN0b3JlOiBNZWRpYUNvbnRyb2xsZXJTdG9yZTtcbn07XG5cbmNvbnN0IFtNZWRpYVByb3ZpZGVyLCB1c2VNZWRpYUNvbnRleHRdID1cbiAgY3JlYXRlTWVkaWFDb250ZXh0PE1lZGlhQ29udGV4dFZhbHVlPihNRURJQV9OQU1FKTtcblxuY29uc3QgdXNlU3RvcmUgPSB1c2VTdG9yZVp1c3RhbmQ7XG5cbmV4cG9ydCB7IE1lZGlhUHJvdmlkZXIsIGNyZWF0ZU1lZGlhU2NvcGUsIHVzZU1lZGlhQ29udGV4dCwgdXNlU3RvcmUgfTtcbmV4cG9ydCB0eXBlIHsgTWVkaWFDb250ZXh0VmFsdWUsIE1lZGlhU2NvcGVkUHJvcHMgfTtcbiIsImltcG9ydCB7IFNsb3QgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXNsb3RcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0ICogYXMgUmVhY3RET00gZnJvbSBcInJlYWN0LWRvbVwiO1xuXG5jb25zdCBOT0RFUyA9IFtcbiAgXCJhXCIsXG4gIFwiYXVkaW9cIixcbiAgXCJidXR0b25cIixcbiAgXCJkaXZcIixcbiAgXCJmb3JtXCIsXG4gIFwiaDJcIixcbiAgXCJoM1wiLFxuICBcImltZ1wiLFxuICBcImlucHV0XCIsXG4gIFwibGFiZWxcIixcbiAgXCJsaVwiLFxuICBcIm5hdlwiLFxuICBcIm9sXCIsXG4gIFwicFwiLFxuICBcInNwYW5cIixcbiAgXCJzdmdcIixcbiAgXCJ1bFwiLFxuICBcInZpZGVvXCIsXG5dIGFzIGNvbnN0O1xuXG4vLyBUZW1wb3Jhcnkgd2hpbGUgd2UgYXdhaXQgbWVyZ2Ugb2YgdGhpcyBmaXg6XG4vLyBodHRwczovL2dpdGh1Yi5jb20vRGVmaW5pdGVseVR5cGVkL0RlZmluaXRlbHlUeXBlZC9wdWxsLzU1Mzk2XG4vLyBiaW9tZS1pZ25vcmUgbGludC9zdXNwaWNpb3VzL25vRXhwbGljaXRBbnk6IGFueVxudHlwZSBQcm9wc1dpdGhvdXRSZWY8UD4gPSBQIGV4dGVuZHMgYW55XG4gID8gXCJyZWZcIiBleHRlbmRzIGtleW9mIFBcbiAgICA/IFBpY2s8UCwgRXhjbHVkZTxrZXlvZiBQLCBcInJlZlwiPj5cbiAgICA6IFBcbiAgOiBQO1xudHlwZSBDb21wb25lbnRQcm9wc1dpdGhvdXRSZWY8VCBleHRlbmRzIFJlYWN0LkVsZW1lbnRUeXBlPiA9IFByb3BzV2l0aG91dFJlZjxcbiAgUmVhY3QuQ29tcG9uZW50UHJvcHM8VD5cbj47XG5cbnR5cGUgUHJpbWl0aXZlcyA9IHtcbiAgW0UgaW4gKHR5cGVvZiBOT0RFUylbbnVtYmVyXV06IFByaW1pdGl2ZUZvcndhcmRSZWZDb21wb25lbnQ8RT47XG59O1xudHlwZSBQcmltaXRpdmVQcm9wc1dpdGhSZWY8RSBleHRlbmRzIFJlYWN0LkVsZW1lbnRUeXBlPiA9XG4gIFJlYWN0LkNvbXBvbmVudFByb3BzV2l0aFJlZjxFPiAmIHtcbiAgICBhc0NoaWxkPzogYm9vbGVhbjtcbiAgfTtcblxuaW50ZXJmYWNlIFByaW1pdGl2ZUZvcndhcmRSZWZDb21wb25lbnQ8RSBleHRlbmRzIFJlYWN0LkVsZW1lbnRUeXBlPlxuICBleHRlbmRzIFJlYWN0LkZvcndhcmRSZWZFeG90aWNDb21wb25lbnQ8UHJpbWl0aXZlUHJvcHNXaXRoUmVmPEU+PiB7fVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQcmltaXRpdmVcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuY29uc3QgUHJpbWl0aXZlID0gTk9ERVMucmVkdWNlKChwcmltaXRpdmUsIG5vZGUpID0+IHtcbiAgY29uc3QgTm9kZSA9IFJlYWN0LmZvcndhcmRSZWYoXG4gICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvc3VzcGljaW91cy9ub0V4cGxpY2l0QW55OiBhbnlcbiAgICAocHJvcHM6IFByaW1pdGl2ZVByb3BzV2l0aFJlZjx0eXBlb2Ygbm9kZT4sIGZvcndhcmRlZFJlZjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGFzQ2hpbGQsIC4uLnByaW1pdGl2ZVByb3BzIH0gPSBwcm9wcztcbiAgICAgIC8vIGJpb21lLWlnbm9yZSBsaW50L3N1c3BpY2lvdXMvbm9FeHBsaWNpdEFueTogYW55XG4gICAgICBjb25zdCBDb21wOiBhbnkgPSBhc0NoaWxkID8gU2xvdCA6IG5vZGU7XG5cbiAgICAgIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIGJpb21lLWlnbm9yZSBsaW50L3N1c3BpY2lvdXMvbm9FeHBsaWNpdEFueTogYW55XG4gICAgICAgICh3aW5kb3cgYXMgYW55KVtTeW1ib2wuZm9yKFwicmFkaXgtdWlcIildID0gdHJ1ZTtcbiAgICAgIH0sIFtdKTtcblxuICAgICAgcmV0dXJuIDxDb21wIHsuLi5wcmltaXRpdmVQcm9wc30gcmVmPXtmb3J3YXJkZWRSZWZ9IC8+O1xuICAgIH0sXG4gICk7XG5cbiAgTm9kZS5kaXNwbGF5TmFtZSA9IGBQcmltaXRpdmUuJHtub2RlfWA7XG5cbiAgLy8gYmlvbWUtaWdub3JlIGxpbnQvcGVyZm9ybWFuY2Uvbm9BY2N1bXVsYXRpbmdTcHJlYWQ6IG5vIHNwcmVhZFxuICByZXR1cm4geyAuLi5wcmltaXRpdmUsIFtub2RlXTogTm9kZSB9O1xufSwge30gYXMgUHJpbWl0aXZlcyk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFV0aWxzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbi8qKlxuICogRmx1c2ggY3VzdG9tIGV2ZW50IGRpc3BhdGNoXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcmFkaXgtdWkvcHJpbWl0aXZlcy9wdWxsLzEzNzhcbiAqXG4gKiBSZWFjdCBiYXRjaGVzICphbGwqIGV2ZW50IGhhbmRsZXJzIHNpbmNlIHZlcnNpb24gMTgsIHRoaXMgaW50cm9kdWNlcyBjZXJ0YWluIGNvbnNpZGVyYXRpb25zIHdoZW4gdXNpbmcgY3VzdG9tIGV2ZW50IHR5cGVzLlxuICpcbiAqIEludGVybmFsbHksIFJlYWN0IHByaW9yaXRpemVzIGV2ZW50cyBpbiB0aGUgZm9sbG93aW5nIG9yZGVyOlxuICogIC0gZGlzY3JldGVcbiAqICAtIGNvbnRpbnVvdXNcbiAqICAtIGRlZmF1bHRcbiAqXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvYmxvYi9hOGE0NzQyZjFjNTQ0OTNkZjAwZGE2NDhhM2Y5ZDI2ZTNkYjljOGI1L3BhY2thZ2VzL3JlYWN0LWRvbS9zcmMvZXZlbnRzL1JlYWN0RE9NRXZlbnRMaXN0ZW5lci5qcyNMMjk0LUwzNTBcbiAqXG4gKiBgZGlzY3JldGVgIGlzIGFuICBpbXBvcnRhbnQgZGlzdGluY3Rpb24gYXMgdXBkYXRlcyB3aXRoaW4gdGhlc2UgZXZlbnRzIGFyZSBhcHBsaWVkIGltbWVkaWF0ZWx5LlxuICogUmVhY3QgaG93ZXZlciwgaXMgbm90IGFibGUgdG8gaW5mZXIgdGhlIHByaW9yaXR5IG9mIGN1c3RvbSBldmVudCB0eXBlcyBkdWUgdG8gaG93IHRoZXkgYXJlIGRldGVjdGVkIGludGVybmFsbHkuXG4gKiBCZWNhdXNlIG9mIHRoaXMsIGl0J3MgcG9zc2libGUgZm9yIHVwZGF0ZXMgZnJvbSBjdXN0b20gZXZlbnRzIHRvIGJlIHVuZXhwZWN0ZWRseSBiYXRjaGVkIHdoZW5cbiAqIGRpc3BhdGNoZWQgYnkgYW5vdGhlciBgZGlzY3JldGVgIGV2ZW50LlxuICpcbiAqIEluIG9yZGVyIHRvIGVuc3VyZSB0aGF0IHVwZGF0ZXMgZnJvbSBjdXN0b20gZXZlbnRzIGFyZSBhcHBsaWVkIHByZWRpY3RhYmx5LCB3ZSBuZWVkIHRvIG1hbnVhbGx5IGZsdXNoIHRoZSBiYXRjaC5cbiAqIFRoaXMgdXRpbGl0eSBzaG91bGQgYmUgdXNlZCB3aGVuIGRpc3BhdGNoaW5nIGEgY3VzdG9tIGV2ZW50IGZyb20gd2l0aGluIGFub3RoZXIgYGRpc2NyZXRlYCBldmVudCwgdGhpcyB1dGlsaXR5XG4gKiBpcyBub3QgbmVjZXNzYXJ5IHdoZW4gZGlzcGF0Y2hpbmcga25vd24gZXZlbnQgdHlwZXMsIG9yIGlmIGRpc3BhdGNoaW5nIGEgY3VzdG9tIHR5cGUgaW5zaWRlIGEgbm9uLWRpc2NyZXRlIGV2ZW50LlxuICogRm9yIGV4YW1wbGU6XG4gKlxuICogZGlzcGF0Y2hpbmcgYSBrbm93biBjbGljayDwn5GOXG4gKiB0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQo4oCYY2xpY2vigJkpKVxuICpcbiAqIGRpc3BhdGNoaW5nIGEgY3VzdG9tIHR5cGUgd2l0aGluIGEgbm9uLWRpc2NyZXRlIGV2ZW50IPCfkY5cbiAqIG9uU2Nyb2xsPXsoZXZlbnQpID0+IGV2ZW50LnRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCjigJhjdXN0b21UeXBl4oCZKSl9XG4gKlxuICogZGlzcGF0Y2hpbmcgYSBjdXN0b20gdHlwZSB3aXRoaW4gYSBgZGlzY3JldGVgIGV2ZW50IPCfkY1cbiAqIG9uUG9pbnRlckRvd249eyhldmVudCkgPT4gZGlzcGF0Y2hEaXNjcmV0ZUN1c3RvbUV2ZW50KGV2ZW50LnRhcmdldCwgbmV3IEN1c3RvbUV2ZW50KOKAmGN1c3RvbVR5cGXigJkpKX1cbiAqXG4gKiBOb3RlOiB0aG91Z2ggUmVhY3QgY2xhc3NpZmllcyBgZm9jdXNgLCBgZm9jdXNpbmAgYW5kIGBmb2N1c291dGAgZXZlbnRzIGFzIGBkaXNjcmV0ZWAsIGl0J3MgIG5vdCByZWNvbW1lbmRlZCB0byB1c2VcbiAqIHRoaXMgdXRpbGl0eSB3aXRoIHRoZW0uIFRoaXMgaXMgYmVjYXVzZSBpdCdzIHBvc3NpYmxlIGZvciB0aG9zZSBoYW5kbGVycyB0byBiZSBjYWxsZWQgaW1wbGljaXRseSBkdXJpbmcgcmVuZGVyXG4gKiBlLmcuIHdoZW4gZm9jdXMgaXMgd2l0aGluIGEgY29tcG9uZW50IGFzIGl0IGlzIHVubW91bnRlZCwgb3Igd2hlbiBtYW5hZ2luZyBmb2N1cyBvbiBtb3VudC5cbiAqL1xuXG5mdW5jdGlvbiBkaXNwYXRjaERpc2NyZXRlQ3VzdG9tRXZlbnQ8RSBleHRlbmRzIEN1c3RvbUV2ZW50PihcbiAgdGFyZ2V0OiBFW1widGFyZ2V0XCJdLFxuICBldmVudDogRSxcbikge1xuICBpZiAodGFyZ2V0KSBSZWFjdERPTS5mbHVzaFN5bmMoKCkgPT4gdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpKTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5jb25zdCBSb290ID0gUHJpbWl0aXZlO1xuXG5leHBvcnQge1xuICBQcmltaXRpdmUsXG4gIC8vXG4gIFJvb3QsXG4gIC8vXG4gIGRpc3BhdGNoRGlzY3JldGVDdXN0b21FdmVudCxcbn07XG5leHBvcnQgdHlwZSB7IENvbXBvbmVudFByb3BzV2l0aG91dFJlZiwgUHJpbWl0aXZlUHJvcHNXaXRoUmVmIH07XG4iLCJleHBvcnQgY29uc3Qgbm9Qcm9wYWdhdGUgPVxuICA8XG4gICAgRSBleHRlbmRzIHtcbiAgICAgIHN0b3BQcm9wYWdhdGlvbigpOiB2b2lkO1xuICAgIH0sXG4gID4oXG4gICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvc3VzcGljaW91cy9ub0V4cGxpY2l0QW55OiBhbnlcbiAgICBjYjogKC4uLmFyZ3M6IGFueSkgPT4gYW55LFxuICApID0+XG4gIChldmVudDogRSkgPT4ge1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgcmV0dXJuIGNiKCk7XG4gIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgY29tcG9zZUV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiQHJhZGl4LXVpL3ByaW1pdGl2ZVwiO1xuaW1wb3J0IHsgUHJlc2VuY2UgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXByZXNlbmNlXCI7XG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gXCJ6dXN0YW5kXCI7XG5pbXBvcnQgeyB1c2VTaGFsbG93IH0gZnJvbSBcInp1c3RhbmQvcmVhY3Qvc2hhbGxvd1wiO1xuaW1wb3J0IHsgdHlwZSBNZWRpYVNjb3BlZFByb3BzLCB1c2VNZWRpYUNvbnRleHQgfSBmcm9tIFwiLi4vc2hhcmVkL2NvbnRleHRcIjtcbmltcG9ydCAqIGFzIFJhZGl4IGZyb20gXCIuLi9zaGFyZWQvcHJpbWl0aXZlXCI7XG5pbXBvcnQgeyBub1Byb3BhZ2F0ZSB9IGZyb20gXCIuLi9zaGFyZWQvdXRpbHNcIjtcblxuY29uc3QgQ09OVFJPTFNfTkFNRSA9IFwiQ29udHJvbHNcIjtcblxudHlwZSBDb250cm9sc0VsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuZGl2PjtcblxuaW50ZXJmYWNlIENvbnRyb2xzUHJvcHNcbiAgZXh0ZW5kcyBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5kaXY+IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gZm9yY2UgbW91bnRpbmcgd2hlbiBtb3JlIGNvbnRyb2wgaXMgbmVlZGVkLiBVc2VmdWwgd2hlblxuICAgKiBjb250cm9sbGluZyBhbmltYXRpb24gd2l0aCBSZWFjdCBhbmltYXRpb24gbGlicmFyaWVzLlxuICAgKi9cbiAgZm9yY2VNb3VudD86IHRydWU7XG5cbiAgLyoqXG4gICAqIEF1dG8taGlkZSB0aGUgY29udHJvbHMgYWZ0ZXIgYSBtb3VzZSBvciB0b3VjaCBpbnRlcmFjdGlvbiAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICpcbiAgICogRGVmYXVsdHMgdG8gMzAwMC4gU2V0IHRvIDAgZm9yIG5vIGhpZGluZy5cbiAgICovXG4gIGF1dG9IaWRlPzogbnVtYmVyO1xufVxuXG5jb25zdCBDb250cm9scyA9IFJlYWN0LmZvcndhcmRSZWY8Q29udHJvbHNFbGVtZW50LCBDb250cm9sc1Byb3BzPihcbiAgKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPENvbnRyb2xzUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBmb3JjZU1vdW50LFxuICAgICAgX19zY29wZU1lZGlhLFxuICAgICAgb25DbGljayxcbiAgICAgIHN0eWxlLFxuICAgICAgYXV0b0hpZGUsXG4gICAgICAuLi5jb250cm9sc1Byb3BzXG4gICAgfSA9IHByb3BzO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChDT05UUk9MU19OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gICAgY29uc3QgeyBoaWRkZW4sIGxvYWRpbmcsIHRvZ2dsZVBsYXksIGVycm9yIH0gPSB1c2VTdG9yZShcbiAgICAgIGNvbnRleHQuc3RvcmUsXG4gICAgICB1c2VTaGFsbG93KCh7IGhpZGRlbiwgbG9hZGluZywgX19jb250cm9sc0Z1bmN0aW9ucywgZXJyb3IgfSkgPT4gKHtcbiAgICAgICAgaGlkZGVuLFxuICAgICAgICBsb2FkaW5nLFxuICAgICAgICB0b2dnbGVQbGF5OiBfX2NvbnRyb2xzRnVuY3Rpb25zLnRvZ2dsZVBsYXksXG4gICAgICAgIGVycm9yOiBlcnJvcj8udHlwZSA/PyBudWxsLFxuICAgICAgfSkpLFxuICAgICk7XG5cbiAgICBjb25zdCBzaG93biA9IHVzZU1lbW8oXG4gICAgICAoKSA9PiAhaGlkZGVuICYmICFsb2FkaW5nICYmICFlcnJvcixcbiAgICAgIFtoaWRkZW4sIGxvYWRpbmcsIGVycm9yXSxcbiAgICApO1xuXG4gICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3MvdXNlRXhoYXVzdGl2ZURlcGVuZGVuY2llczogb25seSBzZXQgb25jZSB0byBwcmV2ZW50IGZsYXNoaW5nXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChhdXRvSGlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnRleHQuc3RvcmUuZ2V0U3RhdGUoKS5fX2NvbnRyb2xzRnVuY3Rpb25zLnNldEF1dG9oaWRlKGF1dG9IaWRlKTtcbiAgICAgIH1cbiAgICB9LCBbXSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFByZXNlbmNlIHByZXNlbnQ9e2ZvcmNlTW91bnQgfHwgc2hvd259PlxuICAgICAgICA8UmFkaXguUHJpbWl0aXZlLmRpdlxuICAgICAgICAgIHsuLi5jb250cm9sc1Byb3BzfVxuICAgICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICAgIGRhdGEtbGl2ZXBlZXItY29udHJvbHM9XCJcIlxuICAgICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKHNob3duKX1cbiAgICAgICAgICBvbkNsaWNrPXtjb21wb3NlRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBub1Byb3BhZ2F0ZSh0b2dnbGVQbGF5KSl9XG4gICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgIC4uLnN0eWxlLFxuICAgICAgICAgICAgLy8gZW5zdXJlcyBjb250cm9scyBleHBhbmRzIGluIHJhdGlvXG4gICAgICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICAgICAgaW5zZXQ6IDAsXG4gICAgICAgICAgfX1cbiAgICAgICAgLz5cbiAgICAgIDwvUHJlc2VuY2U+XG4gICAgKTtcbiAgfSxcbik7XG5cbkNvbnRyb2xzLmRpc3BsYXlOYW1lID0gQ09OVFJPTFNfTkFNRTtcblxuZXhwb3J0IHsgQ29udHJvbHMgfTtcbmV4cG9ydCB0eXBlIHsgQ29udHJvbHNQcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IFByZXNlbmNlIH0gZnJvbSBcIkByYWRpeC11aS9yZWFjdC1wcmVzZW5jZVwiO1xuaW1wb3J0IFJlYWN0LCB7IHVzZU1lbW8gfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgKiBhcyBSYWRpeCBmcm9tIFwiLi4vc2hhcmVkL3ByaW1pdGl2ZVwiO1xuXG5jb25zdCBMSVZFX0lORElDQVRPUl9OQU1FID0gXCJMaXZlSW5kaWNhdG9yXCI7XG5cbnR5cGUgTGl2ZUluZGljYXRvckVsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuYnV0dG9uPjtcblxuaW50ZXJmYWNlIExpdmVJbmRpY2F0b3JQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj4ge1xuICAvKipcbiAgICogVXNlZCB0byBmb3JjZSBtb3VudGluZyB3aGVuIG1vcmUgY29udHJvbCBpcyBuZWVkZWQuIFVzZWZ1bCB3aGVuXG4gICAqIGNvbnRyb2xsaW5nIGFuaW1hdGlvbiB3aXRoIFJlYWN0IGFuaW1hdGlvbiBsaWJyYXJpZXMuXG4gICAqL1xuICBmb3JjZU1vdW50PzogdHJ1ZTtcbiAgLyoqIFRoZSBtYXRjaGVyIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGVsZW1lbnQgc2hvdWxkIGJlIHNob3duLCBnaXZlbiB0aGUgYGxpdmVgIHN0YXRlICh0cnVlIGZvciBsaXZlIHN0cmVhbXMsIGFuZCBmYWxzZSBmb3IgYXNzZXRzKS4gRGVmYXVsdHMgdG8gYHRydWVgLiAqL1xuICBtYXRjaGVyPzogYm9vbGVhbiB8ICgobGl2ZTogYm9vbGVhbikgPT4gYm9vbGVhbik7XG59XG5cbmNvbnN0IExpdmVJbmRpY2F0b3IgPSBSZWFjdC5mb3J3YXJkUmVmPFxuICBMaXZlSW5kaWNhdG9yRWxlbWVudCxcbiAgTGl2ZUluZGljYXRvclByb3BzXG4+KChwcm9wczogTWVkaWFTY29wZWRQcm9wczxMaXZlSW5kaWNhdG9yUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgY29uc3Qge1xuICAgIF9fc2NvcGVNZWRpYSxcbiAgICBmb3JjZU1vdW50LFxuICAgIG1hdGNoZXIgPSB0cnVlLFxuICAgIC4uLmxpdmVJbmRpY2F0b3JQcm9wc1xuICB9ID0gcHJvcHM7XG5cbiAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChMSVZFX0lORElDQVRPUl9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gIGNvbnN0IGxpdmUgPSB1c2VTdG9yZShjb250ZXh0LnN0b3JlLCAoeyBsaXZlIH0pID0+IGxpdmUpO1xuXG4gIGNvbnN0IGlzUHJlc2VudCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHR5cGVvZiBtYXRjaGVyID09PSBcImZ1bmN0aW9uXCIgPyBtYXRjaGVyKGxpdmUpIDogbWF0Y2hlciA9PT0gbGl2ZSksXG4gICAgW21hdGNoZXIsIGxpdmVdLFxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPFByZXNlbmNlIHByZXNlbnQ9e2ZvcmNlTW91bnQgfHwgaXNQcmVzZW50fT5cbiAgICAgIDxSYWRpeC5QcmltaXRpdmUuc3BhblxuICAgICAgICBhcmlhLWxhYmVsPVwibGl2ZVwiXG4gICAgICAgIHsuLi5saXZlSW5kaWNhdG9yUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLWxpdmUtaW5kaWNhdG9yPVwiXCJcbiAgICAgICAgZGF0YS1saXZlPXtTdHJpbmcoQm9vbGVhbihsaXZlKSl9XG4gICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKGlzUHJlc2VudCl9XG4gICAgICAvPlxuICAgIDwvUHJlc2VuY2U+XG4gICk7XG59KTtcblxuTGl2ZUluZGljYXRvci5kaXNwbGF5TmFtZSA9IExJVkVfSU5ESUNBVE9SX05BTUU7XG5cbmV4cG9ydCB7IExpdmVJbmRpY2F0b3IgfTtcbmV4cG9ydCB0eXBlIHsgTGl2ZUluZGljYXRvclByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgY29tcG9zZUV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiQHJhZGl4LXVpL3ByaW1pdGl2ZVwiO1xuXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHVzZVNoYWxsb3cgfSBmcm9tIFwienVzdGFuZC9yZWFjdC9zaGFsbG93XCI7XG5pbXBvcnQgeyB0eXBlIE1lZGlhU2NvcGVkUHJvcHMsIHVzZU1lZGlhQ29udGV4dCB9IGZyb20gXCIuLi9zaGFyZWQvY29udGV4dFwiO1xuaW1wb3J0ICogYXMgUmFkaXggZnJvbSBcIi4uL3NoYXJlZC9wcmltaXRpdmVcIjtcbmltcG9ydCB7IG5vUHJvcGFnYXRlIH0gZnJvbSBcIi4uL3NoYXJlZC91dGlsc1wiO1xuXG5jb25zdCBNVVRFX1RSSUdHRVJfTkFNRSA9IFwiTXV0ZVRyaWdnZXJcIjtcblxudHlwZSBNdXRlVHJpZ2dlckVsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuYnV0dG9uPjtcblxuaW50ZXJmYWNlIE11dGVUcmlnZ2VyUHJvcHNcbiAgZXh0ZW5kcyBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5idXR0b24+IHt9XG5cbmNvbnN0IE11dGVUcmlnZ2VyID0gUmVhY3QuZm9yd2FyZFJlZjxNdXRlVHJpZ2dlckVsZW1lbnQsIE11dGVUcmlnZ2VyUHJvcHM+KFxuICAocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8TXV0ZVRyaWdnZXJQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICAgIGNvbnN0IHsgX19zY29wZU1lZGlhLCAuLi5wbGF5UHJvcHMgfSA9IHByb3BzO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChNVVRFX1RSSUdHRVJfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICAgIGNvbnN0IHsgbXV0ZWQsIHRvZ2dsZU11dGUgfSA9IHVzZVN0b3JlKFxuICAgICAgY29udGV4dC5zdG9yZSxcbiAgICAgIHVzZVNoYWxsb3coKHsgX19jb250cm9scywgX19jb250cm9sc0Z1bmN0aW9ucyB9KSA9PiAoe1xuICAgICAgICBtdXRlZDogX19jb250cm9scy5tdXRlZCxcbiAgICAgICAgdG9nZ2xlTXV0ZTogX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0VG9nZ2xlTXV0ZSxcbiAgICAgIH0pKSxcbiAgICApO1xuXG4gICAgY29uc3QgdGl0bGUgPSBSZWFjdC51c2VNZW1vKFxuICAgICAgKCkgPT4gKG11dGVkID8gXCJVbm11dGUgKG0pXCIgOiBcIk11dGUgKG0pXCIpLFxuICAgICAgW211dGVkXSxcbiAgICApO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxSYWRpeC5QcmltaXRpdmUuYnV0dG9uXG4gICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICBhcmlhLXByZXNzZWQ9e211dGVkfVxuICAgICAgICBhcmlhLWxhYmVsPXt0aXRsZX1cbiAgICAgICAgdGl0bGU9e3RpdGxlfVxuICAgICAgICB7Li4ucGxheVByb3BzfVxuICAgICAgICBvbkNsaWNrPXtjb21wb3NlRXZlbnRIYW5kbGVycyhwcm9wcy5vbkNsaWNrLCBub1Byb3BhZ2F0ZSh0b2dnbGVNdXRlKSl9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLW11dGUtdHJpZ2dlcj1cIlwiXG4gICAgICAgIGRhdGEtbXV0ZWQ9e1N0cmluZyhtdXRlZCl9XG4gICAgICAvPlxuICAgICk7XG4gIH0sXG4pO1xuXG5NdXRlVHJpZ2dlci5kaXNwbGF5TmFtZSA9IE1VVEVfVFJJR0dFUl9OQU1FO1xuXG5leHBvcnQgeyBNdXRlVHJpZ2dlciB9O1xuZXhwb3J0IHR5cGUgeyBNdXRlVHJpZ2dlclByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgY29tcG9zZUV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiQHJhZGl4LXVpL3ByaW1pdGl2ZVwiO1xuaW1wb3J0IHsgUHJlc2VuY2UgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXByZXNlbmNlXCI7XG5pbXBvcnQgUmVhY3QsIHsgdXNlTWVtbyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgKiBhcyBSYWRpeCBmcm9tIFwiLi4vc2hhcmVkL3ByaW1pdGl2ZVwiO1xuaW1wb3J0IHsgbm9Qcm9wYWdhdGUgfSBmcm9tIFwiLi4vc2hhcmVkL3V0aWxzXCI7XG5cbi8qKlxuICogUGxheVBhdXNlVHJpZ2dlclxuICovXG5cbmNvbnN0IFBMQVlfUEFVU0VfVFJJR0dFUl9OQU1FID0gXCJQbGF5UGF1c2VUcmlnZ2VyXCI7XG5cbnR5cGUgUGxheVBhdXNlVHJpZ2dlckVsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuYnV0dG9uPjtcblxuaW50ZXJmYWNlIFBsYXlQYXVzZVRyaWdnZXJQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj4ge31cblxuY29uc3QgUGxheVBhdXNlVHJpZ2dlciA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIFBsYXlQYXVzZVRyaWdnZXJFbGVtZW50LFxuICBQbGF5UGF1c2VUcmlnZ2VyUHJvcHNcbj4oKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPFBsYXlQYXVzZVRyaWdnZXJQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgLi4ucGxheVByb3BzIH0gPSBwcm9wcztcblxuICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFBMQVlfUEFVU0VfVFJJR0dFUl9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gIGNvbnN0IHsgcGxheWluZywgdG9nZ2xlUGxheSwgdGl0bGUgfSA9IHVzZVN0b3JlKFxuICAgIGNvbnRleHQuc3RvcmUsXG4gICAgdXNlU2hhbGxvdygoeyBwbGF5aW5nLCBfX2NvbnRyb2xzRnVuY3Rpb25zLCBhcmlhIH0pID0+ICh7XG4gICAgICBwbGF5aW5nLFxuICAgICAgdG9nZ2xlUGxheTogX19jb250cm9sc0Z1bmN0aW9ucy50b2dnbGVQbGF5LFxuICAgICAgdGl0bGU6IGFyaWEucGxheVBhdXNlLFxuICAgIH0pKSxcbiAgKTtcblxuICByZXR1cm4gKFxuICAgIDxSYWRpeC5QcmltaXRpdmUuYnV0dG9uXG4gICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgIGFyaWEtcHJlc3NlZD17cGxheWluZ31cbiAgICAgIGFyaWEtbGFiZWw9e3RpdGxlID8/IHVuZGVmaW5lZH1cbiAgICAgIHRpdGxlPXt0aXRsZSA/PyB1bmRlZmluZWR9XG4gICAgICB7Li4ucGxheVByb3BzfVxuICAgICAgb25DbGljaz17Y29tcG9zZUV2ZW50SGFuZGxlcnMocHJvcHMub25DbGljaywgbm9Qcm9wYWdhdGUodG9nZ2xlUGxheSkpfVxuICAgICAgcmVmPXtmb3J3YXJkZWRSZWZ9XG4gICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLXBsYXktcGF1c2UtdHJpZ2dlcj1cIlwiXG4gICAgICBkYXRhLXBsYXlpbmc9e1N0cmluZyhwbGF5aW5nKX1cbiAgICAvPlxuICApO1xufSk7XG5cblBsYXlQYXVzZVRyaWdnZXIuZGlzcGxheU5hbWUgPSBQTEFZX1BBVVNFX1RSSUdHRVJfTkFNRTtcblxuLyoqXG4gKiBQbGF5aW5nSW5kaWNhdG9yXG4gKi9cblxuY29uc3QgUExBWUlOR19JTkRJQ0FUT1JfTkFNRSA9IFwiUGxheWluZ0luZGljYXRvclwiO1xuXG50eXBlIFBsYXlpbmdJbmRpY2F0b3JFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj47XG5cbmludGVyZmFjZSBQbGF5aW5nSW5kaWNhdG9yUHJvcHNcbiAgZXh0ZW5kcyBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5kaXY+IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gZm9yY2UgbW91bnRpbmcgd2hlbiBtb3JlIGNvbnRyb2wgaXMgbmVlZGVkLiBVc2VmdWwgd2hlblxuICAgKiBjb250cm9sbGluZyBhbmltYXRpb24gd2l0aCBSZWFjdCBhbmltYXRpb24gbGlicmFyaWVzLlxuICAgKi9cbiAgZm9yY2VNb3VudD86IHRydWU7XG4gIC8qKiBUaGUgbWF0Y2hlciB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBlbGVtZW50IHNob3VsZCBiZSBzaG93biwgZ2l2ZW4gdGhlIHBsYXlpbmcgc3RhdGUuIERlZmF1bHRzIHRvIGB0cnVlYCwgd2hpY2ggZXF1YWxzIHBsYXlpbmcuICovXG4gIG1hdGNoZXI/OiBib29sZWFuIHwgKChzdGF0ZTogYm9vbGVhbikgPT4gYm9vbGVhbik7XG59XG5cbmNvbnN0IFBsYXlpbmdJbmRpY2F0b3IgPSBSZWFjdC5mb3J3YXJkUmVmPFxuICBQbGF5aW5nSW5kaWNhdG9yRWxlbWVudCxcbiAgUGxheWluZ0luZGljYXRvclByb3BzXG4+KChwcm9wczogTWVkaWFTY29wZWRQcm9wczxQbGF5aW5nSW5kaWNhdG9yUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgY29uc3Qge1xuICAgIF9fc2NvcGVNZWRpYSxcbiAgICBmb3JjZU1vdW50LFxuICAgIG1hdGNoZXIgPSB0cnVlLFxuICAgIC4uLnBsYXlQYXVzZUluZGljYXRvclByb3BzXG4gIH0gPSBwcm9wcztcblxuICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFBMQVlJTkdfSU5ESUNBVE9SX05BTUUsIF9fc2NvcGVNZWRpYSk7XG5cbiAgY29uc3QgcGxheWluZyA9IHVzZVN0b3JlKFxuICAgIGNvbnRleHQuc3RvcmUsXG4gICAgdXNlU2hhbGxvdygoeyBwbGF5aW5nIH0pID0+IHBsYXlpbmcpLFxuICApO1xuXG4gIGNvbnN0IGlzUHJlc2VudCA9IHVzZU1lbW8oXG4gICAgKCkgPT5cbiAgICAgIHR5cGVvZiBtYXRjaGVyID09PSBcImJvb2xlYW5cIiA/IG1hdGNoZXIgPT09IHBsYXlpbmcgOiBtYXRjaGVyKHBsYXlpbmcpLFxuICAgIFtwbGF5aW5nLCBtYXRjaGVyXSxcbiAgKTtcblxuICByZXR1cm4gKFxuICAgIDxQcmVzZW5jZSBwcmVzZW50PXtmb3JjZU1vdW50IHx8IGlzUHJlc2VudH0+XG4gICAgICA8UmFkaXguUHJpbWl0aXZlLmRpdlxuICAgICAgICB7Li4ucGxheVBhdXNlSW5kaWNhdG9yUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLXBsYXktcGF1c2UtaW5kaWNhdG9yPVwiXCJcbiAgICAgICAgZGF0YS1wbGF5aW5nPXtTdHJpbmcocGxheWluZyl9XG4gICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKGlzUHJlc2VudCl9XG4gICAgICAvPlxuICAgIDwvUHJlc2VuY2U+XG4gICk7XG59KTtcblxuUGxheWluZ0luZGljYXRvci5kaXNwbGF5TmFtZSA9IFBMQVlJTkdfSU5ESUNBVE9SX05BTUU7XG5cbmV4cG9ydCB7IFBsYXlQYXVzZVRyaWdnZXIsIFBsYXlpbmdJbmRpY2F0b3IgfTtcbmV4cG9ydCB0eXBlIHsgUGxheVBhdXNlVHJpZ2dlclByb3BzLCBQbGF5aW5nSW5kaWNhdG9yUHJvcHMgfTtcbiIsIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgdHlwZSB7IFBsYXliYWNrRXZlbnQgfSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUvbWVkaWFcIjtcbmltcG9ydCB7XG4gIGFkZExlZ2FjeU1lZGlhTWV0cmljc1RvU3RvcmUsXG4gIGFkZE1ldHJpY3NUb1N0b3JlLFxuICBjcmVhdGVDb250cm9sbGVyU3RvcmUsXG4gIHR5cGUgSW5pdGlhbFByb3BzLFxuICB0eXBlIFNyYyxcbn0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL21lZGlhXCI7XG5pbXBvcnQgeyBjcmVhdGVTdG9yYWdlLCBub29wU3RvcmFnZSB9IGZyb20gXCJAbGl2ZXBlZXIvY29yZS9zdG9yYWdlXCI7XG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL3ZlcnNpb25cIjtcbmltcG9ydCB7IGdldERldmljZUluZm8gfSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUtd2ViL2Jyb3dzZXJcIjtcbmltcG9ydCBSZWFjdCwgeyB0eXBlIFByb3BzV2l0aENoaWxkcmVuLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgTWVkaWFQcm92aWRlciwgdHlwZSBNZWRpYVNjb3BlZFByb3BzIH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5cbmludGVyZmFjZSBQbGF5ZXJQcm9wc1xuICBleHRlbmRzIFByb3BzV2l0aENoaWxkcmVuPFxuICAgIE9taXQ8UGFydGlhbDxJbml0aWFsUHJvcHM+LCBcImNyZWF0b3JJZFwiIHwgXCJob3RrZXlzXCI+XG4gID4ge1xuICAvKipcbiAgICogVGhlIHNvdXJjZSBmb3IgdGhlIFBsYXllci4gVGhlIGBTcmNbXWAgY2FuIGJlIGNyZWF0ZWQgZnJvbSBjYWxsaW5nIGBnZXRTcmNgXG4gICAqIHdpdGggTGl2ZXBlZXIgcGxheWJhY2sgaW5mbywgQ2xvdWRmbGFyZSBzdHJlYW0gZGF0YSwgTXV4IFVSTHMsIGBzdHJpbmdbXWAsIG9yIGBzdHJpbmdgLlxuICAgKi9cbiAgc3JjOiBTcmNbXSB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFNldHMgYSBjdXN0b20gcGxheWJhY2sgSUQgZm9yIHBsYXliYWNrLlxuICAgKiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZnVuY3Rpb24gZGVmYXVsdHMgdG8gcGFyc2luZyB0aGUgYHNyY2AgYXR0cmlidXRlIG9mIHRoZSBIVE1MTWVkaWFFbGVtZW50IHRvIGdldCB0aGUgcGxheWJhY2sgSUQuXG4gICAqL1xuICBwbGF5YmFja0lkPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgYXNwZWN0IHJhdGlvIG9mIHRoZSBtZWRpYS4gRGVmYXVsdHMgdG8gMTYgLyA5LlxuICAgKiBUaGlzIHNpZ25pZmljYW50bHkgaW1wcm92ZXMgY3VtdWxhdGl2ZSBsYXlvdXQgc2hpZnQuXG4gICAqIFNldCB0byBgbnVsbGAgdG8gcmVuZGVyIGEgcGxhaW4gZGl2IHByaW1pdGl2ZS5cbiAgICpcbiAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly93ZWIuZGV2L2Nscy99XG4gICAqL1xuICBhc3BlY3RSYXRpbz86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgaG90a2V5cyBhcmUgZW5hYmxlZC4gRGVmYXVsdHMgdG8gYHRydWVgLiBBbGxvd3MgdXNlcnMgdG8gdXNlIGtleWJvYXJkIHNob3J0Y3V0cyBmb3IgcGxheWVyIGNvbnRyb2wuXG4gICAqXG4gICAqIFRoaXMgaXMgaGlnaGx5IHJlY29tbWVuZGVkIHRvIGFkaGVyZSB0byBBUklBIGd1aWRlbGluZXMuXG4gICAqL1xuICBob3RrZXlzPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQSBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCB3aGVuIHRoZSBwbGF5ZXIncyBtZXRyaWNzIGV2ZW50cyBhcmUgZW1pdHRlZC5cbiAgICogVGhpcyBjYW4gYmUgdXNlZCB0byBpbnRlZ3JhdGUgd2l0aCBvdGhlciBhbmFseXRpY3MgcHJvdmlkZXJzLlxuICAgKi9cbiAgLy8gYmlvbWUtaWdub3JlIGxpbnQvc3VzcGljaW91cy9ub0V4cGxpY2l0QW55OiBhbGxvdyBhbnkgZm9yIGluY29taW5nIGNhbGxiYWNrXG4gIG9uUGxheWJhY2tFdmVudHM/OiAoZXZlbnRzOiBQbGF5YmFja0V2ZW50W10pID0+IFByb21pc2U8YW55PiB8IGFueTtcblxuICAvKipcbiAgICogVGhlIGludGVydmFsIGF0IHdoaWNoIG1ldHJpY3MgYXJlIHNlbnQsIGluIG1zLiBEZWZhdWx0cyB0byA1MDAwLlxuICAgKi9cbiAgbWV0cmljc0ludGVydmFsPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgSUNFIHNlcnZlcnMgdG8gdXNlLlxuICAgKlxuICAgKiBJZiBub3QgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IElDRSBzZXJ2ZXJzIHdpbGwgYmUgdXNlZC5cbiAgICovXG4gIGljZVNlcnZlcnM/OiBSVENJY2VTZXJ2ZXIgfCBSVENJY2VTZXJ2ZXJbXTtcbn1cblxuY29uc3QgUGxheWVyID0gUmVhY3QubWVtbygocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8UGxheWVyUHJvcHM+KSA9PiB7XG4gIGNvbnN0IHtcbiAgICBhc3BlY3RSYXRpbyA9IDE2IC8gOSxcbiAgICBzcmMsXG4gICAgY2hpbGRyZW4sXG4gICAgand0LFxuICAgIGFjY2Vzc0tleSxcbiAgICBzdG9yYWdlLFxuICAgIG9uUGxheWJhY2tFdmVudHMsXG4gICAgbWV0cmljc0ludGVydmFsLFxuICAgIHBsYXliYWNrSWQsXG4gICAgLi4ucmVzdFxuICB9ID0gcHJvcHM7XG5cbiAgY29uc3Qgc3RvcmUgPSB1c2VSZWYoXG4gICAgY3JlYXRlQ29udHJvbGxlclN0b3JlKHtcbiAgICAgIGRldmljZTogZ2V0RGV2aWNlSW5mbyh2ZXJzaW9uLnJlYWN0KSxcbiAgICAgIHN0b3JhZ2U6XG4gICAgICAgIHN0b3JhZ2UgPz9cbiAgICAgICAgY3JlYXRlU3RvcmFnZShcbiAgICAgICAgICBzdG9yYWdlICE9PSBudWxsICYmIHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCJcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2U6IHdpbmRvdy5sb2NhbFN0b3JhZ2UsXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2U6IG5vb3BTdG9yYWdlLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICApLFxuICAgICAgc3JjLFxuICAgICAgcGxheWJhY2tJZCxcbiAgICAgIGluaXRpYWxQcm9wczoge1xuICAgICAgICBhc3BlY3RSYXRpbyxcbiAgICAgICAgand0LFxuICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgIC4uLnJlc3QsXG4gICAgICB9LFxuICAgIH0pLFxuICApO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGp3dCkge1xuICAgICAgc3RvcmU/LmN1cnJlbnQ/LnN0b3JlLnNldFN0YXRlKChwcmV2KSA9PiAoe1xuICAgICAgICBfX2luaXRpYWxQcm9wczoge1xuICAgICAgICAgIC4uLnByZXYuX19pbml0aWFsUHJvcHMsXG4gICAgICAgICAgand0LFxuICAgICAgICB9LFxuICAgICAgfSkpO1xuICAgIH1cbiAgfSwgW2p3dF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGFjY2Vzc0tleSkge1xuICAgICAgc3RvcmU/LmN1cnJlbnQ/LnN0b3JlLnNldFN0YXRlKChwcmV2KSA9PiAoe1xuICAgICAgICBfX2luaXRpYWxQcm9wczoge1xuICAgICAgICAgIC4uLnByZXYuX19pbml0aWFsUHJvcHMsXG4gICAgICAgICAgYWNjZXNzS2V5LFxuICAgICAgICB9LFxuICAgICAgfSkpO1xuICAgIH1cbiAgfSwgW2FjY2Vzc0tleV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHN0b3JlPy5jdXJyZW50Py5kZXN0cm95Py4oKTtcbiAgICB9O1xuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBtZXRyaWNzID0gYWRkTGVnYWN5TWVkaWFNZXRyaWNzVG9TdG9yZShzdG9yZS5jdXJyZW50LnN0b3JlKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBtZXRyaWNzLmRlc3Ryb3koKTtcbiAgICB9O1xuICB9LCBbXSk7XG5cbiAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3MvdXNlRXhoYXVzdGl2ZURlcGVuZGVuY2llczogbm8gZGVwc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IG1ldHJpY3MgPSBhZGRNZXRyaWNzVG9TdG9yZShzdG9yZS5jdXJyZW50LnN0b3JlLCB7XG4gICAgICBvblBsYXliYWNrRXZlbnRzLFxuICAgICAgaW50ZXJ2YWw6IG1ldHJpY3NJbnRlcnZhbCxcbiAgICB9KTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBtZXRyaWNzLmRlc3Ryb3koKTtcbiAgICB9O1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8TWVkaWFQcm92aWRlciBzdG9yZT17c3RvcmUuY3VycmVudC5zdG9yZX0gc2NvcGU9e3Byb3BzLl9fc2NvcGVNZWRpYX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9NZWRpYVByb3ZpZGVyPlxuICApO1xufSk7XG5cblBsYXllci5kaXNwbGF5TmFtZSA9IFwiUGxheWVyXCI7XG5cbmNvbnN0IFJvb3QgPSBQbGF5ZXI7XG5cbmV4cG9ydCB7IFJvb3QgfTtcbmV4cG9ydCB0eXBlIHsgUGxheWVyUHJvcHMgfTtcbiIsIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyBQcmVzZW5jZSB9IGZyb20gXCJAcmFkaXgtdWkvcmVhY3QtcHJlc2VuY2VcIjtcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgKiBhcyBSYWRpeCBmcm9tIFwiLi4vc2hhcmVkL3ByaW1pdGl2ZVwiO1xuXG5jb25zdCBQT1NURVJfTkFNRSA9IFwiUG9zdGVyXCI7XG5cbnR5cGUgUG9zdGVyRWxlbWVudCA9IFJlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5pbWc+O1xuXG5pbnRlcmZhY2UgUG9zdGVyUHJvcHNcbiAgZXh0ZW5kcyBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5pbWc+IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gZm9yY2UgbW91bnRpbmcgd2hlbiBtb3JlIGNvbnRyb2wgaXMgbmVlZGVkLiBVc2VmdWwgd2hlblxuICAgKiBjb250cm9sbGluZyBhbmltYXRpb24gd2l0aCBSZWFjdCBhbmltYXRpb24gbGlicmFyaWVzLlxuICAgKi9cbiAgZm9yY2VNb3VudD86IHRydWU7XG59XG5cbmNvbnN0IFBvc3RlciA9IFJlYWN0LmZvcndhcmRSZWY8UG9zdGVyRWxlbWVudCwgUG9zdGVyUHJvcHM+KFxuICAocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8UG9zdGVyUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZm9yY2VNb3VudCwgc3JjLCAuLi5wb3N0ZXJQcm9wcyB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFBPU1RFUl9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gICAgY29uc3QgcG9zdGVyID0gdXNlU3RvcmUoY29udGV4dC5zdG9yZSwgKHsgcG9zdGVyIH0pID0+IHBvc3Rlcik7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFByZXNlbmNlIHByZXNlbnQ9e2ZvcmNlTW91bnQgfHwgQm9vbGVhbihzcmMgfHwgcG9zdGVyKX0+XG4gICAgICAgIDxSYWRpeC5QcmltaXRpdmUuaW1nXG4gICAgICAgICAgYWx0PVwiUG9zdGVyIGZvciB2aWRlb1wiXG4gICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcbiAgICAgICAgICB7Li4ucG9zdGVyUHJvcHN9XG4gICAgICAgICAgc3JjPXtzcmMgfHwgcG9zdGVyIHx8IHVuZGVmaW5lZH1cbiAgICAgICAgICByZWY9e2ZvcndhcmRlZFJlZn1cbiAgICAgICAgICBkYXRhLWxpdmVwZWVyLXBvc3Rlcj1cIlwiXG4gICAgICAgICAgZGF0YS12aXNpYmxlPXtTdHJpbmcoQm9vbGVhbihzcmMgfHwgcG9zdGVyKSl9XG4gICAgICAgIC8+XG4gICAgICA8L1ByZXNlbmNlPlxuICAgICk7XG4gIH0sXG4pO1xuXG5Qb3N0ZXIuZGlzcGxheU5hbWUgPSBQT1NURVJfTkFNRTtcblxuZXhwb3J0IHsgUG9zdGVyIH07XG5leHBvcnQgdHlwZSB7IFBvc3RlclByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHR5cGUgeyBQbGF5YmFja1JhdGUgfSBmcm9tIFwiQGxpdmVwZWVyL2NvcmUvbWVkaWFcIjtcbi8vIGJpb21lLWlnbm9yZSBsaW50L2NvcnJlY3RuZXNzL25vVW51c2VkSW1wb3J0czogaWdub3JlZCB1c2luZyBgLS1zdXBwcmVzc2BcbmltcG9ydCB7IGNvbXBvc2VFdmVudEhhbmRsZXJzIH0gZnJvbSBcIkByYWRpeC11aS9wcmltaXRpdmVcIjtcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjayB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgdHlwZSAqIGFzIFJhZGl4IGZyb20gXCIuLi9zaGFyZWQvcHJpbWl0aXZlXCI7XG5pbXBvcnQgKiBhcyBTZWxlY3RQcmltaXRpdmUgZnJvbSBcIi4uL3NoYXJlZC9TZWxlY3RcIjtcblxuLyoqXG4gKiBSYXRlU2VsZWN0XG4gKi9cblxuY29uc3QgUkFURV9TRUxFQ1RfTkFNRSA9IFwiUmF0ZVNlbGVjdFwiO1xuXG5pbnRlcmZhY2UgUmF0ZVNlbGVjdFByb3BzXG4gIGV4dGVuZHMgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBTZWxlY3RQcmltaXRpdmUuU2VsZWN0Um9vdD4ge31cblxuY29uc3QgUmF0ZVNlbGVjdCA9IChwcm9wczogTWVkaWFTY29wZWRQcm9wczxSYXRlU2VsZWN0UHJvcHM+KSA9PiB7XG4gIC8vIGJpb21lLWlnbm9yZSBsaW50L2NvcnJlY3RuZXNzL25vVW51c2VkVmFyaWFibGVzOiBpZ25vcmVkIHVzaW5nIGAtLXN1cHByZXNzYFxuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZGVmYXVsdFZhbHVlLCAuLi5yYXRlU2VsZWN0UHJvcHMgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGNvbnRleHQgPSB1c2VNZWRpYUNvbnRleHQoUkFURV9TRUxFQ1RfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICBjb25zdCB7IHBsYXliYWNrUmF0ZSwgc2V0UGxheWJhY2tSYXRlIH0gPSB1c2VTdG9yZShcbiAgICBjb250ZXh0LnN0b3JlLFxuICAgIHVzZVNoYWxsb3coKHsgcGxheWJhY2tSYXRlLCBfX2NvbnRyb2xzRnVuY3Rpb25zIH0pID0+ICh7XG4gICAgICBwbGF5YmFja1JhdGUsXG4gICAgICBzZXRQbGF5YmFja1JhdGU6IF9fY29udHJvbHNGdW5jdGlvbnMuc2V0UGxheWJhY2tSYXRlLFxuICAgIH0pKSxcbiAgKTtcblxuICBjb25zdCBvblZhbHVlQ2hhbmdlQ29tcG9zZWQgPSB1c2VDYWxsYmFjayhcbiAgICAodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgc2V0UGxheWJhY2tSYXRlKHZhbHVlIGFzIFBsYXliYWNrUmF0ZSk7XG4gICAgICBwcm9wcy5vblZhbHVlQ2hhbmdlPy4odmFsdWUpO1xuICAgIH0sXG4gICAgW3Byb3BzLm9uVmFsdWVDaGFuZ2UsIHNldFBsYXliYWNrUmF0ZV0sXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8U2VsZWN0UHJpbWl0aXZlLlNlbGVjdFJvb3RcbiAgICAgIHsuLi5yYXRlU2VsZWN0UHJvcHN9XG4gICAgICB2YWx1ZT17cGxheWJhY2tSYXRlID09PSBcImNvbnN0YW50XCIgPyBcImNvbnN0YW50XCIgOiBwbGF5YmFja1JhdGUudG9GaXhlZCgyKX1cbiAgICAgIG9uVmFsdWVDaGFuZ2U9e29uVmFsdWVDaGFuZ2VDb21wb3NlZH1cbiAgICAgIGRhdGEtbGl2ZXBlZXItcmF0ZS1zZWxlY3Q9XCJcIlxuICAgICAgZGF0YS1yYXRlPXtTdHJpbmcocGxheWJhY2tSYXRlKX1cbiAgICAvPlxuICApO1xufTtcblxuUmF0ZVNlbGVjdC5kaXNwbGF5TmFtZSA9IFJBVEVfU0VMRUNUX05BTUU7XG5cbi8qKlxuICogUmF0ZVNlbGVjdEl0ZW1cbiAqL1xuXG5jb25zdCBSQVRFX1NFTEVDVF9JVEVNX05BTUUgPSBcIlJhdGVTZWxlY3RJdGVtXCI7XG5cbnR5cGUgUmF0ZVNlbGVjdEl0ZW1FbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjxcbiAgdHlwZW9mIFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtXG4+O1xuXG5pbnRlcmZhY2UgUmF0ZVNlbGVjdEl0ZW1Qcm9wc1xuICBleHRlbmRzIE9taXQ8XG4gICAgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBTZWxlY3RQcmltaXRpdmUuU2VsZWN0SXRlbT4sXG4gICAgXCJ2YWx1ZVwiXG4gID4ge1xuICAvKipcbiAgICogVGhlIG51bWVyaWNhbCB2YWx1ZSBvZiB0aGUgcmF0ZSBzZWxlY3QgaXRlbS4gVGhpcyBtdXN0IGJlIHByb3ZpZGVkIGFuZCBtdXN0IGJlIGEgbnVtYmVyIG9yIGBjb25zdGFudGAsXG4gICAqIHdoaWNoIGluZGljYXRlcyBhIGNvbnN0YW50IHBsYXliYWNrIHJhdGUuXG4gICAqL1xuICB2YWx1ZTogUGxheWJhY2tSYXRlO1xufVxuXG5jb25zdCBSYXRlU2VsZWN0SXRlbSA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIFJhdGVTZWxlY3RJdGVtRWxlbWVudCxcbiAgUmF0ZVNlbGVjdEl0ZW1Qcm9wc1xuPigocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8UmF0ZVNlbGVjdEl0ZW1Qcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgdmFsdWUsIC4uLnJhdGVTZWxlY3RJdGVtUHJvcHMgfSA9IHByb3BzO1xuXG4gIHJldHVybiAoXG4gICAgPFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtXG4gICAgICB7Li4ucmF0ZVNlbGVjdEl0ZW1Qcm9wc31cbiAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgdmFsdWU9e051bWJlcih2YWx1ZSkudG9GaXhlZCgyKX1cbiAgICAgIGRhdGEtbGl2ZXBlZXItcmF0ZS1zZWxlY3QtaXRlbT1cIlwiXG4gICAgLz5cbiAgKTtcbn0pO1xuXG5SYXRlU2VsZWN0SXRlbS5kaXNwbGF5TmFtZSA9IFJBVEVfU0VMRUNUX0lURU1fTkFNRTtcblxuZXhwb3J0IHsgUmF0ZVNlbGVjdCwgUmF0ZVNlbGVjdEl0ZW0gfTtcbmV4cG9ydCB0eXBlIHsgUmF0ZVNlbGVjdEl0ZW1Qcm9wcywgUmF0ZVNlbGVjdFByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0ICogYXMgU2VsZWN0UHJpbWl0aXZlIGZyb20gXCJAcmFkaXgtdWkvcmVhY3Qtc2VsZWN0XCI7XG5cbmNvbnN0IFNlbGVjdFJvb3QgPSBTZWxlY3RQcmltaXRpdmUuUm9vdDtcbmNvbnN0IFNlbGVjdFRyaWdnZXIgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0VHJpZ2dlcjtcbmNvbnN0IFNlbGVjdFZhbHVlID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdFZhbHVlO1xuY29uc3QgU2VsZWN0SWNvbiA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJY29uO1xuY29uc3QgU2VsZWN0UG9ydGFsID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdFBvcnRhbDtcbmNvbnN0IFNlbGVjdENvbnRlbnQgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0Q29udGVudDtcbmNvbnN0IFNlbGVjdFZpZXdwb3J0ID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdFZpZXdwb3J0O1xuY29uc3QgU2VsZWN0R3JvdXAgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0R3JvdXA7XG5jb25zdCBTZWxlY3RMYWJlbCA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RMYWJlbDtcbmNvbnN0IFNlbGVjdEl0ZW0gPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0SXRlbTtcbmNvbnN0IFNlbGVjdEl0ZW1UZXh0ID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdEl0ZW1UZXh0O1xuY29uc3QgU2VsZWN0SXRlbUluZGljYXRvciA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtSW5kaWNhdG9yO1xuY29uc3QgU2VsZWN0U2Nyb2xsVXBCdXR0b24gPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0U2Nyb2xsVXBCdXR0b247XG5jb25zdCBTZWxlY3RTY3JvbGxEb3duQnV0dG9uID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdFNjcm9sbERvd25CdXR0b247XG5jb25zdCBTZWxlY3RTZXBhcmF0b3IgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0U2VwYXJhdG9yO1xuY29uc3QgU2VsZWN0QXJyb3cgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0QXJyb3c7XG5cbnR5cGUgU2VsZWN0UHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0UHJvcHM7XG50eXBlIFNlbGVjdFRyaWdnZXJQcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RUcmlnZ2VyUHJvcHM7XG50eXBlIFNlbGVjdFZhbHVlUHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0VmFsdWVQcm9wcztcbnR5cGUgU2VsZWN0SWNvblByb3BzID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdEljb25Qcm9wcztcbnR5cGUgU2VsZWN0UG9ydGFsUHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0UG9ydGFsUHJvcHM7XG50eXBlIFNlbGVjdENvbnRlbnRQcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RDb250ZW50UHJvcHM7XG50eXBlIFNlbGVjdFZpZXdwb3J0UHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0Vmlld3BvcnRQcm9wcztcbnR5cGUgU2VsZWN0R3JvdXBQcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RHcm91cFByb3BzO1xudHlwZSBTZWxlY3RMYWJlbFByb3BzID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdExhYmVsUHJvcHM7XG50eXBlIFNlbGVjdEl0ZW1Qcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtUHJvcHM7XG50eXBlIFNlbGVjdEl0ZW1UZXh0UHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0SXRlbVRleHRQcm9wcztcbnR5cGUgU2VsZWN0SXRlbUluZGljYXRvclByb3BzID0gU2VsZWN0UHJpbWl0aXZlLlNlbGVjdEl0ZW1JbmRpY2F0b3JQcm9wcztcbnR5cGUgU2VsZWN0U2Nyb2xsVXBCdXR0b25Qcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RTY3JvbGxVcEJ1dHRvblByb3BzO1xudHlwZSBTZWxlY3RTY3JvbGxEb3duQnV0dG9uUHJvcHMgPSBTZWxlY3RQcmltaXRpdmUuU2VsZWN0U2Nyb2xsRG93bkJ1dHRvblByb3BzO1xudHlwZSBTZWxlY3RTZXBhcmF0b3JQcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RTZXBhcmF0b3JQcm9wcztcbnR5cGUgU2VsZWN0QXJyb3dQcm9wcyA9IFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RBcnJvd1Byb3BzO1xuXG5leHBvcnQge1xuICBTZWxlY3RBcnJvdyxcbiAgU2VsZWN0Q29udGVudCxcbiAgU2VsZWN0R3JvdXAsXG4gIFNlbGVjdEljb24sXG4gIFNlbGVjdEl0ZW0sXG4gIFNlbGVjdEl0ZW1JbmRpY2F0b3IsXG4gIFNlbGVjdEl0ZW1UZXh0LFxuICBTZWxlY3RMYWJlbCxcbiAgU2VsZWN0UG9ydGFsLFxuICBTZWxlY3RSb290LFxuICBTZWxlY3RTY3JvbGxEb3duQnV0dG9uLFxuICBTZWxlY3RTY3JvbGxVcEJ1dHRvbixcbiAgU2VsZWN0U2VwYXJhdG9yLFxuICBTZWxlY3RUcmlnZ2VyLFxuICBTZWxlY3RWYWx1ZSxcbiAgU2VsZWN0Vmlld3BvcnQsXG59O1xuXG5leHBvcnQgdHlwZSB7XG4gIFNlbGVjdEFycm93UHJvcHMsXG4gIFNlbGVjdENvbnRlbnRQcm9wcyxcbiAgU2VsZWN0R3JvdXBQcm9wcyxcbiAgU2VsZWN0SWNvblByb3BzLFxuICBTZWxlY3RJdGVtSW5kaWNhdG9yUHJvcHMsXG4gIFNlbGVjdEl0ZW1Qcm9wcyxcbiAgU2VsZWN0SXRlbVRleHRQcm9wcyxcbiAgU2VsZWN0TGFiZWxQcm9wcyxcbiAgU2VsZWN0UG9ydGFsUHJvcHMsXG4gIFNlbGVjdFByb3BzLFxuICBTZWxlY3RTY3JvbGxEb3duQnV0dG9uUHJvcHMsXG4gIFNlbGVjdFNjcm9sbFVwQnV0dG9uUHJvcHMsXG4gIFNlbGVjdFNlcGFyYXRvclByb3BzLFxuICBTZWxlY3RUcmlnZ2VyUHJvcHMsXG4gIFNlbGVjdFZhbHVlUHJvcHMsXG4gIFNlbGVjdFZpZXdwb3J0UHJvcHMsXG59O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbi8vIGJpb21lLWlnbm9yZSBsaW50L2NvcnJlY3RuZXNzL25vVW51c2VkSW1wb3J0czogaWdub3JlZCB1c2luZyBgLS1zdXBwcmVzc2BcbmltcG9ydCB7IGNvbXBvc2VFdmVudEhhbmRsZXJzIH0gZnJvbSBcIkByYWRpeC11aS9wcmltaXRpdmVcIjtcbmltcG9ydCB7IFByZXNlbmNlIH0gZnJvbSBcIkByYWRpeC11aS9yZWFjdC1wcmVzZW5jZVwiO1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgdHlwZSAqIGFzIFJhZGl4IGZyb20gXCIuLi9zaGFyZWQvcHJpbWl0aXZlXCI7XG5pbXBvcnQgKiBhcyBTbGlkZXJQcmltaXRpdmUgZnJvbSBcIi4uL3NoYXJlZC9TbGlkZXJcIjtcbmltcG9ydCB7IG5vUHJvcGFnYXRlIH0gZnJvbSBcIi4uL3NoYXJlZC91dGlsc1wiO1xuXG5jb25zdCBTRUVLX05BTUUgPSBcIlNlZWtcIjtcblxudHlwZSBTZWVrRWxlbWVudCA9IFJlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5idXR0b24+O1xuXG5pbnRlcmZhY2UgU2Vla1Byb3BzXG4gIGV4dGVuZHMgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBTbGlkZXJQcmltaXRpdmUuUm9vdD4ge1xuICAvKipcbiAgICogVXNlZCB0byBmb3JjZSBtb3VudGluZyB3aGVuIG1vcmUgY29udHJvbCBpcyBuZWVkZWQuIFVzZWZ1bCB3aGVuXG4gICAqIGNvbnRyb2xsaW5nIGFuaW1hdGlvbiB3aXRoIFJlYWN0IGFuaW1hdGlvbiBsaWJyYXJpZXMuXG4gICAqL1xuICBmb3JjZU1vdW50PzogdHJ1ZTtcbn1cblxuY29uc3QgU2VlayA9IFJlYWN0LmZvcndhcmRSZWY8U2Vla0VsZW1lbnQsIFNlZWtQcm9wcz4oXG4gIChwcm9wczogTWVkaWFTY29wZWRQcm9wczxTZWVrUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZm9yY2VNb3VudCwgc3R5bGUsIC4uLnNlZWtQcm9wcyB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFNFRUtfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGFyaWFQcm9ncmVzcyxcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgYnVmZmVyZWQsXG4gICAgICBidWZmZXJlZFBlcmNlbnQsXG4gICAgICBwcm9ncmVzcyxcbiAgICAgIGxpdmUsXG4gICAgICBzZWVrLFxuICAgIH0gPSB1c2VTdG9yZShcbiAgICAgIGNvbnRleHQuc3RvcmUsXG4gICAgICB1c2VTaGFsbG93KFxuICAgICAgICAoe1xuICAgICAgICAgIGFyaWEsXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgYnVmZmVyZWQsXG4gICAgICAgICAgYnVmZmVyZWRQZXJjZW50LFxuICAgICAgICAgIHByb2dyZXNzLFxuICAgICAgICAgIGxpdmUsXG4gICAgICAgICAgX19jb250cm9sc0Z1bmN0aW9ucyxcbiAgICAgICAgfSkgPT4gKHtcbiAgICAgICAgICBhcmlhUHJvZ3Jlc3M6IGFyaWEucHJvZ3Jlc3MsXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgYnVmZmVyZWQsXG4gICAgICAgICAgYnVmZmVyZWRQZXJjZW50LFxuICAgICAgICAgIHByb2dyZXNzLFxuICAgICAgICAgIGxpdmUsXG4gICAgICAgICAgc2VlazogX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0U2VlayxcbiAgICAgICAgfSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICBjb25zdCBvblZhbHVlQ2hhbmdlID0gUmVhY3QudXNlQ2FsbGJhY2soXG4gICAgICAoW3ZhbHVlXTogbnVtYmVyW10pID0+IHNlZWsodmFsdWUpLFxuICAgICAgW3NlZWtdLFxuICAgICk7XG4gICAgY29uc3Qgb25WYWx1ZUNvbW1pdCA9IFJlYWN0LnVzZUNhbGxiYWNrKFxuICAgICAgKFt2YWx1ZV06IG51bWJlcltdKSA9PiBzZWVrKHZhbHVlKSxcbiAgICAgIFtzZWVrXSxcbiAgICApO1xuXG4gICAgY29uc3Qgb25WYWx1ZUNoYW5nZUNvbXBvc2VkID0gdXNlQ2FsbGJhY2soXG4gICAgICAodmFsdWU6IG51bWJlcltdKSA9PiB7XG4gICAgICAgIGlmIChwcm9wcy5vblZhbHVlQ2hhbmdlKSB7XG4gICAgICAgICAgcHJvcHMub25WYWx1ZUNoYW5nZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgb25WYWx1ZUNoYW5nZSh2YWx1ZSk7XG4gICAgICB9LFxuICAgICAgW3Byb3BzLm9uVmFsdWVDaGFuZ2UsIG9uVmFsdWVDaGFuZ2VdLFxuICAgICk7XG5cbiAgICBjb25zdCBvblZhbHVlQ29tbWl0Q29tcG9zZWQgPSB1c2VDYWxsYmFjayhcbiAgICAgICh2YWx1ZTogbnVtYmVyW10pID0+IHtcbiAgICAgICAgaWYgKHByb3BzLm9uVmFsdWVDb21taXQpIHtcbiAgICAgICAgICBwcm9wcy5vblZhbHVlQ29tbWl0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBvblZhbHVlQ29tbWl0KHZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBbcHJvcHMub25WYWx1ZUNvbW1pdCwgb25WYWx1ZUNvbW1pdF0sXG4gICAgKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8UHJlc2VuY2UgcHJlc2VudD17Zm9yY2VNb3VudCB8fCAhbGl2ZX0+XG4gICAgICAgIDxTbGlkZXJQcmltaXRpdmUuUm9vdFxuICAgICAgICAgIGFyaWEtbGFiZWw9e2xpdmUgPyBcIkxpdmUgU2VlayBTbGlkZXJcIiA6IFwiVmlkZW8gU2VlayBTbGlkZXJcIn1cbiAgICAgICAgICBhcmlhLXZhbHVldGV4dD17YXJpYVByb2dyZXNzID8/IHVuZGVmaW5lZH1cbiAgICAgICAgICBzdGVwPXswLjF9XG4gICAgICAgICAgbWF4PXtkdXJhdGlvbn1cbiAgICAgICAgICB2YWx1ZT17W3Byb2dyZXNzXX1cbiAgICAgICAgICByb2xlPVwic2xpZGVyXCJcbiAgICAgICAgICB7Li4uc2Vla1Byb3BzfVxuICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e29uVmFsdWVDaGFuZ2VDb21wb3NlZH1cbiAgICAgICAgICBvblZhbHVlQ29tbWl0PXtvblZhbHVlQ29tbWl0Q29tcG9zZWR9XG4gICAgICAgICAgb25DbGljaz17bm9Qcm9wYWdhdGUoKCkgPT4ge30pfVxuICAgICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICAgIGRhdGEtbGl2ZXBlZXItY29udHJvbHMtc2Vlaz1cIlwiXG4gICAgICAgICAgZGF0YS1kdXJhdGlvbj17ZHVyYXRpb259XG4gICAgICAgICAgZGF0YS1wcm9ncmVzcz17cHJvZ3Jlc3N9XG4gICAgICAgICAgZGF0YS1saXZlPXtTdHJpbmcobGl2ZSl9XG4gICAgICAgICAgZGF0YS1idWZmZXJlZD17YnVmZmVyZWR9XG4gICAgICAgICAgZGF0YS12aXNpYmxlPXtTdHJpbmcoIWxpdmUpfVxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAvLyBiaW9tZS1pZ25vcmUgbGludC9zdXNwaWNpb3VzL25vRXhwbGljaXRBbnk6IHBsYXllciBjb250YWluZXIgY3NzIHZhclxuICAgICAgICAgICAgW1wiLS1saXZlcGVlci1wbGF5ZXItYnVmZmVyaW5nLXdpZHRoXCIgYXMgYW55XTogYCR7XG4gICAgICAgICAgICAgIGJ1ZmZlcmVkUGVyY2VudCA/PyAwXG4gICAgICAgICAgICB9JWAsXG4gICAgICAgICAgICAuLi5zdHlsZSxcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgPC9QcmVzZW5jZT5cbiAgICApO1xuICB9LFxuKTtcblxuU2Vlay5kaXNwbGF5TmFtZSA9IFNFRUtfTkFNRTtcblxuY29uc3QgU0VFS19CVUZGRVJfTkFNRSA9IFwiU2Vla0J1ZmZlclwiO1xuXG50eXBlIFNlZWtCdWZmZXJFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgU2xpZGVyUHJpbWl0aXZlLlRyYWNrPjtcblxuaW50ZXJmYWNlIFNlZWtCdWZmZXJQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgU2xpZGVyUHJpbWl0aXZlLlRyYWNrPiB7fVxuXG5jb25zdCBTZWVrQnVmZmVyID0gUmVhY3QuZm9yd2FyZFJlZjxTZWVrQnVmZmVyRWxlbWVudCwgU2Vla0J1ZmZlclByb3BzPihcbiAgKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPFNlZWtCdWZmZXJQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICAgIGNvbnN0IHsgX19zY29wZU1lZGlhLCBzdHlsZSwgLi4uYnVmZmVyUHJvcHMgfSA9IHByb3BzO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChTRUVLX0JVRkZFUl9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gICAgY29uc3QgeyBidWZmZXJlZFBlcmNlbnQsIGJ1ZmZlcmVkIH0gPSB1c2VTdG9yZShcbiAgICAgIGNvbnRleHQuc3RvcmUsXG4gICAgICB1c2VTaGFsbG93KCh7IGJ1ZmZlcmVkUGVyY2VudCwgYnVmZmVyZWQgfSkgPT4gKHtcbiAgICAgICAgYnVmZmVyZWQsXG4gICAgICAgIGJ1ZmZlcmVkUGVyY2VudCxcbiAgICAgIH0pKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxTbGlkZXJQcmltaXRpdmUuVHJhY2tcbiAgICAgICAgey4uLmJ1ZmZlclByb3BzfVxuICAgICAgICByZWY9e2ZvcndhcmRlZFJlZn1cbiAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgIHJpZ2h0OiBgJHsxMDAgLSAoYnVmZmVyZWRQZXJjZW50ID8/IDApfSVgLFxuICAgICAgICAgIC4uLnN0eWxlLFxuICAgICAgICB9fVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLXNlZWstYnVmZmVyPVwiXCJcbiAgICAgICAgZGF0YS1idWZmZXJlZD17YnVmZmVyZWR9XG4gICAgICAvPlxuICAgICk7XG4gIH0sXG4pO1xuXG5TZWVrQnVmZmVyLmRpc3BsYXlOYW1lID0gU0VFS19CVUZGRVJfTkFNRTtcblxuZXhwb3J0IHsgU2VlaywgU2Vla0J1ZmZlciB9O1xuZXhwb3J0IHR5cGUgeyBTZWVrQnVmZmVyUHJvcHMsIFNlZWtQcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCAqIGFzIFNsaWRlclByaW1pdGl2ZSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXNsaWRlclwiO1xuXG50eXBlIFNsaWRlclByb3BzID0gU2xpZGVyUHJpbWl0aXZlLlNsaWRlclByb3BzO1xuY29uc3QgUm9vdCA9IFNsaWRlclByaW1pdGl2ZS5Sb290O1xudHlwZSBUcmFja1Byb3BzID0gU2xpZGVyUHJpbWl0aXZlLlNsaWRlclRyYWNrUHJvcHM7XG5jb25zdCBUcmFjayA9IFNsaWRlclByaW1pdGl2ZS5UcmFjaztcbnR5cGUgUmFuZ2VQcm9wcyA9IFNsaWRlclByaW1pdGl2ZS5TbGlkZXJSYW5nZVByb3BzO1xuY29uc3QgUmFuZ2UgPSBTbGlkZXJQcmltaXRpdmUuUmFuZ2U7XG50eXBlIFRodW1iUHJvcHMgPSBTbGlkZXJQcmltaXRpdmUuU2xpZGVyVGh1bWJQcm9wcztcbmNvbnN0IFRodW1iID0gU2xpZGVyUHJpbWl0aXZlLlRodW1iO1xuXG5leHBvcnQgeyBSYW5nZSwgUm9vdCwgVGh1bWIsIFRyYWNrIH07XG5leHBvcnQgdHlwZSB7IFJhbmdlUHJvcHMsIFNsaWRlclByb3BzLCBUaHVtYlByb3BzLCBUcmFja1Byb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgYWRkRXZlbnRMaXN0ZW5lcnMsIHR5cGUgSGxzQ29uZmlnIH0gZnJvbSBcIkBsaXZlcGVlci9jb3JlLXdlYi9icm93c2VyXCI7XG5pbXBvcnQgeyB1c2VDb21wb3NlZFJlZnMgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LWNvbXBvc2UtcmVmc1wiO1xuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4uL3NoYXJlZC9jb250ZXh0XCI7XG5pbXBvcnQgKiBhcyBSYWRpeCBmcm9tIFwiLi4vc2hhcmVkL3ByaW1pdGl2ZVwiO1xuXG5jb25zdCBWSURFT19OQU1FID0gXCJWaWRlb1wiO1xuXG50eXBlIE9taXR0ZWRQcm9wcyA9IFwic3JjXCIgfCBcInBvc3RlclwiIHwgXCJhdXRvUGxheVwiIHwgXCJwcmVsb2FkXCI7XG5cbnR5cGUgVmlkZW9FbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLnZpZGVvPjtcblxuaW50ZXJmYWNlIFZpZGVvUHJvcHNcbiAgZXh0ZW5kcyBPbWl0PFxuICAgIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLnZpZGVvPixcbiAgICBPbWl0dGVkUHJvcHNcbiAgPiB7XG4gIC8qKlxuICAgKiBDb250cm9scyB0aGUgcG9zdGVyIHNvdXJjZSwgd2hpY2ggYnkgZGVmYXVsdCB1c2VzIHRoZSB0aHVtYm5haWwgZnJvbSB0aGUgU3JjIGlucHV0LlxuICAgKlxuICAgKiBTZXQgdG8gbnVsbCB0byBkaXNhYmxlIHRoZSBkZWZhdWx0IHBvc3RlciBpbWFnZSBmcm9tIHRoZSBTcmMuXG4gICAqL1xuICBwb3N0ZXI/OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBDb25maWd1cmVzIHRoZSBITFMuanMgb3B0aW9ucywgZm9yIGFkdmFuY2VkIHVzYWdlIG9mIHRoZSBQbGF5ZXIuXG4gICAqL1xuICBobHNDb25maWc/OiBIbHNDb25maWc7XG59XG5cbmNvbnN0IFZpZGVvID0gUmVhY3QuZm9yd2FyZFJlZjxWaWRlb0VsZW1lbnQsIFZpZGVvUHJvcHM+KFxuICAocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8VmlkZW9Qcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICAgIGNvbnN0IHsgX19zY29wZU1lZGlhLCBzdHlsZSwgcG9zdGVyLCBobHNDb25maWcsIHRpdGxlLCAuLi52aWRlb1Byb3BzIH0gPVxuICAgICAgcHJvcHM7XG5cbiAgICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFZJREVPX05BTUUsIF9fc2NvcGVNZWRpYSk7XG5cbiAgICBjb25zdCByZWYgPSBSZWFjdC51c2VSZWY8VmlkZW9FbGVtZW50IHwgbnVsbD4obnVsbCk7XG4gICAgY29uc3QgY29tcG9zZWRSZWZzID0gdXNlQ29tcG9zZWRSZWZzKGZvcndhcmRlZFJlZiwgcmVmKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGN1cnJlbnRTb3VyY2UsXG4gICAgICBzZXRNb3VudGVkLFxuICAgICAgYXV0b1BsYXksXG4gICAgICBwcmVsb2FkLFxuICAgICAgdGh1bWJuYWlsUG9zdGVyLFxuICAgICAgdm9sdW1lLFxuICAgICAgcmVxdWVzdFRvZ2dsZU11dGUsXG4gICAgfSA9IHVzZVN0b3JlKFxuICAgICAgY29udGV4dC5zdG9yZSxcbiAgICAgIHVzZVNoYWxsb3coXG4gICAgICAgICh7XG4gICAgICAgICAgX19jb250cm9sc0Z1bmN0aW9ucyxcbiAgICAgICAgICBfX2luaXRpYWxQcm9wcyxcbiAgICAgICAgICBjdXJyZW50U291cmNlLFxuICAgICAgICAgIGxpdmUsXG4gICAgICAgICAgcG9zdGVyLFxuICAgICAgICAgIHZvbHVtZSxcbiAgICAgICAgfSkgPT4gKHtcbiAgICAgICAgICBhdXRvUGxheTogX19pbml0aWFsUHJvcHMuYXV0b1BsYXksXG4gICAgICAgICAgY3VycmVudFNvdXJjZSxcbiAgICAgICAgICBsaXZlLFxuICAgICAgICAgIHByZWxvYWQ6IF9faW5pdGlhbFByb3BzLnByZWxvYWQsXG4gICAgICAgICAgc2V0TW91bnRlZDogX19jb250cm9sc0Z1bmN0aW9ucy5zZXRNb3VudGVkLFxuICAgICAgICAgIHRodW1ibmFpbFBvc3RlcjogcG9zdGVyLFxuICAgICAgICAgIHZvbHVtZSxcbiAgICAgICAgICByZXF1ZXN0VG9nZ2xlTXV0ZTogX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0VG9nZ2xlTXV0ZSxcbiAgICAgICAgfSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgaWYgKHJlZi5jdXJyZW50KSB7XG4gICAgICAgIGNvbnN0IHsgZGVzdHJveSB9ID0gYWRkRXZlbnRMaXN0ZW5lcnMocmVmLmN1cnJlbnQsIGNvbnRleHQuc3RvcmUpO1xuXG4gICAgICAgIHJldHVybiBkZXN0cm95O1xuICAgICAgfVxuICAgIH0sIFtjb250ZXh0Py5zdG9yZV0pO1xuXG4gICAgLy8gYmlvbWUtaWdub3JlIGxpbnQvY29ycmVjdG5lc3MvdXNlRXhoYXVzdGl2ZURlcGVuZGVuY2llczogb25seSBzZXQgb25jZSB0byBwcmV2ZW50IGZsYXNoaW5nXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChobHNDb25maWcpIHtcbiAgICAgICAgY29udGV4dC5zdG9yZS5nZXRTdGF0ZSgpLl9fY29udHJvbHNGdW5jdGlvbnMuc2V0SGxzQ29uZmlnKGhsc0NvbmZpZyk7XG4gICAgICB9XG4gICAgfSwgW10pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIC8vIHdlIHJ1biB0aGlzIG9uIG1vdW50IHRvIGluaXRpYWxpemUgcGxheWJhY2tcbiAgICAgIHNldE1vdW50ZWQoKTtcbiAgICB9LCBbc2V0TW91bnRlZF0pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdmlkZW9Qcm9wcy5tdXRlZCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICByZXF1ZXN0VG9nZ2xlTXV0ZSh2aWRlb1Byb3BzLm11dGVkKTtcbiAgICAgIH1cbiAgICB9LCBbdmlkZW9Qcm9wcy5tdXRlZCwgcmVxdWVzdFRvZ2dsZU11dGVdKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8UmFkaXguUHJpbWl0aXZlLnZpZGVvXG4gICAgICAgIHBsYXlzSW5saW5lXG4gICAgICAgIHBvc3Rlcj17XG4gICAgICAgICAgcG9zdGVyID09PSBudWxsID8gdW5kZWZpbmVkIDogKHBvc3RlciA/PyB0aHVtYm5haWxQb3N0ZXIgPz8gdW5kZWZpbmVkKVxuICAgICAgICB9XG4gICAgICAgIG11dGVkPXt2b2x1bWUgPT09IDB9XG4gICAgICAgIHsuLi52aWRlb1Byb3BzfVxuICAgICAgICBhcmlhLWxhYmVsPXt0aXRsZSA/PyB2aWRlb1Byb3BzW1wiYXJpYS1sYWJlbFwiXX1cbiAgICAgICAgYXV0b1BsYXk9e2F1dG9QbGF5fVxuICAgICAgICBwcmVsb2FkPXtwcmVsb2FkfVxuICAgICAgICByZWY9e2NvbXBvc2VkUmVmc31cbiAgICAgICAgZGF0YS1saXZlcGVlci12aWRlbz1cIlwiXG4gICAgICAgIGRhdGEtbGl2ZXBlZXItc291cmNlLXR5cGU9e2N1cnJlbnRTb3VyY2U/LnR5cGUgPz8gXCJub25lXCJ9XG4gICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgLi4uc3R5bGUsXG4gICAgICAgICAgLy8gZW5zdXJlcyB2aWRlbyBleHBhbmRzIGluIHJhdGlvXG4gICAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICAgICAgICBpbnNldDogMCxcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgKTtcbiAgfSxcbik7XG5cblZpZGVvLmRpc3BsYXlOYW1lID0gVklERU9fTkFNRTtcblxuZXhwb3J0IHsgVmlkZW8gfTtcbmV4cG9ydCB0eXBlIHsgVmlkZW9Qcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB0eXBlIHsgVmlkZW9RdWFsaXR5IH0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL21lZGlhXCI7XG4vLyBiaW9tZS1pZ25vcmUgbGludC9jb3JyZWN0bmVzcy9ub1VudXNlZEltcG9ydHM6IGlnbm9yZWQgdXNpbmcgYC0tc3VwcHJlc3NgXG5pbXBvcnQgeyBjb21wb3NlRXZlbnRIYW5kbGVycyB9IGZyb20gXCJAcmFkaXgtdWkvcHJpbWl0aXZlXCI7XG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHVzZVNoYWxsb3cgfSBmcm9tIFwienVzdGFuZC9yZWFjdC9zaGFsbG93XCI7XG5pbXBvcnQgeyB0eXBlIE1lZGlhU2NvcGVkUHJvcHMsIHVzZU1lZGlhQ29udGV4dCB9IGZyb20gXCIuLi9zaGFyZWQvY29udGV4dFwiO1xuaW1wb3J0IHR5cGUgKiBhcyBSYWRpeCBmcm9tIFwiLi4vc2hhcmVkL3ByaW1pdGl2ZVwiO1xuaW1wb3J0ICogYXMgU2VsZWN0UHJpbWl0aXZlIGZyb20gXCIuLi9zaGFyZWQvU2VsZWN0XCI7XG5cbi8qKlxuICogVmlkZW9RdWFsaXR5U2VsZWN0XG4gKi9cblxuY29uc3QgVklERU9fUVVBTElUWV9TRUxFQ1RfTkFNRSA9IFwiVmlkZW9RdWFsaXR5U2VsZWN0XCI7XG5cbmludGVyZmFjZSBWaWRlb1F1YWxpdHlTZWxlY3RQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgU2VsZWN0UHJpbWl0aXZlLlNlbGVjdFJvb3Q+IHt9XG5cbmNvbnN0IFZpZGVvUXVhbGl0eVNlbGVjdCA9IChcbiAgcHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8VmlkZW9RdWFsaXR5U2VsZWN0UHJvcHM+LFxuKSA9PiB7XG4gIC8vIGJpb21lLWlnbm9yZSBsaW50L2NvcnJlY3RuZXNzL25vVW51c2VkVmFyaWFibGVzOiBpZ25vcmVkIHVzaW5nIGAtLXN1cHByZXNzYFxuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZGVmYXVsdFZhbHVlLCAuLi52aWRlb1F1YWxpdHlTZWxlY3RQcm9wcyB9ID0gcHJvcHM7XG5cbiAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChWSURFT19RVUFMSVRZX1NFTEVDVF9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gIGNvbnN0IHsgdmlkZW9RdWFsaXR5LCBzZXRWaWRlb1F1YWxpdHkgfSA9IHVzZVN0b3JlKFxuICAgIGNvbnRleHQuc3RvcmUsXG4gICAgdXNlU2hhbGxvdygoeyB2aWRlb1F1YWxpdHksIF9fY29udHJvbHNGdW5jdGlvbnMgfSkgPT4gKHtcbiAgICAgIHZpZGVvUXVhbGl0eSxcbiAgICAgIHNldFZpZGVvUXVhbGl0eTogX19jb250cm9sc0Z1bmN0aW9ucy5zZXRWaWRlb1F1YWxpdHksXG4gICAgfSkpLFxuICApO1xuXG4gIGNvbnN0IG9uVmFsdWVDaGFuZ2VDb21wb3NlZCA9IHVzZUNhbGxiYWNrKFxuICAgICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAocHJvcHMub25WYWx1ZUNoYW5nZSkge1xuICAgICAgICBwcm9wcy5vblZhbHVlQ2hhbmdlKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHNldFZpZGVvUXVhbGl0eSh2YWx1ZSBhcyBWaWRlb1F1YWxpdHkpO1xuICAgIH0sXG4gICAgW3Byb3BzLm9uVmFsdWVDaGFuZ2UsIHNldFZpZGVvUXVhbGl0eV0sXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8U2VsZWN0UHJpbWl0aXZlLlNlbGVjdFJvb3RcbiAgICAgIHsuLi52aWRlb1F1YWxpdHlTZWxlY3RQcm9wc31cbiAgICAgIHZhbHVlPXt2aWRlb1F1YWxpdHl9XG4gICAgICBvblZhbHVlQ2hhbmdlPXtvblZhbHVlQ2hhbmdlQ29tcG9zZWR9XG4gICAgICBkYXRhLWxpdmVwZWVyLXF1YWxpdHktc2VsZWN0PVwiXCJcbiAgICAgIGRhdGEtdmlkZW8tcXVhbGl0eT17U3RyaW5nKHZpZGVvUXVhbGl0eSl9XG4gICAgLz5cbiAgKTtcbn07XG5cblZpZGVvUXVhbGl0eVNlbGVjdC5kaXNwbGF5TmFtZSA9IFZJREVPX1FVQUxJVFlfU0VMRUNUX05BTUU7XG5cbi8qKlxuICogVmlkZW9RdWFsaXR5U2VsZWN0SXRlbVxuICovXG5cbmNvbnN0IFZJREVPX1FVQUxJVFlfU0VMRUNUX0lURU1fTkFNRSA9IFwiVmlkZW9RdWFsaXR5U2VsZWN0SXRlbVwiO1xuXG50eXBlIFZpZGVvUXVhbGl0eVNlbGVjdEl0ZW1FbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjxcbiAgdHlwZW9mIFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtXG4+O1xuXG5pbnRlcmZhY2UgVmlkZW9RdWFsaXR5U2VsZWN0SXRlbVByb3BzXG4gIGV4dGVuZHMgT21pdDxcbiAgICBSYWRpeC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8dHlwZW9mIFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtPixcbiAgICBcInZhbHVlXCJcbiAgPiB7XG4gIC8qKlxuICAgKiBUaGUgbnVtZXJpY2FsIHZhbHVlIG9mIHRoZSBxdWFsaXR5IHNlbGVjdCBpdGVtLiBUaGlzIG11c3QgYmUgcHJvdmlkZWQuXG4gICAqL1xuICB2YWx1ZTogVmlkZW9RdWFsaXR5O1xufVxuXG5jb25zdCBWaWRlb1F1YWxpdHlTZWxlY3RJdGVtID0gUmVhY3QuZm9yd2FyZFJlZjxcbiAgVmlkZW9RdWFsaXR5U2VsZWN0SXRlbUVsZW1lbnQsXG4gIFZpZGVvUXVhbGl0eVNlbGVjdEl0ZW1Qcm9wc1xuPigocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8VmlkZW9RdWFsaXR5U2VsZWN0SXRlbVByb3BzPiwgZm9yd2FyZGVkUmVmKSA9PiB7XG4gIGNvbnN0IHsgX19zY29wZU1lZGlhLCAuLi52aWRlb1F1YWxpdHlTZWxlY3RJdGVtUHJvcHMgfSA9IHByb3BzO1xuXG4gIHJldHVybiAoXG4gICAgPFNlbGVjdFByaW1pdGl2ZS5TZWxlY3RJdGVtXG4gICAgICB7Li4udmlkZW9RdWFsaXR5U2VsZWN0SXRlbVByb3BzfVxuICAgICAgcmVmPXtmb3J3YXJkZWRSZWZ9XG4gICAgICBkYXRhLWxpdmVwZWVyLXF1YWxpdHktc2VsZWN0LWl0ZW09XCJcIlxuICAgIC8+XG4gICk7XG59KTtcblxuVmlkZW9RdWFsaXR5U2VsZWN0SXRlbS5kaXNwbGF5TmFtZSA9IFZJREVPX1FVQUxJVFlfU0VMRUNUX0lURU1fTkFNRTtcblxuZXhwb3J0IHsgVmlkZW9RdWFsaXR5U2VsZWN0LCBWaWRlb1F1YWxpdHlTZWxlY3RJdGVtIH07XG5leHBvcnQgdHlwZSB7IFZpZGVvUXVhbGl0eVNlbGVjdEl0ZW1Qcm9wcywgVmlkZW9RdWFsaXR5U2VsZWN0UHJvcHMgfTtcbiIsIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyB3YXJuIH0gZnJvbSBcIkBsaXZlcGVlci9jb3JlL3V0aWxzXCI7XG4vLyBiaW9tZS1pZ25vcmUgbGludC9jb3JyZWN0bmVzcy9ub1VudXNlZEltcG9ydHM6IGlnbm9yZWQgdXNpbmcgYC0tc3VwcHJlc3NgXG5pbXBvcnQgeyBjb21wb3NlRXZlbnRIYW5kbGVycyB9IGZyb20gXCJAcmFkaXgtdWkvcHJpbWl0aXZlXCI7XG5pbXBvcnQgeyBQcmVzZW5jZSB9IGZyb20gXCJAcmFkaXgtdWkvcmVhY3QtcHJlc2VuY2VcIjtcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gXCJ6dXN0YW5kXCI7XG5pbXBvcnQgeyB1c2VTaGFsbG93IH0gZnJvbSBcInp1c3RhbmQvcmVhY3Qvc2hhbGxvd1wiO1xuaW1wb3J0IHsgdHlwZSBNZWRpYVNjb3BlZFByb3BzLCB1c2VNZWRpYUNvbnRleHQgfSBmcm9tIFwiLi4vc2hhcmVkL2NvbnRleHRcIjtcbmltcG9ydCAqIGFzIFJhZGl4IGZyb20gXCIuLi9zaGFyZWQvcHJpbWl0aXZlXCI7XG5pbXBvcnQgKiBhcyBTbGlkZXJQcmltaXRpdmUgZnJvbSBcIi4uL3NoYXJlZC9TbGlkZXJcIjtcbmltcG9ydCB7IG5vUHJvcGFnYXRlIH0gZnJvbSBcIi4uL3NoYXJlZC91dGlsc1wiO1xuXG4vKipcbiAqIFZvbHVtZVxuICovXG5cbmNvbnN0IFZPTFVNRV9OQU1FID0gXCJWb2x1bWVcIjtcblxudHlwZSBWb2x1bWVFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj47XG5cbmludGVyZmFjZSBWb2x1bWVQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgU2xpZGVyUHJpbWl0aXZlLlJvb3Q+IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gZm9yY2UgbW91bnRpbmcgd2hlbiBtb3JlIGNvbnRyb2wgaXMgbmVlZGVkLiBVc2VmdWwgd2hlblxuICAgKiBjb250cm9sbGluZyBhbmltYXRpb24gd2l0aCBSZWFjdCBhbmltYXRpb24gbGlicmFyaWVzLlxuICAgKi9cbiAgZm9yY2VNb3VudD86IHRydWU7XG59XG5cbmNvbnN0IFZvbHVtZSA9IFJlYWN0LmZvcndhcmRSZWY8Vm9sdW1lRWxlbWVudCwgVm9sdW1lUHJvcHM+KFxuICAocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8Vm9sdW1lUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZm9yY2VNb3VudCwgLi4udm9sdW1lUHJvcHMgfSA9IHByb3BzO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChWT0xVTUVfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICAgIGNvbnN0IHsgdm9sdW1lLCByZXF1ZXN0Vm9sdW1lLCBpc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZCB9ID0gdXNlU3RvcmUoXG4gICAgICBjb250ZXh0LnN0b3JlLFxuICAgICAgdXNlU2hhbGxvdygoeyB2b2x1bWUsIF9fY29udHJvbHNGdW5jdGlvbnMsIF9fZGV2aWNlIH0pID0+ICh7XG4gICAgICAgIHZvbHVtZSxcbiAgICAgICAgcmVxdWVzdFZvbHVtZTogX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0Vm9sdW1lLFxuICAgICAgICBpc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZDogX19kZXZpY2UuaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWQsXG4gICAgICB9KSksXG4gICAgKTtcblxuICAgIGNvbnN0IG9uVmFsdWVDaGFuZ2UgPSBSZWFjdC51c2VDYWxsYmFjayhcbiAgICAgIChbdmFsdWVdOiBudW1iZXJbXSkgPT4gcmVxdWVzdFZvbHVtZSh2YWx1ZSksXG4gICAgICBbcmVxdWVzdFZvbHVtZV0sXG4gICAgKTtcbiAgICBjb25zdCBvblZhbHVlQ29tbWl0ID0gUmVhY3QudXNlQ2FsbGJhY2soXG4gICAgICAoW3ZhbHVlXTogbnVtYmVyW10pID0+IHJlcXVlc3RWb2x1bWUodmFsdWUpLFxuICAgICAgW3JlcXVlc3RWb2x1bWVdLFxuICAgICk7XG5cbiAgICBjb25zdCBvblZhbHVlQ2hhbmdlQ29tcG9zZWQgPSB1c2VDYWxsYmFjayhcbiAgICAgICh2YWx1ZTogbnVtYmVyW10pID0+IHtcbiAgICAgICAgaWYgKHByb3BzLm9uVmFsdWVDaGFuZ2UpIHtcbiAgICAgICAgICBwcm9wcy5vblZhbHVlQ2hhbmdlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBvblZhbHVlQ2hhbmdlKHZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBbcHJvcHMub25WYWx1ZUNoYW5nZSwgb25WYWx1ZUNoYW5nZV0sXG4gICAgKTtcblxuICAgIGNvbnN0IG9uVmFsdWVDb21taXRDb21wb3NlZCA9IHVzZUNhbGxiYWNrKFxuICAgICAgKHZhbHVlOiBudW1iZXJbXSkgPT4ge1xuICAgICAgICBpZiAocHJvcHMub25WYWx1ZUNvbW1pdCkge1xuICAgICAgICAgIHByb3BzLm9uVmFsdWVDb21taXQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIG9uVmFsdWVDb21taXQodmFsdWUpO1xuICAgICAgfSxcbiAgICAgIFtwcm9wcy5vblZhbHVlQ29tbWl0LCBvblZhbHVlQ29tbWl0XSxcbiAgICApO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxQcmVzZW5jZSBwcmVzZW50PXtmb3JjZU1vdW50IHx8IGlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkfT5cbiAgICAgICAgPFNsaWRlclByaW1pdGl2ZS5Sb290XG4gICAgICAgICAgYXJpYS1sYWJlbD1cIlZvbHVtZSBTbGlkZXJcIlxuICAgICAgICAgIHN0ZXA9ezAuMDF9XG4gICAgICAgICAgbWF4PXsxfVxuICAgICAgICAgIHZhbHVlPXtbdm9sdW1lXX1cbiAgICAgICAgICB7Li4udm9sdW1lUHJvcHN9XG4gICAgICAgICAgb25DbGljaz17bm9Qcm9wYWdhdGUoKCkgPT4ge30pfVxuICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e29uVmFsdWVDaGFuZ2VDb21wb3NlZH1cbiAgICAgICAgICBvblZhbHVlQ29tbWl0PXtvblZhbHVlQ29tbWl0Q29tcG9zZWR9XG4gICAgICAgICAgcmVmPXtmb3J3YXJkZWRSZWZ9XG4gICAgICAgICAgZGF0YS1saXZlcGVlci1jb250cm9scy12b2x1bWU9XCJcIlxuICAgICAgICAgIGRhdGEtbGl2ZXBlZXItbXV0ZWQ9e1N0cmluZyh2b2x1bWUgPT09IDApfVxuICAgICAgICAgIGRhdGEtbGl2ZXBlZXItdm9sdW1lPXtTdHJpbmcoKDEwMCAqIHZvbHVtZSkudG9GaXhlZCgwKSl9XG4gICAgICAgICAgZGF0YS12aXNpYmxlPXtTdHJpbmcoQm9vbGVhbihpc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZCkpfVxuICAgICAgICAvPlxuICAgICAgPC9QcmVzZW5jZT5cbiAgICApO1xuICB9LFxuKTtcblxuVm9sdW1lLmRpc3BsYXlOYW1lID0gVk9MVU1FX05BTUU7XG5cbi8qKlxuICogVm9sdW1lSW5kaWNhdG9yXG4gKi9cblxuY29uc3QgVk9MVU1FX0lORElDQVRPUl9OQU1FID0gXCJWb2x1bWVJbmRpY2F0b3JcIjtcblxudHlwZSBWb2x1bWVJbmRpY2F0b3JFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj47XG5cbmludGVyZmFjZSBWb2x1bWVJbmRpY2F0b3JQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj4ge1xuICAvKipcbiAgICogVXNlZCB0byBmb3JjZSBtb3VudGluZyB3aGVuIG1vcmUgY29udHJvbCBpcyBuZWVkZWQuIFVzZWZ1bCB3aGVuXG4gICAqIGNvbnRyb2xsaW5nIGFuaW1hdGlvbiB3aXRoIFJlYWN0IGFuaW1hdGlvbiBsaWJyYXJpZXMuXG4gICAqL1xuICBmb3JjZU1vdW50PzogdHJ1ZTtcbiAgLyoqIFRoZSBtYXRjaGVyIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGVsZW1lbnQgc2hvdWxkIGJlIHNob3duLCBnaXZlbiB0aGUgdm9sdW1lLiBEZWZhdWx0cyB0byBtYXRjaCBgZmFsc2VgLCB3aGljaCBpcyBtdXRlZC4gKi9cbiAgbWF0Y2hlcj86IGJvb2xlYW4gfCAoKHZvbHVtZTogbnVtYmVyKSA9PiBib29sZWFuKTtcbn1cblxuY29uc3QgVm9sdW1lSW5kaWNhdG9yID0gUmVhY3QuZm9yd2FyZFJlZjxcbiAgVm9sdW1lSW5kaWNhdG9yRWxlbWVudCxcbiAgVm9sdW1lSW5kaWNhdG9yUHJvcHNcbj4oKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPFZvbHVtZUluZGljYXRvclByb3BzPiwgZm9yd2FyZGVkUmVmKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBfX3Njb3BlTWVkaWEsXG4gICAgZm9yY2VNb3VudCxcbiAgICBtYXRjaGVyID0gZmFsc2UsXG4gICAgLi4udm9sdW1lSW5kaWNhdG9yUHJvcHNcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGNvbnRleHQgPSB1c2VNZWRpYUNvbnRleHQoVk9MVU1FX0lORElDQVRPUl9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gIGNvbnN0IHsgdm9sdW1lLCBtdXRlZCwgaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWQgfSA9IHVzZVN0b3JlKFxuICAgIGNvbnRleHQuc3RvcmUsXG4gICAgdXNlU2hhbGxvdygoeyB2b2x1bWUsIF9fZGV2aWNlLCBfX2NvbnRyb2xzIH0pID0+ICh7XG4gICAgICB2b2x1bWUsXG4gICAgICBtdXRlZDogX19jb250cm9scy5tdXRlZCxcbiAgICAgIGlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkOiBfX2RldmljZS5pc1ZvbHVtZUNoYW5nZVN1cHBvcnRlZCxcbiAgICB9KSksXG4gICk7XG5cbiAgY29uc3QgaXNQcmVzZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PlxuICAgICAgbWF0Y2hlciAhPT0gdW5kZWZpbmVkXG4gICAgICAgID8gdHlwZW9mIG1hdGNoZXIgPT09IFwiYm9vbGVhblwiXG4gICAgICAgICAgPyBtYXRjaGVyXG4gICAgICAgICAgICA/ICFtdXRlZFxuICAgICAgICAgICAgOiBtdXRlZFxuICAgICAgICAgIDogbWF0Y2hlcih2b2x1bWUpXG4gICAgICAgIDogbXV0ZWQsXG4gICAgW3ZvbHVtZSwgbWF0Y2hlciwgbXV0ZWRdLFxuICApO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkICYmIHR5cGVvZiBtYXRjaGVyICE9PSBcImJvb2xlYW5cIikge1xuICAgICAgd2FybihcIlZvbHVtZSBjaGFuZ2UgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIGRldmljZS5cIik7XG4gICAgfVxuICB9LCBbaXNWb2x1bWVDaGFuZ2VTdXBwb3J0ZWQsIG1hdGNoZXJdKTtcblxuICByZXR1cm4gKFxuICAgIDxQcmVzZW5jZSBwcmVzZW50PXtmb3JjZU1vdW50IHx8IGlzUHJlc2VudH0+XG4gICAgICA8UmFkaXguUHJpbWl0aXZlLmRpdlxuICAgICAgICB7Li4udm9sdW1lSW5kaWNhdG9yUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLW11dGVkPXtTdHJpbmcobXV0ZWQpfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLXZvbHVtZT17U3RyaW5nKCgxMDAgKiB2b2x1bWUpLnRvRml4ZWQoMCkpfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLXZvbHVtZS1pbmRpY2F0b3I9XCJcIlxuICAgICAgICBkYXRhLXZpc2libGU9e1N0cmluZyhpc1ByZXNlbnQpfVxuICAgICAgLz5cbiAgICA8L1ByZXNlbmNlPlxuICApO1xufSk7XG5cblZvbHVtZUluZGljYXRvci5kaXNwbGF5TmFtZSA9IFZPTFVNRV9JTkRJQ0FUT1JfTkFNRTtcblxuZXhwb3J0IHsgVm9sdW1lLCBWb2x1bWVJbmRpY2F0b3IgfTtcbmV4cG9ydCB0eXBlIHsgVm9sdW1lSW5kaWNhdG9yUHJvcHMsIFZvbHVtZVByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0ICogYXMgUmFkaXhBc3BlY3RSYXRpbyBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LWFzcGVjdC1yYXRpb1wiO1xuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4vY29udGV4dFwiO1xuaW1wb3J0ICogYXMgUmFkaXggZnJvbSBcIi4vcHJpbWl0aXZlXCI7XG5cbmNvbnN0IENPTlRBSU5FUl9OQU1FID0gXCJDb250YWluZXJcIjtcblxudHlwZSBDb250YWluZXJFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj47XG50eXBlIENvbnRhaW5lclByb3BzID0gUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPFxuICB0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdlxuPjtcblxuY29uc3QgQ29udGFpbmVyID0gUmVhY3QubWVtbyhcbiAgUmVhY3QuZm9yd2FyZFJlZjxDb250YWluZXJFbGVtZW50LCBNZWRpYVNjb3BlZFByb3BzPENvbnRhaW5lclByb3BzPj4oXG4gICAgKHByb3BzLCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICAgIGNvbnN0IHsgX19zY29wZU1lZGlhLCAuLi5hc3BlY3RSYXRpb1Byb3BzIH0gPSBwcm9wcztcblxuICAgICAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChDT05UQUlORVJfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICAgICAgY29uc3Qge1xuICAgICAgICBhc3BlY3RSYXRpbyxcbiAgICAgICAgZnVsbHNjcmVlbixcbiAgICAgICAgcGxheWluZyxcbiAgICAgICAgY2FuUGxheSxcbiAgICAgICAgcmF0ZSxcbiAgICAgICAgZXJyb3IsXG4gICAgICAgIGxpdmUsXG4gICAgICAgIGhhc1BsYXllZCxcbiAgICAgICAgaGlkZGVuLFxuICAgICAgICBwaWN0dXJlSW5QaWN0dXJlLFxuICAgICAgICBsb2FkaW5nLFxuICAgICAgICB2aWRlb1F1YWxpdHksXG4gICAgICB9ID0gdXNlU3RvcmUoXG4gICAgICAgIGNvbnRleHQuc3RvcmUsXG4gICAgICAgIHVzZVNoYWxsb3coXG4gICAgICAgICAgKHtcbiAgICAgICAgICAgIF9faW5pdGlhbFByb3BzLFxuICAgICAgICAgICAgZnVsbHNjcmVlbixcbiAgICAgICAgICAgIHBsYXlpbmcsXG4gICAgICAgICAgICBjYW5QbGF5LFxuICAgICAgICAgICAgcGxheWJhY2tSYXRlLFxuICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICBsaXZlLFxuICAgICAgICAgICAgaGFzUGxheWVkLFxuICAgICAgICAgICAgaGlkZGVuLFxuICAgICAgICAgICAgcGljdHVyZUluUGljdHVyZSxcbiAgICAgICAgICAgIGxvYWRpbmcsXG4gICAgICAgICAgICB2aWRlb1F1YWxpdHksXG4gICAgICAgICAgfSkgPT4gKHtcbiAgICAgICAgICAgIGFzcGVjdFJhdGlvOiBfX2luaXRpYWxQcm9wcy5hc3BlY3RSYXRpbyxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW4sXG4gICAgICAgICAgICBwbGF5aW5nLFxuICAgICAgICAgICAgY2FuUGxheSxcbiAgICAgICAgICAgIGVycm9yOiBCb29sZWFuKGVycm9yKSxcbiAgICAgICAgICAgIHJhdGU6XG4gICAgICAgICAgICAgIHBsYXliYWNrUmF0ZSA9PT0gXCJjb25zdGFudFwiXG4gICAgICAgICAgICAgICAgPyBcImNvbnN0YW50XCJcbiAgICAgICAgICAgICAgICA6IHBsYXliYWNrUmF0ZSA+IDFcbiAgICAgICAgICAgICAgICAgID8gXCJmYXN0XCJcbiAgICAgICAgICAgICAgICAgIDogcGxheWJhY2tSYXRlIDwgMVxuICAgICAgICAgICAgICAgICAgICA/IFwic2xvd1wiXG4gICAgICAgICAgICAgICAgICAgIDogXCJub3JtYWxcIixcbiAgICAgICAgICAgIGxpdmUsXG4gICAgICAgICAgICBoYXNQbGF5ZWQsXG4gICAgICAgICAgICBoaWRkZW4sXG4gICAgICAgICAgICBwaWN0dXJlSW5QaWN0dXJlLFxuICAgICAgICAgICAgbG9hZGluZyxcbiAgICAgICAgICAgIHZpZGVvUXVhbGl0eSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKSxcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiBhc3BlY3RSYXRpbyA/IChcbiAgICAgICAgPFJhZGl4QXNwZWN0UmF0aW8uUm9vdFxuICAgICAgICAgIHJhdGlvPXthc3BlY3RSYXRpb31cbiAgICAgICAgICB7Li4uYXNwZWN0UmF0aW9Qcm9wc31cbiAgICAgICAgICByZWY9e2ZvcndhcmRlZFJlZn1cbiAgICAgICAgICBkYXRhLWxpdmVwZWVyLWFzcGVjdC1yYXRpbz1cIlwiXG4gICAgICAgICAgZGF0YS1mdWxsc2NyZWVuPXtTdHJpbmcoZnVsbHNjcmVlbil9XG4gICAgICAgICAgZGF0YS1wbGF5aW5nPXtTdHJpbmcocGxheWluZyl9XG4gICAgICAgICAgZGF0YS1jYW4tcGxheT17U3RyaW5nKGNhblBsYXkpfVxuICAgICAgICAgIGRhdGEtcGxheWJhY2stcmF0ZT17cmF0ZX1cbiAgICAgICAgICBkYXRhLWVycm9yPXtTdHJpbmcoZXJyb3IpfVxuICAgICAgICAgIGRhdGEtbG9hZGluZz17U3RyaW5nKGxvYWRpbmcpfVxuICAgICAgICAgIGRhdGEtbGl2ZT17U3RyaW5nKGxpdmUpfVxuICAgICAgICAgIGRhdGEtaGFzLXBsYXllZD17U3RyaW5nKGhhc1BsYXllZCl9XG4gICAgICAgICAgZGF0YS1jb250cm9scy1oaWRkZW49e1N0cmluZyhoaWRkZW4pfVxuICAgICAgICAgIGRhdGEtcGljdHVyZS1pbi1waWN0dXJlPXtTdHJpbmcocGljdHVyZUluUGljdHVyZSl9XG4gICAgICAgICAgZGF0YS12aWRlby1xdWFsaXR5PXtTdHJpbmcodmlkZW9RdWFsaXR5KX1cbiAgICAgICAgLz5cbiAgICAgICkgOiAoXG4gICAgICAgIDxSYWRpeC5QcmltaXRpdmUuZGl2XG4gICAgICAgICAgey4uLmFzcGVjdFJhdGlvUHJvcHN9XG4gICAgICAgICAgcmVmPXtmb3J3YXJkZWRSZWZ9XG4gICAgICAgICAgZGF0YS1saXZlcGVlci13cmFwcGVyPVwiXCJcbiAgICAgICAgICBkYXRhLWZ1bGxzY3JlZW49e1N0cmluZyhmdWxsc2NyZWVuKX1cbiAgICAgICAgICBkYXRhLXBsYXlpbmc9e1N0cmluZyhwbGF5aW5nKX1cbiAgICAgICAgICBkYXRhLWNhbi1wbGF5PXtTdHJpbmcoY2FuUGxheSl9XG4gICAgICAgICAgZGF0YS1wbGF5YmFjay1yYXRlPXtyYXRlfVxuICAgICAgICAgIGRhdGEtZXJyb3I9e1N0cmluZyhlcnJvcil9XG4gICAgICAgICAgZGF0YS1sb2FkaW5nPXtTdHJpbmcobG9hZGluZyl9XG4gICAgICAgICAgZGF0YS1saXZlPXtTdHJpbmcobGl2ZSl9XG4gICAgICAgICAgZGF0YS1oYXMtcGxheWVkPXtTdHJpbmcoaGFzUGxheWVkKX1cbiAgICAgICAgICBkYXRhLWNvbnRyb2xzLWhpZGRlbj17U3RyaW5nKGhpZGRlbil9XG4gICAgICAgICAgZGF0YS1waWN0dXJlLWluLXBpY3R1cmU9e1N0cmluZyhwaWN0dXJlSW5QaWN0dXJlKX1cbiAgICAgICAgICBkYXRhLXZpZGVvLXF1YWxpdHk9e1N0cmluZyh2aWRlb1F1YWxpdHkpfVxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICB9LFxuICApLFxuKTtcblxuQ29udGFpbmVyLmRpc3BsYXlOYW1lID0gQ09OVEFJTkVSX05BTUU7XG5cbmV4cG9ydCB7IENvbnRhaW5lciwgdHlwZSBDb250YWluZXJQcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB0eXBlIHsgUGxheWJhY2tFcnJvciB9IGZyb20gXCJAbGl2ZXBlZXIvY29yZS9tZWRpYVwiO1xuaW1wb3J0IHsgUHJlc2VuY2UgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXByZXNlbmNlXCI7XG5pbXBvcnQgUmVhY3QsIHsgdXNlTWVtbyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdHlwZSBNZWRpYVNjb3BlZFByb3BzLCB1c2VNZWRpYUNvbnRleHQgfSBmcm9tIFwiLi9jb250ZXh0XCI7XG5pbXBvcnQgKiBhcyBSYWRpeCBmcm9tIFwiLi9wcmltaXRpdmVcIjtcblxuY29uc3QgRVJST1JfSU5ESUNBVE9SX05BTUUgPSBcIkVycm9ySW5kaWNhdG9yXCI7XG5cbnR5cGUgRXJyb3JJbmRpY2F0b3JFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj47XG5cbmludGVyZmFjZSBFcnJvckluZGljYXRvclByb3BzXG4gIGV4dGVuZHMgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuZGl2PiB7XG4gIC8qKlxuICAgKiBVc2VkIHRvIGZvcmNlIG1vdW50aW5nIHdoZW4gbW9yZSBjb250cm9sIGlzIG5lZWRlZC4gVXNlZnVsIHdoZW5cbiAgICogY29udHJvbGxpbmcgYW5pbWF0aW9uIHdpdGggUmVhY3QgYW5pbWF0aW9uIGxpYnJhcmllcy5cbiAgICovXG4gIGZvcmNlTW91bnQ/OiB0cnVlO1xuICAvKipcbiAgICogVGhlIG1hdGNoZXIgdXNlZCB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgZWxlbWVudCBzaG91bGQgYmUgc2hvd24sIGdpdmVuIHRoZSBlcnJvciBzdGF0ZS5cbiAgICpcbiAgICogUGFzc2luZyBgYWxsYCBtZWFucyBpdCB3aWxsIGRpc3BsYXkgb24gYWxsIGVycm9ycywgYW5kIGBub3QtcGVybWlzc2lvbnNgIGlzIG9ubHkgZXJyb3JzXG4gICAqIHRoYXQgYXJlIG5vdCBmYWlsZWQgY2FtZXJhLCBhdWRpbywgb3IgZGlzcGxheSBwZXJtaXNzaW9ucyByZXF1ZXN0cy5cbiAgICovXG4gIG1hdGNoZXI6XG4gICAgfCBcImFsbFwiXG4gICAgfCBcIm5vdC1wZXJtaXNzaW9uc1wiXG4gICAgfCBQbGF5YmFja0Vycm9yW1widHlwZVwiXVxuICAgIHwgKChzdGF0ZTogUGxheWJhY2tFcnJvcltcInR5cGVcIl0pID0+IGJvb2xlYW4pO1xufVxuXG5jb25zdCBFcnJvckluZGljYXRvciA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIEVycm9ySW5kaWNhdG9yRWxlbWVudCxcbiAgRXJyb3JJbmRpY2F0b3JQcm9wc1xuPigocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8RXJyb3JJbmRpY2F0b3JQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZm9yY2VNb3VudCwgbWF0Y2hlciwgLi4ub2ZmbGluZUVycm9yUHJvcHMgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGNvbnRleHQgPSB1c2VNZWRpYUNvbnRleHQoRVJST1JfSU5ESUNBVE9SX05BTUUsIF9fc2NvcGVNZWRpYSk7XG5cbiAgY29uc3QgZXJyb3IgPSB1c2VTdG9yZShjb250ZXh0LnN0b3JlLCAoeyBlcnJvciB9KSA9PiBlcnJvcik7XG5cbiAgY29uc3QgaXNQcmVzZW50ID0gdXNlTWVtbyhcbiAgICAoKSA9PlxuICAgICAgZXJyb3JcbiAgICAgICAgPyB0eXBlb2YgbWF0Y2hlciA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgID8gbWF0Y2hlciA9PT0gXCJhbGxcIlxuICAgICAgICAgICAgPyB0cnVlXG4gICAgICAgICAgICA6IG1hdGNoZXIgPT09IFwibm90LXBlcm1pc3Npb25zXCJcbiAgICAgICAgICAgICAgPyBlcnJvci50eXBlICE9PSBcInBlcm1pc3Npb25zXCJcbiAgICAgICAgICAgICAgOiBtYXRjaGVyID09PSBlcnJvci50eXBlXG4gICAgICAgICAgOiBtYXRjaGVyKGVycm9yLnR5cGUpXG4gICAgICAgIDogZmFsc2UsXG4gICAgW2Vycm9yLCBtYXRjaGVyXSxcbiAgKTtcblxuICByZXR1cm4gKFxuICAgIDxQcmVzZW5jZSBwcmVzZW50PXtmb3JjZU1vdW50IHx8IGlzUHJlc2VudH0+XG4gICAgICA8UmFkaXguUHJpbWl0aXZlLmRpdlxuICAgICAgICB7Li4ub2ZmbGluZUVycm9yUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWVycm9yLWluZGljYXRvcj1cIlwiXG4gICAgICAgIGRhdGEtZXJyb3Itc3RhdGU9e1N0cmluZyhCb29sZWFuKGVycm9yKSl9XG4gICAgICAgIGRhdGEtZXJyb3ItdHlwZT17ZXJyb3I/LnR5cGUgPz8gXCJub25lXCJ9XG4gICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKGlzUHJlc2VudCl9XG4gICAgICAvPlxuICAgIDwvUHJlc2VuY2U+XG4gICk7XG59KTtcblxuRXJyb3JJbmRpY2F0b3IuZGlzcGxheU5hbWUgPSBFUlJPUl9JTkRJQ0FUT1JfTkFNRTtcblxuZXhwb3J0IHsgRXJyb3JJbmRpY2F0b3IgfTtcbmV4cG9ydCB0eXBlIHsgRXJyb3JJbmRpY2F0b3JQcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IGNvbXBvc2VFdmVudEhhbmRsZXJzIH0gZnJvbSBcIkByYWRpeC11aS9wcmltaXRpdmVcIjtcbmltcG9ydCB7IFByZXNlbmNlIH0gZnJvbSBcIkByYWRpeC11aS9yZWFjdC1wcmVzZW5jZVwiO1xuaW1wb3J0IFJlYWN0LCB7IHVzZU1lbW8gfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSBcInp1c3RhbmRcIjtcbmltcG9ydCB7IHVzZVNoYWxsb3cgfSBmcm9tIFwienVzdGFuZC9yZWFjdC9zaGFsbG93XCI7XG5pbXBvcnQgeyB0eXBlIE1lZGlhU2NvcGVkUHJvcHMsIHVzZU1lZGlhQ29udGV4dCB9IGZyb20gXCIuL2NvbnRleHRcIjtcbmltcG9ydCAqIGFzIFJhZGl4IGZyb20gXCIuL3ByaW1pdGl2ZVwiO1xuXG5pbXBvcnQgeyBub1Byb3BhZ2F0ZSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8qKlxuICogRnVsbHNjcmVlbkluZGljYXRvclxuICovXG5cbmNvbnN0IEZVTExTQ1JFRU5fSU5ESUNBVE9SX05BTUUgPSBcIkZ1bGxzY3JlZW5JbmRpY2F0b3JcIjtcblxudHlwZSBGdWxsc2NyZWVuSW5kaWNhdG9yRWxlbWVudCA9IFJlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5kaXY+O1xuXG5pbnRlcmZhY2UgRnVsbHNjcmVlbkluZGljYXRvclByb3BzXG4gIGV4dGVuZHMgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuZGl2PiB7XG4gIC8qKlxuICAgKiBVc2VkIHRvIGZvcmNlIG1vdW50aW5nIHdoZW4gbW9yZSBjb250cm9sIGlzIG5lZWRlZC4gVXNlZnVsIHdoZW5cbiAgICogY29udHJvbGxpbmcgYW5pbWF0aW9uIHdpdGggUmVhY3QgYW5pbWF0aW9uIGxpYnJhcmllcy5cbiAgICovXG4gIGZvcmNlTW91bnQ/OiB0cnVlO1xuICAvKiogVGhlIG1hdGNoZXIgdXNlZCB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgZWxlbWVudCBzaG91bGQgYmUgc2hvd24sIGdpdmVuIHRoZSBmdWxsc2NyZWVuIHN0YXRlLiBEZWZhdWx0cyB0byBgdHJ1ZWAuICovXG4gIG1hdGNoZXI/OiBib29sZWFuIHwgKChmdWxsc2NyZWVuOiBib29sZWFuKSA9PiBib29sZWFuKTtcbn1cblxuY29uc3QgRnVsbHNjcmVlbkluZGljYXRvciA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIEZ1bGxzY3JlZW5JbmRpY2F0b3JFbGVtZW50LFxuICBGdWxsc2NyZWVuSW5kaWNhdG9yUHJvcHNcbj4oKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPEZ1bGxzY3JlZW5JbmRpY2F0b3JQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7XG4gICAgX19zY29wZU1lZGlhLFxuICAgIGZvcmNlTW91bnQsXG4gICAgbWF0Y2hlciA9IHRydWUsXG4gICAgLi4uZnVsbHNjcmVlbkluZGljYXRvclByb3BzXG4gIH0gPSBwcm9wcztcblxuICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KEZVTExTQ1JFRU5fSU5ESUNBVE9SX05BTUUsIF9fc2NvcGVNZWRpYSk7XG5cbiAgY29uc3QgZnVsbHNjcmVlbiA9IHVzZVN0b3JlKFxuICAgIGNvbnRleHQuc3RvcmUsXG4gICAgdXNlU2hhbGxvdygoeyBmdWxsc2NyZWVuIH0pID0+IGZ1bGxzY3JlZW4pLFxuICApO1xuXG4gIGNvbnN0IGlzUHJlc2VudCA9IHVzZU1lbW8oXG4gICAgKCkgPT5cbiAgICAgIHR5cGVvZiBtYXRjaGVyID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBtYXRjaGVyKGZ1bGxzY3JlZW4pXG4gICAgICAgIDogbWF0Y2hlciA9PT0gZnVsbHNjcmVlbixcbiAgICBbbWF0Y2hlciwgZnVsbHNjcmVlbl0sXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8UHJlc2VuY2UgcHJlc2VudD17Zm9yY2VNb3VudCB8fCBpc1ByZXNlbnR9PlxuICAgICAgPFJhZGl4LlByaW1pdGl2ZS5kaXZcbiAgICAgICAgey4uLmZ1bGxzY3JlZW5JbmRpY2F0b3JQcm9wc31cbiAgICAgICAgcmVmPXtmb3J3YXJkZWRSZWZ9XG4gICAgICAgIGRhdGEtbGl2ZXBlZXItY29udHJvbHMtZnVsbHNjcmVlbi1pbmRpY2F0b3I9XCJcIlxuICAgICAgICBkYXRhLWZ1bGxzY3JlZW49e1N0cmluZyhCb29sZWFuKGZ1bGxzY3JlZW4pKX1cbiAgICAgICAgZGF0YS12aXNpYmxlPXtTdHJpbmcoaXNQcmVzZW50KX1cbiAgICAgIC8+XG4gICAgPC9QcmVzZW5jZT5cbiAgKTtcbn0pO1xuXG5GdWxsc2NyZWVuSW5kaWNhdG9yLmRpc3BsYXlOYW1lID0gRlVMTFNDUkVFTl9JTkRJQ0FUT1JfTkFNRTtcblxuLyoqXG4gKiBGdWxsc2NyZWVuVHJpZ2dlclxuICovXG5cbmNvbnN0IEZVTExTQ1JFRU5fVFJJR0dFUl9OQU1FID0gXCJGdWxsc2NyZWVuVHJpZ2dlclwiO1xuXG50eXBlIEZ1bGxzY3JlZW5UcmlnZ2VyRWxlbWVudCA9IFJlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5idXR0b24+O1xuXG5pbnRlcmZhY2UgRnVsbHNjcmVlblRyaWdnZXJQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj4ge31cblxuY29uc3QgRnVsbHNjcmVlblRyaWdnZXIgPSBSZWFjdC5mb3J3YXJkUmVmPFxuICBGdWxsc2NyZWVuVHJpZ2dlckVsZW1lbnQsXG4gIEZ1bGxzY3JlZW5UcmlnZ2VyUHJvcHNcbj4oKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPEZ1bGxzY3JlZW5UcmlnZ2VyUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgY29uc3QgeyBfX3Njb3BlTWVkaWEsIC4uLmZ1bGxzY3JlZW5Qcm9wcyB9ID0gcHJvcHM7XG5cbiAgY29uc3QgY29udGV4dCA9IHVzZU1lZGlhQ29udGV4dChGVUxMU0NSRUVOX1RSSUdHRVJfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICBjb25zdCB7IHRpdGxlLCBmdWxsc2NyZWVuLCByZXF1ZXN0VG9nZ2xlRnVsbHNjcmVlbiB9ID0gdXNlU3RvcmUoXG4gICAgY29udGV4dC5zdG9yZSxcbiAgICB1c2VTaGFsbG93KCh7IGZ1bGxzY3JlZW4sIF9fY29udHJvbHNGdW5jdGlvbnMsIGFyaWEgfSkgPT4gKHtcbiAgICAgIGZ1bGxzY3JlZW4sXG4gICAgICByZXF1ZXN0VG9nZ2xlRnVsbHNjcmVlbjogX19jb250cm9sc0Z1bmN0aW9ucy5yZXF1ZXN0VG9nZ2xlRnVsbHNjcmVlbixcbiAgICAgIHRpdGxlOiBhcmlhLmZ1bGxzY3JlZW4sXG4gICAgfSkpLFxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPFJhZGl4LlByaW1pdGl2ZS5idXR0b25cbiAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgYXJpYS1wcmVzc2VkPXtmdWxsc2NyZWVufVxuICAgICAgYXJpYS1sYWJlbD17dGl0bGUgPz8gdW5kZWZpbmVkfVxuICAgICAgdGl0bGU9e3RpdGxlID8/IHVuZGVmaW5lZH1cbiAgICAgIHsuLi5mdWxsc2NyZWVuUHJvcHN9XG4gICAgICBvbkNsaWNrPXtjb21wb3NlRXZlbnRIYW5kbGVycyhcbiAgICAgICAgcHJvcHMub25DbGljayxcbiAgICAgICAgbm9Qcm9wYWdhdGUocmVxdWVzdFRvZ2dsZUZ1bGxzY3JlZW4pLFxuICAgICAgKX1cbiAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgZGF0YS1saXZlcGVlci1jb250cm9scy1mdWxsc2NyZWVuLXRyaWdnZXI9XCJcIlxuICAgICAgZGF0YS1mdWxsc2NyZWVuLXN0YXRlPXtTdHJpbmcoQm9vbGVhbihmdWxsc2NyZWVuKSl9XG4gICAgLz5cbiAgKTtcbn0pO1xuXG5GdWxsc2NyZWVuVHJpZ2dlci5kaXNwbGF5TmFtZSA9IEZVTExTQ1JFRU5fVFJJR0dFUl9OQU1FO1xuXG5leHBvcnQgeyBGdWxsc2NyZWVuSW5kaWNhdG9yLCBGdWxsc2NyZWVuVHJpZ2dlciB9O1xuZXhwb3J0IHR5cGUgeyBGdWxsc2NyZWVuSW5kaWNhdG9yUHJvcHMsIEZ1bGxzY3JlZW5UcmlnZ2VyUHJvcHMgfTtcbiIsIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyBQcmVzZW5jZSB9IGZyb20gXCJAcmFkaXgtdWkvcmVhY3QtcHJlc2VuY2VcIjtcbmltcG9ydCBSZWFjdCwgeyB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gXCJ6dXN0YW5kXCI7XG5pbXBvcnQgeyB0eXBlIE1lZGlhU2NvcGVkUHJvcHMsIHVzZU1lZGlhQ29udGV4dCB9IGZyb20gXCIuL2NvbnRleHRcIjtcbmltcG9ydCAqIGFzIFJhZGl4IGZyb20gXCIuL3ByaW1pdGl2ZVwiO1xuXG5jb25zdCBMT0FESU5HX0lORElDQVRPUl9OQU1FID0gXCJMb2FkaW5nSW5kaWNhdG9yXCI7XG5cbnR5cGUgTG9hZGluZ0luZGljYXRvckVsZW1lbnQgPSBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuZGl2PjtcblxuaW50ZXJmYWNlIExvYWRpbmdJbmRpY2F0b3JQcm9wc1xuICBleHRlbmRzIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmRpdj4ge1xuICAvKipcbiAgICogVXNlZCB0byBmb3JjZSBtb3VudGluZyB3aGVuIG1vcmUgY29udHJvbCBpcyBuZWVkZWQuIFVzZWZ1bCB3aGVuXG4gICAqIGNvbnRyb2xsaW5nIGFuaW1hdGlvbiB3aXRoIFJlYWN0IGFuaW1hdGlvbiBsaWJyYXJpZXMuXG4gICAqL1xuICBmb3JjZU1vdW50PzogdHJ1ZTtcbiAgLyoqIFRoZSBtYXRjaGVyIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGVsZW1lbnQgc2hvdWxkIGJlIHNob3duLCBnaXZlbiB0aGUgYGxvYWRpbmdgIHN0YXRlLiBEZWZhdWx0cyB0byBgdHJ1ZWAuICovXG4gIG1hdGNoZXI/OiBib29sZWFuIHwgKChsaXZlOiBib29sZWFuKSA9PiBib29sZWFuKTtcbn1cblxuY29uc3QgTG9hZGluZ0luZGljYXRvciA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIExvYWRpbmdJbmRpY2F0b3JFbGVtZW50LFxuICBMb2FkaW5nSW5kaWNhdG9yUHJvcHNcbj4oKHByb3BzOiBNZWRpYVNjb3BlZFByb3BzPExvYWRpbmdJbmRpY2F0b3JQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7XG4gICAgX19zY29wZU1lZGlhLFxuICAgIGZvcmNlTW91bnQsXG4gICAgbWF0Y2hlciA9IHRydWUsXG4gICAgLi4ub2ZmbGluZUVycm9yUHJvcHNcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGNvbnRleHQgPSB1c2VNZWRpYUNvbnRleHQoTE9BRElOR19JTkRJQ0FUT1JfTkFNRSwgX19zY29wZU1lZGlhKTtcblxuICBjb25zdCBsb2FkaW5nID0gdXNlU3RvcmUoY29udGV4dC5zdG9yZSwgKHsgbG9hZGluZyB9KSA9PiBsb2FkaW5nKTtcblxuICBjb25zdCBpc1ByZXNlbnQgPSB1c2VNZW1vKFxuICAgICgpID0+XG4gICAgICB0eXBlb2YgbWF0Y2hlciA9PT0gXCJmdW5jdGlvblwiID8gbWF0Y2hlcihsb2FkaW5nKSA6IG1hdGNoZXIgPT09IGxvYWRpbmcsXG4gICAgW21hdGNoZXIsIGxvYWRpbmddLFxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPFByZXNlbmNlIHByZXNlbnQ9e2ZvcmNlTW91bnQgfHwgaXNQcmVzZW50fT5cbiAgICAgIDxSYWRpeC5QcmltaXRpdmUuZGl2XG4gICAgICAgIGFyaWEtbGFiZWw9e1wiTG9hZGluZ1wifVxuICAgICAgICB7Li4ub2ZmbGluZUVycm9yUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWxvYWRpbmctaW5kaWNhdG9yPVwiXCJcbiAgICAgICAgZGF0YS1sb2FkaW5nPXtTdHJpbmcoQm9vbGVhbihsb2FkaW5nKSl9XG4gICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKGlzUHJlc2VudCl9XG4gICAgICAvPlxuICAgIDwvUHJlc2VuY2U+XG4gICk7XG59KTtcblxuTG9hZGluZ0luZGljYXRvci5kaXNwbGF5TmFtZSA9IExPQURJTkdfSU5ESUNBVE9SX05BTUU7XG5cbmV4cG9ydCB7IExvYWRpbmdJbmRpY2F0b3IgfTtcbmV4cG9ydCB0eXBlIHsgTG9hZGluZ0luZGljYXRvclByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgY29tcG9zZUV2ZW50SGFuZGxlcnMgfSBmcm9tIFwiQHJhZGl4LXVpL3ByaW1pdGl2ZVwiO1xuaW1wb3J0IHsgUHJlc2VuY2UgfSBmcm9tIFwiQHJhZGl4LXVpL3JlYWN0LXByZXNlbmNlXCI7XG5cbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4vY29udGV4dFwiO1xuaW1wb3J0ICogYXMgUmFkaXggZnJvbSBcIi4vcHJpbWl0aXZlXCI7XG5pbXBvcnQgeyBub1Byb3BhZ2F0ZSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmNvbnN0IFBJQ1RVUkVfSU5fUElDVFVSRV9UUklHR0VSX05BTUUgPSBcIlBpY3R1cmVJblBpY3R1cmVUcmlnZ2VyXCI7XG5cbnR5cGUgUGljdHVyZUluUGljdHVyZVRyaWdnZXJFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjxcbiAgdHlwZW9mIFJhZGl4LlByaW1pdGl2ZS5idXR0b25cbj47XG5cbmludGVyZmFjZSBQaWN0dXJlSW5QaWN0dXJlVHJpZ2dlclByb3BzXG4gIGV4dGVuZHMgUmFkaXguQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBSYWRpeC5QcmltaXRpdmUuYnV0dG9uPiB7XG4gIC8qKlxuICAgKiBVc2VkIHRvIGZvcmNlIG1vdW50aW5nIHdoZW4gbW9yZSBjb250cm9sIGlzIG5lZWRlZC4gVXNlZnVsIHdoZW5cbiAgICogY29udHJvbGxpbmcgYW5pbWF0aW9uIHdpdGggUmVhY3QgYW5pbWF0aW9uIGxpYnJhcmllcy5cbiAgICovXG4gIGZvcmNlTW91bnQ/OiB0cnVlO1xufVxuXG5jb25zdCBQaWN0dXJlSW5QaWN0dXJlVHJpZ2dlciA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIFBpY3R1cmVJblBpY3R1cmVUcmlnZ2VyRWxlbWVudCxcbiAgUGljdHVyZUluUGljdHVyZVRyaWdnZXJQcm9wc1xuPigocHJvcHM6IE1lZGlhU2NvcGVkUHJvcHM8UGljdHVyZUluUGljdHVyZVRyaWdnZXJQcm9wcz4sIGZvcndhcmRlZFJlZikgPT4ge1xuICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgZm9yY2VNb3VudCwgLi4ucGljdHVyZUluUGljdHVyZVByb3BzIH0gPSBwcm9wcztcblxuICBjb25zdCBjb250ZXh0ID0gdXNlTWVkaWFDb250ZXh0KFxuICAgIFBJQ1RVUkVfSU5fUElDVFVSRV9UUklHR0VSX05BTUUsXG4gICAgX19zY29wZU1lZGlhLFxuICApO1xuXG4gIGNvbnN0IHtcbiAgICBwaWN0dXJlSW5QaWN0dXJlLFxuICAgIHJlcXVlc3RUb2dnbGVQaWN0dXJlSW5QaWN0dXJlLFxuICAgIGlzUGljdHVyZUluUGljdHVyZVN1cHBvcnRlZCxcbiAgICBmdWxsc2NyZWVuLFxuICAgIHRpdGxlLFxuICB9ID0gdXNlU3RvcmUoXG4gICAgY29udGV4dC5zdG9yZSxcbiAgICB1c2VTaGFsbG93KFxuICAgICAgKHtcbiAgICAgICAgcGljdHVyZUluUGljdHVyZSxcbiAgICAgICAgX19jb250cm9sc0Z1bmN0aW9ucyxcbiAgICAgICAgX19kZXZpY2UsXG4gICAgICAgIGZ1bGxzY3JlZW4sXG4gICAgICAgIGFyaWEsXG4gICAgICB9KSA9PiAoe1xuICAgICAgICBwaWN0dXJlSW5QaWN0dXJlLFxuICAgICAgICByZXF1ZXN0VG9nZ2xlUGljdHVyZUluUGljdHVyZTpcbiAgICAgICAgICBfX2NvbnRyb2xzRnVuY3Rpb25zLnJlcXVlc3RUb2dnbGVQaWN0dXJlSW5QaWN0dXJlLFxuICAgICAgICBpc1BpY3R1cmVJblBpY3R1cmVTdXBwb3J0ZWQ6IF9fZGV2aWNlLmlzUGljdHVyZUluUGljdHVyZVN1cHBvcnRlZCxcbiAgICAgICAgZnVsbHNjcmVlbixcbiAgICAgICAgdGl0bGU6IGFyaWEucGljdHVyZUluUGljdHVyZSxcbiAgICAgIH0pLFxuICAgICksXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICAvLyBkbyBub3Qgc2hvdyBidXR0b24gaWYgaXQgaXMgbm90IHN1cHBvcnRlZCBvciBpZiBjdXJyZW50bHkgZnVsbHNjcmVlblxuICAgIDxQcmVzZW5jZVxuICAgICAgcHJlc2VudD17Zm9yY2VNb3VudCB8fCAoaXNQaWN0dXJlSW5QaWN0dXJlU3VwcG9ydGVkICYmICFmdWxsc2NyZWVuKX1cbiAgICA+XG4gICAgICA8UmFkaXguUHJpbWl0aXZlLmJ1dHRvblxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgYXJpYS1wcmVzc2VkPXtwaWN0dXJlSW5QaWN0dXJlfVxuICAgICAgICBhcmlhLWxhYmVsPXt0aXRsZSA/PyB1bmRlZmluZWR9XG4gICAgICAgIHRpdGxlPXt0aXRsZSA/PyB1bmRlZmluZWR9XG4gICAgICAgIHsuLi5waWN0dXJlSW5QaWN0dXJlUHJvcHN9XG4gICAgICAgIG9uQ2xpY2s9e2NvbXBvc2VFdmVudEhhbmRsZXJzKFxuICAgICAgICAgIHByb3BzLm9uQ2xpY2ssXG4gICAgICAgICAgbm9Qcm9wYWdhdGUocmVxdWVzdFRvZ2dsZVBpY3R1cmVJblBpY3R1cmUpLFxuICAgICAgICApfVxuICAgICAgICByZWY9e2ZvcndhcmRlZFJlZn1cbiAgICAgICAgZGF0YS1saXZlcGVlci1jb250cm9scy1waWN0dXJlLWluLXBpY3R1cmUtdHJpZ2dlcj1cIlwiXG4gICAgICAgIGRhdGEtcGljdHVyZS1pbi1waWN0dXJlPXtTdHJpbmcoQm9vbGVhbihwaWN0dXJlSW5QaWN0dXJlKSl9XG4gICAgICAgIGRhdGEtdmlzaWJsZT17U3RyaW5nKGlzUGljdHVyZUluUGljdHVyZVN1cHBvcnRlZCAmJiAhZnVsbHNjcmVlbil9XG4gICAgICAvPlxuICAgIDwvUHJlc2VuY2U+XG4gICk7XG59KTtcblxuUGljdHVyZUluUGljdHVyZVRyaWdnZXIuZGlzcGxheU5hbWUgPSBQSUNUVVJFX0lOX1BJQ1RVUkVfVFJJR0dFUl9OQU1FO1xuXG5leHBvcnQgeyBQaWN0dXJlSW5QaWN0dXJlVHJpZ2dlciB9O1xuZXhwb3J0IHR5cGUgeyBQaWN0dXJlSW5QaWN0dXJlVHJpZ2dlclByb3BzIH07XG4iLCJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0ICogYXMgUmFkaXhQb3J0YWwgZnJvbSBcIkByYWRpeC11aS9yZWFjdC1wb3J0YWxcIjtcbi8vIGJpb21lLWlnbm9yZSBsaW50L3N0eWxlL3VzZUltcG9ydFR5cGU6IG5lY2Vzc2FyeSBpbXBvcnRcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuY29uc3QgUE9SVEFMX05BTUUgPSBcIlBvcnRhbFwiO1xuXG50eXBlIFBvcnRhbFByb3BzID0gUmVhY3QuQ29tcG9uZW50UHJvcHNXaXRob3V0UmVmPHR5cGVvZiBSYWRpeFBvcnRhbC5Sb290PjtcblxuY29uc3QgUG9ydGFsOiBSZWFjdC5GQzxQb3J0YWxQcm9wcz4gPSAocHJvcHM6IFBvcnRhbFByb3BzKSA9PiB7XG4gIHJldHVybiA8UmFkaXhQb3J0YWwuUm9vdCB7Li4ucHJvcHN9IC8+O1xufTtcblxuUG9ydGFsLmRpc3BsYXlOYW1lID0gUE9SVEFMX05BTUU7XG5cbmV4cG9ydCB7IFBvcnRhbCwgdHlwZSBQb3J0YWxQcm9wcyB9O1xuIiwiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgdXNlU2hhbGxvdyB9IGZyb20gXCJ6dXN0YW5kL3JlYWN0L3NoYWxsb3dcIjtcbmltcG9ydCB7IHR5cGUgTWVkaWFTY29wZWRQcm9wcywgdXNlTWVkaWFDb250ZXh0IH0gZnJvbSBcIi4vY29udGV4dFwiO1xuaW1wb3J0ICogYXMgUmFkaXggZnJvbSBcIi4vcHJpbWl0aXZlXCI7XG5cbmNvbnN0IFRJTUVfTkFNRSA9IFwiVGltZVwiO1xuXG50eXBlIFRpbWVFbGVtZW50ID0gUmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj47XG5cbmludGVyZmFjZSBUaW1lUHJvcHNcbiAgZXh0ZW5kcyBPbWl0PFxuICAgIFJhZGl4LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjx0eXBlb2YgUmFkaXguUHJpbWl0aXZlLmJ1dHRvbj4sXG4gICAgXCJjaGlsZHJlblwiXG4gID4ge31cblxuY29uc3QgVGltZSA9IFJlYWN0LmZvcndhcmRSZWY8VGltZUVsZW1lbnQsIFRpbWVQcm9wcz4oXG4gIChwcm9wczogTWVkaWFTY29wZWRQcm9wczxUaW1lUHJvcHM+LCBmb3J3YXJkZWRSZWYpID0+IHtcbiAgICBjb25zdCB7IF9fc2NvcGVNZWRpYSwgLi4udGltZVByb3BzIH0gPSBwcm9wcztcblxuICAgIGNvbnN0IGNvbnRleHQgPSB1c2VNZWRpYUNvbnRleHQoVElNRV9OQU1FLCBfX3Njb3BlTWVkaWEpO1xuXG4gICAgY29uc3QgeyBwcm9ncmVzcywgZHVyYXRpb24sIGxpdmUsIGZvcm1hdHRlZFRpbWUgfSA9IHVzZVN0b3JlKFxuICAgICAgY29udGV4dC5zdG9yZSxcbiAgICAgIHVzZVNoYWxsb3coKHsgcHJvZ3Jlc3MsIGR1cmF0aW9uLCBsaXZlLCBhcmlhIH0pID0+ICh7XG4gICAgICAgIGZvcm1hdHRlZFRpbWU6IGFyaWEudGltZSxcbiAgICAgICAgcHJvZ3Jlc3MsXG4gICAgICAgIGR1cmF0aW9uLFxuICAgICAgICBsaXZlLFxuICAgICAgfSkpLFxuICAgICk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFJhZGl4LlByaW1pdGl2ZS5zcGFuXG4gICAgICAgIGFyaWEtbGFiZWw9e2Zvcm1hdHRlZFRpbWUgPz8gdW5kZWZpbmVkfVxuICAgICAgICB0aXRsZT17Zm9ybWF0dGVkVGltZSA/PyB1bmRlZmluZWR9XG4gICAgICAgIHsuLi50aW1lUHJvcHN9XG4gICAgICAgIHJlZj17Zm9yd2FyZGVkUmVmfVxuICAgICAgICBkYXRhLWxpdmVwZWVyLWNvbnRyb2xzLXRpbWU9XCJcIlxuICAgICAgICBkYXRhLWR1cmF0aW9uPXtkdXJhdGlvbn1cbiAgICAgICAgZGF0YS1wcm9ncmVzcz17cHJvZ3Jlc3N9XG4gICAgICAgIGRhdGEtbGl2ZT17U3RyaW5nKGxpdmUpfVxuICAgICAgPlxuICAgICAgICB7Zm9ybWF0dGVkVGltZX1cbiAgICAgIDwvUmFkaXguUHJpbWl0aXZlLnNwYW4+XG4gICAgKTtcbiAgfSxcbik7XG5cblRpbWUuZGlzcGxheU5hbWUgPSBUSU1FX05BTUU7XG5cbmV4cG9ydCB7IFRpbWUgfTtcbmV4cG9ydCB0eXBlIHsgVGltZVByb3BzIH07XG4iXSwibmFtZXMiOlsiY29tcG9zZUV2ZW50SGFuZGxlcnMiLCJQcmVzZW5jZSIsIlJlYWN0IiwidXNlRWZmZWN0IiwidXNlU3RvcmUiLCJ1c2VTaGFsbG93IiwiY3JlYXRlQ29udGV4dFNjb3BlIiwidXNlU3RvcmVadXN0YW5kIiwiTUVESUFfTkFNRSIsImNyZWF0ZU1lZGlhQ29udGV4dCIsImNyZWF0ZU1lZGlhU2NvcGUiLCJNZWRpYVByb3ZpZGVyIiwidXNlTWVkaWFDb250ZXh0IiwiU2xvdCIsIlJlYWN0RE9NIiwiTk9ERVMiLCJQcmltaXRpdmUiLCJyZWR1Y2UiLCJwcmltaXRpdmUiLCJub2RlIiwiTm9kZSIsImZvcndhcmRSZWYiLCJwcm9wcyIsImZvcndhcmRlZFJlZiIsImFzQ2hpbGQiLCJwcmltaXRpdmVQcm9wcyIsIkNvbXAiLCJ3aW5kb3ciLCJTeW1ib2wiLCJmb3IiLCJjcmVhdGVFbGVtZW50IiwicmVmIiwiZGlzcGxheU5hbWUiLCJub1Byb3BhZ2F0ZSIsImNiIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJDTElQX1RSSUdHRVJfTkFNRSIsIkNsaXBUcmlnZ2VyIiwiX19zY29wZU1lZGlhIiwiZm9yY2VNb3VudCIsIm9uQ2xpcCIsImNsaXBUcmlnZ2VyUHJvcHMiLCJjb250ZXh0IiwiY2xpcExlbmd0aCIsInJlcXVlc3RDbGlwIiwicGxheWJhY2tJZCIsInRpdGxlIiwic3RvcmUiLCJfX2NvbnRyb2xzIiwiX19jb250cm9sc0Z1bmN0aW9ucyIsImFyaWEiLCJfX2luaXRpYWxQcm9wcyIsImNsaXAiLCJzdWJzY3JpYmUiLCJzdGF0ZSIsInJlcXVlc3RlZENsaXBQYXJhbXMiLCJwYXJhbXMiLCJwcmVzZW50IiwiQm9vbGVhbiIsImJ1dHRvbiIsInR5cGUiLCJkaXNhYmxlZCIsIm9uQ2xpY2siLCJTdHJpbmciLCJ1c2VNZW1vIiwiQ09OVFJPTFNfTkFNRSIsIkNvbnRyb2xzIiwic3R5bGUiLCJhdXRvSGlkZSIsImNvbnRyb2xzUHJvcHMiLCJoaWRkZW4iLCJsb2FkaW5nIiwidG9nZ2xlUGxheSIsImVycm9yIiwic2hvd24iLCJnZXRTdGF0ZSIsInNldEF1dG9oaWRlIiwiZGl2IiwicG9zaXRpb24iLCJpbnNldCIsIkxJVkVfSU5ESUNBVE9SX05BTUUiLCJMaXZlSW5kaWNhdG9yIiwibWF0Y2hlciIsImxpdmVJbmRpY2F0b3JQcm9wcyIsImxpdmUiLCJpc1ByZXNlbnQiLCJzcGFuIiwiTVVURV9UUklHR0VSX05BTUUiLCJNdXRlVHJpZ2dlciIsInBsYXlQcm9wcyIsIm11dGVkIiwidG9nZ2xlTXV0ZSIsInJlcXVlc3RUb2dnbGVNdXRlIiwiUExBWV9QQVVTRV9UUklHR0VSX05BTUUiLCJQbGF5UGF1c2VUcmlnZ2VyIiwicGxheWluZyIsInBsYXlQYXVzZSIsIlBMQVlJTkdfSU5ESUNBVE9SX05BTUUiLCJQbGF5aW5nSW5kaWNhdG9yIiwicGxheVBhdXNlSW5kaWNhdG9yUHJvcHMiLCJhZGRMZWdhY3lNZWRpYU1ldHJpY3NUb1N0b3JlIiwiYWRkTWV0cmljc1RvU3RvcmUiLCJjcmVhdGVDb250cm9sbGVyU3RvcmUiLCJjcmVhdGVTdG9yYWdlIiwibm9vcFN0b3JhZ2UiLCJ2ZXJzaW9uIiwiZ2V0RGV2aWNlSW5mbyIsInVzZVJlZiIsIlBsYXllciIsIm1lbW8iLCJhc3BlY3RSYXRpbyIsInNyYyIsImNoaWxkcmVuIiwiand0IiwiYWNjZXNzS2V5Iiwic3RvcmFnZSIsIm9uUGxheWJhY2tFdmVudHMiLCJtZXRyaWNzSW50ZXJ2YWwiLCJyZXN0IiwiZGV2aWNlIiwicmVhY3QiLCJsb2NhbFN0b3JhZ2UiLCJpbml0aWFsUHJvcHMiLCJjdXJyZW50Iiwic2V0U3RhdGUiLCJwcmV2IiwiZGVzdHJveSIsIm1ldHJpY3MiLCJpbnRlcnZhbCIsInNjb3BlIiwiUm9vdCIsIlBPU1RFUl9OQU1FIiwiUG9zdGVyIiwicG9zdGVyUHJvcHMiLCJwb3N0ZXIiLCJpbWciLCJhbHQiLCJ1c2VDYWxsYmFjayIsIlNlbGVjdFByaW1pdGl2ZSIsIlNlbGVjdFJvb3QiLCJTZWxlY3RUcmlnZ2VyIiwiU2VsZWN0VmFsdWUiLCJTZWxlY3RJY29uIiwiU2VsZWN0UG9ydGFsIiwiU2VsZWN0Q29udGVudCIsIlNlbGVjdFZpZXdwb3J0IiwiU2VsZWN0R3JvdXAiLCJTZWxlY3RMYWJlbCIsIlNlbGVjdEl0ZW0iLCJTZWxlY3RJdGVtVGV4dCIsIlNlbGVjdEl0ZW1JbmRpY2F0b3IiLCJTZWxlY3RTY3JvbGxVcEJ1dHRvbiIsIlNlbGVjdFNjcm9sbERvd25CdXR0b24iLCJTZWxlY3RTZXBhcmF0b3IiLCJTZWxlY3RBcnJvdyIsIlJBVEVfU0VMRUNUX05BTUUiLCJSYXRlU2VsZWN0IiwiZGVmYXVsdFZhbHVlIiwicmF0ZVNlbGVjdFByb3BzIiwicGxheWJhY2tSYXRlIiwic2V0UGxheWJhY2tSYXRlIiwib25WYWx1ZUNoYW5nZUNvbXBvc2VkIiwidmFsdWUiLCJvblZhbHVlQ2hhbmdlIiwidG9GaXhlZCIsIlJBVEVfU0VMRUNUX0lURU1fTkFNRSIsIlJhdGVTZWxlY3RJdGVtIiwicmF0ZVNlbGVjdEl0ZW1Qcm9wcyIsIk51bWJlciIsIlNsaWRlclByaW1pdGl2ZSIsIlRyYWNrIiwiUmFuZ2UiLCJUaHVtYiIsIlNFRUtfTkFNRSIsIlNlZWsiLCJzZWVrUHJvcHMiLCJhcmlhUHJvZ3Jlc3MiLCJkdXJhdGlvbiIsImJ1ZmZlcmVkIiwiYnVmZmVyZWRQZXJjZW50IiwicHJvZ3Jlc3MiLCJzZWVrIiwicmVxdWVzdFNlZWsiLCJvblZhbHVlQ29tbWl0Iiwib25WYWx1ZUNvbW1pdENvbXBvc2VkIiwic3RlcCIsIm1heCIsInJvbGUiLCJTRUVLX0JVRkZFUl9OQU1FIiwiU2Vla0J1ZmZlciIsImJ1ZmZlclByb3BzIiwibGVmdCIsInJpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lcnMiLCJ1c2VDb21wb3NlZFJlZnMiLCJWSURFT19OQU1FIiwiVmlkZW8iLCJobHNDb25maWciLCJ2aWRlb1Byb3BzIiwiY29tcG9zZWRSZWZzIiwiY3VycmVudFNvdXJjZSIsInNldE1vdW50ZWQiLCJhdXRvUGxheSIsInByZWxvYWQiLCJ0aHVtYm5haWxQb3N0ZXIiLCJ2b2x1bWUiLCJzZXRIbHNDb25maWciLCJ2aWRlbyIsInBsYXlzSW5saW5lIiwiVklERU9fUVVBTElUWV9TRUxFQ1RfTkFNRSIsIlZpZGVvUXVhbGl0eVNlbGVjdCIsInZpZGVvUXVhbGl0eVNlbGVjdFByb3BzIiwidmlkZW9RdWFsaXR5Iiwic2V0VmlkZW9RdWFsaXR5IiwiVklERU9fUVVBTElUWV9TRUxFQ1RfSVRFTV9OQU1FIiwiVmlkZW9RdWFsaXR5U2VsZWN0SXRlbSIsInZpZGVvUXVhbGl0eVNlbGVjdEl0ZW1Qcm9wcyIsIndhcm4iLCJWT0xVTUVfTkFNRSIsIlZvbHVtZSIsInZvbHVtZVByb3BzIiwicmVxdWVzdFZvbHVtZSIsImlzVm9sdW1lQ2hhbmdlU3VwcG9ydGVkIiwiX19kZXZpY2UiLCJWT0xVTUVfSU5ESUNBVE9SX05BTUUiLCJWb2x1bWVJbmRpY2F0b3IiLCJ2b2x1bWVJbmRpY2F0b3JQcm9wcyIsIlJhZGl4QXNwZWN0UmF0aW8iLCJDT05UQUlORVJfTkFNRSIsIkNvbnRhaW5lciIsImFzcGVjdFJhdGlvUHJvcHMiLCJmdWxsc2NyZWVuIiwiY2FuUGxheSIsInJhdGUiLCJoYXNQbGF5ZWQiLCJwaWN0dXJlSW5QaWN0dXJlIiwicmF0aW8iLCJFUlJPUl9JTkRJQ0FUT1JfTkFNRSIsIkVycm9ySW5kaWNhdG9yIiwib2ZmbGluZUVycm9yUHJvcHMiLCJGVUxMU0NSRUVOX0lORElDQVRPUl9OQU1FIiwiRnVsbHNjcmVlbkluZGljYXRvciIsImZ1bGxzY3JlZW5JbmRpY2F0b3JQcm9wcyIsIkZVTExTQ1JFRU5fVFJJR0dFUl9OQU1FIiwiRnVsbHNjcmVlblRyaWdnZXIiLCJmdWxsc2NyZWVuUHJvcHMiLCJyZXF1ZXN0VG9nZ2xlRnVsbHNjcmVlbiIsIkxPQURJTkdfSU5ESUNBVE9SX05BTUUiLCJMb2FkaW5nSW5kaWNhdG9yIiwiUElDVFVSRV9JTl9QSUNUVVJFX1RSSUdHRVJfTkFNRSIsIlBpY3R1cmVJblBpY3R1cmVUcmlnZ2VyIiwicGljdHVyZUluUGljdHVyZVByb3BzIiwicmVxdWVzdFRvZ2dsZVBpY3R1cmVJblBpY3R1cmUiLCJpc1BpY3R1cmVJblBpY3R1cmVTdXBwb3J0ZWQiLCJSYWRpeFBvcnRhbCIsIlBPUlRBTF9OQU1FIiwiUG9ydGFsIiwiVElNRV9OQU1FIiwiVGltZSIsInRpbWVQcm9wcyIsImZvcm1hdHRlZFRpbWUiLCJ0aW1lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@livepeer/react/dist/player/index.js\n");

/***/ })

};
;